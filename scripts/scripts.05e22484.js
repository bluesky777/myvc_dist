!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){e.ui=e.ui||{};e.ui.version="1.12.1";var a,t=0,r=Array.prototype.slice;e.cleanData=(a=e.cleanData,function(t){var r,n,o;for(o=0;null!=(n=t[o]);o++)try{(r=e._data(n,"events"))&&r.remove&&e(n).triggerHandler("remove")}catch(e){}a(t)}),e.widget=function(a,t,r){var n,o,i,s={},u=a.split(".")[0],l=u+"-"+(a=a.split(".")[1]);return r||(r=t,t=e.Widget),e.isArray(r)&&(r=e.extend.apply(null,[{}].concat(r))),e.expr[":"][l.toLowerCase()]=function(a){return!!e.data(a,l)},e[u]=e[u]||{},n=e[u][a],o=e[u][a]=function(e,a){if(!this._createWidget)return new o(e,a);arguments.length&&this._createWidget(e,a)},e.extend(o,n,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),(i=new t).options=e.widget.extend({},i.options),e.each(r,function(a,r){e.isFunction(r)?s[a]=function(){function e(){return t.prototype[a].apply(this,arguments)}function n(e){return t.prototype[a].apply(this,e)}return function(){var a,t=this._super,o=this._superApply;return this._super=e,this._superApply=n,a=r.apply(this,arguments),this._super=t,this._superApply=o,a}}():s[a]=r}),o.prototype=e.widget.extend(i,{widgetEventPrefix:n&&i.widgetEventPrefix||a},s,{constructor:o,namespace:u,widgetName:a,widgetFullName:l}),n?(e.each(n._childConstructors,function(a,t){var r=t.prototype;e.widget(r.namespace+"."+r.widgetName,o,t._proto)}),delete n._childConstructors):t._childConstructors.push(o),e.widget.bridge(a,o),o},e.widget.extend=function(a){for(var t,n,o=r.call(arguments,1),i=0,s=o.length;i<s;i++)for(t in o[i])n=o[i][t],o[i].hasOwnProperty(t)&&void 0!==n&&(e.isPlainObject(n)?a[t]=e.isPlainObject(a[t])?e.widget.extend({},a[t],n):e.widget.extend({},n):a[t]=n);return a},e.widget.bridge=function(a,t){var n=t.prototype.widgetFullName||a;e.fn[a]=function(o){var i="string"==typeof o,s=r.call(arguments,1),u=this;return i?this.length||"instance"!==o?this.each(function(){var t,r=e.data(this,n);return"instance"===o?(u=r,!1):r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(t=r[o].apply(r,s))!==r&&void 0!==t?(u=t&&t.jquery?u.pushStack(t.get()):t,!1):void 0:e.error("no such method '"+o+"' for "+a+" widget instance"):e.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+o+"'")}):u=void 0:(s.length&&(o=e.widget.extend.apply(null,[o].concat(s))),this.each(function(){var a=e.data(this,n);a?(a.option(o||{}),a._init&&a._init()):e.data(this,n,new t(o,this))})),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(a,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),a),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var a=this;this._destroy(),e.each(this.classesElementLookup,function(e,t){a._removeClass(t,e)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(a,t){var r,n,o,i=a;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof a)if(i={},a=(r=a.split(".")).shift(),r.length){for(n=i[a]=e.widget.extend({},this.options[a]),o=0;o<r.length-1;o++)n[r[o]]=n[r[o]]||{},n=n[r[o]];if(a=r.pop(),1===arguments.length)return void 0===n[a]?null:n[a];n[a]=t}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];i[a]=t}return this._setOptions(i),this},_setOptions:function(e){var a;for(a in e)this._setOption(a,e[a]);return this},_setOption:function(e,a){return"classes"===e&&this._setOptionClasses(a),this.options[e]=a,"disabled"===e&&this._setOptionDisabled(a),this},_setOptionClasses:function(a){var t,r,n;for(t in a)n=this.classesElementLookup[t],a[t]!==this.options.classes[t]&&n&&n.length&&(r=e(n.get()),this._removeClass(n,t),r.addClass(this._classes({element:r,keys:t,classes:a,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(a){var t=[],r=this;function n(n,o){var i,s;for(s=0;s<n.length;s++)i=r.classesElementLookup[n[s]]||e(),i=a.add?e(e.unique(i.get().concat(a.element.get()))):e(i.not(a.element).get()),r.classesElementLookup[n[s]]=i,t.push(n[s]),o&&a.classes[n[s]]&&t.push(a.classes[n[s]])}return a=e.extend({element:this.element,classes:this.options.classes||{}},a),this._on(a.element,{remove:"_untrackClassesElement"}),a.keys&&n(a.keys.match(/\S+/g)||[],!0),a.extra&&n(a.extra.match(/\S+/g)||[]),t.join(" ")},_untrackClassesElement:function(a){var t=this;e.each(t.classesElementLookup,function(r,n){-1!==e.inArray(a.target,n)&&(t.classesElementLookup[r]=e(n.not(a.target).get()))})},_removeClass:function(e,a,t){return this._toggleClass(e,a,t,!1)},_addClass:function(e,a,t){return this._toggleClass(e,a,t,!0)},_toggleClass:function(e,a,t,r){r="boolean"==typeof r?r:t;var n="string"==typeof e||null===e,o={extra:n?a:t,keys:n?e:a,element:n?this.element:e,add:r};return o.element.toggleClass(this._classes(o),r),this},_on:function(a,t,r){var n,o=this;"boolean"!=typeof a&&(r=t,t=a,a=!1),r?(t=n=e(t),this.bindings=this.bindings.add(t)):(r=t,t=this.element,n=this.widget()),e.each(r,function(r,i){function s(){if(a||!0!==o.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof i?o[i]:i).apply(o,arguments)}"string"!=typeof i&&(s.guid=i.guid=i.guid||s.guid||e.guid++);var u=r.match(/^([\w:-]*)\s*(.*)$/),l=u[1]+o.eventNamespace,c=u[2];c?n.on(l,c,s):t.on(l,s)})},_off:function(a,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.off(t).off(t),this.bindings=e(this.bindings.not(a).get()),this.focusable=e(this.focusable.not(a).get()),this.hoverable=e(this.hoverable.not(a).get())},_delay:function(e,a){var t=this;return setTimeout(function(){return("string"==typeof e?t[e]:e).apply(t,arguments)},a||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a),this._on(a,{mouseenter:function(a){this._addClass(e(a.currentTarget),null,"ui-state-hover")},mouseleave:function(a){this._removeClass(e(a.currentTarget),null,"ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a),this._on(a,{focusin:function(a){this._addClass(e(a.currentTarget),null,"ui-state-focus")},focusout:function(a){this._removeClass(e(a.currentTarget),null,"ui-state-focus")}})},_trigger:function(a,t,r){var n,o,i=this.options[a];if(r=r||{},(t=e.Event(t)).type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),t.target=this.element[0],o=t.originalEvent)for(n in o)n in t||(t[n]=o[n]);return this.element.trigger(t,r),!(e.isFunction(i)&&!1===i.apply(this.element[0],[t].concat(r))||t.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(a,t){e.Widget.prototype["_"+a]=function(r,n,o){var i;"string"==typeof n&&(n={effect:n});var s=n?!0===n||"number"==typeof n?t:n.effect||t:a;"number"==typeof(n=n||{})&&(n={duration:n}),i=!e.isEmptyObject(n),n.complete=o,n.delay&&r.delay(n.delay),i&&e.effects&&e.effects.effect[s]?r[a](n):s!==a&&r[s]?r[s](n.duration,n.easing,o):r.queue(function(t){e(this)[a](),o&&o.call(r[0]),t()})}});e.widget,e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(a){return function(t){return!!e.data(t,a)}}):function(a,t,r){return!!e.data(a,r[3])}});e.ui.focusable=function(a,t){var r,n,o,i,s,u=a.nodeName.toLowerCase();return"area"===u?(n=(r=a.parentNode).name,!(!a.href||!n||"map"!==r.nodeName.toLowerCase())&&((o=e("img[usemap='#"+n+"']")).length>0&&o.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(u)?(i=!a.disabled)&&(s=e(a).closest("fieldset")[0])&&(i=!s.disabled):i="a"===u&&a.href||t,i&&e(a).is(":visible")&&function(e){var a=e.css("visibility");for(;"inherit"===a;)e=e.parent(),a=e.css("visibility");return"hidden"!==a}(e(a)))},e.extend(e.expr[":"],{focusable:function(a){return e.ui.focusable(a,null!=e.attr(a,"tabindex"))}});e.ui.focusable,e.fn.scrollParent=function(a){var t=this.css("position"),r="absolute"===t,n=a?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var a=e(this);return(!r||"static"!==a.css("position"))&&n.test(a.css("overflow")+a.css("overflow-y")+a.css("overflow-x"))}).eq(0);return"fixed"!==t&&o.length?o:e(this[0].ownerDocument||document)},e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var n=!1;e(document).on("mouseup",function(){n=!1});e.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.on("mousedown."+this.widgetName,function(e){return a._mouseDown(e)}).on("click."+this.widgetName,function(t){if(!0===e.data(t.target,a.widgetName+".preventClickEvent"))return e.removeData(t.target,a.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(!n){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(a),this._mouseDownEvent=a;var t=this,r=1===a.which,o=!("string"!=typeof this.options.cancel||!a.target.nodeName)&&e(a.target).closest(this.options.cancel).length;return!(r&&!o&&this._mouseCapture(a))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(a),!this._mouseStarted)?(a.preventDefault(),!0):(!0===e.data(a.target,this.widgetName+".preventClickEvent")&&e.removeData(a.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),a.preventDefault(),n=!0,!0))}},_mouseMove:function(a){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!a.button)return this._mouseUp(a);if(!a.which)if(a.originalEvent.altKey||a.originalEvent.ctrlKey||a.originalEvent.metaKey||a.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(a)}return(a.which||a.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,a),this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted)},_mouseUp:function(a){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,a.target===this._mouseDownEvent.target&&e.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,n=!1,a.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.ui.plugin={add:function(a,t,r){var n,o=e.ui[a].prototype;for(n in r)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([t,r[n]])},call:function(e,a,t,r){var n,o=e.plugins[a];if(o&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;n<o.length;n++)e.options[o[n][0]]&&o[n][1].apply(e.element,t)}},e.ui.safeActiveElement=function(e){var a;try{a=e.activeElement}catch(t){a=e.body}return a||(a=e.body),a.nodeName||(a=e.body),a},e.ui.safeBlur=function(a){a&&"body"!==a.nodeName.toLowerCase()&&e(a).trigger("blur")};e.widget("ui.draggable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,a){this._super(e,a),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(a){var t=this.options;return!(this.helper||t.disabled||e(a.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(a),!!this.handle&&(this._blurActiveElement(a),this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(a){this.iframeBlocks=this.document.find(a).map(function(){var a=e(this);return e("<div>").css("position","absolute").appendTo(a.parent()).outerWidth(a.outerWidth()).outerHeight(a.outerHeight()).offset(a.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(a){var t=e.ui.safeActiveElement(this.document[0]);e(a.target).closest(t).length||e.ui.safeBlur(t)},_mouseStart:function(a){var t=this.options;return this.helper=this._createHelper(a),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(a),this.originalPosition=this.position=this._generatePosition(a,!1),this.originalPageX=a.pageX,this.originalPageY=a.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",a)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!t.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,a),this._mouseDrag(a,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,a),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(a,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(a,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var r=this._uiHash();if(!1===this._trigger("drag",a,r))return this._mouseUp(new e.Event("mouseup",a)),!1;this.position=r.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,a),!1},_mouseStop:function(a){var t=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,a)),this.dropped&&(r=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==t._trigger("stop",a)&&t._clear()}):!1!==this._trigger("stop",a)&&this._clear(),!1},_mouseUp:function(a){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,a),this.handleElement.is(a.target)&&this.element.trigger("focus"),e.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new e.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(a){return!this.options.handle||!!e(a.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(a){var t=this.options,r=e.isFunction(t.helper),n=r?e(t.helper.apply(this.element[0],[a])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),r&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" ")),e.isArray(a)&&(a={left:+a[0],top:+a[1]||0}),"left"in a&&(this.offset.click.left=a.left+this.margins.left),"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left),"top"in a&&(this.offset.click.top=a.top+this.margins.top),"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var a=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(a={top:0,left:0}),{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),a=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(a?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(a?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a,t,r,n=this.options,o=this.document[0];this.relativeContainer=null,n.containment?"window"!==n.containment?"document"!==n.containment?n.containment.constructor!==Array?("parent"===n.containment&&(n.containment=this.helper[0].parentNode),(r=(t=e(n.containment))[0])&&(a=/(scroll|auto)/.test(t.css("overflow")),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(a?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(a?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t)):this.containment=n.containment:this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,a){a||(a=this.position);var t="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:a.top+this.offset.relative.top*t+this.offset.parent.top*t-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*t,left:a.left+this.offset.relative.left*t+this.offset.parent.left*t-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*t}},_generatePosition:function(e,a){var t,r,n,o,i=this.options,s=this._isRootNode(this.scrollParent[0]),u=e.pageX,l=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),a&&(this.containment&&(this.relativeContainer?(r=this.relativeContainer.offset(),t=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):t=this.containment,e.pageX-this.offset.click.left<t[0]&&(u=t[0]+this.offset.click.left),e.pageY-this.offset.click.top<t[1]&&(l=t[1]+this.offset.click.top),e.pageX-this.offset.click.left>t[2]&&(u=t[2]+this.offset.click.left),e.pageY-this.offset.click.top>t[3]&&(l=t[3]+this.offset.click.top)),i.grid&&(n=i.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/i.grid[1])*i.grid[1]:this.originalPageY,l=t?n-this.offset.click.top>=t[1]||n-this.offset.click.top>t[3]?n:n-this.offset.click.top>=t[1]?n-i.grid[1]:n+i.grid[1]:n,o=i.grid[0]?this.originalPageX+Math.round((u-this.originalPageX)/i.grid[0])*i.grid[0]:this.originalPageX,u=t?o-this.offset.click.left>=t[0]||o-this.offset.click.left>t[2]?o:o-this.offset.click.left>=t[0]?o-i.grid[0]:o+i.grid[0]:o),"y"===i.axis&&(u=this.originalPageX),"x"===i.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:u-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(a,t,r){return r=r||this._uiHash(),e.ui.plugin.call(this,a,[t,r,this],!0),/^(drag|start|stop)/.test(a)&&(this.positionAbs=this._convertPositionTo("absolute"),r.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,a,t,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(a,t,r){var n=e.extend({},t,{item:r.element});r.sortables=[],e(r.options.connectToSortable).each(function(){var t=e(this).sortable("instance");t&&!t.options.disabled&&(r.sortables.push(t),t.refreshPositions(),t._trigger("activate",a,n))})},stop:function(a,t,r){var n=e.extend({},t,{item:r.element});r.cancelHelperRemoval=!1,e.each(r.sortables,function(){this.isOver?(this.isOver=0,r.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(a),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",a,n))})},drag:function(a,t,r){e.each(r.sortables,function(){var n=!1,o=this;o.positionAbs=r.positionAbs,o.helperProportions=r.helperProportions,o.offset.click=r.offset.click,o._intersectsWith(o.containerCache)&&(n=!0,e.each(r.sortables,function(){return this.positionAbs=r.positionAbs,this.helperProportions=r.helperProportions,this.offset.click=r.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(n=!1),n})),n?(o.isOver||(o.isOver=1,r._parent=t.helper.parent(),o.currentItem=t.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return t.helper[0]},a.target=o.currentItem[0],o._mouseCapture(a,!0),o._mouseStart(a,!0,!0),o.offset.click.top=r.offset.click.top,o.offset.click.left=r.offset.click.left,o.offset.parent.left-=r.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=r.offset.parent.top-o.offset.parent.top,r._trigger("toSortable",a),r.dropped=o.element,e.each(r.sortables,function(){this.refreshPositions()}),r.currentItem=r.element,o.fromOutside=r),o.currentItem&&(o._mouseDrag(a),t.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",a,o._uiHash(o)),o._mouseStop(a,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),t.helper.appendTo(r._parent),r._refreshOffsets(a),t.position=r._generatePosition(a,!0),r._trigger("fromSortable",a),r.dropped=!1,e.each(r.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(a,t,r){var n=e("body"),o=r.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(a,t,r){var n=r.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(a,t,r){var n=e(t.helper),o=r.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(a,t,r){var n=r.options;n._opacity&&e(t.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,a,t){t.scrollParentNotHidden||(t.scrollParentNotHidden=t.helper.scrollParent(!1)),t.scrollParentNotHidden[0]!==t.document[0]&&"HTML"!==t.scrollParentNotHidden[0].tagName&&(t.overflowOffset=t.scrollParentNotHidden.offset())},drag:function(a,t,r){var n=r.options,o=!1,i=r.scrollParentNotHidden[0],s=r.document[0];i!==s&&"HTML"!==i.tagName?(n.axis&&"x"===n.axis||(r.overflowOffset.top+i.offsetHeight-a.pageY<n.scrollSensitivity?i.scrollTop=o=i.scrollTop+n.scrollSpeed:a.pageY-r.overflowOffset.top<n.scrollSensitivity&&(i.scrollTop=o=i.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(r.overflowOffset.left+i.offsetWidth-a.pageX<n.scrollSensitivity?i.scrollLeft=o=i.scrollLeft+n.scrollSpeed:a.pageX-r.overflowOffset.left<n.scrollSensitivity&&(i.scrollLeft=o=i.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(a.pageY-e(s).scrollTop()<n.scrollSensitivity?o=e(s).scrollTop(e(s).scrollTop()-n.scrollSpeed):e(window).height()-(a.pageY-e(s).scrollTop())<n.scrollSensitivity&&(o=e(s).scrollTop(e(s).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(a.pageX-e(s).scrollLeft()<n.scrollSensitivity?o=e(s).scrollLeft(e(s).scrollLeft()-n.scrollSpeed):e(window).width()-(a.pageX-e(s).scrollLeft())<n.scrollSensitivity&&(o=e(s).scrollLeft(e(s).scrollLeft()+n.scrollSpeed)))),!1!==o&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,a)}}),e.ui.plugin.add("draggable","snap",{start:function(a,t,r){var n=r.options;r.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var a=e(this),t=a.offset();this!==r.element[0]&&r.snapElements.push({item:this,width:a.outerWidth(),height:a.outerHeight(),top:t.top,left:t.left})})},drag:function(a,t,r){var n,o,i,s,u,l,c,d,p,f,m=r.options,g=m.snapTolerance,_=t.offset.left,h=_+r.helperProportions.width,v=t.offset.top,b=v+r.helperProportions.height;for(p=r.snapElements.length-1;p>=0;p--)l=(u=r.snapElements[p].left-r.margins.left)+r.snapElements[p].width,d=(c=r.snapElements[p].top-r.margins.top)+r.snapElements[p].height,h<u-g||_>l+g||b<c-g||v>d+g||!e.contains(r.snapElements[p].item.ownerDocument,r.snapElements[p].item)?(r.snapElements[p].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,a,e.extend(r._uiHash(),{snapItem:r.snapElements[p].item})),r.snapElements[p].snapping=!1):("inner"!==m.snapMode&&(n=Math.abs(c-b)<=g,o=Math.abs(d-v)<=g,i=Math.abs(u-h)<=g,s=Math.abs(l-_)<=g,n&&(t.position.top=r._convertPositionTo("relative",{top:c-r.helperProportions.height,left:0}).top),o&&(t.position.top=r._convertPositionTo("relative",{top:d,left:0}).top),i&&(t.position.left=r._convertPositionTo("relative",{top:0,left:u-r.helperProportions.width}).left),s&&(t.position.left=r._convertPositionTo("relative",{top:0,left:l}).left)),f=n||o||i||s,"outer"!==m.snapMode&&(n=Math.abs(c-v)<=g,o=Math.abs(d-b)<=g,i=Math.abs(u-_)<=g,s=Math.abs(l-h)<=g,n&&(t.position.top=r._convertPositionTo("relative",{top:c,left:0}).top),o&&(t.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top),i&&(t.position.left=r._convertPositionTo("relative",{top:0,left:u}).left),s&&(t.position.left=r._convertPositionTo("relative",{top:0,left:l-r.helperProportions.width}).left)),!r.snapElements[p].snapping&&(n||o||i||s||f)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,a,e.extend(r._uiHash(),{snapItem:r.snapElements[p].item})),r.snapElements[p].snapping=n||o||i||s||f)}}),e.ui.plugin.add("draggable","stack",{start:function(a,t,r){var n,o=r.options,i=e.makeArray(e(o.stack)).sort(function(a,t){return(parseInt(e(a).css("zIndex"),10)||0)-(parseInt(e(t).css("zIndex"),10)||0)});i.length&&(n=parseInt(e(i[0]).css("zIndex"),10)||0,e(i).each(function(a){e(this).css("zIndex",n+a)}),this.css("zIndex",n+i.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(a,t,r){var n=e(t.helper),o=r.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(a,t,r){var n=r.options;n._zIndex&&e(t.helper).css("zIndex",n._zIndex)}});e.ui.draggable}),function(e,a){"use strict";var t=a.module("angular-sortable-view",[]);function r(e){if(!("clientX"in e||"clientY"in e)){var a=e.touches||e.originalEvent.touches;a&&a.length&&(e.clientX=a[0].clientX,e.clientY=a[0].clientY),e.preventDefault()}}t.directive("svRoot",[function(){function e(e){return r[e]}var t,r=Object.create(null);return{restrict:"A",controller:["$scope","$attrs","$interpolate","$parse",function(n,o,s,u){var l=s(o.svRoot)(n)||n.$id;r[l]||(r[l]=[]);var c,d,p,f,m,g=!1,_=u(o.svOnSort);o.svOnStart=o.$$element[0].attributes["sv-on-start"],o.svOnStart=o.svOnStart&&o.svOnStart.value,o.svOnStop=o.$$element[0].attributes["sv-on-stop"],o.svOnStop=o.svOnStop&&o.svOnStop.value;var h=u(o.svOnStart),v=u(o.svOnStop);if(this.sortingInProgress=function(){return t},o.svGrid){if(null===(g="true"===o.svGrid||"false"!==o.svGrid&&null))throw"Invalid value of sv-grid attribute"}else n.$watchCollection(function(){return e(l)},function(e){g=!1;var a=e.filter(function(e){return!e.container}).map(function(e){return{part:e.getPart().id,y:e.element[0].getBoundingClientRect().top}}),t=Object.create(null);a.forEach(function(e){t[e.part]?t[e.part].push(e.y):t[e.part]=[e.y]}),Object.keys(t).forEach(function(e){t[e].sort(),t[e].forEach(function(a,r){r<t[e].length-1&&a>0&&a===t[e][r+1]&&(g=!0)})})});this.$moveUpdate=function(r,o,s,u,_,v,b){var y=s[0].getBoundingClientRect();"element"===r.tolerance&&(o={x:~~(y.left+y.width/2),y:~~(y.top+y.height/2)}),t=!0,c=[],d||(_?(d=_.clone()).removeClass("ng-hide"):((d=u.clone()).addClass("sv-visibility-hidden"),d.addClass("sv-placeholder"),d.css({height:y.height+"px",width:y.width+"px"})),u.after(d),u.addClass("ng-hide"),f=u,r,h(n,{$helper:{element:p=s},$part:v.model(v.scope),$index:b,$item:v.model(v.scope)[b]}),n.$root&&n.$root.$$phase||n.$apply()),p[0].reposition({x:o.x+document.body.scrollLeft-o.offset.x*y.width,y:o.y+document.body.scrollTop-o.offset.y*y.height}),e(l).forEach(function(e,a){if(null==r.containment||i(e.element,r.containment)||i(e.element,r.containment+" *")){var t=e.element[0].getBoundingClientRect(),n={x:~~(t.left+t.width/2),y:~~(t.top+t.height/2)};e.container||!e.element[0].scrollHeight&&!e.element[0].scrollWidth||c.push({element:e.element,q:(n.x-o.x)*(n.x-o.x)+(n.y-o.y)*(n.y-o.y),view:e.getPart(),targetIndex:e.getIndex(),after:function(e,a,t){return t?e.x-a.x<0:e.y-a.y<0}(n,o,g)}),e.container&&!e.element[0].querySelector("[sv-element]:not(.sv-placeholder):not(.sv-source)")&&c.push({element:e.element,q:(n.x-o.x)*(n.x-o.x)+(n.y-o.y)*(n.y-o.y),view:e.getPart(),targetIndex:0,container:!0})}});var w=d[0].getBoundingClientRect(),C=~~(w.left+w.width/2),N=~~(w.top+w.height/2);c.push({q:(C-o.x)*(C-o.x)+(N-o.y)*(N-o.y),element:d,placeholder:!0}),c.sort(function(e,a){return e.q-a.q}),c.forEach(function(e,t){var r,n,o;0!==t||e.placeholder||e.container?0===t&&e.container?(m=e,e.element.append(d)):e.element.removeClass("sv-candidate"):(m=e,e.element.addClass("sv-candidate"),e.after?e.element.after(d):(r=e.element,n=d,(o=function(e){if((e=e[0]).previousElementSibling)return a.element(e.previousElementSibling);for(var t=e.previousSibling;null!=t&&1!=t.nodeType;)t=t.previousSibling;return a.element(t)}(r)).length>0?o.after(n):r.parent().prepend(n)))})},this.$drop=function(e,a,r){if(d)if(r.revert){var o=d[0].getBoundingClientRect(),i=p[0].getBoundingClientRect(),s=Math.sqrt(Math.pow(i.top-o.top,2)+Math.pow(i.left-o.left,2)),u=+r.revert*s/200;u=Math.min(u,+r.revert),["-webkit-","-moz-","-ms-","-o-",""].forEach(function(e){void 0!==p[0].style[e+"transition"]&&(p[0].style[e+"transition"]="all "+u+"ms ease")}),setTimeout(l,u),p.css({top:o.top+document.body.scrollTop+"px",left:o.left+document.body.scrollLeft+"px"})}else l();function l(){if(t=!1,d.remove(),p.remove(),f.removeClass("ng-hide"),c=void 0,d=void 0,r=void 0,p=void 0,f=void 0,v(n,{$part:e.model(e.scope),$index:a,$item:e.model(e.scope)[a]}),m){m.element.removeClass("sv-candidate");var o=e.model(e.scope).splice(a,1),i=m.targetIndex;m.view===e&&m.targetIndex>a&&i--,m.after&&i++,m.view.model(m.view.scope).splice(i,0,o[0]),m.view===e&&a===i||_(n,{$partTo:m.view.model(m.view.scope),$partFrom:e.model(e.scope),$item:o[0],$indexTo:i,$indexFrom:a})}m=void 0,n.$root&&n.$root.$$phase||n.$apply()}},this.addToSortableElements=function(a){e(l).push(a)},this.removeFromSortableElements=function(a){var t=e(l),n=t.indexOf(a);n>-1&&(t.splice(n,1),0===t.length&&delete r[l])}}]}}]),t.directive("svPart",["$parse",function(e){return{restrict:"A",require:"^svRoot",controller:["$scope",function(e){e.$ctrl=this,this.getPart=function(){return e.part},this.$drop=function(a,t){e.$sortableRoot.$drop(e.part,a,t)}}],scope:!0,link:function(a,t,r,n){if(!r.svPart)throw new Error("no model provided");var o=e(r.svPart);if(!o.assign)throw new Error("model not assignable");a.part={id:a.$id,element:t,model:o,scope:a},a.$sortableRoot=n;var i={element:t,getPart:a.$ctrl.getPart,container:!0};n.addToSortableElements(i),a.$on("$destroy",function(){n.removeFromSortableElements(i)})}}}]),t.directive("svElement",["$parse",function(e){return{restrict:"A",require:["^svPart","^svRoot"],controller:["$scope",function(e){e.$ctrl=this}],link:function(t,n,o,i){var u={element:n,getPart:i[0].getPart,getIndex:function(){return t.$index}};i[1].addToSortableElements(u),t.$on("$destroy",function(){i[1].removeFromSortableElements(u)});var l,c,d=n;d.on("mousedown touchstart",m),t.$watch("$ctrl.handle",function(e){e&&(d.off("mousedown touchstart",m),(d=e).on("mousedown touchstart",m))}),t.$watch("$ctrl.helper",function(e){e&&(l=e)}),t.$watch("$ctrl.placeholder",function(e){e&&(c=e)});a.element(document.body);var p,f=a.element(document.documentElement);function m(u){if(r(u),!i[1].sortingInProgress()&&(0==u.button||"mousedown"!==u.type)){p=!1;var d=e(o.svElement)(t);if((d=a.extend({},{tolerance:"pointer",revert:200,containment:"html"},d)).containment)var m=s.call(n,d.containment).getBoundingClientRect();var g,_=n,h=n[0].getBoundingClientRect();l||(l=i[0].helper),c||(c=i[0].placeholder),l?((g=l.clone()).removeClass("ng-hide"),g.css({left:h.left+document.body.scrollLeft+"px",top:h.top+document.body.scrollTop+"px"}),_.addClass("sv-visibility-hidden")):(g=_.clone()).addClass("sv-helper").css({left:h.left+document.body.scrollLeft+"px",top:h.top+document.body.scrollTop+"px",width:h.width+"px"}),g[0].reposition=function(e){var a=e.x,t=e.y,r=g[0].getBoundingClientRect(),n=document.body;m&&(t<m.top+n.scrollTop&&(t=m.top+n.scrollTop),t+r.height>m.top+n.scrollTop+m.height&&(t=m.top+n.scrollTop+m.height-r.height),a<m.left+n.scrollLeft&&(a=m.left+n.scrollLeft),a+r.width>m.left+n.scrollLeft+m.width&&(a=m.left+n.scrollLeft+m.width-r.width)),this.style.left=a-n.scrollLeft+"px",this.style.top=t-n.scrollTop+"px"};var v={x:(u.clientX-h.left)/h.width,y:(u.clientY-h.top)/h.height};f.addClass("sv-sorting-in-progress"),f.on("mousemove touchmove",b).on("mouseup touchend touchcancel",function e(a){f.off("mousemove touchmove",b),f.off("mouseup touchend touchcancel",e),f.removeClass("sv-sorting-in-progress"),p&&i[0].$drop(t.$index,d),n.removeClass("sv-visibility-hidden")})}function b(e){r(e),p||(n.parent().prepend(g),p=!0),i[1].$moveUpdate(d,{x:e.clientX,y:e.clientY,offset:v},g,n,c,i[0].getPart(),t.$index)}}}}}]),t.directive("svHandle",function(){return{require:"?^svElement",link:function(e,a,t,r){r&&(r.handle=a.add(r.handle))}}}),t.directive("svHelper",function(){return{require:["?^svPart","?^svElement"],link:function(e,a,t,r){a.addClass("sv-helper").addClass("ng-hide"),r[1]?r[1].helper=a:r[0]&&(r[0].helper=a)}}}),t.directive("svPlaceholder",function(){return{require:["?^svPart","?^svElement"],link:function(e,a,t,r){a.addClass("sv-placeholder").addClass("ng-hide"),r[1]?r[1].placeholder=a:r[0]&&(r[0].placeholder=a)}}}),a.element(document.head).append(["<style>.sv-helper{position: fixed !important;z-index: 99999;margin: 0 !important;}.sv-candidate{}.sv-placeholder{}.sv-sorting-in-progress{-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.sv-visibility-hidden{visibility: hidden !important;opacity: 0 !important;}</style>"].join(""));var n=document.documentElement,o=n.matches?"matches":n.matchesSelector?"matchesSelector":n.webkitMatches?"webkitMatches":n.webkitMatchesSelector?"webkitMatchesSelector":n.msMatches?"msMatches":n.msMatchesSelector?"msMatchesSelector":n.mozMatches?"mozMatches":n.mozMatchesSelector?"mozMatchesSelector":null;if(null==o)throw"This browser doesn't support the HTMLElement.matches method";function i(e,t){if(e instanceof a.element&&(e=e[0]),null!==o)return e[o](t)}var s=a.element.prototype.closest||function(e){for(var t=this[0].parentNode;t!==document.documentElement&&!t[o](e);)t=t.parentNode;return t[o](e)?a.element(t):a.element()};"function"!=typeof a.element.prototype.add&&(a.element.prototype.add=function(e){var t,r=a.element();for(e=a.element(e),t=0;t<this.length;t++)r.push(this[t]);for(t=0;t<e.length;t++)r.push(e[t]);return r})}(window,window.angular),window.saveAs=window.saveAs||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var a=function(){return e.URL||e.webkitURL||e},t=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in t,n=/constructor/i.test(e.HTMLElement)||e.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent),i=e.setImmediate||e.setTimeout,s=function(e){i(function(){throw e},0)},u=function(e){setTimeout(function(){"string"==typeof e?a().revokeObjectURL(e):e.remove()},4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=function(c,d,p){p||(c=l(c));var f,m=this,g="application/octet-stream"===c.type,_=function(){!function(e,a,t){for(var r=(a=[].concat(a)).length;r--;){var n=e["on"+a[r]];if("function"==typeof n)try{n.call(e,t||e)}catch(e){s(e)}}}(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,r)return f=a().createObjectURL(c),void i(function(){var e,a;t.href=f,t.download=d,e=t,a=new MouseEvent("click"),e.dispatchEvent(a),_(),u(f),m.readyState=m.DONE},0);!function(){if((o||g&&n)&&e.FileReader){var t=new FileReader;return t.onloadend=function(){var a=o?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(a,"_blank")||(e.location.href=a),a=void 0,m.readyState=m.DONE,_()},t.readAsDataURL(c),void(m.readyState=m.INIT)}f||(f=a().createObjectURL(c)),g?e.location.href=f:e.open(f,"_blank")||(e.location.href=f);m.readyState=m.DONE,_(),u(f)}()},d=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,a,t){return a=a||e.name||"download",t||(e=l(e)),navigator.msSaveOrOpenBlob(e,a)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(e,a,t){return new c(e,a||e.name||"download",t)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this),function(){"use strict";var e,a;angular.module("myvcFrontApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngSanitize","ngTouch","ui.bootstrap","ui.router","ui.select","angular-loading-bar","ckeditor","uiBreadcrumbs","toastr","http-auth-interceptor","ui.grid","ui.grid.edit","ui.grid.resizeColumns","ui.grid.exporter","ui.grid.selection","ui.grid.cellNav","ui.grid.autoResize","ui.grid.pinning","ui.grid.expandable","ui.grid.moveColumns","ngFileUpload","FBAngular","nvd3","angular-sortable-view"]).constant("App",(a=(e=location.protocol+"//"+location.hostname+"/")+"5myvc/public/",location.origin,location.href.indexOf("demo")>0&&(a=e+"demo/5myvc/public/"),{Server:a,views:"views/",images:a+"images/",perfilPath:a+"images/perfil/",imgSharedPath:a+"images/shared/",parentescos:[{parentesco:"Padre"},{parentesco:"Madre"},{parentesco:"Hermano"},{parentesco:"Hermana"},{parentesco:"Abuelo"},{parentesco:"Abuela"},{parentesco:"Tío"},{parentesco:"Tía"},{parentesco:"Primo(a)"},{parentesco:"Otro"}],religiones:["Adventista","Católico","Pentecostal","Cuadrangular","Testigo de Jehová","Mormón","Otra","Ninguna"],tipos_sangre:["AB+","AB-","A+","A-","B+","B-","O+","O-"]})).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",alumno:"alumno",acudiente:"acudiente",profesor:"profesor",guest:"guest"}).constant("PERMISSIONS",{can_work_like_admin:"can_work_like_admin",can_work_like_teacher:"can_work_like_teacher",can_work_like_student:"can_work_like_student",can_work_like_acudiente:"can_work_like_acudiente",can_accept_images:"can_accept_images",can_edit_alumnos:"can_edit_alumnos",can_edit_usuarios:"can_edit_usuarios",can_edit_notas:"can_edit_notas",can_edit_years:"can_edit_years",can_edit_periodos:"can_edit_periodos",can_edit_paises:"can_edit_paises",can_edit_ciudades:"can_edit_ciudades",can_edit_disciplinas:"can_edit_disciplinas",can_edit_profesores:"can_edit_profesores",can_edit_eventos:"can_edit_eventos",can_edit_votaciones:"can_edit_votaciones",can_edit_aspiraciones:"can_edit_aspiraciones",can_edit_participantes:"can_edit_participantes",can_edit_candidatos:"can_edit_candidatos",can_edit_unidades_subunidades:"can_edit_unidades_subunidades"})}.call(this),function(){angular.module("myvcFrontApp").config(["$cookiesProvider","$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider","$httpProvider","$locationProvider","App","PERMISSIONS","$intervalProvider","$rootScopeProvider","USER_ROLES","toastrConfig","uiSelectConfig",function(e,a,t,r,n,o,i,s,u,l,c,d,p){return n.defaults.headers.post["X-CSRFToken"]=e.csrftoken,n.defaults.headers.put["X-CSRFToken"]=e.csrftoken,n.defaults.useXDomain=!0,n.defaults.xsrfCookieName="csrftoken",n.defaults.xsrfHeaderName="X-CSRFToken",delete n.defaults.headers.common["X-Requested-With"],n.interceptors.push(["$q",function(e){return{request:function(e){var a;return(a=e.url.split("::")).length>1?e.url=i.Server+a[1]:(a=e.url.split("==")).length>1&&(e.url=i.views+a[1]),e}}}]),p.theme="select2",p.resetSearchInput=!0,r.strictMode(!1),t.otherwise("/login"),t.when("/user/:username",["$match","$state",function(e,a){return a.transitionTo("panel.user.resumen",e)}]),a.state("main",{url:"/",views:{principal:{templateUrl:i.views+"main/main.tpl.html",controller:"MainCtrl"}},data:{displayName:"principal",icon_fa:"",pageTitle:"Construcción - MyVc"}}).state("login",{url:"/login",views:{principal:{templateUrl:`${i.views}login/login.tpl.html`,controller:"LoginCtrl"}},data:{displayName:"Login",icon_fa:"fa fa-user",pageTitle:"Ingresar a MyVc"}}).state("reset-password",{url:"/reset-password/:numero/:username",views:{principal:{templateUrl:`${i.views}login/reset-password.tpl.html`,controller:"ResetPasswordCtrl"}},data:{displayName:"Resetear",icon_fa:"fa fa-user",pageTitle:"Ingreso a MyVc"}}).state("logout",{url:"/logout",views:{principal:{templateUrl:`${i.views}login/logout.tpl.html`,controller:"LogoutCtrl"}},data:{displayName:"Logout",icon_fa:"fa fa-user"}}).state("panel",{url:"/panel",views:{principal:{templateUrl:`${i.views}panel/panel.tpl.html`,controller:"PanelCtrl"}},resolve:{resolved_user:["AuthService",function(e){return e.verificar()}]},data:{displayName:"Inicio",icon_fa:"fa fa-home",pageTitle:"Bienvenido - MyVc"}}),angular.extend(d,{allowHtml:!0,closeButton:!0,extendedTimeOut:1e3,preventOpenDuplicates:!1,maxOpened:3,tapToDismiss:!0,target:"body",timeOut:4e3}),this}]).filter("capitalize",function(){return function(e,a){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}})}.call(this),function(){angular.module("myvcFrontApp").run(["$rootScope","cfpLoadingBar","$state","$stateParams","$cookies","Perfil","AuthService","AUTH_EVENTS","toastr",function(e,a,t,r,n,o,i,s,u){return e.$state=t,e.$stateParams=r,e.lastState=null,e.lastStateParam=null,e.notaRapida={enable:!1,valorNota:0},e.menucompacto=!1,e.$on("event:auth-loginRequired",function(e){return console.log("Acceso no permitido, vamos a loguear",e),t.transitionTo("login")}),e.ingresar=function(){return null===e.lastState||"login"===e.lastState||"/"===e.lastState||"main"===e.lastState?t.transitionTo("panel"):t.transitionTo(e.lastState,e.lastStateParam)},e.$on("event:auth-loginConfirmed",function(){return console.log("Logueado con éxito!"),e.ingresar()}),e.$on("$stateChangeStart",function(a,t,r,n,o){if(null===e.lastState||"logout"!==t.name&&"login"!==t.name&&"main"!==t.name)return e.lastState=t.name,e.lastStateParam=r}),e.$on("$stateChangeSuccess",function(a,r,n,o,i){return e.pageTitle=t.current.name}),e.$on("$stateChangeError",function(a,r,n,o,i){if(console.log("Evento fallido: ",a),u.warning("Lo sentimos, hubo un error o no puedes acceder a esta vista"),"panel"!==e.lastState)return t.transitionTo("panel")}),e.$on(s.loginSuccess,function(){var a;if(a=o.User())return a.votaciones?(1===a.votaciones.length?u.success("Hay 1 votación en ejecución."):u.success("Hay "+a.votaciones.length+" votaciones en ejecución."),t.go("panel.actividades.votaciones.votar")):e.ingresar()}),e.$on(s.loginFailed,function(e){}),e.$on(s.notAuthenticated,function(e){return u.warning("No está autorizado.","Acceso exclusivo"),console.log("Evento notAuthenticated: ",e),t.transitionTo("login")}),e.$on(s.notAuthorized,function(a){return u.warning("No está autorizado para entrar a esta vista","Restringido"),t.go("panel"),console.log("Evento notAuthorized: ",a,e.lastState)})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ApplicationController",["$scope",function(e){return e.isLoginPage=!1,Date.prototype.yyyymmdd=function(){var e,a;return a=this.getMonth()+1,e=this.getDate(),[this.getFullYear(),(a>9?"":"0")+a,(e>9?"":"0")+e].join("-")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MainCtrl",["$scope","$window","$interval",function(e,a,t){}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PanelCtrl",["$scope","$http","$state","$cookies","$rootScope","AuthService","Perfil","App","resolved_user","toastr","cfpLoadingBar","$window",function(e,a,t,r,n,o,i,s,u,l,c,d){e.USER=u,e.pageTitle=n.pageTitle,e.perfilPath=s.images+"perfil/",e.views=s.views,e.logoPathDefault="images/Logo_MyVc_Header.gif",e.logoPath="images/Logo_Colegio_Header.gif",a.get(e.logoPath).then(function(){return console.log("logoPath  existe")},function(){return e.logoPath=e.logoPathDefault}),n.menucompacto="true"===localStorage.menucompacto,c.complete(),o.verificar_acceso(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.date=new Date,a.get("::years").then(function(a){return e.years=a.data},function(e){return l.error("No se trajeron los años")}),a.get("::periodos").then(function(a){return e.periodos=a.data},function(e){return l.error("No se trajeron los periodos")}),"Acudiente"===e.USER.tipo&&a.put("::acudientes/mis-acudidos").then(function(a){return e.mis_acudidos=a.data.alumnos},function(e){return l.error("No se trajeron los acudidos")}),e.setImagenPrincipal=function(){var a,t,r;return r=(a=s.images+"perfil/")+e.USER.imagen_nombre,t=a+e.USER.foto_nombre,e.imagenPrincipal=r,e.imagenOficial=t},e.setImagenPrincipal(),e.nameToShow=i.nameToShow,e.usuario=function(){return i.User().username},e.toggleCompactMenu=function(){return n.menucompacto=!n.menucompacto,localStorage.menucompacto=n.menucompacto},e.seeDropdownPeriodos=!1,e.togglePeriodos=function(){return e.seeDropdownPeriodos=!e.seeDropdownPeriodos,console.log(e.seeDropdownPeriodos)},e.cambiarPeriodo=function(t){return a.put("::periodos/useractive/"+t.id).then(function(a){return l.success("Periodo cambiado con éxito al perido "+t.numero,"Cambiado"),e.USER.periodo_id=t.id,e.USER.numero_periodo=t.numero,d.location.reload()},function(e){return l.warning("No se pudo cambiar de periodo.","Problema")})},e.cambiarYear=function(t){return a.put("::years/useractive/"+t.id).then(function(a){return a=a.data,e.USER.year_id=t.id,e.USER.year=t.year,e.USER.numero_periodo=a.numero,e.USER.periodo_id=a.id,l.success("Año cambiado con éxito: "+t.year,"Cambiado"),d.location.reload()},function(e){return l.warning("No se pudo cambiar el año.","Problema")})},e.logout=function(){return o.logout()},e.goFileManager=function(){return t.go("panel.filemanager")},e.indexChar=function(e){return String.fromCharCode(65+e)},e.$on("cambianImgs",function(a,t){return e.USER=i.User(),e.setImagenPrincipal()})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","USER_ROLES","PERMISSIONS",function(e,a,t){e.state("panel.alumnos",{url:"^/alumnos",views:{maincontent:{templateUrl:"==alumnos/alumnos.tpl.html",controller:"AlumnosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Alumnos"}]}}},data:{displayName:"Alumnos",icon_fa:"fa fa-male",needed_permissions:[t.can_work_like_teacher,t.can_work_like_admin,t.can_edit_alumnos],pageTitle:"Alumnos - MyVc"}}).state("panel.mensajes",{url:"^/mensajes",views:{maincontent:{templateUrl:"==mensajes/mensajes.tpl.html",controller:"MensajesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Mensajes"}]}}},data:{displayName:"Mensajes",icon_fa:"fa fa-envelope"}}).state("panel.years",{url:"^/years",views:{maincontent:{templateUrl:"==colegio/years.tpl.html",controller:"YearsCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Años"}]}}},data:{displayName:"Años",icon_fa:"fa fa-graduation-cap",needed_permissions:[t.can_work_like_admin],pageTitle:"Años - MyVc"}}).state("panel.paises",{url:"^/paises",views:{maincontent:{templateUrl:"==paises/paises.tpl.html",controller:"PaisesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Paises"}]}}},data:{displayName:"Paises",icon_fa:"fa fa-flag-checkered",needed_permissions:[t.can_work_like_admin],pageTitle:"Paises - MyVc"}}).state("panel.profesores",{url:"^/profesores",views:{maincontent:{templateUrl:"==profesores/profesores.tpl.html",controller:"ProfesoresCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Profesores"}]}}},data:{displayName:"Profesores",icon_fa:"fa fa-graduation-cap",needed_permissions:[t.can_work_like_admin],pageTitle:"Profesores - MyVc"}}).state("panel.ciudades",{url:"/ciudades",views:{maincontent:{templateUrl:"==ciudades/ciudades.tpl.html",controller:"CiudadesCtrl",resolve:{paises:["$http",function(e){return e.get("::paises")}]}},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Ciudades"}],paises:["$http",function(e){return e.get("::paises")}]}}},data:{displayName:"Ciudades",icon_fa:"fa fa-map-marker",needed_permissions:[t.can_work_like_admin],pageTitle:"Ciudades - MyVc"}}).state("panel.disciplinas",{url:"/disciplinas",views:{maincontent:{templateUrl:"==disciplinas/disciplinas.tpl.html",controller:"DisciplinasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Disciplinas"}]}}},data:{displayName:"Disciplinas",icon_fa:"fa fa-align-justify",pageTitle:"Disciplinas - MyVc"}}).state("panel.eventos",{url:"/eventos",views:{maincontent:{templateUrl:"==eventos/eventos.tpl.html",controller:"EventosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Eventos"}]}}},data:{displayName:"Eventos",icon_fa:"fa fa-laptop",needed_permissions:[t.can_work_like_admin],pageTitle:"Eventos - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PanelHeaderCtrl",["$scope","titulo","$state","$stateParams","Fullscreen","$rootScope",function(e,a,t,r,n,o){e.titulo=a,o.reload=function(){return t.go(t.current,r,{reload:!0})},e.setFullScreen=function(){return n.toggleAll()}}])}.call(this),function(){angular.module("myvcFrontApp").directive("anunciosDir",["App","$http","toastr","$uibModal","$state","AuthService",function(e,a,t,r,n,o){return{restrict:"E",templateUrl:`${e.views}panel/anunciosDir.tpl.html`,link:function(t,r,i){if(t.perfilPath=e.images+"perfil/",t.views=e.views,n.is("panel"))return a.get("::ChangesAsked/to-me").then(function(e){var a,r,n,i,s;if(t.changes_asked=e.data,o.hasRoleOrPerm(["admin","profesor","alumno"])){for(t.options={chart:{type:"discreteBarChart",height:180,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.0f")(e)},transitionDuration:500,xAxis:{axisLabel:"X Axis",rotateLabels:30,showMaxMin:!1},zoom:{enabled:!0,scaleExtent:[1,10],useFixedDomain:!1,useNiceScale:!1,horizontalOff:!1,verticalOff:!0,unzoomEventType:"dblclick.zoom"}},title:{enable:!1,text:"Asignaturas correctas"}},s=[],a=0,r=(i=t.changes_asked.profes_actuales).length;a<r;a++)n=i[a],s.push({label:n.nombres+" "+n.apellidos.substr(0,1)+".",value:n.porcentaje});return t.data=[{key:"Asignaturas correctas",values:s}]}},function(e){return console.log(e)})},controller:"AnunciosDirCtrl"}}]).controller("AnunciosDirCtrl",["$scope","$uibModal","AuthService","$http","toastr","$filter","App",function(e,a,t,r,n,o,i){return e.hasRoleOrPerm=t.hasRoleOrPerm,e.perfilPath=i.images+"perfil/",e.views=i.views,e.srcCant=e.views+"informes2/verCantAlumnosPorGrupos.tpl.html",e.profe_seleccionado=!1,e.seleccionar_profe=function(a){return r.put("::historiales/de-usuario",{user_id:a.user_id}).then(function(t){return e.profe_seleccionado=t.data,e.profe_seleccionado.profesor=a},function(e){return console.log("Error trayendo detalles",e)})},e.desseleccionar_profe=function(){return e.profe_seleccionado=!1},e.verDetalles=function(e){var a;return e.mostrando?e.mostrando=!1:(e.mostrando=!0,e.detalles?void 0:(a={asked_id:e.asked_id},r.put("::ChangesAsked/ver-detalles",a).then(function(a){return e.detalles=a.data.detalles},function(e){return console.log("Error trayendo detalles",e)})))},e.traerCatAlumnosPorGrupos=function(){return r.put("::grupos/con-cantidad-alumnos").then(function(a){var t,r,n,o,i;for(e.grupos_cantidades=a.data.grupos,e.periodos_total=a.data.periodos_total,e.cant_total_alumnos=0,i=[],r=0,n=(o=e.grupos_cantidades).length;r<n;r++)t=o[r],i.push(e.cant_total_alumnos=e.cant_total_alumnos+t.cant_alumnos);return i},function(e){return console.log("Error trayendo cantidad de alumnos",e)})},e.rechazarCambio=function(e,t){return a.open({templateUrl:"==panel/rechazarAsked.tpl.html",controller:"RechazarAskedCtrl",resolve:{asked:function(){return e},tipo:function(){return t}}}).result.then(function(a){if(n.info("Pedido rechazado."),e.finalizado=a.finalizado,"img_perfil"===t&&(e.detalles.image_id_accepted=!1),"foto_oficial"===t&&(e.detalles.foto_id_accepted=!1),"img_delete"===t&&(e.detalles.image_to_delete_accepted=!1),"nombres"===t&&(e.detalles.nombres_accepted=!1),"apellidos"===t&&(e.detalles.apellidos_accepted=!1),"sexo"===t&&(e.detalles.sexo_accepted=!1),"fecha_nac"===t)return e.detalles.fecha_nac_accepted=!1})},e.aprobarCambio=function(e,t,r){return a.open({templateUrl:"==panel/aceptarAsked.tpl.html",controller:"AceptarAskedCtrl",resolve:{asked:function(){return e},tipo:function(){return t},valor_nuevo:function(){return r}}}).result.then(function(a){if(n.success("Pedido aceptado."),e.finalizado=a.finalizado,"img_perfil"===t&&(e.detalles.image_id_accepted=!0),"img_delete"===t&&(e.detalles.image_to_delete_accepted=!0),"nombres"===t&&(e.detalles.nombres_accepted=!0),"apellidos"===t&&(e.detalles.apellidos_accepted=!0),"sexo"===t&&(e.detalles.sexo_accepted=!0),"fecha_nac"===t&&(e.detalles.fecha_nac_accepted=!0),"foto_oficial"===t&&(e.detalles.foto_id_accepted=!0,e.foto_nombre=e.detalles.foto_new_nombre),"asignatura"===t)return e.finalizado=!0})},e.eliminarSolicitudes=function(e){return a.open({templateUrl:"==panel/eliminarAsked.tpl.html",controller:"EliminarAskedCtrl",resolve:{asked:function(){return e}}}).result.then(function(a){return n.success("Pedido eliminado."),e.finalizado=!0})},e.verDetalleDeMiSesion=function(e){return r.put("::historiales/sesion",{historial_id:e.id,tipo:e.tipo}).then(function(t){return a.open({templateUrl:"==panel/modalDetallesSesion.tpl.html",controller:"ModalDetallesSesionCtrl",resolve:{historial:function(){return t.data.historial}}}).result.then(function(a){return console.log(e)})},function(e){return n.error("No se pudo traer el detalle")})},e.eliminarIntentoFallido=function(a){if(!1,confirm("¿Está seguro de eliminar este registro?"))return r.delete("::bitacoras/destroy/"+a.id).then(function(t){return n.success("Eliminado. Recargue para ver los cambios."),a.eliminada=!0,e.changes_asked.intentos_fallidos=o("filter")(e.changes_asked.intentos_fallidos,{id:"!"+a.id},!0)},function(e){return n.error("No se pudo eliminar")})}}]).controller("AceptarAskedCtrl",["$scope","$uibModalInstance","asked","tipo","valor_nuevo","$http","toastr","App",function(e,a,t,r,n,o,i,s){return e.imagesPath=s.images+"perfil/",e.asked=t,e.aceptarAsignatura=function(){var e;return e={pedido:t,tipo:r,asker_id:t.asked_by_user_id},o.put("::ChangesAsked/aceptar-asignatura",e).then(function(e){return a.close(e.data)},function(e){return i.warning("Problema","No se pudo aceptar petición.")})},e.ok=function(){var s;return t.assignment_id?e.aceptarAsignatura():(s={asked_id:t.asked_id,data_id:t.detalles.data_id,tipo:r,valor_nuevo:n,asker_id:t.asked_by_user_id},t.alumno_id&&(s.alumno_id=t.alumno_id),o.put("::ChangesAsked/aceptar-alumno",s).then(function(e){return a.close(e.data)},function(e){return i.warning("Problema","No se pudo aceptar petición.")}))},e.cancel=function(){return a.dismiss("cancel")}}]).controller("RechazarAskedCtrl",["$scope","$uibModalInstance","asked","tipo","$http","toastr","App",function(e,a,t,r,n,o,i){return e.imagesPath=i.images+"perfil/",e.asked=t,e.ok=function(){var e,i,s;return i=t.detalles?t.detalles.data_id:t.assignment_id,e=t.detalles.assignment_id,s={asked_id:t.asked_id,data_id:i,assignment_id:e,tipo:r,asker_id:t.asked_by_user_id},n.put("::ChangesAsked/rechazar",s).then(function(e){return a.close(e.data)},function(e){return o.error("Problema","No se pudo rechazar petición.")})},e.cancel=function(){return a.dismiss("cancel")}}]).controller("EliminarAskedCtrl",["$scope","$uibModalInstance","asked","$http","toastr","App",function(e,a,t,r,n,o){return e.imagesPath=o.images+"perfil/",e.asked=t,e.ok=function(){var e;return e={asked_id:t.asked_id,data_id:t.detalles.data_id},r.put("::ChangesAsked/destruir",e).then(function(e){return a.close(e.data)},function(e){return n.error("Problema","No se pudo eliminar peticiones.")})},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ModalDetallesSesionCtrl",["$scope","$uibModalInstance","historial","$http","toastr","App","$filter",function(e,a,t,r,n,o,i){var s,u,l,c,d;return e.imagesPath=o.images+"perfil/",e.historial=t,t.logout_at?(s=new Date(t.created_at),u=new Date(t.logout_at).getTime()-s.getTime(),parseInt(u%1e3/100),d=parseInt(u/1e3%60),c=parseInt(u/6e4%60),l=(l=parseInt(u/36e5%24))<10?"0"+l:l,c=c<10?"0"+c:c,d=d<10?"0"+d:d,e.duracion=l+":"+c+":"+d):e.duracion="No cerró sesión.",e.ok=function(){return a.close()},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("YearsCtrl",["App","$scope","$http","$uibModal","$state","ProfesoresServ","$cookies","$rootScope","$filter","toastr",function(e,a,t,r,n,o,i,s,u,l){a.perfilPath=e.images+"perfil/",a.status={open_year:!0},t.get("::years/colegio").then(function(e){var r,n,o,i,s,u,c;for(r=0,o=(u=(e=e.data).years).length;r<o;r++)for(n=0,i=(c=u[r].periodos).length;n<i;n++)(s=c[n]).fecha_inicio=new Date(s.fecha_inicio),s.fecha_fin=new Date(s.fecha_fin),s.fecha_plazo=new Date(s.fecha_plazo);return a.years=e.years,a.certificados=e.certificados,a.imagenes=e.imagenes,t.get("::profesores/todos").then(function(e){return a.profesores=e.data,a.fixControles()},function(e){return l.error("No se pudo traer los profesores")})},function(e){return l.error("No se trajeron los años")}),a.fixControles=function(){var e,t,r,n,o,i;for(o=a.years.length-1,a.newcertif={},a.newYear={nombre_colegio:a.years[o].nombre_colegio,abrev_colegio:a.years[o].abrev_colegio,year:a.years[o].year+1,actual:!0,alumnos_can_see_notas:!0,nota_minima_aceptada:a.years[o].nota_minima_aceptada,resolucion:a.years[o].resolucion,codigo_dane:a.years[o].codigo_dane,telefono:a.years[o].telefono,celular:a.years[o].celular,unidad_displayname:a.years[o].unidad_displayname,unidades_displayname:a.years[o].unidades_displayname,genero_unidad:a.years[o].genero_unidad,subunidad_displayname:a.years[o].subunidad_displayname,subunidades_displayname:a.years[o].subunidades_displayname,genero_subunidad:a.years[o].genero_subunidad},n=[],e=0,t=(r=a.years).length;e<t;e++)(i=r[e]).ocultando=!i.actual,i.rector=u("filter")(a.profesores,{profesor_id:i.rector_id},!0)[0],i.secretario=u("filter")(a.profesores,{profesor_id:i.secretario_id},!0)[0],n.push(i.tesorero=u("filter")(a.profesores,{profesor_id:i.tesorero_id},!0)[0]);return n},a.addPeriodo=function(e){return r.open({templateUrl:"==colegio/addPeriodo.tpl.html",controller:"AddPeriodoCtrl",resolve:{year:function(){return e}}}).result.then(function(a){return e.periodos.push(a)})},a.removePeriodo=function(e,a){return r.open({templateUrl:"==colegio/removePeriodo.tpl.html",controller:"RemovePeriodoCtrl",resolve:{periodo:function(){return a}}}).result.then(function(a){return e.periodos=u("filter")(e.periodos,{id:"!"+a.id})})},a.toggleBloquearNotas=function(e,a){return t.put("::years/alumnos-can-see-notas",{can:a,year_id:e}).then(function(e){return l.success(e.data)},function(e){return l.warning("No se pudo bloquear o desbloquear el sistema.","Problema")})},a.toggleBloquearProfesEditAlumnos=function(e,a){return t.put("::years/profes-can-edit-alumnos",{can:a,year_id:e}).then(function(e){return l.success(e.data)},function(e){return l.warning("No se pudo bloquear o desbloquear la edición.","Problema")})},a.toggleMostrarPuestoEnBoletin=function(e,a){return t.put("::years/toggle-mostrar-puestos-en-boletin",{can:a,year_id:e}).then(function(e){return l.success(e.data)},function(e){return l.warning("No se pudo bloquear o desbloquear la edición.","Problema")})},a.toggleMostrarNotaComportamientoEnBoletin=function(e,a){return t.put("::years/toggle-mostrar-nota-comport-en-boletin",{can:a,year_id:e}).then(function(e){return l.success(e.data)},function(e){return l.warning("No se pudo cambiar.","Problema")})},a.toggleMostrarAnioPasado=function(e,a){return t.put("::years/toggle-mostrar-anio-pasado-en-boletin",{can:a,year_id:e}).then(function(e){return l.success(e.data)},function(e){return l.warning("No se pudo cambiar.","Problema")})},a.toggleIgnorarNotasPerdidas=function(e,a){return t.put("::years/toggle-ignorar-notas-perdidas",{can:a,year_id:e}).then(function(e){return l.success(e.data)},function(e){return l.warning("No se pudo bloquear o desbloquear la edición.","Problema")})},a.restarNewYear=function(){if(a.newYear.year>1990)return a.newYear.year=a.newYear.year-1},a.sumarNewYear=function(){if(a.newYear.year<3e3)return a.newYear.year=a.newYear.year+1},a.restarNewNota=function(){if(a.newYear.nota_minima_aceptada>0)return a.newYear.nota_minima_aceptada=a.newYear.nota_minima_aceptada-.1},a.sumarNewNota=function(){if(a.newYear.nota_minima_aceptada<1e3)return a.newYear.nota_minima_aceptada=a.newYear.nota_minima_aceptada+.1},a.actualPeriodo=function(e,a){return t.put("::periodos/establecer-actual/"+a.id).then(function(t){var r,n,o;for(l.success("Periodo "+a.numero+" establecido como actual."),r=0,n=(o=e.periodos).length;r<n;r++)o[r].actual=!1;return a.actual=!0},function(e){return l.warning("No se pudo establecer como actual.","Problema")})},a.crearNewYear=function(){return t.post("::years/store",a.newYear).then(function(e){var t,r,n;for(l.success("Año "+a.newYear.year+" creado. Por favor configúrelo."),a.nonuevo=!1,t=0,r=(n=a.years).length;t<r;t++)n[t].actual=0;return a.years.push(e.data)},function(e){return l.warning("No se pudo crear año.","Problema")})},a.guardar_cambios=function(e){return e.rector_id=e.rector?e.rector.profesor_id:null,e.secretario_id=e.secretario?e.secretario.profesor_id:null,e.tesorero_id=e.tesorero?e.tesorero.profesor_id:null,t.put("::years/guardar-cambios",e).then(function(e){return l.success("Cambios guardados.")},function(e){return l.warning("No se pudo guardar cambios.","Problema")})},a.deleteYear=function(e){return r.open({templateUrl:"==colegio/removeYear.tpl.html",controller:"RemoveYearCtrl",resolve:{year:function(){return e}}}).result.then(function(e){return a.years=u("filter")(a.years,{id:"!"+e.id})})},a.cambiarFechaInicio=function(e,a){return t.put("::periodos/cambiar-fecha-inicio",{periodo_id:e.id,fecha:a}).then(function(e){return l.success("Fecha guardada.")},function(e){return l.warning("No se pudo guardar fecha.","Problema")})},a.cambiarFechaFin=function(e,a){return t.put("::periodos/cambiar-fecha-fin",{periodo_id:e.id,fecha:a}).then(function(e){return l.success("Fecha guardada.")},function(e){return l.warning("No se pudo guardar fecha.","Problema")})},a.toggleProfesPuedenEditarNotas=function(e,a){return t.put("::periodos/toggle-profes-pueden-editar-notas",{periodo_id:e.id,pueden:a}).then(function(e){return l.success("Cambiado.")},function(e){return l.warning("No se pudo guardar fecha.","Problema")})},a.toggleProfesPuedenNivelar=function(e,a){return t.put("::periodos/toggle-profes-pueden-nivelar",{periodo_id:e.id,pueden:a}).then(function(e){return l.success("Cambiado.")},function(e){return l.warning("No se pudo guardar fecha.","Problema")})}}]).controller("RemoveYearCtrl",["$scope","$uibModalInstance","year","$http","toastr",function(e,a,t,r,n){return e.year=t,e.ok=function(){return r.delete("::years/delete/"+t.id).then(function(e){return n.success("Año "+t.year+" enviado a la papelera."),a.close(t)},function(e){return n.warning("No se pudo eliminar el año.","Problema"),a.dismiss()})},e.cancel=function(){return a.dismiss("cancel")}}]).controller("RemovePeriodoCtrl",["$scope","$uibModalInstance","periodo","$http","toastr",function(e,a,t,r,n){return e.periodo=t,e.ok=function(){return r.delete("::periodos/destroy/"+t.id).then(function(e){return n.success("Periodo eliminado con éxito.","Eliminado"),a.close(t)},function(e){return n.warning("No se pudo eliminar el periodo.","Problema"),a.dismiss()})},e.cancel=function(){return a.dismiss("cancel")}}]).controller("AddPeriodoCtrl",["$scope","$uibModalInstance","year","$http","toastr",function(e,a,t,r,n){return e.year=t,e.new_periodo={},e.year_id=e.year.id,e.ok=function(){return r.post("::periodos/store/"+t.id,e.new_periodo).then(function(e){return n.success("Periodo creado con éxito.","Creado"),a.close(e.data)},function(e){return n.warning("No se pudo crear el periodo.","Problema"),a.dismiss()})},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("configuracionCertificados",["App",function(e){return{restrict:"E",templateUrl:`${e.views}colegio/configCertificados.tpl.html`,link:function(e,a,t){},controller:"ConfigCertificadosCtrl"}}]).controller("ConfigCertificadosCtrl",["$scope","App","$http","$state","toastr","uiGridConstants","$filter",function(e,a,t,r,n,o,i){var s,u,l;e.newcertif={encabezado_width:0,encabezado_height:0,encabezado_margin_top:0,encabezado_margin_left:0,piepagina_width:0,piepagina_height:0,piepagina_margin_bottom:0,piepagina_margin_left:0},e.creando_certificado=!1,e.editando=!1,e.currentCertif={},e.certificado={},(l=i("filter")(e.certificados,{id:e.year.config_certificado_estudio_id}))&&l.length>0&&(e.certificado.config_actual=l[0]),e.crearConfig=function(){return e.creando_certificado=!0},e.cancelConfig=function(){return e.creando_certificado=!1},s='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',u='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!1,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:50,enableCellEdit:!1,enableColumnMenu:!1},{field:"nombre",displayName:"Nombre",enableSorting:!1,enableColumnMenu:!1},{name:"edicion",displayName:"Edición",width:60,enableSorting:!1,enableFiltering:!1,cellTemplate:s+u,enableCellEdit:!1,enableColumnMenu:!1},{field:"encabezado_width",displayName:"AnchoE",filter:{condition:o.filter.CONTAINS}},{field:"encabezado_height",displayName:"AltoE",filter:{condition:o.filter.CONTAINS}},{field:"encabezado_margin_top",displayName:"MargenEArr",filter:{condition:o.filter.CONTAINS}},{field:"encabezado_margin_left",displayName:"MargenEIzq",filter:{condition:o.filter.CONTAINS}},{field:"piepagina_width",displayName:"AnchoP"},{field:"piepagina_height",displayName:"AltoP"},{field:"piepagina_margin_left",displayName:"MargenPIzq"},{field:"piepagina_margin_bottom",displayName:"MargenPAba"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,r,o,i){return o!==i&&t.put("::certificados/update",a).then(function(e){return n.success("Certificado modificado","Actualizado")},function(e){return n.error("Cambio no guardado","Error")}),e.$apply()})}},e.gridOptions.data=e.certificados,e.guardar=function(){return t.post("::certificados/store",e.newcertif).then(function(a){return n.success("Certificado creado."),e.creando_certificado=!1,e.certificados.push(a.data),e.gridOptions.data=e.certificados},function(e){return n.error("Certificado no guardado","Error")})},e.editar=function(a){var t,r;if(e.editando=!0,e.currentCertif=a,t=i("filter")(e.imagenes,{id:a.encabezado_img_id}),r=i("filter")(e.imagenes,{id:a.piepagina_img_id}),t.length>0&&(t=t[0],e.currentCertif.encabezado_img=t),r.length>0)return r=r[0],e.currentCertif.piepagina_img=r},e.cancelEdit=function(){return e.editando=!1},e.actualizar=function(){return t.put("::certificados/update",e.currentCertif).then(function(a){return n.success("Certificado modificado","Actualizado"),e.editando=!1},function(e){return n.error("Cambio no guardado","Error")})},e.eliminar=function(a){return t.delete("::certificados/destroy/"+a.id).then(function(t){return n.success("Certificado eliminado."),e.certificados=i("filter")(e.certificados,{id:"!"+a.id}),e.gridOptions.data=e.certificados},function(e){return n.error("Certificado no eliminado","Error")})},e.certificadoSelect=function(a,r){return t.put("::certificados/actual",{config_certificado_estudio_id:a.id,year_id:e.year.id}).then(function(e){return n.success("Certificado actual cambiado.")},function(e){return n.error("Certificado no cambiado","Error")})},e.guardarEncabezado=function(){return t.put("::certificados/encabezado",{encabezado_certificado:e.year.encabezado_certificado,year_id:e.year.id}).then(function(e){return n.success("Encabezado guardado.")},function(e){return n.error("Encabezado no guardado","Error")})}}])}.call(this),function(){angular.module("myvcFrontApp").directive("configuracionEscalas",["App",function(e){return{restrict:"E",templateUrl:`${e.views}colegio/configEscalas.tpl.html`,link:function(e,a,t){},controller:"ConfigEscalasCtrl"}}]).controller("ConfigEscalasCtrl",["$scope","App","$http","$state","$cookies","toastr","uiGridConstants","$filter",function(e,a,t,r,n,o,i,s){var u;e.creando_escala=!1,u='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminarEscala(row.entity)"><i class="fa fa-trash "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:50,enableCellEdit:!1,enableColumnMenu:!1},{field:"desempenio",displayName:"Desempeño",enableSorting:!1,enableColumnMenu:!1},{name:"eliminar",displayName:"Elimin",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:u,enableCellEdit:!1,enableColumnMenu:!1},{field:"descripcion",displayName:"Descripción"},{field:"porc_inicial",displayName:"Valor inicial"},{field:"porc_final",displayName:"Valor final"},{field:"orden",type:"number"},{field:"perdido",type:"boolean",cellTemplate:'<input type="checkbox" ng-model="row.entity.perdido" ng-true-value="1" ng-false-value="0">'},{field:"valoracion",displayName:"Valoración"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,r,n,i){return n!==i&&t.put("::escalas/update",a).then(function(e){return o.success("Escala modificada","Actualizada")},function(e){return o.error("Cambio no guardado","Error")}),e.$apply()})}},e.gridOptions.data=e.year.escalas,e.crearEscala=function(){return t.post("::escalas/store").then(function(a){return o.success("Escala creada."),e.creando_escala=!1,e.year.escalas.push(a.data),e.gridOptions.data=e.year.escalas},function(e){return o.error("Escala no guardada","Error")})},e.eliminarEscala=function(a){return t.delete("::escalas/destroy/"+a.id).then(function(t){return o.success("Escala eliminada."),e.year.escalas=s("filter")(e.year.escalas,{id:"!"+a.id}),e.gridOptions.data=e.year.escalas},function(e){return o.error("Escala no eliminada","Error")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(e,a,t){e.state("panel.promocionar_notas",{url:"/promocionar_notas",views:{maincontent:{templateUrl:`${a.views}alumnos/promocionarNotas.tpl.html`,controller:"PromocionarNotasCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Promocionar notas de alumno promovido"}]}}},data:{displayName:"Promocionar notas",icon_fa:"fa fa-apple",pageTitle:"Promocionar notas - MyVc",needed_permissions:[t.can_work_like_teacher]}}).state("panel.alumnos.nuevo",{url:"/nuevo",views:{edit_alumno:{templateUrl:`${a.views}alumnos/alumnosNew.tpl.html`,controller:"AlumnosNewCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo alumno"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-male",pageTitle:"Nuevo alumno - MyVc",needed_permissions:[t.can_work_like_admin,t.can_edit_alumnos]}}).state("panel.alumnos.editar",{url:"/editar/:alumno_id",views:{edit_alumno:{templateUrl:`${a.views}alumnos/alumnosEdit.tpl.html`,controller:"AlumnosEditCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-users",pageTitle:"Editar alumno - MyVc",needed_permissions:[t.can_work_like_admin,t.can_edit_alumnos]}}).state("panel.listalumnos",{url:"^/listalumnos/:grupo_id",param:{grupo_id:null},views:{maincontent:{templateUrl:`${a.views}alumnos/listAlumnos.tpl.html`,controller:"ListAlumnosCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Listado de alumnos"}]}}},data:{displayName:"Listado",icon_fa:"fa fa-users",pageTitle:"Listado alumnos - MyVc",needed_permissions:[t.can_work_like_teacher]}}).state("panel.matriculas",{url:"^/matriculas",views:{maincontent:{templateUrl:`${a.views}alumnos/matriculas.tpl.html`,controller:"MatriculasCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas de alumnos"}]}}},data:{displayName:"matriculas",icon_fa:"fa fa-users",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[t.can_work_like_teacher,t.can_work_like_admin,t.can_edit_alumnos]}}),e.state("panel.matriculas.nuevo",{url:"/nuevo",views:{edit_alumno:{templateUrl:`${a.views}alumnos/alumnosNew.tpl.html`,controller:"AlumnosNewCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo alumno"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-male",pageTitle:"Nuevo alumno - MyVc",needed_permissions:[t.can_work_like_teacher,t.can_work_like_admin,t.can_edit_alumnos]}}).state("panel.matriculas.detalles",{url:"^/matriculas/detalles/:alumno_id",param:{alumno_id:null},views:{matricula_detalle:{templateUrl:`${a.views}alumnos/matriculasDetalles.tpl.html`,controller:"MatriculasDetallesCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas detalladas"}]}}},data:{displayName:"detalles",icon_fa:"fa fa-pencil",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[t.can_work_like_admin]}}).state("panel.alumnos.matricula_detalles",{url:"^/alumnos/matricula_detalles/:alumno_id",param:{alumno_id:null},views:{matricula_detalle:{templateUrl:`${a.views}alumnos/matriculasDetalles.tpl.html`,controller:"MatriculasDetallesCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas detalladas"}]}}},data:{displayName:"detalles",icon_fa:"fa fa-pencil",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[t.can_work_like_admin]}}).state("panel.matriculas.detalles.periodos",{url:"^/matriculas/detalles/:alumno_id/periodos",param:{alumno_id:null},views:{matricula_detalle_periodos:{templateUrl:`${a.views}alumnos/matriculasDetallesPeriodos.tpl.html`,controller:"MatriculasDetallesPeriodosCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas detalladas"}]}}},data:{displayName:"periodos",icon_fa:"fa fa-ioxhost",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[t.can_work_like_admin]}}).state("panel.cartera",{url:"^/cartera",views:{maincontent:{templateUrl:`${a.views}alumnos/cartera.tpl.html`,controller:"CarteraCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Cartera"}]}}},data:{displayName:"cartera",icon_fa:"fa fa-money",pageTitle:"Cartera - MyVc",needed_permissions:[t.can_work_like_teacher]}}).state("panel.cartera.editar",{url:"/editar/:alumno_id",views:{edit_alumno:{templateUrl:`${a.views}alumnos/alumnosEdit.tpl.html`,controller:"AlumnosEditCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"editar",icon_fa:"fa fa-users",pageTitle:"Editar alumno - MyVc",needed_permissions:[t.can_work_like_teacher]}}).state("panel.acudientes",{url:"^/acudientes",views:{maincontent:{templateUrl:`${a.views}alumnos/acudientes.tpl.html`,controller:"AcudientesCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Acudientes"}]}}},data:{displayName:"Acudientes",icon_fa:"fa fa-users",pageTitle:"Acudientes - MyVc",needed_permissions:[t.can_work_like_teacher]}}).state("panel.asistencias",{url:"^/asistencias",views:{maincontent:{templateUrl:`${a.views}alumnos/asistencias.tpl.html`,controller:"AsistenciasCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Asistencias a la institución"}]}}},data:{displayName:"Asistencias a la institución",icon_fa:"fa fa-users",pageTitle:"Asistencias - MyVc",needed_permissions:[t.can_work_like_teacher]}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AlumnosCtrl",["$scope","App","$rootScope","$state","$interval","uiGridConstants","uiGridEditConstants","$uibModal","$filter","AuthService","toastr","$http","DownloadServ","Upload",function(e,a,t,r,n,o,i,s,u,l,c,d,p,f){var m,g,_,h,v,b,y,w,C,N,A;l.verificar_acceso(),l.hasRoleOrPerm("Profesor")&&!e.USER.profes_can_edit_alumnos&&(c.warning("No tienes permiso para editar alumnos"),r.transitionTo("panel")),e.dato={},e.dato.mostrartoolgrupo=!0,e.gridScope=e,e.views=a.views,e.perfilPath=a.images+"perfil/",e.year_ant=e.USER.year-1,e.gridOptions={},e.gridOptionsSinMatricula={},e.paises=[],e.religiones=a.religiones,e.tipos_sangre=a.tipos_sangre,e.mostrar_pasado=!1,e.mostrar_retirados=!1,e.texto_a_buscar="",e.parentescos=a.parentescos,e.dato.grupo="",d.get("::grupos/con-paises-tipos").then(function(a){var t,r,n,o,i,s;for(o=0,localStorage.matr_grupo&&(o=parseInt(localStorage.matr_grupo)),e.grupos=a.data.grupos,e.paises=a.data.paises,e.tipos_doc=a.data.tipos_doc,s=[],r=0,n=(i=e.grupos).length;r<n;r++)t=i[r],parseInt(t.id)===parseInt(o)?(e.dato.grupo=t,s.push(e.selectGrupo(e.dato.grupo))):s.push(void 0);return s}),e.selectGrupo=function(a){var t,r,n,o,i,s,u,l,p;for(localStorage.matr_grupo=a.id,e.dato.grupo=a,o=0,s=(l=e.grupos).length;o<s;o++)(r=l[o]).active=!1;for(a.active=!0,n=[],i=0,u=(p=e.grupos).length;i<u;i++)(r=p[i]).orden_grado===a.orden_grado-1&&n.push(r);return t=n.length>0?n[0].grado_id:null,e.traerAlumnnosConGradosAnterior=function(){return d.put("::matriculas/alumnos-con-grado-anterior",{grupo_actual:a,grado_ant_id:t,year_ant:e.year_ant}).then(function(a){var t,r,n,o,i,s,u,l,p,f,m,g,_,h,v,b,y,w,C;for(e.gridOptions.data=a.data.AlumnosActuales,e.AlumnosDesertRetir=a.data.AlumnosDesertRetir,e.gridOptionsSinMatricula.data=a.data.AlumnosSinMatricula,r=0,o=(_=e.gridOptions.data).length;r<o;r++){for((t=_[r]).estado_ant=t.estado,t.fecha_retiro_ant=t.fecha_retiro,t.fecha_retiro=t.fecha_retiro?new Date(t.fecha_retiro.replace(/-/g,"/")):t.fecha_retiro,t.fecha_matricula_ant=t.fecha_matricula,t.fecha_matricula=t.fecha_matricula?new Date(t.fecha_matricula.replace(/-/g,"/")):t.fecha_matricula,t.fecha_nac=t.fecha_nac?new Date(t.fecha_nac.replace(/-/g,"/")):t.fecha_nac,n=0,i=(h=e.tipos_doc).length;n<i;n++)(C=h[n]).id===t.tipo_doc&&(t.tipo_doc=C);for(p=0,s=(v=t.subGridOptions.data).length;p<s;p++)(g=v[p]).fecha_nac_ant=g.fecha_nac,g.fecha_nac=g.fecha_nac?new Date(g.fecha_nac.replace(/-/g,"/")):g.fecha_nac;t.subGridOptions.onRegisterApi=function(a){return a.edit.on.afterCellEdit(e,function(a,t,r,n){if(r!==n){if("sexo"===t.field&&"M"!==(r=r.toUpperCase())&&"F"!==r)return c.warning("Debe usar M o F"),void(a.sexo=n);if("email"===t.field&&!/\S+@\S+\.\S+/.test(r))return c.warning("Email no válido"),void(a.email=n);d.put("::acudientes/guardar-valor",{parentesco_id:a.parentesco_id,acudiente_id:a.id,user_id:a.user_id,propiedad:t.field,valor:r}).then(function(e){return c.success("Acudiente actualizado con éxito")},function(e){return a[t.field]=n,c.error("Cambio no guardado","Error")})}return e.$apply()})}}for(f=0,u=(b=e.AlumnosDesertRetir).length;f<u;f++)(t=b[f]).estado_ant=t.estado,t.fecha_retiro_ant=t.fecha_retiro,t.fecha_retiro=t.fecha_retiro?new Date(t.fecha_retiro.replace(/-/g,"/")):t.fecha_retiro,t.fecha_matricula_ant=t.fecha_matricula,t.fecha_matricula=t.fecha_matricula?new Date(t.fecha_matricula.replace(/-/g,"/")):t.fecha_matricula;for(w=[],m=0,l=(y=e.gridOptionsSinMatricula.data).length;m<l;m++)(t=y[m]).estado_ant=t.estado,t.fecha_retiro_ant=t.fecha_retiro,t.fecha_retiro=t.fecha_retiro?new Date(t.fecha_retiro.replace(/-/g,"/")):t.fecha_retiro,t.fecha_matricula_ant=t.fecha_matricula,w.push(t.fecha_matricula=t.fecha_matricula?new Date(t.fecha_matricula.replace(/-/g,"/")):t.fecha_matricula);return w})},e.traerAlumnnosConGradosAnterior()},e.editar=function(e){return r.go("panel.alumnos.editar",{alumno_id:e.alumno_id})},e.eliminar=function(a){return s.open({templateUrl:"==alumnos/removeAlumno.tpl.html",controller:"RemoveAlumnoCtrl",resolve:{alumno:function(){return a}}}).result.then(function(a){return e.gridOptions.data=u("filter")(e.gridOptions.data,{alumno_id:"!"+a.alumno_id})},function(){})},e.agregarAcudiente=function(a){return delete t.acudiente_cambiar,s.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return a},paises:function(){return e.paises},tipos_doc:function(){return e.tipos_doc},parentescos:function(){return e.parentescos}}}).result.then(function(e){return a.subGridOptions.data.splice(a.subGridOptions.data.length-1,0,e)},function(){})},e.cambiarAcudiente=function(a,r){return t.acudiente_cambiar=r,s.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return a},paises:function(){return e.paises},tipos_doc:function(){return e.tipos_doc},parentescos:function(){return e.parentescos}}}).result.then(function(e){var t,n,o,i,s,u;for(u=[],n=t=0,o=(s=a.subGridOptions.data).length;t<o;n=++t)(i=s[n])&&i.id===r.id?u.push(a.subGridOptions.data.splice(n,1,e)):u.push(void 0);return u},function(){})},e.quitarAcudiente=function(e,a){return s.open({templateUrl:"==alumnos/quitarAcudienteModalConfirm.tpl.html",controller:"QuitarAcudienteModalConfirmCtrl",resolve:{alumno:function(){return e},acudiente:function(){return a}}}).result.then(function(a){var t,r,n,o,i,s;for(s=[],r=t=0,n=(i=e.subGridOptions.data).length;t<n;r=++t)(o=i[r])&&o.id===a.id?s.push(e.subGridOptions.data.splice(r,1)):s.push(void 0);return s},function(){})},e.cambiarCiudad=function(a,t){return s.open({templateUrl:"==alumnos/cambiarCiudadModal.tpl.html",controller:"CambiarCiudadModalCtrl",resolve:{persona:function(){return a},paises:function(){return e.paises},tipo_ciudad:function(){return t},tipo_persona:function(){return a.subGridOptions?"alumno":"acudiente"}}}).result.then(function(e){return a=e})},e.cambiarPazysalvo=function(e){var a;return e.pazysalvo=!e.pazysalvo,e.alumno_id||(e.alumno_id=e.id),a={alumno_id:e.alumno_id,propiedad:"pazysalvo",valor:e.pazysalvo},d.put("::alumnos/guardar-valor",a).then(function(e){return console.log("Cambios guardados")},function(a){return e.pazysalvo=!e.pazysalvo,c.error("Cambio no guardado","Error")})},e.toggleNuevo=function(e){var a;return e.nuevo=!e.nuevo,e.alumno_id||(e.alumno_id=e.id),a={alumno_id:e.alumno_id,propiedad:"nuevo",valor:e.nuevo},d.put("::alumnos/guardar-valor",a).then(function(e){return console.log("Cambios guardados")},function(a){return e.nuevo=!e.nuevo,c.error("Cambio no guardado","Error")})},e.toggleRepitente=function(e){var a;return e.repitente=!e.repitente,e.alumno_id||(e.alumno_id=e.id),a={alumno_id:e.alumno_id,propiedad:"repitente",valor:e.repitente},d.put("::alumnos/guardar-valor",a).then(function(e){return console.log("Cambios guardados")},function(a){return e.repitente=!e.repitente,c.error("Cambio no guardado","Error")})},e.crearUsuario=function(a){if(!a.user_id){if("Acudiente"===a.tipo){if(!a.id)return void c.info("Sólo con acudientes creados");d.post("::acudientes/crear-usuario",{acudiente:a}).then(function(t){return e.usuario_creado=!0,a.user_id=t.data.id,a.username=t.data.username,c.success("Usuario creado")},function(){return c.error("No se pudo crear el usuario")})}return"Acudiente"!==a.tipo?c.info("Aquí solo puede crear usuario de acudiente","Lo sentimos"):void 0}c.warning("Ya tiene usuario")},e.resetPass=function(e){if(e.user_id)return s.open({templateUrl:a.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return e}}}).result.then(function(e){});c.warning("Aún no tiene usuario")},e.cambiaUsernameCheck=function(a){return e.verificandoUsername=!0,d.put("::users/usernames-check",{texto:a}).then(function(a){return e.username_match=a.data.usernames,e.verificandoUsername=!1,e.username_match.map(function(e){return e.username})})},e.eliminarMatricula=function(e){return d.delete("::matriculas/destroy/"+e.matricula_id).then(function(a){return e.currentyear=0,c.success("Alumno desmatriculado"),e},function(e){return c.error("No se pudo desmatricular","Problema")})},g='<span style="padding-left: 2px; padding-top: 4px;" class="btn-group">'+'<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>'+"</span>",w="==directives/botonesMatricularMas.tpl.html",C="==directives/botonPazysalvo.tpl.html",b="==directives/botonIsNuevo.tpl.html",A="==directives/botonesResetPassword.tpl.html",h="==directives/botonCiudadNac.tpl.html",_="==directives/botonCiudadDoc.tpl.html",N="==directives/botonTipoDoc.tpl.html",v="==alumnos/botonEditEps.tpl.html",m='uib-popover-template="views+\'==alumnos/popoverAlumnoGrid.tpl.html\'" popover-trigger="\'mouseenter\'" popover-title="{{ row.entity.nombres + \' \' + row.entity.apellidos }}" popover-popup-delay="500" popover-append-to-body="true"',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Alumnos - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,expandableRowTemplate:"==alumnos/expandableRowTemplate.tpl.html",expandableRowHeight:120,expandableRowScope:{agregarAcudiente:e.agregarAcudiente,quitarAcudiente:e.quitarAcudiente,cambiarAcudiente:e.cambiarAcudiente,crearUsuario:e.crearUsuario,resetPass:e.resetPass,cambiarCiudad:e.cambiarCiudad,cambiaUsernameCheck:e.cambiaUsernameCheck},columnDefs:[{field:"no",pinnedLeft:!0,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>',width:40,enableCellEdit:!1},{field:"nombres",minWidth:130,pinnedLeft:!0,filter:{condition:function(e,a,t){return t.entity.nombres.toLowerCase().indexOf(e.toLowerCase())>-1}},enableHiding:!1,cellTemplate:'<div class="ui-grid-cell-contents" style="padding: 0px;" '+m+'><img ng-src="{{grid.appScope.perfilPath + row.entity.foto_nombre}}" style="width: 35px" />{{row.entity.nombres}}</div>'},{field:"apellidos",minWidth:110,filter:{condition:o.filter.CONTAINS}},{name:"edicion",displayName:"Elimi",width:54,enableSorting:!1,enableFiltering:!1,cellTemplate:g,enableCellEdit:!1,enableColumnMenu:!0},{field:"sexo",displayName:"Sex",width:40},{field:"grupo_id",displayName:"Matrícula",enableCellEdit:!1,cellTemplate:w,minWidth:180,enableFiltering:!1},{field:"fecha_matricula",displayName:"Fecha matrícula",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"no_matricula",displayName:"# matrícula",minWidth:80,enableColumnMenu:!0},{field:"username",filter:{condition:o.filter.CONTAINS},displayName:"Usuario",cellTemplate:A,editableCellTemplate:"==alumnos/botonEditUsername.tpl.html",minWidth:135},{field:"deuda",displayName:"Deuda",type:"number",cellFilter:'currency:"$":0',minWidth:70},{field:"pazysalvo",displayName:"A paz?",cellTemplate:C,minWidth:60,enableCellEdit:!1},{field:"nuevo",displayName:"Nuevo?",cellTemplate:b,minWidth:60,enableCellEdit:!1},{field:"repitente",displayName:"Repitente?",cellTemplate:"==directives/botonIsRepitente.tpl.html",minWidth:60,enableCellEdit:!1},{field:"religion",displayName:"Religión",minWidth:70,editableCellTemplate:"==alumnos/botonEditReligion.tpl.html"},{field:"tipo_doc",displayName:"Tipo documento",minWidth:120,cellTemplate:N,enableCellEdit:!1},{field:"documento",minWidth:100,cellFilter:"formatNumberDocumento"},{field:"ciudad_doc",displayName:"Ciud Docu",minWidth:120,cellTemplate:_,enableCellEdit:!1},{field:"tipo_sangre",displayName:"RH",minWidth:70},{field:"estrato",minWidth:70,type:"number"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"ciudad_nac",displayName:"Ciud Nacimi",minWidth:120,cellTemplate:h,enableCellEdit:!1},{field:"direccion",displayName:"Dirección",minWidth:80},{field:"barrio",minWidth:80},{field:"ciudad_resid",displayName:"Ciud Resid",minWidth:120,cellTemplate:"==directives/botonCiudadResid.tpl.html",enableCellEdit:!1},{field:"telefono",displayName:"Teléfono",minWidth:80},{field:"celular",displayName:"Celular",minWidth:80},{field:"eps",displayName:"EPS",minWidth:100,editableCellTemplate:v}],multiSelect:!1,exporterHeaderFilter:function(e){return"A paz?"===e?"Paz y salvo":"Matrícula"===e?"Grupo":e},exporterFieldCallback:function(a,t,r,n){return"no"===r.name?a.renderContainers.body.visibleRowCache.indexOf(t)+1:"grupo_id"===r.name?e.dato.grupo.nombre:"ciudad_nac"===r.name?t.entity.ciudad_nac_nombre:"pazysalvo"===r.name||"nuevo"===r.name?n?"Si":"No":"tipo_doc"===r.name&&n&&n.tipo?n.tipo:n},onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){if(r!==n){if(a.alumno_id||(a.alumno_id=fila.id),"sexo"===t.field&&"M"!==(r=r.toUpperCase())&&"F"!==r)return c.warning("Debe usar M o F"),void(a.sexo=n);if("fecha_matricula"===t.field)return e.cambiarFechaMatricula(a);if("tipo_sangre"===t.field&&(r=r.toUpperCase(),!(e.tipos_sangre.indexOf(r)>-1)))return c.warning("Debe usar: "+e.tipos_sangre.join(" ")),void(a.tipo_sangre=n);if("estrato"===t.field&&(r<0||r>9))return c.warning("Valor no admitido"),void(a.estrato=n);if("documento"===t.field&&10!==r.length&&0!==r.length)return void c.warning("Debe ser de diez dígitos");d.put("::alumnos/guardar-valor",{alumno_id:a.alumno_id,propiedad:t.field,valor:r}).then(function(e){return c.success("Alumno(a) actualizado con éxito")},function(e){return a[t.field]=n,c.error("Cambio no guardado","Error")})}if("religion"!==t.field)return e.$apply()})}},y='<span style="padding-left: 2px; padding-top: 4px;" class="btn-group">'+'<label ng-click="grid.appScope.setNewAsistente(row.entity)" uib-tooltip="Inscribir como asistente" tooltip-append-to-body="true" class="btn btn-success shiny btn-xs">Asis</label>'+'<label ng-click="grid.appScope.matricularUno(row.entity, true)" uib-tooltip="Matricular" tooltip-append-to-body="true" tooltip-popup-delay="1000" class="btn btn-success shiny btn-xs">Matric</label>'+'<label ng-click="grid.appScope.matricularEn(row.entity)" uib-tooltip="Matricular en..." tooltip-append-to-body="true" tooltip-placement="right" class="btn btn-success shiny btn-xs">Otro grupo...</label>'+"</span>",e.gridOptionsSinMatricula={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,columnDefs:[{field:"no",cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>',width:40},{field:"nombres",minWidth:120,filter:{condition:function(e,a,t){return t.entity.nombres.toLowerCase().indexOf(e.toLowerCase())>-1}},enableHiding:!1,cellTemplate:'<div class="ui-grid-cell-contents" style="padding: 0px;" '+m+'><img ng-src="{{grid.appScope.perfilPath + row.entity.foto_nombre}}" style="width: 35px" />{{row.entity.nombres}}</div>'},{field:"apellidos",minWidth:80,filter:{condition:o.filter.CONTAINS}},{field:"sexo",displayName:"Sex",width:40},{field:"grupo_id",displayName:"Matrícula",cellTemplate:y,minWidth:180,enableFiltering:!1},{field:"fecha_matricula",displayName:"Fecha matrícula",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"no_matricula",displayName:"# matrícula",minWidth:80,enableColumnMenu:!0},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"telefono",displayName:"Teléfono",minWidth:70}],multiSelect:!0},e.religionSelected=function(a,t){if(e.religiones.indexOf(a.religion)>-1)return e.$broadcast(i.events.END_CELL_EDIT)},e.religionEditPressEnter=function(a){return e.$broadcast(i.events.END_CELL_EDIT)},e.tipoDocSeleccionado=function(e,a){var t,r;return t={propiedad:"tipo_doc",valor:e.id},r="acudientes",a.subGridOptions?(r="alumnos",t.alumno_id=a.alumno_id):(t.acudiente_id=a.acudiente_id,t.parentesco_id=a.parentesco_id,t.user_acud_id=a.user_id),d.put("::"+r+"/guardar-valor",t).then(function(e){return c.success("Alumno(a) actualizado con éxito","Actualizado")},function(e){return a.tipo_doc=oldValue,c.error("Cambio no guardado","Error")})},e.matricularUno=function(a,t){var r;if(e.dato.grupo.id)return r={alumno_id:a.alumno_id,grupo_id:e.dato.grupo.id,year_id:e.USER.year_id},d.post("::matriculas/matricularuno",r).then(function(r){return r=r.data,a.matricula_id=r.id,a.grupo_id=r.grupo_id,a.estado="MATR",a.fecha_matricula_ant=r.fecha_matricula.date,a.fecha_matricula=new Date(r.fecha_matricula.date),c.success("Alumno matriculado con éxito","Matriculado"),t&&e.traerAlumnnosConGradosAnterior(),a},function(e){return c.error("No se pudo matricular el alumno.","Error")});c.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},e.cambiaEpsCheck=function(a){return e.verificandoEps=!0,d.put("::alumnos/eps-check",{texto:a}).then(function(a){return e.eps_match=a.data.eps,e.verificandoEps=!1,e.eps_match.map(function(e){return e.eps})})},e.reMatricularUno=function(a){var t;if(e.dato.grupo.id)return t={matricula_id:a.matricula_id},d.put("::matriculas/re-matricularuno",t).then(function(e){return e=e.data,c.success("Alumno rematriculado","Matriculado"),a},function(e){return c.error("No se pudo matricular el alumno.","Error")});c.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},e.matricularEn=function(a){return s.open({templateUrl:"==alumnos/matricularEn.tpl.html",controller:"MatricularEnCtrl",resolve:{alumno:function(){return a},grupos:function(){return e.grupos},year_id:function(){return e.USER.year_id}}}).result.then(function(a){return console.log("Cierra"),e.traerAlumnnosConGradosAnterior()})},e.setAsistente=function(a){return d.put("::matriculas/set-asistente",{matricula_id:a.matricula_id,grupo_id:e.dato.grupo.grupo_id}).then(function(e){return c.success("Guardado como asistente")},function(e){return c.error("No se pudo guardar como asistente","Error")})},e.setNewAsistente=function(a){return d.put("::matriculas/set-new-asistente",{alumno_id:a.alumno_id,grupo_id:e.dato.grupo.id}).then(function(a){return console.log("Cambios guardados"),e.traerAlumnnosConGradosAnterior()},function(e){return c.error("No se pudo crear asistente","Error")})},e.cambiarFechaRetiro=function(e){return d.put("::matriculas/cambiar-fecha-retiro",{matricula_id:e.matricula_id,fecha_retiro:e.fecha_retiro}).then(function(e){return c.success("Fecha retiro guardada")},function(a){return e.fecha_retiro=e.fecha_retiro_ant,c.error("No se pudo guardar la fecha","Error")})},e.cambiarFechaMatricula=function(e){return d.put("::matriculas/cambiar-fecha-matricula",{matricula_id:e.matricula_id,fecha_matricula:e.fecha_matricula}).then(function(e){return c.success("Fecha matrícula guardada")},function(a){return e.fecha_matricula=e.fecha_matricula_ant,c.error("No se pudo guardar la fecha","Error")})},e.desertar=function(e){var a;return a=e.fecha_retiro,null===e.fecha_retiro_ant&&(a=new Date,e.fecha_retiro=a),d.put("::matriculas/desertar",{matricula_id:e.matricula_id,fecha_retiro:e.fecha_retiro}).then(function(e){return c.success("Alumno desertado")},function(e){return c.error("No se pudo desertar","Problema")})},e.retirar=function(e){var a;return a=e.fecha_retiro,null===e.fecha_retiro_ant&&(a=new Date,e.fecha_retiro=a),d.put("::matriculas/retirar",{matricula_id:e.matricula_id,fecha_retiro:e.fecha_retiro}).then(function(e){return c.success("Alumno retirado")},function(e){return c.error("No se pudo desmatricular","Problema")})},e.buscar_por=function(a){if(""!==e.texto_a_buscar)return d.put("::buscar/por-"+a,{texto_a_buscar:e.texto_a_buscar}).then(function(a){return e.alumnos_encontrados=a.data},function(e){return c.error("No se pudo buscar","Problema")});c.warning("Escriba término a buscar")},e.exportarAlumnos=function(){return p.download("::simat/alumnos-exportar","Alumnos a importar "+e.USER.year+".xls")},e.importarSimat=function(t,r){if(e.f=t,e.errFile=r&&r[0],t)return t.upload=f.upload({url:a.Server+"importar/algo/"+e.USER.year,data:{file:t}}),t.upload.then(function(e){return $timeout(function(){return t.result=e.data})},function(a){if(a.status>0)return e.errorMsg=a.status+": "+a.data},function(e){return t.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},e.$on("alumnoguardado",function(a,t){return e.gridOptions.data.push(t)})}]).controller("RemoveAlumnoCtrl",["$scope","$uibModalInstance","alumno","$http","toastr","App",function(e,a,t,r,n,o){return e.alumno=t,e.perfilPath=o.images+"perfil/",e.ok=function(){return r.delete("::alumnos/destroy/"+t.alumno_id).then(function(e){return n.success("Alumno enviado a la papelera.","Eliminado")},function(e){return n.warning("No se pudo enviar a la papelera.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("selectorGrupoDir",["App","Perfil",function(e,a){return{restrict:"EA",templateUrl:"==grados/selectorGrupoDir.tpl.html",controller:["$scope","App",function(e,a){}]}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AlumnosNewCtrl",["$scope","$rootScope","toastr","$http","$filter","$state",function(e,a,t,r,n,o){e.data={},e.$state=o,e.alumno={no_matricula:"",nombres:"",apellidos:"",sexo:"M",documento:"",fecha_nac:new Date("2000-06-26"),tipo_sangre:{},eps:"",telefono:"",celular:"",direccion:"",barrio:"",estrato:1,email:"@gmail.com",foto:"perfil/default_male.jpg",pazysalvo:!0,deuda:0,pais_nac:{id:1,pais:"COLOMBIA",abrev:"CO"}},e.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],r.get("::paises").then(function(a){return a=a.data,e.paises=a,e.pais_nac=a[0],e.paisNacSelect(a[0],e.pais_nac)},function(){return console.log("No se pudo traer los paises")}),r.get("::grupos").then(function(a){return e.grupos=a.data},function(){return console.log("No se pudo traer los grupos")}),r.get("::tiposdocumento").then(function(a){return e.tipos_doc=a.data}),e.crear=function(){if(e.alumno.grupo)return e.alumno.fecha_nac=n("date")(e.alumno.fecha_nac,"yyyy-MM-dd"),r.post("::alumnos/store",e.alumno).then(function(a){return t.success("Alumno "+a.data.nombres+" creado"),e.$emit("alumnoguardado",a.data)},function(e){return t.warning("No se pudo guardar alumno","Problema")});t.warning("Debe seleccionar el grupo.")},e.paisNacSelect=function(a,t){return r.get("::ciudades/departamentos/"+a.id).then(function(t){if(e.departamentosNac=t.data,void 0===e.alumno.pais_doc)return e.alumno.pais_doc=a,e.paisSelecionado(a)})},e.departNacSelect=function(a){return r.get("::ciudades/por-departamento/"+a.departamento).then(function(t){if(e.ciudadesNac=t.data,void 0===e.alumno.departamento_doc)return e.alumno.departamento_doc=a,e.departSeleccionado(a)})},e.paisSelecionado=function(a,t){return r.get("::ciudades/departamentos/"+a.id).then(function(a){return e.departamentos=a.data})},e.departSeleccionado=function(a){return r.get("::ciudades/por-departamento/"+a.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yy"},e.restarEstrato=function(){if(e.alumno.estrato>0)return e.alumno.estrato=e.alumno.estrato-1},e.sumarEstrato=function(){if(e.alumno.estrato<10)return e.alumno.estrato=e.alumno.estrato+1}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AlumnosEditCtrl",["$scope","$state","$http","toastr",function(e,a,t,r){e.data={},e.alumno={},e.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],t.get("::alumnos/show/"+a.params.alumno_id).then(function(a){if(e.alumno=a.data,a.data.user&&(e.alumno.username=a.data.user.username),a.data.user&&(e.alumno.email2=a.data.user.email),e.alumno.ciudad_nac_id=a.data.ciudad_nac,e.alumno.ciudad_doc_id=a.data.ciudad_doc,null===e.alumno.ciudad_nac?(e.alumno.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},e.paisNacSelect(e.alumno.pais_nac,e.alumno.pais_nac)):t.get("::ciudades/datosciudad/"+e.alumno.ciudad_nac_id).then(function(a){return e.paises=a.data.paises,e.departamentosNac=a.departamentos,e.ciudadesNac=a.ciudades,e.alumno.pais_nac=a.pais,e.alumno.departamento_nac=a.departamento,e.alumno.ciudad_nac=a.ciudad}),e.alumno.ciudad_doc>0)return t.get("::ciudades/datosciudad/"+e.alumno.ciudad_doc_id).then(function(a){return e.paises=a.data.paises,e.departamentos=a.departamentos,e.ciudades=a.ciudades,e.alumno.pais_doc=a.pais,e.alumno.departamento_doc=a.departamento,e.alumno.ciudad_doc=a.ciudad})}),t.get("::paises").then(function(a){return e.paises=a.data}),t.get("::tiposdocumento").then(function(a){return e.tipos_doc=a.data}),e.guardar=function(){return t.put("::alumnos/update/"+e.alumno.id,e.alumno).then(function(e){return r.success("Alumno actualizado correctamente")},function(e){return r.error("No se pudo guardar el alumno")})},e.paisNacSelect=function(a,r){return t.get("::ciudades/departamentos/"+a.id).then(function(t){if(e.departamentosNac=t.data,void 0===e.alumno.pais_doc)return e.alumno.pais_doc=a,e.paisSelecionado(a)})},e.departNacSelect=function(a){return t.get("::ciudades/por-departamento/"+a.departamento).then(function(t){if(e.ciudadesNac=t.data,void 0===e.alumno.departamento_doc)return e.alumno.departamento_doc=a,e.departSeleccionado(a)})},e.paisSelecionado=function(a,r){return t.get("::ciudades/departamentos/"+a.id).then(function(a){return e.departamentos=a.data})},e.departSeleccionado=function(a){return t.get("::ciudades/por-departamento/"+a.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yyyy"},e.restarEstrato=function(){if(e.alumno.estrato>0)return e.alumno.estrato=e.alumno.estrato-1},e.sumarEstrato=function(){if(e.alumno.estrato<10)return e.alumno.estrato=parseInt(e.alumno.estrato)+1}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ListAlumnosCtrl",["$scope","App","$rootScope","$state","$interval","uiGridConstants","uiGridEditConstants","$uibModal","$filter","AuthService","toastr","$http","$stateParams",function(e,a,t,r,n,o,i,s,u,l,c,d,p){var f,m,g,_,h,v,b;return l.verificar_acceso(),e.dato={},e.dato.mostrartoolgrupo=!0,e.gridScope=e,e.views=a.views,e.perfilPath=a.images+"perfil/",e.year_ant=e.USER.year-1,e.gridOptions={},e.gridOptionsSinMatricula={},e.paises=[],e.religiones=a.religiones,e.tipos_sangre=a.tipos_sangre,e.mostrar_pasado=!1,e.mostrar_retirados=!1,e.es_titular=!0,e.parentescos=a.parentescos,e.dato.grupo="",d.get("::grupos/con-paises-tipos").then(function(a){var t,r,n,o,i,s;for(o=0,p.grupo_id&&(localStorage.matr_grupo=parseInt(p.grupo_id),o=parseInt(localStorage.matr_grupo)),e.grupos=a.data.grupos,e.paises=a.data.paises,e.tipos_doc=a.data.tipos_doc,e.grupos_titularia=a.data.grupos_titularia,s=[],r=0,n=(i=e.grupos).length;r<n;r++)t=i[r],parseInt(t.id)===parseInt(o)?(e.dato.grupo=t,s.push(e.selectGrupo(e.dato.grupo))):s.push(void 0);return s}),e.selectGrupo=function(a){var t,r,n;for(localStorage.matr_grupo=a.id,e.dato.grupo=a,t=0,r=(n=e.grupos).length;t<r;t++)n[t].active=!1;return a.active=!0,l.hasRoleOrPerm("Profesor")&&(a.es_titular?e.es_titular=!0:e.es_titular=!1),e.traerAlumnnos=function(){return d.put("::grupos/alumnos-con-datos",{grupo_actual:a}).then(function(a){var t,r,n,o,i,s,u,l,p,f,m,g;for(e.gridOptions.data=a.data.AlumnosActuales,r=0,i=(p=e.gridOptions.data).length;r<i;r++){for((t=p[r]).fecha_nac=t.fecha_nac?new Date(t.fecha_nac.replace(/-/g,"/")):t.fecha_nac,n=0,s=(f=e.tipos_doc).length;n<s;n++)(g=f[n]).id===t.tipo_doc&&(t.tipo_doc=g);for(o=0,u=(m=t.subGridOptions.data).length;o<u;o++)(l=m[o]).fecha_nac_ant=l.fecha_nac,l.fecha_nac=l.fecha_nac?new Date(l.fecha_nac.replace(/-/g,"/")):l.fecha_nac;if(!e.es_titular)return;t.subGridOptions.onRegisterApi=function(a){return a.edit.on.afterCellEdit(e,function(a,t,r,n){if(r!==n){if("sexo"===t.field&&"M"!==(r=r.toUpperCase())&&"F"!==r)return c.warning("Debe usar M o F"),void(a.sexo=n);if("email"===t.field&&!/\S+@\S+\.\S+/.test(r))return c.warning("Email no válido"),void(a.email=n);d.put("::acudientes/guardar-valor",{parentesco_id:a.parentesco_id,acudiente_id:a.id,user_id:a.user_id,propiedad:t.field,valor:r}).then(function(e){return c.success("Acudiente actualizado con éxito")},function(e){return a[t.field]=n,c.error("Cambio no guardado","Error")})}return e.$apply()})}}})},e.traerAlumnnos()},e.agregarAcudiente=function(a){if(e.es_titular)return delete t.acudiente_cambiar,s.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return a},paises:function(){return e.paises},tipos_doc:function(){return e.tipos_doc},parentescos:function(){return e.parentescos}}}).result.then(function(e){return a.subGridOptions.data.splice(a.subGridOptions.data.length-1,0,e)},function(){});c.warning("No eres titular","No puedes editar.")},e.cambiarAcudiente=function(a,r){if(e.es_titular)return t.acudiente_cambiar=r,s.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return a},paises:function(){return e.paises},tipos_doc:function(){return e.tipos_doc},parentescos:function(){return e.parentescos}}}).result.then(function(e){var t,n,o,i,s,u;for(u=[],n=t=0,o=(s=a.subGridOptions.data).length;t<o;n=++t)(i=s[n])&&i.id===r.id?u.push(a.subGridOptions.data.splice(n,1,e)):u.push(void 0);return u},function(){});c.warning("No eres titular","No puedes editar.")},e.quitarAcudiente=function(a,t){if(e.es_titular)return s.open({templateUrl:"==alumnos/quitarAcudienteModalConfirm.tpl.html",controller:"QuitarAcudienteModalConfirmCtrl",resolve:{alumno:function(){return a},acudiente:function(){return t}}}).result.then(function(e){var t,r,n,o,i,s;for(s=[],r=t=0,n=(i=a.subGridOptions.data).length;t<n;r=++t)(o=i[r])&&o.id===e.id?s.push(a.subGridOptions.data.splice(r,1)):s.push(void 0);return s},function(){});c.warning("No eres titular","No puedes editar.")},e.cambiarCiudad=function(a,t){if(e.es_titular)return s.open({templateUrl:"==alumnos/cambiarCiudadModal.tpl.html",controller:"CambiarCiudadModalCtrl",resolve:{persona:function(){return a},paises:function(){return e.paises},tipo_ciudad:function(){return t},tipo_persona:function(){return a.subGridOptions?"alumno":"acudiente"}}}).result.then(function(e){return a=e});c.warning("No eres titular","No puedes editar.")},e.cambiarPazysalvo=function(a){var t;if(e.es_titular)return a.pazysalvo=!a.pazysalvo,a.alumno_id||(a.alumno_id=a.id),t={alumno_id:a.alumno_id,propiedad:"pazysalvo",valor:a.pazysalvo},d.put("::alumnos/guardar-valor",t).then(function(e){return console.log("Cambios guardados")},function(e){return a.pazysalvo=!a.pazysalvo,c.error("Cambio no guardado","Error")});c.warning("No eres titular","No puedes editar.")},e.resetPass=function(t){if(e.es_titular)return s.open({templateUrl:a.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return t}}}).result.then(function(e){});c.warning("No eres titular","No puedes editar.")},e.religionSelected=function(a,t){if(e.es_titular)return e.religiones.indexOf(a.religion)>-1?e.$broadcast(i.events.END_CELL_EDIT):void 0;c.warning("No eres titular","No puedes editar.")},e.religionEditPressEnter=function(a){return e.$broadcast(i.events.END_CELL_EDIT)},e.tipoDocSeleccionado=function(a,t){var r,n;if(e.es_titular)return r={propiedad:"tipo_doc",valor:a.id},n="acudientes",t.subGridOptions?(n="alumnos",r.alumno_id=t.alumno_id):(r.acudiente_id=t.acudiente_id,r.parentesco_id=t.parentesco_id,r.user_acud_id=t.user_id),d.put("::"+n+"/guardar-valor",r).then(function(e){return c.success("Alumno(a) actualizado con éxito","Actualizado")},function(e){return c.error("Cambio no guardado.","Error")});c.warning("No eres titular","No puedes editar.")},e.cambiaUsernameCheck=function(a){if(e.es_titular)return e.verificandoUsername=!0,d.put("::users/usernames-check",{texto:a}).then(function(a){return e.username_match=a.data.usernames,e.verificandoUsername=!1,e.username_match.map(function(e){return e.username})});c.warning("No eres titular","No puedes editar.")},e.cambiaEpsCheck=function(a){if(e.es_titular)return e.verificandoEps=!0,d.put("::alumnos/eps-check",{texto:a}).then(function(a){return e.eps_match=a.data.eps,e.verificandoEps=!1,e.eps_match.map(function(e){return e.eps})});c.warning("No eres titular","No puedes editar.")},"","==alumnos/botonEditReligion.tpl.html",h="==directives/botonPazysalvo.tpl.html",b="==directives/botonesResetPassword.tpl.html",g="==directives/botonCiudadNac.tpl.html",m="==directives/botonCiudadDoc.tpl.html","==directives/botonCiudadResid.tpl.html",v="==directives/botonTipoDoc.tpl.html","==alumnos/botonEditUsername.tpl.html",_="==alumnos/botonEditEps.tpl.html","'==alumnos/popoverAlumnoGrid.tpl.html'","'mouseenter'","' '",f='uib-popover-template="views+\'==alumnos/popoverAlumnoGrid.tpl.html\'" popover-trigger="\'mouseenter\'" popover-title="{{ row.entity.nombres + \' \' + row.entity.apellidos }}" popover-popup-delay="500" popover-append-to-body="true"',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Alumnos - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,expandableRowTemplate:"==alumnos/expandableRowTemplate.tpl.html",expandableRowHeight:110,expandableRowScope:{agregarAcudiente:e.agregarAcudiente,quitarAcudiente:e.quitarAcudiente,cambiarAcudiente:e.cambiarAcudiente,resetPass:e.resetPass,cambiarCiudad:e.cambiarCiudad,cambiaUsernameCheck:e.cambiaUsernameCheck},columnDefs:[{field:"no",pinnedLeft:!0,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>',width:40,enableCellEdit:!1},{field:"nombres",minWidth:130,pinnedLeft:!0,filter:{condition:function(e,a,t){return t.entity.nombres.toLowerCase().indexOf(e.toLowerCase())>-1}},enableHiding:!1,cellTemplate:'<div class="ui-grid-cell-contents" style="padding: 0px;" '+f+'><img ng-src="{{grid.appScope.perfilPath + row.entity.foto_nombre}}" style="width: 35px" />{{row.entity.nombres}}</div>'},{field:"apellidos",minWidth:110,filter:{condition:o.filter.CONTAINS}},{field:"sexo",displayName:"Sex",width:40},{field:"no_matricula",displayName:"# matrícula",minWidth:80,enableColumnMenu:!0},{field:"username",filter:{condition:o.filter.CONTAINS},displayName:"Usuario",cellTemplate:b,editableCellTemplate:"==alumnos/botonEditUsername.tpl.html",minWidth:135},{field:"deuda",displayName:"Deuda",type:"number",cellFilter:'currency:"$":0',minWidth:70},{field:"pazysalvo",displayName:"A paz?",cellTemplate:h,minWidth:60,enableCellEdit:!1},{field:"religion",displayName:"Religión",minWidth:70,editableCellTemplate:"==alumnos/botonEditReligion.tpl.html"},{field:"tipo_doc",displayName:"Tipo documento",minWidth:120,cellTemplate:v,enableCellEdit:!1},{field:"documento",minWidth:100,cellFilter:"formatNumberDocumento"},{field:"ciudad_doc",displayName:"Ciud Docu",minWidth:120,cellTemplate:m,enableCellEdit:!1},{field:"tipo_sangre",displayName:"RH",minWidth:70},{field:"estrato",minWidth:70,type:"number"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"ciudad_nac",displayName:"Ciud Nacimi",minWidth:120,cellTemplate:g,enableCellEdit:!1},{field:"direccion",displayName:"Dirección",minWidth:70},{field:"barrio",minWidth:70},{field:"ciudad_resid",displayName:"Ciud Resid",minWidth:120,cellTemplate:"==directives/botonCiudadResid.tpl.html",enableCellEdit:!1},{field:"telefono",displayName:"Teléfono",minWidth:80},{field:"eps",displayName:"EPS",minWidth:100,editableCellTemplate:_}],multiSelect:!1,exporterHeaderFilter:function(e){return"A paz?"===e?"Paz y salvo":"Matrícula"===e?"Grupo":e},exporterFieldCallback:function(a,t,r,n){return"no"===r.name?a.renderContainers.body.visibleRowCache.indexOf(t)+1:"grupo_id"===r.name?e.dato.grupo.nombre:"ciudad_nac"===r.name?t.entity.ciudad_nac_nombre:"pazysalvo"===r.name?n?"Si":"No":"tipo_doc"===r.name&&n&&n.tipo?n.tipo:n},onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){if(r!==n){if(l.hasRoleOrPerm("Profesor")&&e.USER.profes_can_edit_alumnos){if(!e.es_titular)return a[t.field]=n,void c.warning("No eres el titular")}else if(!l.hasRoleOrPerm("Admin"))return a[t.field]=n,void c.warning("Actualmente no hay permiso para editar");if(a.alumno_id||(a.alumno_id=fila.id),"sexo"===t.field&&"M"!==(r=r.toUpperCase())&&"F"!==r)return c.warning("Debe usar M o F"),void(a.sexo=n);if("fecha_matricula"===t.field)return e.cambiarFechaMatricula(a);if("tipo_sangre"===t.field&&(r=r.toUpperCase(),!(e.tipos_sangre.indexOf(r)>-1)))return c.warning("Debe usar: "+e.tipos_sangre.join(" ")),void(a.tipo_sangre=n);if("estrato"===t.field&&(r<0||r>9))return c.warning("Valor no admitido"),void(a.estrato=n);if("documento"===t.field&&10!==r.length&&0!==r.length)return void c.warning("Debe ser de diez dígitos");d.put("::alumnos/guardar-valor",{alumno_id:a.alumno_id,propiedad:t.field,valor:r}).then(function(e){return c.success("Alumno(a) actualizado con éxito")},function(e){return a[t.field]=n,c.error("Cambio no guardado","Error")})}if("religion"!==t.field)return e.$apply()})}}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MatriculasCtrl",["$scope","App","$state","$interval","$uibModal","$filter","AuthService","toastr","$http",function(e,a,t,r,n,o,i,s,u){i.verificar_acceso(),e.dato={sortMatricula:!1,sortMatriculaReverse:!1,sortNombres:!1,sortNombresReverse:!1,sortType:"apellidos",sortReverse:!1},e.dato_f={sortMatricula:!1,sortMatriculaReverse:!1,sortNombres:!1,sortNombresReverse:!1,sortType:"apellidos",sortReverse:!1},e.alumnos_encontrados=[],e.texto_a_buscar="",e.year_ant=e.USER.year-1,e.perfilPath=a.images+"perfil/",e.views=a.views,e.alumnos_all=[],e.dato.grupo="",u.get("::grupos").then(function(a){var t,r,n,o,i;for(o=0,localStorage.matr_grupo&&(o=parseInt(localStorage.matr_grupo)),e.grupos=a.data,r=0,n=(i=e.grupos).length;r<n;r++)(t=i[r]).id===o&&(e.dato.grupo=t);return e.traerAlumnos(e.dato.grupo)}),e.editar=function(e){return t.go("panel.alumnos.editar",{alumno_id:e.alumno_id})},e.onGrupoSelect=function(a,t){if(a)return localStorage.setItem("matr_grupo",a.id),e.traerAlumnos(a)},e.traerAlumnos=function(a){var t,r,n,o,i,s;for(n=[],o=0,i=(s=e.grupos).length;o<i;o++)(r=s[o]).orden_grado===a.orden_grado-1&&n.push(r);return t=n.length>0?n[0].grado_id:null,u.put("::matriculas/alumnos-grado-anterior",{grupo_actual:a,grado_ant_id:t,year_ant:e.year_ant}).then(function(a){var t,r,n,o,i;for(e.alumnos_all=a.data,i=[],r=0,n=(o=e.alumnos_all).length;r<n;r++)(t=o[r]).estado_ant=t.estado,t.fecha_retiro_ant=t.fecha_retiro,t.fecha_retiro=new Date(t.fecha_retiro),t.fecha_matricula_ant=t.fecha_matricula,i.push(t.fecha_matricula=new Date(t.fecha_matricula));return i})},e.matricularUno=function(a){var t;if(e.dato.grupo.id)return t={alumno_id:a.alumno_id,grupo_id:e.dato.grupo.id,year_id:e.USER.year_id},u.post("::matriculas/matricularuno",t).then(function(e){return e=e.data,a.matricula_id=e.id,a.grupo_id=e.grupo_id,a.estado="MATR",a.fecha_matricula_ant=e.fecha_matricula.date,a.fecha_matricula=new Date(e.fecha_matricula.date),s.success("Alumno matriculado con éxito","Matriculado"),a},function(e){return s.error("No se pudo matricular el alumno.","Error")});s.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},e.reMatricularUno=function(a){var t;if(e.dato.grupo.id)return t={matricula_id:a.matricula_id},u.put("::matriculas/re-matricularuno",t).then(function(e){return e=e.data,s.success("Alumno rematriculado","Matriculado"),a},function(e){return s.error("No se pudo matricular el alumno.","Error")});s.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},e.matricularEn=function(a){return n.open({templateUrl:"==alumnos/matricularEn.tpl.html",controller:"MatricularEnCtrl",resolve:{alumno:function(){return a},grupos:function(){return e.grupos},year_id:function(){return e.USER.year_id}}}).result.then(function(e){return console.log("Cierra")})},e.setAsistente=function(a){return u.put("::matriculas/set-asistente",{matricula_id:a.matricula_id,grupo_id:e.dato.grupo.grupo_id}).then(function(e){return s.success("Guardado como asistente")},function(e){return s.error("No se pudo guardar como asistente","Error")})},e.setNewAsistente=function(a){return u.put("::matriculas/set-new-asistente",{alumno_id:a.alumno_id,grupo_id:e.dato.grupo.id}).then(function(e){return console.log("Cambios guardados")},function(e){return s.error("No se pudo crear asistente","Error")})},e.cambiarFechaRetiro=function(e){return u.put("::matriculas/cambiar-fecha-retiro",{matricula_id:e.matricula_id,fecha_retiro:e.fecha_retiro}).then(function(e){return s.success("Fecha retiro guardada")},function(a){return e.fecha_retiro=e.fecha_retiro_ant,s.error("No se pudo guardar la fecha","Error")})},e.cambiarFechaMatricula=function(e){return u.put("::matriculas/cambiar-fecha-matricula",{matricula_id:e.matricula_id,fecha_matricula:e.fecha_matricula}).then(function(e){return s.success("Fecha matricula guardada")},function(a){return e.fecha_matricula=e.fecha_matricula_ant,s.error("No se pudo guardar la fecha","Error")})},e.desertar=function(e){var a;return a=e.fecha_retiro,null===e.fecha_retiro_ant&&(a=new Date,e.fecha_retiro=a),u.put("::matriculas/desertar",{matricula_id:e.matricula_id,fecha_retiro:e.fecha_retiro}).then(function(e){return s.success("Alumno desertado")},function(e){return s.error("No se pudo desertar","Problema")})},e.retirar=function(e){var a;return a=e.fecha_retiro,null===e.fecha_retiro_ant&&(a=new Date,e.fecha_retiro=a),u.put("::matriculas/retirar",{matricula_id:e.matricula_id,fecha_retiro:e.fecha_retiro}).then(function(e){return s.success("Alumno retirado")},function(e){return s.error("No se pudo desmatricular","Problema")})},e.buscar_por_nombre=function(){if(""!==e.texto_a_buscar)return u.put("::buscar/por-nombre",{texto_a_buscar:e.texto_a_buscar}).then(function(a){return e.alumnos_encontrados=a.data},function(e){return s.error("No se pudo buscar","Problema")});s.warning("Escriba término a buscar")},e.filterActuales=function(a){return a.grupo_id===e.dato.grupo.id},e.filterNOActuales=function(a){return a.grupo_id!==e.dato.grupo.id}}]).controller("MatricularEnCtrl",["$scope","$uibModalInstance","alumno","grupos","year_id","$http","toastr",function(e,a,t,r,n,o,i){var s,u,l,c,d;for(e.alumno=t,e.grupos=r,e.dato={},localStorage.matr_grupo&&(c=parseInt(localStorage.matr_grupo)),u=0,l=(d=e.grupos).length;u<l;u++)(s=d[u]).id===c&&(e.dato.grupo=s);return e.ok=function(){var t;if(e.dato.grupo.id)return t={alumno_id:e.alumno.alumno_id,grupo_id:e.dato.grupo.id,year_id:n},o.post("::matriculas/matricular-en",t).then(function(t){if("Ya matriculado"!==(t=t.data))return e.alumno.matricula_id=t.id,e.alumno.grupo_id=t.grupo_id,i.success("Alumno matriculado con éxito","Matriculado"),a.close(e.alumno);i.warning("Ya tiene matrícula en ese grupo")},function(e){return i.error("No se pudo matricular el alumno.","Error")});i.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MatriculasDetallesCtrl",["$scope","App","$state","$uibModal","$filter","AuthService","toastr","$http",function(e,a,t,r,n,o,i,s){o.verificar_acceso(),e.year_ant=e.USER.year-1,e.perfilPath=a.images+"perfil/",e.views=a.views,e.matricula_detalle=!1,e.matric_cargando=!1,e.detallesAlumno=function(){return s.put("::detalles/alumno",{year_id:e.USER.year_id,alumno_id:parseInt(t.params.alumno_id)}).then(function(a){return e.matriculas=a.data})},e.detallesAlumno(),e.matricSeleccionada=function(a){var t,r,n,o,i;for(r=0,n=(i=e.matriculas).length;r<n;r++)(o=i[r]).matricula_id===a.matricula_id?o.seleccionada=!0:o.seleccionada=!1;return t={alumno_id:a.alumno_id,year_id:a.year_id,matricula_id:a.matricula_id},e.matric_cargando=!0,e.matricula_detalle=!1,s.put("::detalles/grupos-periodos",t).then(function(t){var r,n,o,i,s;for(t=t.data,e.matricula_detalle=t,e.matric_cargando=!1,s=[],r=0,n=(i=e.matricula_detalle).length;r<n;r++)o=i[r],s.push(o.year=a.year);return s})},e.eliminarMatric=function(a){if(!1,confirm("¿Está seguro que quiere eliminar la matricula "+a+" definitivamente?"))return s.put("::detalles/eliminar-matricula-destroy",{matricula_id:a}).then(function(t){return 0===parseInt(t.data)?i.warning("No se eliminó matricula"):(i.success("Matricula "+a+" eliminada."),e.matriculas=n("filter")(e.matriculas,{matricula_id:"!"+a},!0))},function(e){return i.error("No se pudo eliminar la matricula "+a,"Error")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").directive("matriculasDetallesPeriodosDir",[function(){return{restrict:"E",templateUrl:"==alumnos/matriculasDetallesPeriodos.tpl.html",controller:"MatriculasDetallesPeriodosCtrl"}}]).controller("MatriculasDetallesPeriodosCtrl",["$scope","App","$rootScope","$state","$interval","uiGridConstants","$uibModal","$filter","AuthService","toastr","$http",function(e,a,t,r,n,o,i,s,u,l,c){e.eliminarNotasPeriodo=function(e,a){if(confirm("¿Está seguro? estas notas no se podrán recuperar si las borra."))return c.put("::detalles/eliminar-notas-periodo",{alumno_id:parseInt(r.params.alumno_id),grupo_id:a.id,periodo_id:e.id}).then(function(e){return 0===parseInt(e.data)?l.warning("No se eliminó ninguna nota"):l.success("Notas eliminadas: "+e.data)},function(e){return l.error("No se pudo eliminar las notas","Error")})},e.eliminarMatriculaDestroy=function(a,t){if(!1,1===a.length?confirm("Solo queda esta matricula para este grupo, ¿Está seguro que quiere eliminarla definitivamente?"):confirm("¿Está seguro que quiere eliminar la matricula "+t+" definitivamente?"))return c.put("::detalles/eliminar-matricula-destroy",{matricula_id:t}).then(function(r){return 0===parseInt(r.data)?l.warning("No se eliminó matricula"):(l.success("Matricula "+t+" eliminada."),e.matriculas=s("filter")(e.matriculas,{matricula_id:"!"+t}),a=s("filter")(a,{matricula_id:"!"+t})),e.$parent.detallesAlumno()},function(e){return l.error("No se pudo eliminar la matricula "+t,"Error")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("CarteraCtrl",["$scope","App","$state","$interval","$uibModal","$filter","AuthService","toastr","$http","uiGridConstants",function(e,a,t,r,n,o,i,s,u,l){var c,d,p;i.verificar_acceso(),e.dato={},e.gridOptions={},e.perfilPath=a.images+"perfil/",e.views=a.views,e.gridScope=e,e.mySelectedRows=[],e.valorDeuda=0,e.dato.grupo="",u.get("::grupos").then(function(a){var t,r,n,o,i;for(o=0,localStorage.matr_grupo&&(o=parseInt(localStorage.matr_grupo)),e.grupos=a.data,r=0,n=(i=e.grupos).length;r<n;r++)(t=i[r]).id===o&&(e.dato.grupo=t);return e.traerAlumnos(e.dato.grupo)}),e.onGrupoSelect=function(a,t){if(a)return localStorage.setItem("matr_grupo",a.id),e.traerAlumnos(a)},e.editar=function(e){return console.log(e.alumno_id),t.go("panel.cartera.editar",{alumno_id:e.alumno_id})},c='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',d="==directives/botonesPazysalvo.tpl.html",p="==directives/botonesResetPassword.tpl.html",e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEdit:!0,enableCellEditOnFocus:!0,columnDefs:[{name:"no",displayName:"No",width:45,enableCellEdit:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row)+1}}</div>'},{name:"edicion",displayName:"Edición",width:30,enableSorting:!1,enableFiltering:!1,cellTemplate:c,enableCellEdit:!1,enableColumnMenu:!0},{field:"foto_nombre",displayName:"Foto",cellTemplate:'<img width="35px" ng-src="{{grid.appScope.perfilPath + grid.getCellValue(row, col)}}">',width:40},{field:"nombres",minWidth:80,filter:{condition:function(e,a,t){return t.entity.nombres.toLowerCase().indexOf(e.toLowerCase())>-1}},enableHiding:!1},{field:"apellidos",minWidth:80,filter:{condition:l.filter.CONTAINS}},{field:"sexo",width:60},{field:"nombre_grupo",displayName:"Grupo"},{field:"username",filter:{condition:l.filter.CONTAINS},displayName:"Usuario",cellTemplate:p,minWidth:150},{field:"deuda",displayName:"Deuda",cellTemplate:d,minWidth:150},{field:"fecha_pension",displayName:"Fecha hasta",minWidth:150,cellFilter:"date:mediumDate",type:"date"}],multiSelect:!0,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){return r!==n&&(a.alumno_id||(a.alumno_id=fila.id),u.put("::alumnos/guardar-valor",{alumno_id:a.alumno_id,propiedad:t.field,valor:r}).then(function(e){return s.success("Alumno(a) actualizado con éxito")},function(e){return a[t.field]=n,s.error("Cambio no guardado","Error")})),e.$apply()})}},e.getSelectedRows=function(){return e.mySelectedRows=e.gridApi.selection.getSelectedRows()},e.traerAlumnos=function(a){return u.put("::cartera/alumnos",{grupo_actual:a}).then(function(a){return e.gridOptions.data=a.data,e.gridOptions.columnDefs[6].visible=!1,e.gridApi.grid.refresh()})},e.cambiarValorVarios=function(a,t){var r;return"fecha_pension"===t&&(a=o("date")(a,"mediumDate")),r={alumnos:e.getSelectedRows(),propiedad:t,valor:a},u.put("::alumnos/guardar-valor-varios",r).then(function(r){var n,o,i;for(n=0,o=(i=e.getSelectedRows()).length;n<o;n++)i[n][t]=a;return s.success("Cambios guardados")},function(e){return s.error("Cambio no guardado","Error")})},e.cambiarPazysalvo=function(e){var a;return e.pazysalvo=!e.pazysalvo,e.alumno_id||(e.alumno_id=e.id),a={alumno_id:e.alumno_id,propiedad:"pazysalvo",valor:e.pazysalvo},u.put("::alumnos/guardar-valor",a).then(function(e){return console.log("Cambios guardados")},function(a){return e.pazysalvo=!e.pazysalvo,s.error("Cambio no guardado","Error")})},e.resetPass=function(e){return n.open({templateUrl:a.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return e}}}).result.then(function(e){})},e.traerSoloDeudores=function(a){return u.put("::cartera/solo-deudores",{year_id:e.USER.year_id}).then(function(a){return e.gridOptions.data=a.data,e.gridOptions.columnDefs[6].visible=!0,e.gridApi.grid.refresh()})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AcudientesCtrl",["$scope","App","$state","$interval","$uibModal","$filter","AuthService","toastr","$http","uiGridConstants","DownloadServ",function(e,a,t,r,n,o,i,s,u,l,c){var d,p;i.verificar_acceso(),e.dato={},e.gridOptions={},e.perfilPath=a.images+"perfil/",e.views=a.views,e.gridScope=e,e.dato.grupo="",u.get("::grupos/con-paises-tipos").then(function(a){var t,r,n,o,i,s;for(t=0,localStorage.acud_grupo&&(t=parseInt(localStorage.acud_grupo)),e.grupos=a.data.grupos,e.paises=a.data.paises,e.tipos_doc=a.data.tipos_doc,s=[],n=0,o=(i=e.grupos).length;n<o;n++)r=i[n],parseInt(r.id)===parseInt(t)?(e.dato.grupo=r,s.push(e.selectGrupo(e.dato.grupo))):s.push(void 0);return s}),e.selectGrupo=function(a){var t,r,n,o,i,l,c,d;for(localStorage.acud_grupo=a.id,e.dato.grupo=a,n=0,i=(c=e.grupos).length;n<i;n++)(t=c[n]).active=!1;for(a.active=!0,r=[],o=0,l=(d=e.grupos).length;o<l;o++)(t=d[o]).orden_grado===a.orden_grado-1&&r.push(t);return e.traerAcudientes=function(){return u.put("::acudientes/datos",{grupo_actual:a}).then(function(a){var t,r,n,o,i;for(e.gridOptions.data=a.data.acudientes,i=[],t=0,r=(o=e.gridOptions.data).length;t<r;t++)(n=o[t]).fecha_nac_ant=n.fecha_nac,n.fecha_nac=n.fecha_nac?new Date(n.fecha_nac.replace(/-/g,"/")):n.fecha_nac,i.push(n.subGridOptions.onRegisterApi=function(a){return a.edit.on.afterCellEdit(e,function(a,t,r,n){return s.warning("Desde aquí sólo podrás editar Acudientes","No guardado"),e.$apply()})});return i})},e.traerAcudientes()},d='<span style="padding-left: 2px; padding-top: 4px;" class="btn-group">'+'<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>'+'<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>'+"</span>",p="==directives/botonesResetPassword.tpl.html",e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEdit:!0,enableCellEditOnFocus:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Alumnos - MyVC.csv",enableGridMenu:!0,expandableRowTemplate:"==alumnos/expandableRowTemplate.tpl.html",expandableRowHeight:110,columnDefs:[{name:"no",displayName:"No",width:45,enableCellEdit:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row)+1}}</div>'},{field:"id",width:60,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:60,enableSorting:!1,enableFiltering:!1,cellTemplate:d,enableCellEdit:!1,enableColumnMenu:!0},{field:"foto_nombre",displayName:"Foto",cellTemplate:'<img width="35px" ng-src="{{grid.appScope.perfilPath + grid.getCellValue(row, col)}}">',width:40},{field:"nombres",minWidth:100,filter:{condition:function(e,a,t){return t.entity.nombres.toLowerCase().indexOf(e.toLowerCase())>-1}},enableHiding:!1},{field:"apellidos",minWidth:100,filter:{condition:l.filter.CONTAINS}},{field:"sexo",width:60},{field:"username",filter:{condition:l.filter.CONTAINS},displayName:"Usuario",cellTemplate:p,minWidth:150},{field:"documento",displayName:"Documento",minWidth:100,cellFilter:"formatNumberDocumento"},{field:"direccion",displayName:"Dirección",minWidth:90},{field:"barrio",minWidth:80},{field:"telefono",displayName:"Teléfono",minWidth:90},{field:"celular",displayName:"Celular",minWidth:90},{field:"ocupacion",displayName:"Ocupación",minWidth:90}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){if(!e.usuario_creado)return r!==n&&("sexo"===t.field?"M"===r||"F"===r?u.put("::acudientes/guardar-valor",{acudiente_id:a.id,parentesco_id:a.parentesco_id,user_id:a.user_id,propiedad:t.field,valor:r}).then(function(e){return s.success("Acudiente actualizado con éxito","Actualizado")},function(e){return s.error("Cambio no guardado","Error")}):(s.warning("Debe usar M o F"),a.sexo=n):u.put("::acudientes/guardar-valor",{acudiente_id:a.id,parentesco_id:a.parentesco_id,user_id:a.user_id,propiedad:t.field,valor:r}).then(function(e){return s.success("Acudiente actualizado con éxito","Actualizado")},function(e){return s.error("Cambio no guardado","Error")})),e.$apply();e.usuario_creado=!1})}},e.eliminar=function(a){return n.open({templateUrl:"==alumnos/removeAcudiente.tpl.html",controller:"RemoveAcudienteCtrl",resolve:{acudiente:function(){return a}}}).result.then(function(a){return e.gridOptions.data=o("filter")(e.gridOptions.data,{id:"!"+a.id})},function(){})},e.editar=function(a){return n.open({templateUrl:"==alumnos/editAcudienteModal.tpl.html",controller:"EditAcudienteModalCtrl",resolve:{acudiente:function(){return a},paises:function(){return e.paises},tipos_doc:function(){return e.tipos_doc},parentescos:function(){return e.parentescos}}}).result.then(function(a){return e.gridOptions.data=o("filter")(e.gridOptions.data,{id:"!"+a.id})},function(){})},e.cambiarPazysalvo=function(e){var a;return e.pazysalvo=!e.pazysalvo,e.alumno_id||(e.alumno_id=e.id),a={alumno_id:e.alumno_id,propiedad:"pazysalvo",valor:e.pazysalvo},u.put("::alumnos/guardar-valor",a).then(function(e){return console.log("Cambios guardados")},function(a){return e.pazysalvo=!e.pazysalvo,s.error("Cambio no guardado","Error")})},e.resetPass=function(e){if(e.user_id)return n.open({templateUrl:a.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return e}}}).result.then(function(e){});s.warning("Aún no tiene usuario")},e.traerNOAsignados=function(){return u.put("::acudientes/no-asignados").then(function(a){var t,r,n,o,i;for(e.gridOptions.data=a.data.acudientes,i=[],t=0,r=(o=e.gridOptions.data).length;t<r;t++)(n=o[t]).fecha_nac_ant=n.fecha_nac,i.push(n.fecha_nac=n.fecha_nac?new Date(n.fecha_nac.replace(/-/g,"/")):n.fecha_nac);return i},function(){return s.error("No se pudo traer los acudientes sin asignar")})},e.crearUsuario=function(a){if(!a.user_id)return u.post("::acudientes/crear-usuario",{acudiente:a}).then(function(t){return e.usuario_creado=!0,a.user_id=t.data.id,a.username=t.data.username,s.success("Usuario creado")},function(){return s.error("No se pudo crear el usuario")});s.warning("Ya tiene usuario")},e.exportarAcudientesPlanillas=function(){return c.download("::acudientes-export/acudientes","Asistencia acudientes Per "+e.USER.numero_periodo+" - "+e.USER.year+".xls")},e.verPlanillas=function(){return t.go("panel.informes.planillas-ausencias-acudientes")}}]).controller("RemoveAcudienteCtrl",["$scope","$uibModalInstance","acudiente","$http","toastr","App",function(e,a,t,r,n,o){return e.acudiente=t,e.perfilPath=o.images+"perfil/",e.ok=function(){return r.delete("::acudientes/destroy/"+t.id).then(function(e){return n.success("Acudiente enviado a la papelera.","Eliminado")},function(e){return n.warning("No se pudo enviar a la papelera.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NewAcudienteModalCtrl",["$scope","App","$uibModalInstance","alumno","paises","tipos_doc","parentescos","$http","toastr","$filter","$rootScope",function(e,a,t,r,n,o,i,s,u,l,c){var d,p,f,m;if(e.alumno=r,e.paises=n,e.parentescos=i,e.datos={},e.tipos_doc=o,e.crearTabSelected=!1,e.selectTabSelected=!0,e.perfilPath=a.images+"perfil/",e.acudiente_cambiar=c.acudiente_cambiar,e.acudiente={sexo:"M",parentesco:e.parentescos[0],tipo_doc:e.tipos_doc[0]},e.acudientes=[],e.acudiente_cambiar&&e.acudiente_cambiar.parentesco)for(d=0,p=(m=e.parentescos).length;d<p;d++)(f=m[d]).parentesco.toLowerCase()===e.acudiente_cambiar.parentesco.toLowerCase()&&(e.acudiente.parentesco=f);return e.selectCrearTab=function(){return e.crearTabSelected=!0,e.selectTabSelected=!1},e.selectSelectTab=function(){return e.crearTabSelected=!1,e.selectTabSelected=!0},e.cancel=function(){return t.dismiss("cancel")},e.$on("modal.closing",function(e,a,t){switch(a){case"backdrop click":case"escape key press":if(!confirm("¿Seguro que quiere cerrar sin guardar acudiente?"))return e.preventDefault()}}),s.put("::acudientes/ultimos").then(function(a){return e.sin_repetir(a.data)}),e.refreshAcudientes=function(a){if(a)return s.put("::acudientes/buscar",{termino:a}).then(function(a){return e.sin_repetir(a.data)},function(e){return u.warning("No se pudo encontrar nada.","Problema")})},e.sin_repetir=function(a){var t,n,o,i,s,u,l;for(l=[],n=0,i=a.length;n<i;n++){for(t=a[n],e.existe=!1,o=0,s=(u=r.subGridOptions.data).length;o<s;o++)u[o].id===t.id&&(e.existe=!0);e.existe||l.push(t)}return e.acudientes=l},e.paisNacSelect=function(a,t){return s.get("::ciudades/departamentos/"+a.id).then(function(a){return e.departamentosNac=a.data})},e.departNacSelect=function(a){return s.get("::ciudades/por-departamento/"+a.departamento).then(function(t){if(e.ciudadesNac=t.data,void 0===e.acudiente.departamento_doc)return e.acudiente.departamento_doc=a,e.departSeleccionado(a)})},e.paisSelecionado=function(a,t){return s.get("::ciudades/departamentos/"+a.id).then(function(t){var r,n,o,i,s;if(e.departamentos=t.data,void 0===e.acudiente.pais_nac){for(i=[],r=0,n=(o=e.paises).length;r<n;r++)(s=o[r]).id===a.id?(e.acudiente.pais_nac=s,i.push(e.paisNacSelect(s))):i.push(void 0);return i}})},e.departSeleccionado=function(a){return s.get("::ciudades/por-departamento/"+a.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yy"},e.restarEstrato=function(){if(e.alumno.estrato>0)return e.alumno.estrato=e.alumno.estrato-1},e.sumarEstrato=function(){if(e.alumno.estrato<10)return e.alumno.estrato=e.alumno.estrato+1},e.crearAcudiente=function(){return e.acudiente.alumno_id=r.alumno_id,s.post("::acudientes/crear",e.acudiente).then(function(e){return u.success("Acudiente creado con éxito."),t.close(e.data)},function(e){return u.warning("No se pudo crear al alumno.","Problema")})},e.seleccionarAcudiente=function(){var a;return a={acudiente_id:e.datos.acudiente.id,alumno_id:r.alumno_id,parentesco:e.acudiente.parentesco.parentesco,ocupacion:e.acudiente.ocupacion},c.acudiente_cambiar&&(a.parentesco_acudiente_cambiar_id=c.acudiente_cambiar.parentesco_id),s.put("::acudientes/seleccionar-parentesco",a).then(function(e){return u.success("Acudiente seleccionado."),delete c.acudiente_cambiar,t.close(e.data)},function(e){return u.warning("No se pudo seleccionar.","Problema")})},e.ocupacionCheck=function(a){return e.verificandoOcupacion=!0,s.put("::acudientes/ocupaciones-check",{texto:a}).then(function(a){return e.ocupaciones_match=a.data.ocupaciones,e.verificandoOcupacion=!1,e.ocupaciones_match.map(function(e){return e.ocupacion})})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("EditAcudienteModalCtrl",["$scope","App","$uibModalInstance","acudiente","paises","tipos_doc","parentescos","$http","toastr","$filter","$rootScope",function(e,a,t,r,n,o,i,s,u,l,c){var d,p,f,m;if(e.acudiente=r,e.paises=n,e.parentescos=i,e.datos={},e.tipos_doc=o,e.perfilPath=a.images+"perfil/",e.cancel=function(){return t.dismiss("cancel")},e.paisNacSelect=function(a,t){return s.get("::ciudades/departamentos/"+a.id).then(function(a){return e.departamentosNac=a.data})},e.departNacSelect=function(a){return s.get("::ciudades/por-departamento/"+a.departamento).then(function(t){if(e.ciudadesNac=t.data,void 0===e.acudiente.departamento_doc)return e.acudiente.departamento_doc=a,e.departSeleccionado(a)})},e.paisSelecionado=function(a,t){return s.get("::ciudades/departamentos/"+a.id).then(function(t){var r,n,o,i,s;if(e.departamentos=t.data,void 0===e.acudiente.pais_nac){for(i=[],r=0,n=(o=e.paises).length;r<n;r++)(s=o[r]).id===a.id?(e.acudiente.pais_nac=s,i.push(e.paisNacSelect(s))):i.push(void 0);return i}})},e.departSeleccionado=function(a){return s.get("::ciudades/por-departamento/"+a.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yy"},e.restarEstrato=function(){if(e.alumno.estrato>0)return e.alumno.estrato=e.alumno.estrato-1},e.sumarEstrato=function(){if(e.alumno.estrato<10)return e.alumno.estrato=e.alumno.estrato+1},e.crearAcudiente=function(){return e.acudiente.alumno_id=alumno.alumno_id,s.post("::acudientes/crear",e.acudiente).then(function(e){return u.success("Acudiente creado con éxito."),t.close(e.data)},function(e){return u.warning("No se pudo crear al alumno.","Problema")})},e.seleccionarAcudiente=function(){var a;return a={acudiente_id:e.datos.acudiente.id,alumno_id:alumno.alumno_id,parentesco:e.acudiente.parentesco.parentesco,ocupacion:e.acudiente.ocupacion},c.acudiente_cambiar&&(a.parentesco_acudiente_cambiar_id=c.acudiente_cambiar.parentesco_id),s.put("::acudientes/seleccionar-parentesco",a).then(function(e){return u.success("Acudiente seleccionado."),delete c.acudiente_cambiar,t.close(e.data)},function(e){return u.warning("No se pudo seleccionar.","Problema")})},e.ocupacionCheck=function(a){return e.verificandoOcupacion=!0,s.put("::acudientes/ocupaciones-check",{texto:a}).then(function(a){return e.ocupaciones_match=a.data.ocupaciones,e.verificandoOcupacion=!1,e.ocupaciones_match.map(function(e){return e.ocupacion})})},null===e.acudiente.tipo_doc)e.acudiente.tipo_doc=e.tipos_doc[0];else for(d=0,p=(f=e.tipos_doc).length;d<p;d++)m=f[d],e.acudiente.tipo_doc===m.id&&(e.acudiente.tipo_doc=m);return null===e.acudiente.ciudad_nac?(e.acudiente.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},e.paisNacSelect(e.acudiente.pais_nac,e.acudiente.pais_nac)):(s.get("::ciudades/datosciudad/"+e.acudiente.ciudad_nac).then(function(a){var t,r,n,o,i,s,u,l,c,d,p,f,m;for(e.paises=a.data.paises,e.departamentosNac=a.data.departamentos,e.ciudadesNac=a.data.ciudades,n=0,s=(d=e.paises).length;n<s;n++)(c=d[n]).id===a.data.pais.id&&(e.acudiente.pais_nac=c);for(o=0,u=(p=e.departamentosNac).length;o<u;o++)(r=p[o]).departamento===a.data.departamento.departamento&&(e.acudiente.departamento_nac=r);for(m=[],i=0,l=(f=e.ciudadesNac).length;i<l;i++)(t=f[i]).id===a.data.ciudad.id?m.push(e.acudiente.ciudad_nac=t):m.push(void 0);return m}),null===e.acudiente.ciudad_doc?(e.acudiente.pais_doc={id:1,pais:"COLOMBIA",abrev:"CO"},e.paisDocSelect(e.acudiente.pais_doc,e.acudiente.pais_doc)):s.get("::ciudades/datosciudad/"+e.acudiente.ciudad_doc).then(function(a){return a=a.data,e.paises=a.paises,e.departamentos=a.departamentos,e.ciudades=a.ciudades,e.acudiente.pais_doc=a.pais,e.acudiente.departamento_doc=a.departamento,e.acudiente.ciudad_doc=a.ciudad}))}])}.call(this),function(){angular.module("myvcFrontApp").controller("CambiarCiudadModalCtrl",["$scope","$uibModalInstance","persona","paises","tipo_ciudad","tipo_persona","$http","toastr","$filter",function(e,a,t,r,n,o,i,s,u){return e.persona=t,e.paises=r,e.tipo_ciudad=n,e.modificarCiudades=!1,e.datos={},e.creando_ciudad=!1,e.creando_departamento=!1,e.creando_pais=!1,e.ciudad_new="",e.departamento_new="",e.pais_new="",e.modificando_depart=!1,e.crearCiudad=function(){return e.creando_ciudad=!0,e.$broadcast("paisSeleccionadoEvent2")},e.crearDepartamento=function(){return e.creandodepartamento=!0},e.crearPais=function(){return e.creandopais=!0},e.guardarCiudad=function(a,t){var r;if(e.datos.pais)if(e.datos.departamento||""!==t){if(""!==a)return r=e.datos.departamento?departamento.departamento:t,i.post("::ciudades/guardar-ciudad",{ciudad:a,departamento:r,pais_id:e.datos.pais.id}).then(function(a){return s.success("Creado correctamente: "+a.data.ciudad),e.datos.departamento&&e.ciudades.push(a.data),e.creandociudad=!1,e.ciudad_new="",e.departamento_new="",e.guardar=!0,i.get("::paises").then(function(a){return e.paises=a.data,e.paisSelect(u("filter")(e.paises,{id:1})[0])},function(e){return s.error("No se pudo traer las ciudades.")})},function(e){return s.error("No se pudo crear","Error")});s.warning("Debe escribir la nueva ciudad.")}else s.warning("Debe seleccionar departamento o escribir uno nuevo.");else s.warning("Debes seleccionar un pais.")},e.guardarPais=function(){return i.post("::paises/guardar",e.pais_new).then(function(a){return s.success("Creado correctamente: "+a.data.paisnuevo),e.paises.push(a.data),e.paisSelect(e.ciudad_new.pais)},function(e){return s.error("No se pudo crear","Error")})},e.escribeEnDepartamentoNew=function(){return e.datos.departamento=void 0},e.actualizarCiudad=function(e){return i.put("::ciudades/actualizar-ciudad",e).then(function(a){return s.success("Actualizado: "+e.ciudad),e.editandoCiudad=!1},function(e){return s.error("No se pudo actualizar","Error")})},e.actualizarDepartamento=function(a){return i.put("::ciudades/actualizar-departamento",a).then(function(t){var r,n,o;for(s.success("Actualizado: "+a.departamento),a.editandoDepart=!1,e.ciudad_new.pais,r=0,n=(o=e.ciudades).length;r<n;r++)o[r].departamento=a.departamento;return e.modificando_depart=!0},function(e){return s.error("No se pudo actualizar","Error")})},e.actualizarPais=function(e){return i.put("::paises/actualizar",e).then(function(a){return s.success("Actualizado: "+e.pais),e.editandoPais=!1,e.editandoAbrev=!1},function(e){return s.error("No se pudo actualizar","Error")})},e.paisSelect=function(a,t){return i.put("::ciudades/departamentos-by-id",{pais_id:a.id}).then(function(r){return e.departamentos=r.data.departamentos,void 0===e.datos.pais&&(e.datos.pais=a),e.$broadcast("paisSeleccionadoEvent"+t)})},e.paisSelect(u("filter")(e.paises,{id:1})[0],1),e.departamentoSelect=function(a,t){if(a)return e.departamento_new="",i.get("::ciudades/por-departamento/"+a.departamento).then(function(r){return e.ciudades=r.data,void 0===e.datos.departamento&&(e.datos.departamento=a),e.$broadcast("departamentoSeleccionadoEvent"+t)})},e.eliminarCiudad=function(a){return i.delete("::ciudades/destroy/"+a.id).then(function(t){return s.success("Ciudad enviada a la papelera.","Eliminado"),e.ciudades=u("filter")(e.ciudades,{id:"!"+a.id})},function(e){return s.warning("No se pudo enviar a la papelera.","Problema")})},e.ok=function(r){var u,l;if(!e.seleccionandoCiudad)return e.seleccionandoCiudad=!0,u=e.datos.ciudad,r&&(u=r),l={propiedad:n,valor:u.id},"acudiente"===o?(l.acudiente_id=t.id,l.parentesco_id=t.parentesco_id,l.user_acud_id=t.user_id):l.alumno_id=t.alumno_id,i.put("::"+o+"s/guardar-valor",l).then(function(e){return s.success("Seleccionado."),t[n+"_nombre"]=u.ciudad,t[n]=u.id,a.close(t)},function(e){return s.warning("No se pudo seleccionar.","Problema")})},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PromocionarNotasCtrl",["$scope","App","$rootScope","$state","$timeout","uiGridConstants","uiGridEditConstants","$uibModal","$filter","AuthService","toastr","$http","EscalasValorativasServ",function(e,a,t,r,n,o,i,s,u,l,c,d,p){l.verificar_acceso(),e.dato={},e.gridScope=e,e.views=a.views,e.perfilPath=a.images+"perfil/",e.hasRoleOrPerm=l.hasRoleOrPerm,e.dato.grupo="",d.get("::grupos").then(function(a){var t,r,n,o,i,s;for(o=0,localStorage.matr_grupo&&(o=parseInt(localStorage.matr_grupo)),e.grupos=a.data,s=[],r=0,n=(i=e.grupos).length;r<n;r++)t=i[r],parseInt(t.id)===parseInt(o)?(e.dato.grupo=t,s.push(e.selectGrupo(e.dato.grupo))):s.push(void 0);return s}),p.escalas().then(function(a){return e.escalas=a,e.escala_maxima=p.escala_maxima()},function(e){return console.log("No se trajeron las escalas valorativas",e)}),e.cambiaNotaComport=function(a,t,r){var n;if(e.dato.grupo.titular_id===e.USER.persona_id||e.hasRoleOrPerm("admin"))return a.id?(n=a.nota,d.put("::nota_comportamiento/update/"+a.id,{nota:a.nota}).then(function(e){return c.success("Nota cambiada: "+a.nota)},function(e){return c.error("No pudimos guardar la nota "+a.nota),a.nota=n})):((n={}).nota=a.nota,n.year_id=t.year_id,n.alumno_id=e[r].alumno.id,n.periodo_id=t.id,d.put("::nota_comportamiento/crear",n).then(function(e){var t;return t=e.data.nota_comport,a.id=t.id,a.year_id=t.year_id,a.nombres=t.nombres,a.apellidos=t.apellidos,a.alumno_id=t.alumno_id,a.foto_id=t.foto_id,a.foto_nombre=t.foto_nombre,a.sexo=t.sexo,a.periodo_id=t.periodo_id,c.success("Nota creada: "+a.nota)},function(e){return c.error("No pudimos guardar la nota "+n.nota),a=n}));c.warning("No eres el titular para cambiar comportamiento.")},e.selectGrupo=function(a){var t,r,n;for(e.dato={},localStorage.matr_grupo=a.id,e.dato.grupo=a,t=0,r=(n=e.grupos).length;t<r;t++)n[t].active=!1;return a.active=!0,d.put("::alumnos/de-grupo/"+a.id).then(function(a){var t,r,n,o,i,s;for(e.alumnos=a.data.alumnos,r=0,localStorage.matr_grupo&&(r=parseInt(localStorage.alumno_seleccionado_id)),s=[],n=0,o=(i=e.alumnos).length;n<o;n++)t=i[n],parseInt(t.id)===r?(e.dato.selected_alumno=t,s.push(e.selectAlumno(e.dato.selected_alumno))):s.push(void 0);return s})},e.selectAlumno=function(a){return localStorage.alumno_seleccionado_id=a.id,e.dato.periodo_id=void 0,d.put("::alumnos/years-con-notas",{alumno_id:a.id}).then(function(a){return e.years_notas=a.data.years,e.years_dest=a.data.years_dest})},e.eligirPanelNotas=function(a){return e.dato.panel_index=a},e.eligirPeriodoNotas=function(a,t,r,n,o){return e.dato.periodo_id=t.id,d.put("::notas/alumno-periodo-grupo",{alumno_id:e.dato.selected_alumno.id,periodo_id:t.id,grupo_id:a.grupo_id}).then(function(i){return 1===n?(e.datos_origen={grupo:a,periodo:t,num_year:r,alumno:o},e.notas_origen=i.data.notas):(e.datos_destino={grupo:a,periodo:t,num_year:r,alumno:o},e.notas_destino=i.data.notas,$.isArray(e.notas_destino.asignaturas)?void 0:e.notas_destino.asignaturas=[e.notas_destino.asignaturas[Object.keys(e.notas_destino.asignaturas)[0]]])})},e.pasarNota=function(a){var t,r,n,o,i;if(!e.pasando_nota){for(e.pasando_nota=!0,r=0,n=0,o=(i=e.notas_destino.asignaturas).length;n<o;n++)(t=i[n]).materia_id===a.materia_id&&(r+=1,t.nf_id?(e.asign_temp=a,d.put("::definitivas_periodos/update",{nf_id:t.nf_id,nota:a.nota_asignatura,num_periodo:e.datos_destino.periodo.numero}).then(function(t){return e.evento_definitiva_cambiada(!1,a)},function(t){return e.pasando_nota=!1,400===t.status?c.warning("Parece que no tienes permisos","Lo sentimos"):c.error("No pudimos guardar la nota "+a.nota_asignatura,"",{timeOut:8e3})})):d.put("::definitivas_periodos/update",{alumno_id:e.dato.selected_alumno.id,nota:a.nota_asignatura,asignatura_id:a.asignatura_id,num_periodo:e.datos_destino.periodo.numero}).then(function(t){return e.evento_definitiva_cambiada(!0,a,t.data[0])},function(t){return e.pasando_nota=!1,400===t.status?c.warning("Parece que no tienes permisos","Lo sentimos"):c.error("No pudimos guardar la nota "+a.nota_asignatura,"",{timeOut:8e3})}));return 0===r?(c.warning("No coincide con ninguna materia destino."),e.pasando_nota=!1):void 0}},e.evento_definitiva_cambiada=function(a,t,r){var o,i,s,u,l,d,p,f;if(a){for(c.success("Creada: "+t.nota_asignatura),f=[],i=0,u=(d=e.notas_destino.asignaturas).length;i<u;i++)(o=d[i]).asignatura_id===r.asignatura_id?(o.nf_id=r.id,o.nota_asignatura=r.nota,o.manual=1,o.recuperada=0,e.pasando_nota=!1,f.push(n(function(){return e.$apply()}))):f.push(void 0);return f}for(s=0,l=(p=e.notas_destino.asignaturas).length;s<l;s++)(o=p[s]).materia_id===e.asign_temp.materia_id&&(o.nota_asignatura=e.asign_temp.nota_asignatura,o.manual=1,n(function(){return e.$apply()}));return c.success("Cambiada: "+t.nota_asignatura),e.pasando_nota=!1},e.cambiaNotaDef=function(a,t,r,n){if(!(t>e.escala_maxima.porc_final||"undefined"===t||void 0===t))return r?d.put("::definitivas_periodos/update",{nf_id:r,nota:t}).then(function(e){return a.manual||(a.manual=1),c.success("Cambiada: "+t)},function(e){return 400===e.status?c.warning("Parece que no tienes permisos","Lo sentimos"):c.error("No pudimos guardar la nota "+t,"",{timeOut:8e3})}):d.put("::definitivas_periodos/update",{alumno_id:e.alumno_traido.alumno_id,nota:t,asignatura_id:a.asignatura_id,num_periodo:n}).then(function(e){return c.success("Creada: "+t),e=e.data[0],a.nf_id=e.id,a.recuperada=0,a.manual=1},function(e){return 400===e.status?c.warning("Parece que no tienes permisos","Lo sentimos"):c.error("No pudimos guardar la nota "+t,"",{timeOut:8e3})});c.error("No puede ser mayor de "+e.escala_maxima.porc_final,"NO guardada",{timeOut:8e3})},e.toggleNotaFinalRecuperada=function(e,a,t){return d.put("::definitivas_periodos/toggle-recuperada",{nf_id:t,recuperada:a}).then(function(t){return a&&!e.manual?(e.manual=1,c.success("Indicará que es recuperada, así que también será manual.")):a?c.success("Recuperada"):c.success("No recuperada")},function(e){return 400===e.status?c.warning("Parece que no tienes permisos","Lo sentimos"):c.error("No pudimos cambiar.","",{timeOut:8e3})})},e.toggleNotaFinalManual=function(e,a,t){return d.put("::definitivas_periodos/toggle-manual",{nf_id:t,manual:a}).then(function(t){return!a&&e.nota_final.recuperada?(e.nota_final.recuperada=!1,c.success("Será automática y no recuperada.")):a?c.success("Nota manual."):c.success("Ahora la calculará el sistema.")},function(e){return 400===e.status?c.warning("Parece que no tienes permisos","Lo sentimos"):c.error("No pudimos cambiar.","",{timeOut:8e3})})},e.verDetalleNota=function(a,t){s.open({templateUrl:"==notas/notaFinalDetalleModal.tpl.html",controller:"NotaFinalDetalleModalCtrl",resolve:{alumno:function(){return t},asignatura:function(){return a},USER:function(){return e.USER},escala_maxima:function(){return e.escala_maxima}}}).result.then(function(e){if("Eliminada"===e)return a.eliminada=!0},function(){})}}]).controller("NotaFinalDetalleModalCtrl",["$scope","$uibModalInstance","alumno","asignatura","AuthService","$http","toastr","$filter","USER","escala_maxima",function(e,a,t,r,n,o,i,s,u,l){return e.alumno=t,e.nota=r,e.hasRoleOrPerm=n.hasRoleOrPerm,e.escala_maxima=l,o.put("::historiales/nota-final-detalle",{nf_id:r.nf_id}).then(function(a){return e.cambios=a.data.cambios,e.nota_detalle=a.data.nota},function(e){return i.warning("No se pudo traer el historial.","Problema")}),e.eliminarNota=function(){return o.delete("::definitivas_periodos/destroy/"+r.nf_id).then(function(e){return i.success("Nota eliminada","Recarga para ver"),a.close("Eliminada")},function(e){return i.error("No se pudo eliminar nota.","Problema")})},e.ok=function(){return a.close(t)},e.cambiaNotaDef=function(a,t,r,n){if(!(t>e.escala_maxima.porc_final||"undefined"===t||void 0===t))return r?o.put("::definitivas_periodos/update",{nf_id:r,nota:t}).then(function(e){return a.manual||(a.manual=1),i.success("Cambiada: "+t)},function(e){return 400===e.status?i.warning("Parece que no tienes permisos","Lo sentimos"):i.error("No pudimos guardar la nota "+t,"",{timeOut:8e3})}):o.put("::definitivas_periodos/update",{alumno_id:e.alumno_traido.alumno_id,nota:t,asignatura_id:a.asignatura_id,num_periodo:n}).then(function(e){return i.success("Creada: "+t),e=e.data[0],a.nf_id=e.id,a.recuperada=0,a.manual=1},function(e){return 400===e.status?i.warning("Parece que no tienes permisos","Lo sentimos"):i.error("No pudimos guardar la nota "+t,"",{timeOut:8e3})});i.error("No puede ser mayor de "+e.escala_maxima.porc_final,"NO guardada",{timeOut:8e3})},e.toggleNotaFinalRecuperada=function(e,a,t){return o.put("::definitivas_periodos/toggle-recuperada",{nf_id:t,recuperada:a}).then(function(t){return a&&!e.manual?(e.manual=1,i.success("Indicará que es recuperada, así que también será manual.")):a?i.success("Recuperada"):i.success("No recuperada")},function(e){return 400===e.status?i.warning("Parece que no tienes permisos","Lo sentimos"):i.error("No pudimos cambiar.","",{timeOut:8e3})})},e.toggleNotaFinalManual=function(e,a,t){return o.put("::definitivas_periodos/toggle-manual",{nf_id:t,manual:a}).then(function(t){return!a&&e.nota_final.recuperada?(e.nota_final.recuperada=!1,i.success("Será automática y no recuperada.")):a?i.success("Nota manual."):i.success("Ahora la calculará el sistema.")},function(e){return 400===e.status?i.warning("Parece que no tienes permisos","Lo sentimos"):i.error("No pudimos cambiar.","",{timeOut:8e3})})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AsistenciasCtrl",["$scope","toastr","$http","$uibModal","$state","$rootScope","$filter","App","AuthService","$timeout","EscalasValorativasServ","$stateParams","NotasServ",function(e,a,t,r,n,o,i,s,u,l,c,d,p){u.verificar_acceso(),e.asignatura={},e.grupo_id=n.params.grupo_id,e.datos={},e.perfilPath=s.images+"perfil/",e.views=s.views,e.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.ausencia_edit={},e.tardanza_edit={},e.alumno_aus_tard_edit={},e.opts_picker={minDate:new Date("1/1/2017"),showWeeks:!1,startingDay:0},e.hasRoleOrPerm=u.hasRoleOrPerm,t.put("::asistencias/detailed",{con_grupos:!0}).then(function(a){var t,r,n,o,i,s;for(e.alumnos=a.data.alumnos,e.grupos=a.data.grupos,o=0,localStorage.matr_grupo&&(o=parseInt(localStorage.matr_grupo)),s=[],r=0,n=(i=e.grupos).length;r<n;r++)t=i[r],parseInt(t.id)===parseInt(o)?(e.grupo=t,s.push(e.traerAsistencias(e.grupo))):s.push(void 0);return s},function(e){return a.error("No se pudo traer las notas con asignaturas.")}),e.traerAsistencias=function(r){var o,i,s;for(localStorage.matr_grupo=r.id,n.go(".",{grupo_id:r.id},{notify:!1}),t.put("::asistencias/detailed",{grupo_id:r.id,con_grupos:!1}).then(function(a){var t,r,n,o,i,s,u,l,c,d;for(e.alumnos=a.data.alumnos,c=[],n=0,i=(u=e.alumnos).length;n<i;n++){for(o=0,s=(l=(t=u[n]).ausencias).length;o<s;o++)(r=l[o]).backup=r.fecha_hora,r.fecha_hora?r.fecha_hora=new Date(r.fecha_hora):r.fecha_hora=new Date;c.push(function(){var e,a,r,n;for(n=[],e=0,a=(r=t.tardanzas).length;e<a;e++)(d=r[e]).backup=d.fecha_hora,d.fecha_hora?n.push(d.fecha_hora=new Date(d.fecha_hora)):n.push(d.fecha_hora=new Date);return n}())}return c},function(e){return a.error("No se pudo traer las asistencias.")}),o=0,i=(s=e.grupos).length;o<i;o++)s[o].active=!1;return r.active=!0,e.grupo_id=r.id,e.grupo=r},e.seleccionarFila=function(a){var t,r,n;for(t=0,r=(n=e.alumnos).length;t<r;t++)n[t].seleccionado=!1;return a.seleccionado=!0},e.cambiaAusencia=function(e){var r,n,o,s,u,l,c,d,p;if(e.ausencias_count>e.ausencias.length){for(d=[],u=o=0,l=e.ausencias_count-e.ausencias.length-1;0<=l?o<=l:o>=l;u=0<=l?++o:--o)n={alumno_id:e.alumno_id,entrada:1,tipo:"ausencia"},d.push(t.post("::ausencias/store",n).then(function(a){return a=a.data,e.ausencias.push(a)},function(e){return a.warning("No se pudo agregar ausencia.","Problema")}));return d}if(e.ausencias_count<e.ausencias.length){for(p=[],u=s=0,c=e.ausencias.length-e.ausencias_count-1;0<=c?s<=c:s>=c;u=0<=c?++s:--s)r=e.ausencias[e.ausencias.length-u-1].id,p.push(t.delete("::ausencias/destroy/"+r).then(function(a){return a=a.data,e.ausencias=i("filter")(e.ausencias,{id:"!"+a.id})},function(e){return a.warning("No se pudo quitar ausencia.","Problema")}));return p}},e.cambiaTardanza=function(e){var r,n,o,s,u,l,c,d,p;if(e.tardanzas_count>e.tardanzas.length){for(c=[],s=n=0,u=e.tardanzas_count-e.tardanzas.length-1;0<=u?n<=u:n>=u;s=0<=u?++n:--n)r={alumno_id:e.alumno_id,entrada:1,tipo:"tardanza"},c.push(t.post("::ausencias/store",r).then(function(a){return a=a.data,e.tardanzas.push(a)},function(e){return a.warning("No se pudo agregar tardanza.","Problema")}));return c}if(e.tardanzas_count<e.tardanzas.length){for(d=[],s=o=0,l=e.tardanzas.length-e.tardanzas_count-1;0<=l?o<=l:o>=l;s=0<=l?++o:--o)p=e.tardanzas[e.tardanzas.length-s-1].id,d.push(t.delete("::ausencias/destroy/"+p).then(function(a){return a=a.data,e.tardanzas=i("filter")(e.tardanzas,{id:"!"+a.id})},function(e){return a.warning("No se pudo quitar tardanza.","Problema")}));return d}},e.clickAusenciaObject=function(a,t){return a.backup=a.fecha_hora,a.fecha_hora?a.fecha_hora=new Date(a.fecha_hora):a.fecha_hora=new Date,e.ausencia_edit=a,e.alumno_aus_tard_edit=t,a.isOpen=!a.isOpen},e.clickTardanzaObject=function(a,t){return a.backup=a.fecha_hora,a.fecha_hora?a.fecha_hora=new Date(a.fecha_hora):a.fecha_hora=new Date,e.tardanza_edit=a,e.alumno_aus_tard_edit=t,a.isOpen=!a.isOpen},e.guardarCambioAusencia=function(r){var n;return n={ausencia_id:r.id,fecha_hora:i("date")(r.fecha_hora,"yyyy-MM-dd HH:mm:ss")},t.put("::ausencias/guardar-cambios-ausencia",n).then(function(a){return a=a.data,alumno.tardanzas.push(a),e.ausencia_edit.isOpen=!1,e.tardanza_edit.isOpen=!1},function(e){return a.warning("No se pudo agregar tardanza.","Problema")})},e.cancelarCambioAusencia=function(e){return e.isOpen=!1},e.cancelarCambioTardanza=function(e){return e.isOpen=!1},e.eliminarAusencia=function(e,r){return t.delete("::ausencias/destroy/"+e.id).then(function(a){return a=a.data,r.ausencias=i("filter")(r.ausencias,{id:"!"+a.id}),e.isOpen=!1},function(e){return a.warning("No se pudo quitar ausencia.","Problema")})},e.eliminarTardanza=function(e,r){return t.delete("::ausencias/destroy/"+e.id).then(function(a){return a=a.data,r.tardanzas=i("filter")(r.tardanzas,{id:"!"+a.id}),e.isOpen=!1},function(e){return a.warning("No se pudo quitar tardanza.","Problema")})},e.showFrases=function(a){return r.open({templateUrl:"==notas/showFrases.tpl.html",controller:"ShowFrasesCtrl",size:"lg",resolve:{alumno:function(){return a},frases:function(){return t.get("::frases")},asignatura:function(){return e.asignatura},USER:function(){return e.USER}}}).result.then(function(e){return a.frases=e.frases_asignatura},function(e){return console.log(e)})}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(e,a,t,r){return e.state("panel.notas",{url:"^/notas/:asignatura_id/:profesor_id",views:{maincontent:{templateUrl:"==notas/notas.tpl.html",controller:"NotasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas"}]}}},resolve:{escalas:["EscalasValorativasServ",function(e){return e.escalas()}]},data:{displayName:"Notas",icon_fa:"fa fa-graduation-cap",needed_permissions:[r.can_work_like_teacher,r.can_work_like_admin,r.can_edit_notas],pageTitle:"Notas - MyVc"}}).state("panel.definitivas_periodos",{url:"^/definitivas-periodos/:profesor_id",params:{profesor_id:{value:null}},views:{maincontent:{templateUrl:"==notas/definitivasPeriodos.tpl.html",controller:"DefinitivasPeriodosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Definitivas periodos"}]}}},resolve:{escalas:["EscalasValorativasServ",function(e){return e.escalas()}],asignaturas_definitivas:["$http","AuthService","$stateParams",function(e,a,t){return a.hasRoleOrPerm(["alumno","acudiente"])?"Sin alumnos":t.profesor_id?e.get("::definitivas_periodos",{params:{profesor_id:t.profesor_id}}):e.get("::definitivas_periodos")}]},data:{displayName:"Notas",icon_fa:"fa fa-graduation-cap",needed_permissions:[r.can_work_like_teacher,r.can_work_like_admin,r.can_edit_notas],pageTitle:"Definitivas - MyVc"}}).state("panel.comportamiento",{url:"^/comportamiento/:grupo_id",views:{maincontent:{templateUrl:"==notas/comportamiento.tpl.html",controller:"ComportamientoCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Comportamiento"}]}}},resolve:{comportamiento:["ComportamientoServ","$stateParams",function(e,a){return e.detallados(a.grupo_id)}]},data:{displayName:"Comportamiento",icon_fa:"fa fa-street-view",needed_permissions:[r.can_work_like_teacher,r.can_work_like_admin,r.can_edit_notas],pageTitle:"Comportamiento - MyVc"}}).state("panel.notas_alumno",{url:"^/notas_alumno/:alumno_id",params:{alumno_id:{value:null}},views:{maincontent:{templateUrl:"==notas/notasAlumno.tpl.html",controller:"NotasAlumnoCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas alumno"}]}}},resolve:{alumnos:["$http","AuthService","resolved_user",function(e,a,t){return a.hasRoleOrPerm(["alumno","acudiente"])?"Sin alumnos":e.get("::alumnos/sin-matriculas")}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]},data:{displayName:"Notas alumno",icon_fa:"fa fa-graduation-cap",pageTitle:"Notas alumno - MyVc"}}).state("panel.boletin_acudiente",{url:"/boletin_acudiente/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{maincontent:{templateUrl:"==informes/boletinesPeriodo.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o;return n=t.defer(),(o=r.getObject("requested_alumno"))&&e.put("::boletines/detailed-notas/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Boletín del periodo",pageTitle:"Boletín del periodo - MyVc"}}).state("panel.notas_perdidas_profesor_edit",{url:"^/notas_perdidas_profesor_edit",views:{maincontent:{templateUrl:"==notas/notasPerdidasProfesorEdit.tpl.html",controller:"NotasPerdidasProfesorEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas perdidas a editar"}]}}},data:{displayName:"Notas perdidas a editar",icon_fa:"fa fa-graduation-cap",needed_permissions:[r.can_work_like_teacher,r.can_work_like_admin,r.can_edit_notas],pageTitle:"Notas perdidas a editar - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").filter("juicioValorativo",[function(){return function(e,a,t){var r;return r={},angular.forEach(a,function(a){if(e>=a.porc_inicial&&e<=a.porc_final)return r.desempenio=a.desempenio,r.valoracion=a.valoracion}),t?r.desempenio:r.valoracion}}]).filter("soloAsignaturasConPerdidas",["$filter",function(e){return function(a,t){return t?(this.asignaturas_resp=[],angular.forEach(a,function(a){if(e("soloUnidadesConPerdidas")(a.unidades,!0).length)return this.asignaturas_resp.push(a)}),this.asignaturas_resp):a}}]).filter("soloUnidadesConPerdidas",["$filter",function(e){return function(a,t){return t?(this.unidades_resp=[],angular.forEach(a,function(a){if(e("soloSubunidadesPerdidas")(a.subunidades,!0).length)return this.unidades_resp.push(a)}),this.unidades_resp):a}}]).filter("soloSubunidadesPerdidas",["Perfil",function(e){return function(a,t){return t?(this.subunidades_resp=[],angular.forEach(a,function(a){if(a.nota&&a.nota.nota<e.User().nota_minima_aceptada)return this.subunidades_resp.push(a)}),this.subunidades_resp):a}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NotasCtrl",["$scope","toastr","$http","$uibModal","$state","$rootScope","$filter","App","AuthService","$timeout","EscalasValorativasServ","$stateParams","NotasServ",function(e,a,t,r,n,o,i,s,u,l,c,d,p){u.verificar_acceso(),e.asignatura={},e.asignatura_id=n.params.asignatura_id,e.datos={},e.UNIDAD=e.USER.unidad_displayname,e.SUBUNIDAD=e.USER.subunidad_displayname,e.UNIDADES=e.USER.unidades_displayname,e.SUBUNIDADES=e.USER.subunidades_displayname,e.perfilPath=s.images+"perfil/",e.views=s.views,e.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.ocultando_ausencias=!0,e.ausencia_edit={},e.tardanza_edit={},e.alumno_aus_tard_edit={},e.opts_picker={minDate:new Date("1/1/2017"),showWeeks:!1,startingDay:0},e.hasRoleOrPerm=u.hasRoleOrPerm,p.detalladas(d.asignatura_id,d.profesor_id,!0).then(function(a){return e.asignatura=a.asignatura,e.alumnos=a.alumnos,e.unidades=a.unidades,e.asignaturas=a.asignaturas,e.arreglarDatos()},function(e){return a.error("No se pudo traer las notas con asignaturas.")}),c.escalas().then(function(a){return e.escalas=a},function(e){return console.log("No se trajeron las escalas valorativas",e)}),e.escala_maxima=c.escala_maxima(),e.arreglarDatos=function(){var a,t,r,n,o,i,s,u,c,d,p,f,m,g,_,h,v,b,y,w,C,N,A,S;for(e.subunidadesunidas=[],n=0,u=(h=e.unidades).length;n<u;n++)for(0===(S=h[n]).subunidades.length&&e.subunidadesunidas.push({empty:!0}),o=0,c=(v=S.subunidades).length;o<c;o++)N=v[o],e.subunidadesunidas.push(N);for(localStorage.ocultando_ausencias&&(e.ocultando_ausencias="true"===localStorage.ocultando_ausencias),localStorage.historial_activado&&(e.historial_activado="true"===localStorage.historial_activado),i=0,d=(b=e.alumnos).length;i<d;i++){for(s=0,p=(y=(a=b[i]).ausencias).length;s<p;s++)(r=y[s]).fecha_hora&&(r.fecha_hora=new Date(r.fecha_hora));for(g=0,f=(w=a.tardanzas).length;g<f;g++)(A=w[g]).fecha_hora&&(A.fecha_hora=new Date(A.fecha_hora))}for(_=0,m=(C=e.asignaturas).length;_<m;_++)t=C[_],parseInt(t.asignatura_id)===parseInt(e.asignatura.asignatura_id)&&(t.active=!0);return l(function(){return localStorage.tab_horiz_or_verti&&"vertical"===localStorage.tab_horiz_or_verti?e.setTabVertically():e.setTabHorizontally()},1)},e.setTabVertically=function(){var a;if(localStorage.tab_horiz_or_verti="vertical",e.tab_horiz_or_verti="vertical",a=$("table tr"),angular.forEach(a,function(e,a){var t;return t=$(e).find(".input-nota"),angular.forEach(t,function(e,a){return $(e).attr("tabindex",a+1)})}),e.eleFocus&&e.eleFocus.focus)return e.eleFocus.focus()},e.setTabHorizontally=function(){var a;if(localStorage.tab_horiz_or_verti="horizontal",e.tab_horiz_or_verti="horizontal",a=$(".input-nota"),angular.forEach(a,function(e,a){return $(e).attr("tabindex",a+1)}),e.eleFocus)return e.eleFocus.focus()},e.onInputFocus=function(a){return e.eleFocus=a.currentTarget},e.traerNotasDeAsignatura=function(a){var t,r,o;for(n.go(".",{asignatura_id:a.asignatura_id},{notify:!1}),p.detalladas(a.asignatura_id,a.profesor_id,!1).then(function(a){return e.asignatura=a.asignatura,e.alumnos=a.alumnos,e.unidades=a.unidades,e.arreglarDatos()}),t=0,r=(o=e.asignaturas).length;t<r;t++)o[t].active=!1;return a.active=!0,e.asignatura_id=a.asignatura_id},e.toggleHistorial=function(){if(e.historial_activado=!e.historial_activado,localStorage.historial_activado=e.historial_activado,e.historial_activado)return a.info("Ahora dale doble click a la nota que quieres ver")},e.seleccionarFila=function(a){var t,r,n;for(t=0,r=(n=e.alumnos).length;t<r;t++)n[t].seleccionado=!1;return a.seleccionado=!0},e.toggleAusencias=function(){return e.ocultando_ausencias=!e.ocultando_ausencias,localStorage.ocultando_ausencias=e.ocultando_ausencias},e.cambiaAusencia=function(r){var n,o,s,u,l,c,d,p,f;if(r.ausencias_count>r.ausencias.length){for(p=[],l=s=0,c=r.ausencias_count-r.ausencias.length-1;0<=c?s<=c:s>=c;l=0<=c?++s:--s)o={alumno_id:r.alumno_id,asignatura_id:e.asignatura_id,cantidad_ausencia:1},p.push(t.post("::ausencias/store",o).then(function(e){return e=e.data,r.ausencias.push(e)},function(e){return a.warning("No se pudo agregar ausencia.","Problema")}));return p}if(r.ausencias_count<r.ausencias.length){for(f=[],l=u=0,d=r.ausencias.length-r.ausencias_count-1;0<=d?u<=d:u>=d;l=0<=d?++u:--u)n=r.ausencias[r.ausencias.length-l-1].id,f.push(t.delete("::ausencias/destroy/"+n).then(function(e){return e=e.data,r.ausencias=i("filter")(r.ausencias,{id:"!"+e.id})},function(e){return a.warning("No se pudo quitar ausencia.","Problema")}));return f}},e.cambiaTardanza=function(r){var n,o,s,u,l,c,d,p,f;if(r.tardanzas_count>r.tardanzas.length){for(d=[],u=o=0,l=r.tardanzas_count-r.tardanzas.length-1;0<=l?o<=l:o>=l;u=0<=l?++o:--o)n={alumno_id:r.alumno_id,asignatura_id:e.asignatura_id,cantidad_tardanza:1},d.push(t.post("::ausencias/store",n).then(function(e){return e=e.data,r.tardanzas.push(e)},function(e){return a.warning("No se pudo agregar tardanza.","Problema")}));return d}if(r.tardanzas_count<r.tardanzas.length){for(p=[],u=s=0,c=r.tardanzas.length-r.tardanzas_count-1;0<=c?s<=c:s>=c;u=0<=c?++s:--s)f=r.tardanzas[r.tardanzas.length-u-1].id,p.push(t.delete("::ausencias/destroy/"+f).then(function(e){return e=e.data,r.tardanzas=i("filter")(r.tardanzas,{id:"!"+e.id})},function(e){return a.warning("No se pudo quitar tardanza.","Problema")}));return p}},e.clickAusenciaObject=function(a,t){return a.backup=a.fecha_hora,a.fecha_hora?a.fecha_hora=new Date(a.fecha_hora):a.fecha_hora=new Date,e.ausencia_edit=a,e.alumno_aus_tard_edit=t,a.isOpen=!a.isOpen},e.clickTardanzaObject=function(a,t){return a.backup=a.fecha_hora,a.fecha_hora?a.fecha_hora=new Date(a.fecha_hora):a.fecha_hora=new Date,e.tardanza_edit=a,e.alumno_aus_tard_edit=t,a.isOpen=!a.isOpen},e.guardarCambioAusencia=function(r){var n;return n={ausencia_id:r.id,fecha_hora:i("date")(r.fecha_hora,"yyyy-MM-dd HH:mm:ss")},t.put("::ausencias/guardar-cambios-ausencia",n).then(function(a){return a=a.data,alumno.tardanzas.push(a),e.ausencia_edit.isOpen=!1,e.tardanza_edit.isOpen=!1},function(e){return a.warning("No se pudo agregar tardanza.","Problema")})},e.cancelarCambioAusencia=function(e){return e.isOpen=!1},e.cancelarCambioTardanza=function(e){return e.isOpen=!1},e.eliminarAusencia=function(e,r){return t.delete("::ausencias/destroy/"+e.id).then(function(a){return a=a.data,r.ausencias=i("filter")(r.ausencias,{id:"!"+a.id}),e.isOpen=!1},function(e){return a.warning("No se pudo quitar ausencia.","Problema")})},e.eliminarTardanza=function(e,r){return t.delete("::ausencias/destroy/"+e.id).then(function(a){return a=a.data,r.tardanzas=i("filter")(r.tardanzas,{id:"!"+a.id}),e.isOpen=!1},function(e){return a.warning("No se pudo quitar tardanza.","Problema")})},e.cambiaNotaDef=function(r,n,o){if(!(n>e.escala_maxima.porc_final||"undefined"===n||void 0===n))return t.put("::definitivas_periodos/update",{nf_id:o,nota:n}).then(function(e){return r.nota_final.manual||(r.nota_final.manual=1),a.success("Cambiada: "+n)},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+n,"",{timeOut:8e3})});a.error("No puede ser mayor de "+e.escala_maxima.porc_final,"NO guardada",{timeOut:8e3})},e.toggleNotaFinalRecuperada=function(e,r,n){return t.put("::definitivas_periodos/toggle-recuperada",{nf_id:n,recuperada:r}).then(function(t){return r&&!e.nota_final.manual?(e.nota_final.manual=1,a.success("Indicará que es recuperada, así que también será manual.")):r?a.success("Recuperada"):a.success("No recuperada")},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos cambiar.","",{timeOut:8e3})})},e.toggleNotaFinalManual=function(e,r,n){return t.put("::definitivas_periodos/toggle-manual",{nf_id:n,manual:r}).then(function(t){return!r&&e.nota_final.recuperada?(e.nota_final.recuperada=!1,a.success("Será automática y no recuperada.")):r?a.success("Nota manual."):a.success("Ahora la calculará el sistema.")},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos cambiar.","",{timeOut:8e3})})},e.cambiaNota=function(r,n){if(!(r.nota>e.escala_maxima.porc_final||"undefined"===r.nota||void 0===r.nota))return t.put("::notas/update/"+r.id,{nota:r.nota}).then(function(e){return a.success("Cambiada: "+r.nota),r.updated_at=r.updated_at},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+r.nota,"",{timeOut:8e3})});a.error("No puede ser mayor de "+e.escala_maxima.porc_final,"NO guardada",{timeOut:8e3})},e.showFrases=function(a){return r.open({templateUrl:"==notas/showFrases.tpl.html",controller:"ShowFrasesCtrl",size:"lg",resolve:{alumno:function(){return a},frases:function(){return t.get("::frases")},asignatura:function(){return e.asignatura},USER:function(){return e.USER}}}).result.then(function(e){return a.frases=e.frases_asignatura},function(e){return console.log(e)})},e.promedioTotal=function(e){var a,t,r,n,o;for(a=0,t=0,r=(o=e.notas).length;t<r;t++)a+=(n=o[t]).nota*n.subunidad_porc*n.unidad_porc;return e.total_definit=parseInt(i("number")(a,0)),i("number")(a,1)},e.verDetalleNota=function(a,t){e.historial_activado&&r.open({templateUrl:"==notas/notaDetalleModal.tpl.html",controller:"NotaDetalleModalCtrl",resolve:{alumno:function(){return t},nota:function(){return a}}}).result.then(function(e){if("Eliminada"===e)return a.eliminada=!0},function(){})},e.verifClickNotaRapida=function(a){l(function(){var t;if(o.notaRapida.enable)return a.backup?o.notaRapida.valorNota!==a.nota?(a.backup=a.nota,a.nota=o.notaRapida.valorNota):(t=a.backup,a.backup=a.nota,a.nota=t):(a.backup=a.nota,a.nota=o.notaRapida.valorNota),e.cambiaNota(a)})},e.columnaNotaRapida=function(r){l(function(){var n,i,s,u,l,c,d,p;if(o.notaRapida.enable){for(d=[],s=0,u=(c=e.alumnos).length;s<u;s++)n=c[s],d.push(function(){var s,u,c,d;for(d=[],s=0,u=(c=n.notas).length;s<u;s++)(l=c[s]).subunidad_id===r?(l.backup?o.notaRapida.valorNota!==l.nota?(l.backup=l.nota,l.nota=o.notaRapida.valorNota):(p=l.backup,l.backup=l.nota,l.nota=p):(l.backup=l.nota,l.nota=o.notaRapida.valorNota),i=0,d.push(t.put("::notas/update/"+l.id,{nota:l.nota}).then(function(t){if((i+=1)===e.alumnos.length-1)return a.success(i+1+" notas guardadas.")},function(e){return a.error("No pudimos guardar la nota "+l.nota,"",{timeOut:8e3})}))):d.push(void 0);return d}());return d}return a.info("Activa la Nota Rápida para cambiar todas las notas de esta columna.")})},e.filaNotaRapida=function(e,r){l(function(){var r,n,i,s,u,l,c;if(o.notaRapida.enable){for(l=[],n=0,i=(u=e.notas).length;n<i;n++)(s=u[n]).backup?o.notaRapida.valorNota!==s.nota?(s.backup=s.nota,s.nota=o.notaRapida.valorNota):(c=s.backup,s.backup=s.nota,s.nota=c):(s.backup=s.nota,s.nota=o.notaRapida.valorNota),r=0,l.push(t.put("::notas/update/"+s.id,{nota:s.nota}).then(function(t){if((r+=1)===e.notas.length-1)return a.success(r+1+" notas guardadas.")},function(e){return a.error("No pudimos guardar la nota "+s.nota,"",{timeOut:8e3})}));return l}return a.info("Activa la Nota Rápida para cambiar todas las notas de este alumno.")})}}]).controller("ShowFrasesCtrl",["$scope","$uibModalInstance","alumno","frases","asignatura","$http","toastr","$filter","USER","AuthService",function(e,a,t,r,n,o,i,s,u,l){return e.alumno=t,e.frases=r.data,e.asignatura=n,e.USER=u,e.hasRoleOrPerm=l.hasRoleOrPerm,e.alumno.newFrase="",o.get("::frases_asignatura/show/"+t.alumno_id+"/"+n.asignatura_id).then(function(a){return e.frases_asignatura=a.data},function(e){return i.warning("No se pudo traer frases.","Problema")}),e.addFrase=function(){var a;return""!==e.alumno.newFrase?(a={alumno_id:t.alumno_id,frase:e.alumno.newFrase,asignatura_id:e.asignatura.asignatura_id},o.post("::frases_asignatura/store",a).then(function(a){return e.frases_asignatura=a.data,i.success("Frase añadida.")},function(e){return i.warning("No se pudo añadir frase.","Problema")})):i.warning("No ha copiado ninguna frase")},e.addFrase_id=function(){var a;return e.alumno.newFrase_by_id?(a={alumno_id:t.alumno_id,frase_id:e.alumno.newFrase_by_id.id,asignatura_id:e.asignatura.asignatura_id},o.post("::frases_asignatura/store/"+e.alumno.newFrase_by_id.id,a).then(function(a){return i.success("Frase añadida."),e.frases_asignatura=a.data},function(e){return i.warning("No se pudo añadir frase.","Problema")})):i.warning("No ha seleccionado frase")},e.quitarFrase=function(a){return o.delete("::frases_asignatura/destroy/"+a.id).then(function(t){return i.success("Frase quitada"),e.frases_asignatura=s("filter")(e.frases_asignatura,{id:"!"+a.id})},function(e){return i.warning("No se pudo quitar la frase.","Problema")})},e.ok=function(){return a.close({alumno:t,frases_asignatura:e.frases_asignatura})},e.$on("modal.closing",function(r,n,o){switch(n){case"backdrop click":case"cancel":case"escape key press":return a.close({alumno:t,frases_asignatura:e.frases_asignatura}),r.preventDefault()}})}]).controller("NotaDetalleModalCtrl",["$scope","$uibModalInstance","alumno","nota","AuthService","$http","toastr","$filter",function(e,a,t,r,n,o,i,s){return e.alumno=t,e.nota=r,e.hasRoleOrPerm=n.hasRoleOrPerm,o.put("::historiales/nota-detalle",{nota_id:r.id}).then(function(a){return e.cambios=a.data.cambios,e.nota_detalle=a.data.nota},function(e){return i.warning("No se pudo traer el historial.","Problema")}),e.eliminarNota=function(){return o.delete("::notas/destroy/"+r.id).then(function(e){return i.success("Nota eliminada","Puede recargar y será creada de nuevo"),a.close("Eliminada")},function(e){return i.error("No se pudo eliminar nota.","Problema")})},e.ok=function(){return a.close(t)}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("DefinitivasPeriodosCtrl",["$scope","toastr","$http","$uibModal","$state","$rootScope","$filter","App","asignaturas_definitivas","AuthService","$timeout","EscalasValorativasServ",function(e,a,t,r,n,o,i,s,u,l,c,d){var p,f,m,g,_;for(l.verificar_acceso(),e.asignatura={},e.asignatura_id=n.params.asignatura_id,e.datos={},e.UNIDAD=e.USER.unidad_displayname,e.SUBUNIDAD=e.USER.subunidad_displayname,e.UNIDADES=e.USER.unidades_displayname,e.SUBUNIDADES=e.USER.subunidades_displayname,e.perfilPath=s.images+"perfil/",e.views=s.views,e.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.opts_picker={minDate:new Date("1/1/2017"),showWeeks:!1,startingDay:0},e.dato={asignatura:{}},e.ocultando_ausencias=!0,e.hasRoleOrPerm=l.hasRoleOrPerm,e.escala_maxima=d.escala_maxima(),e.selectAsignatura=function(a){var t,r,n;for(localStorage.asignatura_id_def=a.asignatura_id,e.dato.asignatura=a,t=0,r=(n=e.asignaturas).length;t<r;t++)n[t].active=!1;return a.active=!0},"Sin alumnos"===u&&(a.warning("No parece que tengas acceso"),n.go("panel")),e.asignaturas=u.data,f=0,e.USER.is_superuser&&(0===e.asignaturas.length?a.warning("Profesor no tiene asignaturas"):e.dato.asignatura.nombres_profesor=e.asignaturas[0].nombres_profesor),localStorage.asignatura_id_def&&(f=parseInt(localStorage.asignatura_id_def)),m=0,g=(_=e.asignaturas).length;m<g;m++)p=_[m],parseInt(p.asignatura_id)===parseInt(f)&&(e.dato.asignatura=p,e.selectAsignatura(e.dato.asignatura));e.cambiaNotaDef=function(r,n,o,i,s){if(!(n>e.escala_maxima.porc_final||"undefined"===n||void 0===n))return o?t.put("::definitivas_periodos/update",{nf_id:o,nota:n,num_periodo:i}).then(function(e){return r["manual_"+i]=1,a.success("Cambiada: "+n)},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+n,"",{timeOut:8e3})}):t.put("::definitivas_periodos/update",{alumno_id:r.alumno_id,nota:n,asignatura_id:e.dato.asignatura.asignatura_id,num_periodo:i}).then(function(e){return a.success("Creada: "+n),e=e.data[0],r["nf_id_"+i]=e.id,r["nfinal"+i+"_desactualizada"]=0,r["periodo_id"+i]=e.periodo_id,r["recuperada_"+i]=0,r["manual_"+i]=1},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+n,"",{timeOut:8e3})});a.error("No puede ser mayor de "+e.escala_maxima.porc_final,"NO guardada",{timeOut:8e3})},e.toggleNotaRecuperada=function(e,r,n,o){return t.put("::definitivas_periodos/toggle-recuperada",{nf_id:n,recuperada:r,num_periodo:o}).then(function(t){return r&&!e["manual_"+o]?(e["manual_"+o]=1,a.success("Indicará que es recuperada, así que también será manual.")):r?a.success("Recuperada"):a.success("No recuperada")},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la recuperación.",{timeOut:8e3})})},e.toggleNotaManual=function(e,r,n,o){return t.put("::definitivas_periodos/toggle-manual",{nf_id:n,manual:r,num_periodo:o}).then(function(t){return!r&&e["recuperada_"+o]?(e["recuperada_"+o]=0,a.success("Será automática y no recuperada.")):r?a.success("Nota manual."):a.success("Ahora la calculará el sistema.")},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la recuperación.",{timeOut:8e3})})},e.promedioTotalDef=function(a){var t;return t=(a.nota_final_per1+a.nota_final_per2+a.nota_final_per3+a.nota_final_per4)/4,a.nota_requerida=0,a.total_definit=0,t<e.nota_minima_aceptada&&(a.nota_requerida=i("number")(e.nota_minima_aceptada-t,0)),a.total_definit=parseFloat(i("number")(t,1)),a.total_definit},e.toggleAusencias=function(){return e.ocultando_ausencias=!e.ocultando_ausencias,localStorage.ocultando_ausencias=e.ocultando_ausencias},e.cambiaAusencia=function(r){var n,o,s,u,l,c,d,p,f;if(r.ausencias_count>r.ausencias.length){for(p=[],l=s=0,c=r.ausencias_count-r.ausencias.length-1;0<=c?s<=c:s>=c;l=0<=c?++s:--s)o={alumno_id:r.alumno_id,asignatura_id:e.asignatura_id,cantidad_ausencia:1},p.push(t.post("::ausencias/store",o).then(function(e){return e=e.data,r.ausencias.push(e)},function(e){return a.warning("No se pudo agregar ausencia.","Problema")}));return p}if(r.ausencias_count<r.ausencias.length){for(f=[],l=u=0,d=r.ausencias.length-r.ausencias_count-1;0<=d?u<=d:u>=d;l=0<=d?++u:--u)n=r.ausencias[r.ausencias.length-l-1].id,f.push(t.delete("::ausencias/destroy/"+n).then(function(e){return e=e.data,r.ausencias=i("filter")(r.ausencias,{id:"!"+e.id})},function(e){return a.warning("No se pudo quitar ausencia.","Problema")}));return f}},e.cambiaTardanza=function(r){var n,o,s,u,l,c,d,p,f;if(r.tardanzas_count>r.tardanzas.length){for(d=[],u=o=0,l=r.tardanzas_count-r.tardanzas.length-1;0<=l?o<=l:o>=l;u=0<=l?++o:--o)n={alumno_id:r.alumno_id,asignatura_id:e.asignatura_id,cantidad_tardanza:1},d.push(t.post("::ausencias/store",n).then(function(e){return e=e.data,r.tardanzas.push(e)},function(e){return a.warning("No se pudo agregar tardanza.","Problema")}));return d}if(r.tardanzas_count<r.tardanzas.length){for(p=[],u=s=0,c=r.tardanzas.length-r.tardanzas_count-1;0<=c?s<=c:s>=c;u=0<=c?++s:--s)f=r.tardanzas[r.tardanzas.length-u-1].id,p.push(t.delete("::ausencias/destroy/"+f).then(function(e){return e=e.data,r.tardanzas=i("filter")(r.tardanzas,{id:"!"+e.id})},function(e){return a.warning("No se pudo quitar tardanza.","Problema")}));return p}},e.clickAusenciaObject=function(a,t){return a.backup=a.fecha_hora,a.fecha_hora?a.fecha_hora=new Date(a.fecha_hora):a.fecha_hora=new Date,e.ausencia_edit=a,e.alumno_aus_tard_edit=t,a.isOpen=!a.isOpen},e.clickTardanzaObject=function(a,t){return a.backup=a.fecha_hora,a.fecha_hora?a.fecha_hora=new Date(a.fecha_hora):a.fecha_hora=new Date,e.tardanza_edit=a,e.alumno_aus_tard_edit=t,a.isOpen=!a.isOpen},e.guardarCambioAusencia=function(r){var n;return n={ausencia_id:r.id,fecha_hora:i("date")(r.fecha_hora,"yyyy-MM-dd HH:mm:ss")},t.put("::ausencias/guardar-cambios-ausencia",n).then(function(a){return a=a.data,alumno.tardanzas.push(a),e.ausencia_edit.isOpen=!1,e.tardanza_edit.isOpen=!1},function(e){return a.warning("No se pudo agregar tardanza.","Problema")})},e.cancelarCambioAusencia=function(e){return e.isOpen=!1},e.cancelarCambioTardanza=function(e){return e.isOpen=!1},e.eliminarAusencia=function(e,r){return t.delete("::ausencias/destroy/"+e.id).then(function(a){return a=a.data,r.ausencias=i("filter")(r.ausencias,{id:"!"+a.id}),e.isOpen=!1},function(e){return a.warning("No se pudo quitar ausencia.","Problema")})},e.eliminarTardanza=function(e,r){return t.delete("::ausencias/destroy/"+e.id).then(function(a){return a=a.data,r.tardanzas=i("filter")(r.tardanzas,{id:"!"+a.id}),e.isOpen=!1},function(e){return a.warning("No se pudo quitar tardanza.","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("NotasAlumnoCtrl",["$scope","toastr","$http","$uibModal","$state","alumnos","escalas","$rootScope","$filter","App","AuthService","Perfil","EscalasValorativasServ","$cookies",function(e,a,t,r,n,o,i,s,u,l,c,d,p,f){if(c.verificar_acceso(),e.hasRoleOrPerm=c.hasRoleOrPerm,"Sin alumnos"===!(o=o.data)&&(e.filtered_alumnos=o),e.perfilPath=l.images+"perfil/",e.views=l.views,e.datos={grupo:""},e.USER=d.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.escalas=i,e.config={solo_notas_perdidas:!0},e.hasRoleOrPerm(["alumno","acudiente"])?e.hasRoleOrPerm(["alumno","acudiente"])&&console.log(e.mis_acudidos):t.get("::grupos").then(function(a){return a=a.data,e.grupos=a}),p.escalas().then(function(a){return e.escalas=a,e.escala_maxima=p.escala_maxima()},function(e){return console.log("No se trajeron las escalas valorativas",e)}),e.verBoletin=(()=>{var t,r,o,i;for(r=0,o=(i=e.mis_acudidos).length;r<o;r++)if(!0===(t=i[r]).seleccionado){if(!t.pazysalvo)return void a.info("Lo sentimos. Debe estar a paz y salvo");f.putObject("requested_alumno",[{alumno_id:t.alumno_id,grupo_id:t.grupo_id}]),n.go("panel.boletin_acudiente",{periodo_a_calcular:e.USER.numero_periodo})}}),e.verMiBoletin=(()=>{if(e.USER.pazysalvo)return f.putObject("requested_alumno",[{alumno_id:e.USER.persona_id,grupo_id:e.USER.grupo_id}]),n.go("panel.boletin_acudiente",{periodo_a_calcular:e.USER.numero_periodo});a.info("Lo sentimos. Debe estar a paz y salvo")}),e.cambiaNotaComport=function(r,n){var o;if(e.datos.grupo.titular_id===e.USER.persona_id||e.hasRoleOrPerm("admin"))return r.id?(o=r.nota,t.put("::nota_comportamiento/update/"+r.id,{nota:r.nota}).then(function(e){return a.success("Nota cambiada: "+r.nota)},function(e){return a.error("No pudimos guardar la nota "+r.nota),r.nota=o})):((o={}).nota=r.nota,o.year_id=n.year_id,o.alumno_id=e.datos.selected_alumno.alumno_id,o.periodo_id=n.id,t.put("::nota_comportamiento/crear",o).then(function(e){var t;return t=e.data.nota_comport,r.id=t.id,r.year_id=t.year_id,r.nombres=t.nombres,r.apellidos=t.apellidos,r.alumno_id=t.alumno_id,r.foto_id=t.foto_id,r.foto_nombre=t.foto_nombre,r.sexo=t.sexo,r.periodo_id=t.periodo_id,a.success("Nota creada: "+r.nota)},function(e){return a.error("No pudimos guardar la nota "+o.nota),r=o}));a.warning("No eres el titular para cambiar comportamiento.")},e.verNotasAlumno=function(r){return r||(r=e.datos.selected_alumno.alumno_id),t.get("::notas/alumno/"+r).then(function(t){return(t=t.data)[0]?(e.alumno_traido=t[0],e.periodos_notas=t[0].periodos):(e.periodos_notas=void 0,a.warning("Sin matrícula este año."))},function(e){return a.warning("Lo sentimos, No se trajeron las notas")})},e.seleccionarAcudido=function(r){var n,o,i;if(r.pazysalvo){for(n=0,o=(i=e.mis_acudidos).length;n<o;n++)i[n].seleccionado=!1;return r.seleccionado=!0,t.get("::notas/alumno/"+r.alumno_id).then(function(t){return(t=t.data)[0]?(e.alumno_traido=t[0],e.periodos_notas=t[0].periodos):(e.periodos_notas=void 0,a.warning("Sin matrícula este año."))},function(e){return a.warning("Lo sentimos, No se trajeron las notas")})}a.info("Lo sentimos. Debe estar a paz y salvo")},n.params.alumno_id){if("Alumno"===e.USER.tipo)return void a.warning("No puedes ver otras notas");e.verNotasAlumno(n.params.alumno_id)}return"Alumno"===e.USER.tipo&&e.USER.pazysalvo&&e.verNotasAlumno(e.USER.persona_id),e.cambiaNotaDef=function(r,n,o,i){if(!(n>e.escala_maxima.porc_final||"undefined"===n||void 0===n))return o?t.put("::definitivas_periodos/update",{nf_id:o,nota:n}).then(function(e){return r.manual||(r.manual=1),a.success("Cambiada: "+n)},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+n,"",{timeOut:8e3})}):t.put("::definitivas_periodos/update",{alumno_id:e.alumno_traido.alumno_id,nota:n,asignatura_id:r.asignatura_id,num_periodo:i}).then(function(e){return a.success("Creada: "+n),e=e.data[0],r.nf_id=e.id,r.recuperada=0,r.manual=1},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+n,"",{timeOut:8e3})});a.error("No puede ser mayor de "+e.escala_maxima.porc_final,"NO guardada",{timeOut:8e3})},e.toggleNotaFinalRecuperada=function(e,r,n){return t.put("::definitivas_periodos/toggle-recuperada",{nf_id:n,recuperada:r}).then(function(t){return r&&!e.manual?(e.manual=1,a.success("Indicará que es recuperada, así que también será manual.")):r?a.success("Recuperada"):a.success("No recuperada")},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos cambiar.","",{timeOut:8e3})})},e.toggleNotaFinalManual=function(e,r,n){return t.put("::definitivas_periodos/toggle-manual",{nf_id:n,manual:r}).then(function(t){return!r&&e.nota_final.recuperada?(e.nota_final.recuperada=!1,a.success("Será automática y no recuperada.")):r?a.success("Nota manual."):a.success("Ahora la calculará el sistema.")},function(e){return 400===e.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos cambiar.","",{timeOut:8e3})})},e.cambiaNota=function(e,r){return t.put("::notas/update/"+e.id,{nota:e.nota}).then(function(t){return t=t.data,a.success("Cambiada: "+e.nota)},function(t){return 400===t.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+e.nota,"",{timeOut:8e3})})},e.selectGrupo=function(a){return a?e.filtered_alumnos=u("filter")(o,{grupo_id:a.id},!0):(e.filtered_alumnos=o,$cookieStore.put("requested_alumno","")),e.datos.selected_alumno=""}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NotasPerdidasProfesorEditCtrl",["$scope","toastr","$http","$uibModal","$state","$filter","App","AuthService",function(e,a,t,r,n,o,i,s){s.verificar_acceso(),e.hasRoleOrPerm=s.hasRoleOrPerm,e.datos={},e.grupos=[],e.profesores=[],e.perfilPath=i.images+"perfil/",e.views=i.views,s.hasRoleOrPerm(["profesor"])?t.put("::notas-perdidas/profesor-grupos",{profesor_id:e.USER.persona_id,periodo_a_calcular:e.USER.numero_periodo}).then(function(a){return e.grupos=a.data},function(e){return a.error("No se trajeron las notas")}):t.get("::contratos").then(function(a){return e.profesores=a.data},function(e){return a.error("No se trajeron los profesores")}),e.verNotasPerdidasProfesor=function(){return e.datos.profesor?t.put("::notas-perdidas/profesor-grupos",{profesor_id:e.datos.profesor.profesor_id,periodo_a_calcular:10}).then(function(a){return e.grupos=a.data},function(e){return a.error("No se trajeron las notas")}):a.warning("Debes elegir profesor")},e.cambiaNota=function(e){return t.put("::notas/update/"+e.nota_id,{nota:e.nota,num_periodo:e.numero_periodo}).then(function(t){return t=t.data,a.success("Cambiada: "+e.nota)},function(t){return 400===t.status?a.warning("Parece que no tienes permisos","Lo sentimos"):a.error("No pudimos guardar la nota "+e.nota,"",{timeOut:8e3})})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CumpleanosPorMesesCtrl",["$scope","App","Perfil","meses_cumple","$state","$filter",function(e,a,t,r,n,o){var i,s,u,l,c,d,p,f;for(e.meses_cumple=r.data,e.tamanio_letra=15,e.USER=t.User(),e.perfilPath=a.images+"perfil/",e.alinear="center",e.aumentar_letra=function(){return e.tamanio_letra=e.tamanio_letra+2},e.disminuir_letra=function(){return e.tamanio_letra=e.tamanio_letra-2},e.setAlinear=function(a){return e.alinear=a},e.establecerColumnas=function(e){if(!0!==e.apretado)return e.apretado=!0,e.alumnos_temp=e.alumnos.splice(parseInt(e.alumnos.length/2),e.alumnos.length)},e.setAlinear2=function(a){return e.alinear2=a},e.establecerColumnas2=function(e){return e.apretado=!1,e.alumnos=e.alumnos.concat(e.alumnos_temp),e.alumnos_temp=[]},s=0,l=(p=e.meses_cumple).length;s<l;s++){for(u=0,c=(f=(d=p[s]).alumnos).length;u<c;u++)(i=f[u]).day_nac=i.fecha_nac.substr(8,2);d.alumnos=o("orderBy")(d.alumnos,"day_nac"),d.alumnos_temp=[]}return e.quitar_mes=function(e){return e.quitado=!0},e.$emit("cambia_descripcion","Cumpleaños por meses ")}]).directive("draggable",["$document",function(e){return function(a,t,r){var n,o,i,s,u,l,c;return[l,c,n,s,u]=[null,null,null,null,null],o=function(e){return c=e.pageY-u,(l=e.pageX-s)<0&&(l=0),c<0&&(c=0),a.$apply(function(){return a.$parent.events.push({mousemove:{x:l,y:c,pageX:e.pageX,pageY:e.pageY,startY:u,startX:s}})}),n.css({top:c+"px",left:l+"px"})},i=function(){return e.unbind("mousemove",o),e.unbind("mouseup",i),a.elem&&(a.elem.top=c,a.elem.left=l),a.$apply(function(){return a.$parent.events.push({mouseup:{x:l,y:c}})})},s=0,u=0,a.elem&&(l=a.elem.left,c=a.elem.top),n=null,t.css({position:"relative",cursor:"pointer"}),t.on("mousedown",function(t){if(1===t.which)return t.preventDefault(),n=r.$$element.parent(),a.$apply(function(){return a.$parent.events=[{mousedown:{x:l,y:c,pageX:t.pageX,pageY:t.pageY,startY:u,startX:s}}]}),s=t.pageX-l,u=t.pageY-c,e.on("mousemove",o),e.on("mouseup",i)})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ComportamientoCtrl",["$scope","$filter","$state","comportamiento","$uibModal","App","$http","AuthService","toastr","EscalasValorativasServ",function(e,a,t,r,n,o,i,s,u,l){return s.verificar_acceso(),e.perfilPath=o.images+"perfil/",e.profesor_id=localStorage.profesor_id,e.frases=r[0],e.alumnos=r[1],e.grupo=r[2],e.hasRoleOrPerm=s.hasRoleOrPerm,e.tipos=[{tipo_frase:"Todas"},{tipo_frase:"Debilidad"},{tipo_frase:"Amenaza"},{tipo_frase:"Oportunidad"},{tipo_frase:"Fortaleza"}],l.escalas().then(function(a){return e.escalas=a,e.escala_maxima=l.escala_maxima()},function(e){return console.log("No se trajeron las escalas valorativas",e)}),e.addFrase=function(e){var a;if(e.agregando_frase=!0,e.newfrase)return a={comportamiento_id:e.nota.id,frase_id:e.newfrase.id},i.post("::definiciones_comportamiento/store",a).then(function(a){return u.success("Frase agregada con éxito"),e.newfrase.definicion_id=a.data.id,e.definiciones.push(e.newfrase),e.newfrase=null,e.agregando_frase=!1},function(a){return u.error("No se pudo agregar la frase","Problema"),e.agregando_frase=!1});u.warning("Debe seleccionar frase")},e.addFraseEscrita=function(e){var a;if(e.agregando_frase=!0,""!==e.newfrase_escrita)return a={comportamiento_id:e.nota.id,frase:e.newfrase_escrita},i.post("::definiciones_comportamiento/store-escrita",a).then(function(a){return u.success("Frase agregada con éxito"),e.newfrase_escrita="",e.definiciones.push(a.data),e.agregando_frase=!1},function(a){return u.error("No se pudo agregar la frase","Problema"),e.agregando_frase=!1});u.warning("Debe escribir la frase")},e.cambiaNota=function(e){var a;return a=e.nota,i.put("::nota_comportamiento/update/"+e.id,{nota:e.nota}).then(function(a){return u.success("Nota cambiada: "+e.nota)},function(t){return u.error("No pudimos guardar la nota "+e.nota),e.nota=a})},e.quitarFrase=function(e,t){var r;return r=e.definicion_id?e.definicion_id:e.id,i.delete("::definiciones_comportamiento/destroy/"+r).then(function(n){return u.success("Definicion quitada"),e.definicion_id?t.definiciones=a("filter")(t.definiciones,{definicion_id:"!"+r}):t.definiciones=a("filter")(t.definiciones,{id:"!"+r})},function(e){return u.error("No pudimos quitar frase","Problema")})}}]).filter("porTipoFrase",[function(){return function(e,a){var t,r,n,o;if("Todas"===a||void 0===a)return e;for(o=[],r=0,n=e.length;r<n;r++)a===(t=e[r]).tipo_frase&&o.push(t);return o}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(e,a,t){e.state("panel.actividades",{url:"^/actividades?grupo_id&asign_id&compartidas",params:{grupo_id:null,asign_id:null,compartidas:null},views:{maincontent:{templateUrl:`${a.views}actividades/actividades.tpl.html`,controller:"ActividadesCtrl",resolve:{datos:["$q","$http","$stateParams",function(e,a,t){var r,n;return r=e.defer(),t.compartidas?a.put("::actividades/compartidas").then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}):(n={grupo_id:t.grupo_id,asign_id:t.asign_id},a.put("::actividades/datos",n).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)})),r.promise}]}},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Actividades"}]}}},data:{displayName:"Actividades",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Actividades - MyVc"}}),e.state("panel.respuestas",{url:"^/respuestas?actividad_id",params:{actividad_id:null},views:{maincontent:{templateUrl:`${a.views}actividades/respuestas.tpl.html`,controller:"RespuestasCtrl",resolve:{datos:["$q","$http","$stateParams",function(e,a,t){var r,n;return r=e.defer(),n={actividad_id:t.actividad_id},a.put("::respuestas/actividad",n).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise}]}},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Respuestas"}]}}},data:{displayName:"Respuestas",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Respuestas - MyVc"}}),e.state("panel.mis_actividades",{url:"^/mis-actividades?alumno_id&asign_id",params:{alumno_id:null,asign_id:null},views:{maincontent:{templateUrl:`${a.views}actividades/misActividades.tpl.html`,controller:"MisActividadesCtrl",resolve:{datos:["$q","$http","$stateParams",function(e,a,t){var r,n;return r=e.defer(),n={alumno_id:t.alumno_id,asign_id:t.asign_id},a.put("::mis-actividades/datos",n).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise}]}},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Mis actividades"}]}}},data:{displayName:"Mis actividades",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Mis actividades - MyVc"}}),e.state("panel.mi_actividad",{url:"^/mi-actividad?actividad_id",params:{actividad_id:null},views:{maincontent:{templateUrl:`${a.views}actividades/miActividad.tpl.html`,controller:"MiActividadCtrl",resolve:{datos:["$q","$http","$stateParams",function(e,a,t){var r,n;return r=e.defer(),n={actividad_id:t.actividad_id},a.put("::mis-actividades/mi-actividad",n).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise}]}},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Actividad"}]}}},data:{displayName:"Actividad",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Actividad - MyVc"}}).state("panel.editar_actividad",{url:"^/editar-actividad?actividad_id",params:{actividad_id:null},views:{maincontent:{templateUrl:`${a.views}actividades/editarActividad.tpl.html`,controller:"EditarActividadCtrl",resolve:{datos:["$q","$http","$stateParams",function(e,a,t){var r;return r=e.defer(),0,t.actividad_id?t.actividad_id:localStorage.pregunta_edit.actividad_id,a.put("::actividades/edicion",{actividad_id:t.actividad_id}).then(function(e){var a,t,n,o,i;if(localStorage.pregunta_edit)for(a=0,t=(i=e.data.actividad.preguntas).length;a<t;a++)n=i[a],o=JSON.parse(localStorage.pregunta_edit),n.id===o.id&&(localStorage.pregunta_edit=JSON.stringify(n));return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise}]}},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar actividad"}]}}},data:{displayName:"Editar actividad",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Editar actividad - MyVc"}}).state("panel.editar_actividad.pregunta",{url:"/pregunta?pregunta_id",views:{preguntacontent:{templateUrl:`${a.views}actividades/editarPregunta.tpl.html`,controller:"EditarPreguntaCtrl",resolve:{datos:["$q","$http","$stateParams","$location",function(e,a,t,r){var n,o;return n=e.defer(),t.pregunta_id?a.put("::preguntas/edicion",{pregunta_id:t.pregunta_id}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e)}):localStorage.pregunta_edit?(o=JSON.parse(localStorage.pregunta_edit),n.resolve(o)):(console.log("No se ha provisto id ni pregunta"),n.reject("No se ha provisto id ni pregunta")),n.promise}]}},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Pregunta"}]}}},data:{displayName:"Pregunta",icon_fa:"fa fa-question",pageTitle:"Pregunta - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ActividadesCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(e,a,t,r,n,o,i,s,u,l,c){s.verificar_acceso(),e.grupo_id=l.grupo_id,e.asign_id=l.asign_id,e.compartidas=l.compartidas,e.grupos=u.grupos,e.otras_asignaturas=u.otras_asignaturas,e.mis_asignaturas=u.mis_asignaturas,e.$state=r,e.actv_alumnos=u.actv_alumnos,e.actv_profes=u.actv_profes,e.actv_acudi=u.actv_acudi,e.actv_x_respon=u.actv_x_respon,e.perfilPath=a.images+"perfil/",e.views=a.views,t.menucompacto=!0,l.asign_id&&(e.grupo_id=u.grupo_id),e.crear=function(e){return n.post("::actividades/crear",{asignatura_id:e}).then(function(e){return e=e.data,c.success("Actividad creada","Ahora a editar"),r.go("panel.editar_actividad",{actividad_id:e.id})},function(e){return c.error("No se pudo crear actividad.","Error")})},e.eliminarActividad=function(e,t){return o.open({templateUrl:a.views+"actividades/removeActividad.tpl.html",controller:"RemoveActividadCtrl",resolve:{actividad:function(){return e}}}).result.then(function(e){return t.actividades=i("filter")(t.actividades,{id:"!"+e.id})})}}]).controller("RemoveActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(e,a,t,r,n){return e.actividad=t,e.ok=function(){return r.delete("::actividades/destroy/"+t.id).then(function(e){return n.success("Actividad enviada a la papelera.","Eliminado")},function(e){return n.warning("No se pudo enviar a la papelera.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("EditarActividadCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","toastr","$stateParams","$timeout","$location","$anchorScroll",function(e,a,t,r,n,o,i,s,u,l,c,d,p,f){var m,g,_,h,v,b,y,w,C;for(s.verificar_acceso(),e.actividad_id=c.actividad_id,e.datos={selected_grupos:[]},e.mostrando_detalles_actividad=!0,e.perfilPath=a.images+"perfil/",e.views=a.views,e.actividad=u.actividad,e.grupos=u.grupos,e.compartidas=u.compartidas,h=0,b=(w=e.compartidas).length;h<b;h++)for(g=w[h],v=0,y=(C=e.grupos).length;v<y;v++)(_=C[v]).id===g.grupo_id&&e.datos.selected_grupos.push(_);e.actividad.finaliza_at?e.actividad.finaliza_at=new Date(e.actividad.finaliza_at):e.actividad.finaliza_at=new Date,e.actividad.inicia_at?e.actividad.inicia_at=new Date(e.actividad.inicia_at):e.actividad.inicia_at=new Date,e.actividad.para_alumnos=!!e.actividad.para_alumnos,e.actividad.para_profesores=!!e.actividad.para_profesores,e.actividad.para_acudientes=!!e.actividad.para_acudientes,e.editor_options={allowedContent:!0,entities:!1},e.restar=function(a){if(e.actividad[a]>0)return e.actividad[a]=e.actividad[a]-1},e.sumar=function(a){if(e.actividad[a]<1e3)return e.actividad[a]=parseInt(e.actividad[a])+1},e.onEditorReady=function(){return console.log("Editor listo")},m=function(e){return e<10&&(e="0"+e),e},e.ftime_to_string=function(e){var a,t,r;return a=m(e.getHours()),t=m(e.getMinutes()),r=m(e.getSeconds()),e.yyyymmdd()+"T"+a+":"+t+":"+r+".000Z"},e.guardarActividad=function(a){var t,o;return t=e.ftime_to_string(e.actividad.finaliza_at),e.actividad.finaliza_at_str=t,o=e.ftime_to_string(e.actividad.inicia_at),e.actividad.inicia_at_str=o,n.put("::actividades/guardar",e.actividad).then(function(t){if(t=t.data,l.success("Cambios guardados"),a)return r.go("panel.actividades",{asign_id:e.actividad.asignatura_id})},function(e){return l.error("No se pudo guardar cambios")})},e.editar_pregunta=function(a){return r.go("panel.editar_actividad",{actividad_id:e.actividad.id}),localStorage.pregunta_edit=JSON.stringify(a),d(function(){return r.go("panel.editar_actividad.pregunta")})},e.crearPregunta=function(){return u={actividad_id:e.actividad_id},n.post("::preguntas/crear",u).then(function(a){return a=a.data,e.actividad.preguntas.push(a),e.editar_pregunta(a)},function(e){return l.error("No se pudo crear pregunta")})},e.cambios_pregunta_guardados=function(a){return e.actividad.preguntas=i("filter")(e.actividad.preguntas,{id:"!"+a.id}),e.actividad.preguntas.push(a),e.actividad.preguntas=i("orderBy")(e.actividad.preguntas,"orden")},e.duplicar_pregunta=function(a){return a.orden=e.actividad.preguntas.length,n.put("::preguntas/duplicar-pregunta",a).then(function(a){return a=a.data,l.success("Pregunta duplicada"),e.actividad.preguntas.push(a),d(function(){return p.hash("end-preguntas"),f()})},function(e){return l.error("No se pudo duplicar")})},e.on_sort_preguntas=function(e,a,t,r,o){var i,s,c,d,p,f;for(f=[],s=c=0,d=a.length;c<d;s=++c)(p=a[s]).orden=s,(i={})[""+p.id]=s,f.push(i);return u={sortHash:f},n.put("::preguntas/update-orden",u).then(function(e){return!0},function(e){return l.warning("No se pudo ordenar","Problema"),!1})},e.para_alumnos_toggle=function(a){return n.put("::actividades/para-alumnos-toggle",{actividad_id:e.actividad.id,para_alumnos:a}).then(function(e){return a?l.success("Debe haber al menos un grupo seleccionado"):l.info("No la realizarán los alumnos")},function(e){return l.warning("No se pudo guardar cambio","Problema"),!1})},e.para_profesores_toggle=function(a){return n.put("::actividades/para-profesores-toggle",{actividad_id:e.actividad.id,para_profesores:a}).then(function(e){return a?l.success("La realizarán los docentes"):l.info("No la realizarán los docentes")},function(e){return l.warning("No se pudo guardar cambio","Problema"),!1})},e.para_acudientes_toggle=function(a){return n.put("::actividades/para-acudientes-toggle",{actividad_id:e.actividad.id,para_acudientes:a}).then(function(e){return a?l.success("La realizarán los acudientes"):l.info("No la realizarán los acudientes")},function(e){return l.warning("No se pudo guardar cambio","Problema"),!1})},e.toggle_compartida=function(a){return n.put("::actividades/set-compartida",{actividad_id:e.actividad.id,compartida:a}).then(function(e){return l.success("Compartida: "+a)},function(e){return l.warning("No se pudo establecer compartida","Problema"),!1})},e.select_grupo_compartido=function(a){return n.put("::actividades/insert-grupo-compartido",{actividad_id:e.actividad.id,grupo_id:a.id}).then(function(e){return l.success("Grupo agregado")},function(e){return l.warning("No se pudo agregar grupo","Problema"),!1})},e.quitando_grupo_compartido=function(a){return n.put("::actividades/quitando-grupo-compartido",{actividad_id:e.actividad.id,grupo_id:a.id}).then(function(e){return l.success("Grupo quitado")},function(e){return l.warning("No se pudo quitar grupo","Problema"),!1})},e.ver_preguntas=function(){return e.mostrando_preguntas=!0,e.mostrando_detalles_actividad=!1},e.ver_detalles_actividad=function(){return e.mostrando_detalles_actividad=!0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MisActividadesCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(e,a,t,r,n,o,i,s,u,l,c){var d,p,f,m;if(s.verificar_acceso(),e.grupo_id=l.grupo_id,e.asign_id=l.asign_id,e.grupos=u.grupos,e.otras_asignaturas=u.otras_asignaturas,e.mis_asignaturas=u.mis_asignaturas,e.perfilPath=a.images+"perfil/",e.views=a.views,t.menucompacto=!0,l.asign_id)for(p=0,f=(m=e.mis_asignaturas).length;p<f;p++)(d=m[p]).asignatura_id===parseInt(e.asign_id)&&(e.actividades=d.actividades,e.asignatura=d);e.crear=function(e){return n.post("::actividades/crear",{asignatura_id:e}).then(function(e){return e=e.data,c.success("Actividad creada","Ahora a editar"),r.go("panel.editar_actividad",{actividad_id:e.id})},function(e){return c.error("No se pudo crear actividad.","Error")})},e.eliminarActividad=function(e,t){return o.open({templateUrl:a.views+"actividades/removeActividad.tpl.html",controller:"RemoveActividadCtrl",resolve:{actividad:function(){return e}}}).result.then(function(e){return t.actividades=i("filter")(t.actividades,{id:"!"+e.id})})}}]).controller("RemoveActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(e,a,t,r,n){return e.actividad=t,e.ok=function(){return r.delete("::actividades/destroy/"+t.id).then(function(e){return n.success("Actividad enviada a la papelera.","Eliminado")},function(e){return n.warning("No se pudo enviar a la papelera.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MiActividadCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(e,a,t,r,n,o,i,s,u,l,c){s.verificar_acceso(),e.actividad_id=l.actividad_id,e.perfilPath=a.images+"perfil/",e.views=a.views,e.actividad=u.actividad,e.actividad_resuelta=u.actividad_resuelta,t.menucompacto=!0,e.seleccionar_opcion=function(a,t){var r,o,i;for(u={actividad_resuelta_id:e.actividad_resuelta.id,pregunta_id:a.id,tipo_pregunta:a.tipo_pregunta,opcion_id:t.id,opcion_cuadricula_id:null},e.actividad.one_by_one||n.put("::mis-actividades/seleccionar-opcion",u).then(function(){return c.success("Selección guardada")},function(){return c.error("No se pudo guardar selección")}),r=0,o=(i=a.opciones).length;r<o;r++)i[r].seleccionada=!1;return t.seleccionada=!0},e.finalizar_actividad=function(){return o.open({templateUrl:a.views+"actividades/finalizarActividad.tpl.html",controller:"FinalizarActividadCtrl",resolve:{actividad:function(){return e.actividad}}}).result.then(function(a){return r.go("panel.mis_actividades",{alumno_id:e.USER.persona_id})})}}]).controller("FinalizarActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(e,a,t,r,n){return e.actividad=t,e.ok=function(){return r.put("::mis-actividades/finalizar-actividad",{actividad_resuelta_id:t.actividad_resuelta_id}).then(function(){return n.info("Has finalizado actividad"),a.close(t)},function(){return n.error("No se pudo guardar selección")})},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("EditarPreguntaCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","toastr","$stateParams","$location","$anchorScroll","$timeout",function(e,a,t,r,n,o,i,s,u,l,c,d,p,f){s.verificar_acceso(),e.pregunta_id=c.pregunta_id,e.perfilPath=a.images+"perfil/",e.views=a.views,e.pregunta=u,e.editor_options={allowedContent:!0,entities:!1},f(function(){return d.hash("scroll-pregunta"),p()}),e.onEditorReady=function(){return console.log("Editor listo")},e.guardar_cambios=function(a){return n.put("::preguntas/guardar",e.pregunta).then(function(t){if(t=t.data,e.$parent.cambios_pregunta_guardados(e.pregunta),l.success("Cambios guardados"),a)return r.go("panel.editar_actividad",{actividad_id:e.pregunta.actividad_id})},function(e){return l.error("No se pudo guardar cambios")})},e.restar=function(a){if(e.pregunta[a]>0)return e.pregunta[a]=e.pregunta[a]-1},e.sumar=function(a){if(e.pregunta[a]<1e3)return e.pregunta[a]=parseInt(e.pregunta[a])+1},e.cancelar=function(){return r.go("panel.editar_actividad",{actividad_id:e.pregunta.actividad_id})},e.add_opcion=function(){var a,t;return t={definicion:"Opcion "+((a=e.pregunta.opciones.length)+1),orden:a,pregunta_id:e.pregunta.id,is_correct:!1},n.put("::opciones/add-opcion",t).then(function(a){return a=a.data,l.success("Opción agregada"),e.pregunta.opciones.push(a)},function(e){return l.error("No se pudo agregar")})},e.toggle_opcion_otra=function(a){return n.put("::preguntas/toggle-opcion-otra",{id:e.pregunta.id,opcion_otra:a}).then(function(t){return t=t.data,l.success("Opción OTRA agregada"),e.pregunta.opcion_otra=a},function(e){return l.error("No se pudo agregar OTRA")})},e.setOpcionCorrect=function(a){return n.put("::opciones/set-opcion-correct",a).then(function(t){var r,n,o,i,s;for(t=t.data,s=[],r=0,n=(i=e.pregunta.opciones).length;r<n;r++)o=i[r],s.push(o.is_correct=a===o);return s},function(e){return l.error("No se pudo establecer correcta")})},e.eliminarOpcion=function(a){return n.delete("::opciones/destroy/"+a.id).then(function(t){return t=t.data,l.success("Opción eliminada"),e.pregunta.opciones=i("filter")(e.pregunta.opciones,{id:"!"+a.id})},function(e){return l.error("No se pudo establecer correcta")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("RespuestasCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(e,a,t,r,n,o,i,s,u,l,c){var d,p,f,m,g,_,h,v,b,y,w;for(s.verificar_acceso(),e.actividad_id=l.actividad_id,e.perfilPath=a.images+"perfil/",e.views=a.views,e.plantilla=e.views+"notas/popoverAlumnoInfo.tpl.html?"+Math.random().toString(36).slice(2),e.actividad=u.actividad,e.grupos=u.grupos,t.menucompacto=!0,e.alumnos_unidos=[],p=0,g=(b=e.grupos).length;p<g;p++)for(f=0,_=(y=b[p].alumnos).length;f<_;f++)d=y[f],e.alumnos_unidos.push(d);for(e.cantOpcMaxi=0,m=0,h=(w=e.actividad.preguntas).length;m<h;m++)v=w[m],e.cantOpcMaxi=v.opciones.length>e.cantOpcMaxi?v.opciones.length:e.cantOpcMaxi;e.getOpcionesMaximas=function(){return new Array(e.cantOpcMaxi)},e.finalizar_actividad=function(){return o.open({templateUrl:a.views+"actividades/finalizarActividad.tpl.html",controller:"FinalizarActividadCtrl",resolve:{actividad:function(){return e.actividad}}}).result.then(function(a){return r.go("panel.mis_actividades",{alumno_id:e.USER.persona_id})})}}]).controller("FinalizarActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(e,a,t,r,n){return e.actividad=t,e.ok=function(){return r.put("::mis-actividades/finalizar-actividad",{actividad_resuelta_id:t.actividad_resuelta_id}).then(function(){return n.info("Has finalizado actividad"),a.close(t)},function(){return n.error("No se pudo guardar selección")})},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider",function(e){e.state("panel.profesores.nuevo",{url:"/nuevo",views:{edit_profesor:{templateUrl:"==profesores/profesoresNew.tpl.html",controller:"ProfesoresNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo profesor"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Profesor nuevo - MyVc"}}).state("panel.profesores.editar",{url:"/editar/:profe_id",views:{edit_profesor:{templateUrl:"==profesores/profesoresEdit.tpl.html",controller:"ProfesoresEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar profesor - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ProfesoresCtrl",["$scope","$uibModal","toastr","uiGridConstants","$http","$state","App","$filter",function(e,a,t,r,n,o,i,s){var u,l,c,d,p,f;e.gridScope=e,e.current_year=e.USER.year_id,e.views=i.views,e.perfilPath=i.images+"perfil/",e.editar=function(e){return o.go("panel.profesores.editar",{profe_id:e.id})},e.eliminar=function(t){return a.open({templateUrl:"==profesores/removeProfesor.tpl.html",controller:"RemoveProfesorCtrl",resolve:{profesor:function(){return t}}}).result.then(function(a){return e.gridOptions.data=s("filter")(e.gridOptions.data,{alumno_id:"!"+a.alumno_id})})},l='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',c='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',d="==profesores/botonContratar.tpl.html",f="==directives/botonesResetPassword.tpl.html",u="==profesores/botonEditUsername.tpl.html",e.gridOptions={enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Todos los docentes - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",displayName:"Id",width:50,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:l+c,enableCellEdit:!1},{name:"contrato",displayName:"Contrato",width:75,enableSorting:!1,enableFiltering:!1,cellTemplate:d,enableCellEdit:!1},{field:"nombres",enableHiding:!1,minWidth:100},{field:"apellidos",minWidth:100},{field:"sexo",maxWidth:40},{field:"fecha_nac",displayName:"Nacimiento",minWidth:100},{field:"username",filter:{condition:r.filter.CONTAINS},displayName:"Usuario",cellTemplate:f,editableCellTemplate:u,minWidth:135},{field:"email_usu",displayName:"Email",minWidth:100},{field:"celular",minWidth:100}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,r,o,i){return o!==i&&n.put("::profesores/update/"+a.id,a).then(function(e){return t.success("Profesor actualizado con éxito","Actualizado")},function(e){return t.error("Cambio no guardado","Error")}),e.$apply()})}},n.get("::profesores").then(function(a){return e.gridOptions.data=a.data}),e.$on("profesorcreado",function(a,t){return e.gridOptions.data.push(t)}),e.quitarContrato=function(a){return n.delete("::contratos/destroy/"+a).then(function(r){return t.success("Quitado de este año "+e.USER.year),e.gridCurrentOptions.data=s("filter")(e.gridCurrentOptions.data,{contrato_id:"!"+a}),s("filter")(e.gridOptions.data,{contrato_id:a})[0].year_id=null},function(e){return t.error("No se pudo agregar el profesor al presente año","Problema")})},e.contratar=function(a){return n.post("::contratos",{profesor_id:a.id}).then(function(r){var n;return t.success(a.nombres+" contratado para este año"),r=r.data[0],e.gridCurrentOptions.data.push(r),(n=s("filter")(e.gridOptions.data,{id:r.profesor_id})[0]).year_id=e.current_year,n.contrato_id=r.contrato_id},function(e){return e.data.contratado?t.warning("Este profesor ya está contratado"):t.error("No se pudo agregar el profesor al presente año","Problema")})},p='<a uib-tooltip="Quitar de año actual" tooltip-placement="left" class="btn btn-default btn-xs shiny danger" ng-click="grid.appScope.quitarContrato(row.entity.contrato_id)"><i class="fa fa-times "></i></a>',e.gridCurrentOptions={enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Docentes contratados - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"profesor_id",displayName:"Id",width:50,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:p,enableCellEdit:!1},{field:"nombres",enableHiding:!1,minWidth:100},{field:"apellidos",minWidth:100},{field:"sexo",width:40},{field:"fecha_nac",displayName:"Nacimiento",minWidth:100},{field:"username",filter:{condition:r.filter.CONTAINS},displayName:"Usuario",cellTemplate:f,editableCellTemplate:u,minWidth:135},{field:"email_usu",displayName:"Email",minWidth:100},{field:"celular",minWidth:100}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,r,o,i){return o!==i&&n.put("::profesores/update/"+a.profesor_id,a).then(function(e){return t.success("Profesor actualizado con éxito","Actualizado")},function(e){return t.error("Cambio no guardado","Error")}),e.$apply()})}},n.get("::contratos").then(function(a){return e.gridCurrentOptions.data=a.data},function(e){return t.error("No se trajeron los profesores contratados")}),e.cambiaUsernameCheck=function(a){return e.verificandoUsername=!0,n.put("::users/usernames-check",{texto:a}).then(function(a){return e.username_match=a.data.usernames,e.verificandoUsername=!1,e.username_match.map(function(e){return e.username})})},e.resetPass=function(e){return a.open({templateUrl:i.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return e}}}).result.then(function(e){})}}]).controller("RemoveProfesorCtrl",["$scope","$uibModalInstance","profesor","$http","toastr",function(e,a,t,r,n){return e.profesor=t,e.ok=function(){return r.delete("::profesores/destroy/"+t.id).then(function(e){return n.success("Profesor enviado a la papelera.","Eliminado")},function(e){return n.warning("No se pudo enviar a la papelera.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ProfesoresNewCtrl",["$scope","$http","toastr","$filter",function(e,a,t,r){e.profesor={sexo:"M",fecha_nac:new Date("1990-01-01")},e.estados_civiles=[{estado_civil:"Soltero"},{estado_civil:"Casado"},{estado_civil:"Divorciado"},{estado_civil:"Viudo"}],a.get("::paises").then(function(a){return e.paises=a.data}),a.get("::tiposdocumento").then(function(a){return e.tipos_doc=a.data}),e.crear=function(){return e.profesor.fecha_nac=r("date")(e.profesor.fecha_nac,"yyyy-MM-dd"),a.post("::profesores/store",e.profesor).then(function(a){return t.success("Profesor creado"),e.$emit("profesorcreado",a.data)},function(e){return t.error("Profesor NO creado","Problema")})},e.paisNacSelect=function(t,r){return a.get("::ciudades/departamentos/"+t.id).then(function(a){if(e.departamentosNac=a.data,void 0===e.profesor.pais_doc)return e.profesor.pais_doc=t,e.paisSelecionado(t)})},e.departNacSelect=function(t){return a.get("::ciudades/por-departamento/"+t.departamento).then(function(a){if(e.ciudadesNac=a.data,void 0===e.profesor.departamento_doc)return e.profesor.departamento_doc=t,e.departSeleccionado(t)})},e.paisSelecionado=function(t,r){return a.get("::ciudades/departamentos/"+t.id).then(function(a){return e.departamentos=a.data})},e.departSeleccionado=function(t){return a.get("::ciudades/por-departamento/"+t.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yy"}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ProfesoresEditCtrl",["$scope","toastr","$http","$state","$filter",function(e,a,t,r,n){e.data={},e.profesor={},e.paises=[{id:1,pais:"COLOMBIA"}],e.tipos_doc=[{id:1,tipo:"CC"}],e.departamentos=[{id:1,departamento:"ANTIOQUIA"}],e.ciudades=[{id:1,ciudad:"MEDELLÍN"}],e.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],e.estados_civiles=[{estado_civil:"Soltero"},{estado_civil:"Casado"},{estado_civil:"Divorciado"},{estado_civil:"Viudo"}],t.get("::profesores/show/"+r.params.profe_id).then(function(a){var r,n,o,i;if(e.profesor=a.data[0],e.profesor.fecha_nac=new Date(e.profesor.fecha_nac),e.profesor.password="",e.profesor.password2="",e.profesor.estado_civil)for(n=0,o=(i=e.estados_civiles).length;n<o;n++)(r=i[n]).estado_civil===e.profesor.estado_civil&&(e.profesor.estado_civil=r);else e.profesor.estado_civil=e.estados_civiles[0];return null===e.profesor.ciudad_nac?(e.profesor.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},e.paisNacSelect(e.profesor.pais_nac,e.profesor.pais_nac)):t.get("::ciudades/datosciudad/"+e.profesor.ciudad_nac).then(function(a){var t,r,n,o,i,s,u,l,c,d,p,f,m;for(e.paises=a.data.paises,e.departamentosNac=a.data.departamentos,e.ciudadesNac=a.data.ciudades,n=0,s=(d=e.paises).length;n<s;n++)(c=d[n]).id===a.data.pais.id&&(e.profesor.pais_nac=c);for(o=0,u=(p=e.departamentosNac).length;o<u;o++)(r=p[o]).departamento===a.data.departamento.departamento&&(e.profesor.departamento_nac=r);for(m=[],i=0,l=(f=e.ciudadesNac).length;i<l;i++)(t=f[i]).id===a.data.ciudad.id?m.push(e.profesor.ciudad_nac=t):m.push(void 0);return m}),null===e.profesor.ciudad_doc?(e.profesor.pais_doc={id:1,pais:"COLOMBIA",abrev:"CO"},e.paisDocSelect(e.profesor.pais_doc,e.profesor.pais_doc)):t.get("::ciudades/datosciudad/"+e.profesor.ciudad_doc).then(function(a){return a=a.data,e.paises=a.paises,e.departamentos=a.departamentos,e.ciudades=a.ciudades,e.profesor.pais_doc=a.pais,e.profesor.departamento_doc=a.departamento,e.profesor.ciudad_doc=a.ciudad}),t.get("::tiposdocumento").then(function(a){var t,r,n,o,i;if(e.tipos_doc=a.data,null===e.profesor.tipo_doc)return e.profesor.tipo_doc=e.tipos_doc[0];for(o=[],t=0,r=(n=e.tipos_doc).length;t<r;t++)i=n[t],e.profesor.tipo_doc===i.id?o.push(e.profesor.tipo_doc=i):o.push(void 0);return o})}),t.get("::paises").then(function(a){return e.paises=a.data},function(e){return a.error("No se pudo traer los paises")}),e.guardar=function(){if(0===e.profesor.password.length){if(e.profesor.password.length>0)return void a.warning("Si lo quieres es cambiar la contraseña, debes copiarla 2 veces.")}else{if(e.profesor.password.length<3)return void a.warning("La contraseña debe tener al menos 3 caracteres");if(e.profesor.password!==e.profesor.password2)return void a.warning("Las contraseñas deben ser iguales")}return t.put("::profesores/update/"+e.profesor.profesor_id,e.profesor).then(function(e){return a.success("Profesor actualizado con éxito")},function(e){return a.error("No se guardaron los cambios","Problemas")})},e.paisNacSelect=function(a,r){return t.get("::ciudades/departamentos/"+a.id).then(function(t){if(e.departamentosNac=t.data,void 0===e.profesor.pais_doc)return e.profesor.pais_doc=a,e.paisDocSelect(a)})},e.departNacSelect=function(a){return t.get("::ciudades/por-departamento/"+a.departamento).then(function(t){if(e.ciudadesNac=t.data,void 0===e.profesor.departamento_doc)return e.profesor.departamento_doc=a,e.departDocSelect(a)})},e.paisDocSelect=function(a,r){return t.get("::ciudades/departamentos/"+a.id).then(function(a){return e.departamentos=a.data})},e.departDocSelect=function(a){return t.get("::ciudades/por-departamento/"+a.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yyyy"}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AreasCtrl",["$scope","toastr","$filter","$http","$uibModal",function(e,a,t,r,n){var o,i;return e.creando=!1,e.editando=!1,e.currentArea={},e.currenAreaEdit={},e.gridScope=e,e.cancelarCrear=function(){return e.creando=!1},e.cancelarEdit=function(){return e.editando=!1},e.crear=function(){return r.post("::areas",e.currentArea).then(function(t){return e.gridOptions.data.push(t.data),delete e.currentArea,a.success("Area creada con éxito")},function(e){return a.error("Error creando","Problema")})},e.guardar=function(){return r.put("::areas/update/"+e.currentAreaEdit.id,e.currentAreaEdit).then(function(t){return delete e.currentAreaEdit,a.success("Area actualizada con éxito"),e.cancelarEdit()},function(e){return a.error("Error guardando","Problema")})},e.editar=function(a){return e.currentAreaEdit=a,e.editando=!0},e.eliminar=function(a){return n.open({templateUrl:"==areas/removeArea.tpl.html",controller:"RemoveAreaCtrl",resolve:{area:function(){return a}}}).result.then(function(a){return e.gridOptions.data=t("filter")(e.areas,{id:"!"+a.id})})},o='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',i='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",maxWidth:50,enableFiltering:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:o+i,enableCellEdit:!1},{field:"orden",type:"number",maxWidth:40,enableSorting:!1},{field:"nombre",enableHiding:!1},{field:"alias",displayName:"Alias"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){return r!==n&&(e.currentAreaEdit=a,e.guardar()),e.$apply()})}},r.get("::areas").then(function(a){return e.areas=a.data,e.gridOptions.data=e.areas})}]).controller("RemoveAreaCtrl",["$scope","$uibModalInstance","area","$http","toastr",function(e,a,t,r,n){return e.area=t,e.ok=function(){return r.delete("::areas/destroy/"+t.id).then(function(e){return n.success("Grupo eliminado: "+t.nombre,"Eliminado")},function(e){return n.warning("Problema","No se pudo eliminar el area.")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("LoginCtrl",["$scope","$rootScope","AUTH_EVENTS","AuthService","$location","$cookies","Perfil","App","$http",function(e,a,t,r,n,o,i,s,u){e.logueando=!0,e.recuperando=!1,e.registrando=!1,e.logoPathDefault="images/Logo_MyVc_Header.gif",e.logoPath="images/Logo_Colegio_Header.gif",u.get(e.logoPath).then(function(){return console.log("imagen existe")},function(){return e.logoPath=e.logoPathDefault}),e.credentials={username:"",password:""},e.host=n.host(),e.login=function(e){return o.remove("xtoken"),i.deleteUser(),r.login_credentials(e).then(function(e){r.verificar().then(function(e){return localStorage.removeItem("logueando")},function(e){return console.log("Falló en Verificar")})})},e.enviarPass=function(e){return u.post("::login/ver-pass",{email:e,ruta:location.origin+location.pathname}).then(function(e){return alert("Ahora, verifica tu correo")},function(){return alert("Parece que el correo no está registrado.")})},e.to_recuperando=function(){return e.logueando=!1,e.recuperando=!0,e.registrando=!1},e.to_registrando=function(){return e.logueando=!1,e.recuperando=!1,e.registrando=!0},e.to_logueando=function(){return e.logueando=!0,e.recuperando=!1,e.registrando=!1}}]).controller("ResetPasswordCtrl",["$scope","$state","$stateParams","$cookies","Perfil","App","$http","toastr",function(e,a,t,r,n,o,i,s){e.reseteando=!1,e.username=t.username,e.logoPath="images/Logo_Colegio_Header.gif",t.numero<1e4&&(console.log("Reseteo inválido, deja de intentarlo."),a.go("login")),e.credentials={password1:"",password2:""},e.reset=function(r){return e.reseteando=!0,r.password1!==r.password2?(s.warning("Las contraseñas no coinciden."),void(e.reseteando=!1)):r.password1.length<4?(s.warning("Debe tener al menos 4 caracteres"),void(e.reseteando=!1)):i.put("::login/reset-password",{password1:r.password1,numero:t.numero,username:t.username}).then(function(t){return"Token inválido"===t.data?(s.warning("Token inválido"),e.reseteando=!1):a.go("login")},function(a){return console.log("No se pudo resetear"),e.reseteando=!1})}}])}.call(this),function(){angular.module("myvcFrontApp").directive("loginDialog",["AUTH_EVENTS","App",function(e,a){return{restrict:"A",templateUrl:"==login/login-form.html",link:function(a){var t;return t=function(){return a.visible=!0},a.visible=!1,a.$on(e.notAuthenticated,t),a.$on(e.sessionTimeout,t)}}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("LogoutCtrl",["$scope","$state","$cookieStore","Perfil",function(e,a,t,r){return console.log("A salir!!"),a.go("login")}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider",function(e){return e.state("panel.niveles",{url:"^/niveles",views:{maincontent:{templateUrl:"==grados/niveles.tpl.html",controller:"NivelesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Niveles educativos"}]}}},data:{displayName:"Niveles",icon_fa:"fa fa-graduation-cap",pageTitle:"Niveles - MyVc"}}),e.state("panel.niveles.nuevo",{url:"/nuevo",views:{edit_nivel:{templateUrl:"==grados/nivelesNew.tpl.html",controller:"NivelesNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Nivel nuevo - MyVc"}}),e.state("panel.niveles.editar",{url:"/editar/:nivel_id",views:{edit_nivel:{templateUrl:"==grados/nivelesEdit.tpl.html",controller:"NivelesEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar nivel - MyVc"}}),e.state("panel.grados",{url:"^/grados",views:{maincontent:{templateUrl:"==grados/grados.tpl.html",controller:"GradosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Grados"}]}}},resolve:{niveles:["$http",function(e){return e.get("::niveles_educativos").then(function(e){return e.data})}]},data:{displayName:"Grados",icon_fa:"fa fa-graduation-cap",pageTitle:"Grados - MyVc"}}),e.state("panel.grados.nuevo",{url:"/nuevo",views:{edit_grado:{templateUrl:"==grados/gradosNew.tpl.html",controller:"GradosNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Grado nuevo - MyVc"}}),e.state("panel.grados.editar",{url:"/editar/:grado_id",views:{edit_grado:{templateUrl:"==grados/gradosEdit.tpl.html",controller:"GradosEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar grado - MyVc"}}),e.state("panel.grupos",{url:"^/grupos",views:{maincontent:{templateUrl:"==grados/grupos.tpl.html",controller:"GruposCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Grupos"}]}}},resolve:{grados:["$http",function(e){return e.get("::grados").then(function(e){return e.data})}],profesores:["$http",function(e){return e.get("::contratos").then(function(e){return e.data})}]},data:{displayName:"Grupos",icon_fa:"fa fa-graduation-cap",pageTitle:"Grupos - MyVc"}}),e.state("panel.grupos.nuevo",{url:"/nuevo",views:{edit_grupo:{templateUrl:"==grados/gruposNew.tpl.html",controller:"GruposNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Grupo nuevo - MyVc"}}),e.state("panel.grupos.editar",{url:"/editar/:grupo_id",views:{edit_grupo:{templateUrl:"==grados/gruposEdit.tpl.html",controller:"GruposEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar grupo - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GradosCtrl",["$scope","$filter","$state","App","niveles","$uibModal","toastr","$http",function(e,a,t,r,n,o,i,s){var u,l;e.grados={nivel:{}},e.gridScope=e,e.niveles=n,e.editar=function(e){return t.go("panel.grados.editar",{grado_id:e.id})},e.eliminar=function(t){return o.open({templateUrl:"==grados/removeGrado.tpl.html",controller:"RemoveGradoCtrl",size:"sm",resolve:{grado:function(){return t}}}).result.then(function(t){return e.grados=a("filter")(e.grados,{id:"!"+t.id}),e.gridOptions.data=e.grados})},u='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:u+l,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"abreviatura",maxWidth:50,enableSorting:!1},{field:"orden",type:"number",maxWidth:50},{field:"nivel_educativo_id",displayName:"Nivel Educativo",editDropdownOptionsArray:n,cellFilter:"mapNivel:grid.appScope.niveles",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{name:"nn",displayName:"",maxWidth:20,enableSorting:!1,enableFiltering:!1}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){return r!==n&&s.put("::grados/update/"+a.id,a).then(function(e){return i.success("Grado actualizado con éxito","Actualizado")},function(e){return i.error("Cambio no guardado","Error")}),e.$apply()})}},s.get("::grados").then(function(a){return e.grados=a.data,e.gridOptions.data=e.grados}),e.$on("gradocreado",function(a,t){return e.grados.push(t),e.gridOptions.data=e.grados})}]).filter("mapNivel",["$filter",function(e){return function(a,t){return a?e("filter")(t,{id:a})[0].nombre:""}}]).controller("RemoveGradoCtrl",["$scope","$uibModalInstance","grado","$http","toastr",function(e,a,t,r,n){return e.grado=t,e.ok=function(){return r.delete("::grados/destroy/"+t.id).then(function(e){return n.success("Grado "+e.nombre+" eliminado con éxito","Eliminado")},function(e){return n.error("No se pudo eliminar a "+row.nombre)}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GradosNewCtrl",["$scope","toastr","$http",function(e,a,t){return e.grado={orden:1},e.restarOrden=function(){if(e.grado.orden>0)return e.grado.orden=e.grado.orden-1},e.sumarOrden=function(){if(e.grado.orden<40)return e.grado.orden=e.grado.orden+1},e.crear=function(){return t.post("::grados/store",e.grado).then(function(t){return t=t.data,e.$emit("gradocreado",t),a.success("Grado "+t.nombre+" creado")},function(e){return a.error("Falló al intentar guardar")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GradosEditCtrl",["$scope","$state","$http","toastr",function(e,a,t,r){return t.get("::grados/show/"+a.params.grado_id).then(function(a){return e.grado=a.data}),e.guardar=function(){return t.put("::grados/update/"+e.grado.id,e.grado).then(function(e){return r.success("Se guardaron los cambios.")},function(e){return r.error("Falló al intentar guardar")})},e.restarOrden=function(){if(e.grado.orden>0)return e.grado.orden=e.grado.orden-1},e.sumarOrden=function(){if(e.grado.orden<40)return e.grado.orden=e.grado.orden+1}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GruposCtrl",["$scope","$filter","$state","grados","profesores","$uibModal","$http","toastr","AuthService",function(e,a,t,r,n,o,i,s,u){var l,c,d;e.gridScope=e,e.grados=r,e.profesores=n,e.hasRoleOrPerm=u.hasRoleOrPerm,e.editar=function(e){return t.go("panel.grupos.editar",{grupo_id:e.id})},e.eliminar=function(t){return o.open({templateUrl:"==grados/removeGrupo.tpl.html",controller:"RemoveGrupoCtrl",resolve:{grupo:function(){return t}}}).result.then(function(t){return e.grupos=a("filter")(e.grupos,{id:"!"+t.id}),e.gridOptions.data=e.grupos})},l='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',c='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',d='<a uib-tooltip="Listado de alumnos" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ui-sref="panel.listalumnos({grupo_id: row.entity.id})"><i class="fa fa-users "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"orden",type:"number",maxWidth:60},{name:"edicion",displayName:"Edición",maxWidth:80,enableSorting:!1,enableFiltering:!1,cellTemplate:l+c+d,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura",maxWidth:50,enableSorting:!1},{field:"titular_id",displayName:"Titular",editDropdownOptionsArray:n,cellFilter:"mapProfesores:grid.appScope.profesores",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"profesor_id",editDropdownValueLabel:"nombre_completo"},{field:"grado_id",displayName:"Grado",editDropdownOptionsArray:r,cellFilter:"mapGrado:grid.appScope.grados",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{field:"cant_alumnos",displayName:"Cantidad alumnos",enableSorting:!1,enableFiltering:!1,enableCellEdit:!1}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){var o;return r!==n&&(o={abrev:a.abrev,grado_id:a.grado_id,nombre:a.nombre,orden:a.orden,titular_id:a.titular_id,caritas:a.caritas,id:a.id},i.put("::grupos/update",o).then(function(e){return s.success("Grupo actualizado con éxito","Actualizado")},function(e){return s.error("Cambio no guardado","Error")})),e.$apply()})}},e.cambiarCaritas=function(e){var a;return e.caritas=!e.caritas,a={abrev:e.abrev,grado_id:e.grado_id,nombre:e.nombre,orden:e.orden,titular_id:e.titular_id,caritas:e.caritas,id:e.id},i.put("::grupos/update",a).then(function(e){return s.success("Grupo actualizado con éxito","Actualizado")},function(e){return s.error("Cambio no guardado","Error")})},i.get("::grupos/cant-alumnos").then(function(a){var t,r,n,o;for(e.grupos=a.data,r=0,n=(o=e.grupos).length;r<n;r++)(t=o[r]).caritas=!!t.caritas;return e.gridOptions.data=e.grupos}),e.$on("grupocreado",function(a,t){return e.grupos.push(t),e.gridOptions.data=e.grupos})}]).filter("mapGrado",["$filter",function(e){return function(a,t){return a?e("filter")(t,{id:a})[0].nombre:"Elija..."}}]).controller("RemoveGrupoCtrl",["$scope","$uibModalInstance","grupo","$http","toastr",function(e,a,t,r,n){return e.grupo=t,e.ok=function(){return r.delete("::grupos/destroy/"+t.id).then(function(e){return n.success("Grupo "+t.nombre+" eliminado con éxito.","Eliminado")},function(e){return n.warning("No se pudo eliminar al grupo.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GruposNewCtrl",["$scope","$http","toastr",function(e,a,t){return e.grupo={orden:1,caritas:!1,valormatricula:0,valorpension:0},a.get("::grados").then(function(a){return e.grados=a.data}),a.get("::contratos").then(function(a){return e.profesores=a.data}),e.restarOrden=function(){if(e.grupo.orden>0)return e.grupo.orden=e.grupo.orden-1},e.sumarOrden=function(){if(e.grupo.orden<40)return e.grupo.orden=e.grupo.orden+1},e.crear=function(){return a.post("::grupos/store",e.grupo).then(function(a){return e.$emit("grupocreado",a.data),t.success("Grupo "+a.data.nombre+" creado")},function(e){return t.error("No se pudo crear el grupo","Error")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GruposEditCtrl",["$scope","$state","$http","toastr",function(e,a,t,r){return t.get("::grupos/show/"+a.params.grupo_id).then(function(a){return e.grupo=a.data}),t.get("::grados").then(function(a){return e.grados=a.data}),t.get("::contratos").then(function(a){return e.profesores=a.data}),e.guardar=function(){var a;return e.grupo.titular.profesor_id?e.grupo.titular_id=e.grupo.titular.profesor_id:e.grupo.titular_id=e.grupo.titular.id,a=e.grupo.titular,delete e.grupo.titular,e.grupo.grado_id=e.grupo.grado.id,t.put("::grupos/update",e.grupo).then(function(t){return r.success("Grupo "+t.data.nombre+" editado."),e.grupo.titular=a},function(t){return e.grupo.titular=a})},e.restarOrden=function(){if(e.grupo.orden>0)return e.grupo.orden=e.grupo.orden-1},e.sumarOrden=function(){if(e.grupo.orden<40)return e.grupo.orden=e.grupo.orden+1}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NivelesCtrl",["$scope","$filter","$state","toastr","$http",function(e,a,t,r,n){var o,i;e.gridScope=e,e.editar=function(e){return t.go("panel.niveles.editar",{nivel_id:e.id})},e.eliminar=function(t){return $htt.delete("niveles_educativos/"+t.id).then(function(t){return e.niveles=a("filter")(e.niveles,{id:"!"+t.data.id}),e.gridOptions.data=e.niveles},function(e){return r.warning("No se pudo eliminar.")})},o='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',i='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"orden",type:"number",maxWidth:50,enableSorting:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:o+i,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,o,i){return o!==i&&n.put("::niveles_educativos/"+a.id,a).then(function(e){return r.success("Nivel actualizado","Actualizado")},function(e){return r.error("Cambio no guardado","Error")}),e.$apply()})}},n.get("::niveles_educativos").then(function(a){return e.niveles=a.data,e.gridOptions.data=e.niveles})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NivelesNewCtrl",["$scope","$http","toastr",function(e,a,t){e.nivel={orden:0},e.restarOrden=function(){if(e.nivel.orden>0)return e.nivel.orden=e.nivel.orden-1},e.sumarOrden=function(){if(e.nivel.orden<40)return e.nivel.orden=e.nivel.orden+1},e.crear=function(){return a.post("::niveles_educativos",e.nivel).then(function(e){return t.success("Se hizo el post del nivel")},function(e){return t.error("Falló al intentar guardar")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NivelesEditCtrl",["$scope","toastr","$state","$http",function(e,a,t,r){return e.nivel={},r.get("::niveles_educativos/"+t.params.nivel_id).then(function(a){return e.nivel=a.data}),e.guardar=function(){return r.put("niveles_educativos/"+t.params.nivel_id,e.nivel).then(function(e){return a.success("Se guardó nivel")},function(e){return a.error("Falló al intentar guardar")})},e.restarOrden=function(){if(e.nivel.orden>0)return e.nivel.orden=e.nivel.orden-1},e.sumarOrden=function(){if(e.nivel.orden<40)return e.nivel.orden=e.nivel.orden+1}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(e,a){return e.state("panel.areas",{url:"^/areas",views:{maincontent:{templateUrl:"==areas/areas.tpl.html",controller:"AreasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Areas"}]}}},data:{displayName:"Areas",icon_fa:"fa fa-graduation-cap",pageTitle:"Áreas - MyVc"}}),e.state("panel.materias",{url:"^/materias",views:{maincontent:{templateUrl:"==areas/materias.tpl.html",controller:"MateriasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Materias"}]}}},resolve:{areas:["$http",function(e){return e.get("::areas").then(function(e){return e.data})}]},data:{displayName:"Materias",icon_fa:"fa fa-graduation-cap",pageTitle:"Materias - MyVc"}}),e.state("panel.asignaturas",{url:"^/asignaturas",views:{maincontent:{templateUrl:"==areas/asignaturas.tpl.html",controller:"AsignaturasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Asignaturas"}]}}},resolve:{datosAsignaturas:["$http",function(e){return e.put("::asignaturas/datos-asignaturas").then(function(e){return e.data})}]},data:{displayName:"Asignaturas",icon_fa:"fa fa-graduation-cap",pageTitle:"Asignatura - MyVc"}}),e.state("panel.listasignaturas",{url:"^/listasignaturas/:profesor_id",params:{profesor_id:{value:null}},views:{maincontent:{templateUrl:"==areas/listAsignaturas.tpl.html",controller:"ListAsignaturasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:["$stateParams",function(e){return localStorage.profesor_id=e.profesor_id,"Listado de asignaturas"}]}}},data:{displayName:"Listado de asignaturas",icon_fa:"fa fa-graduation-cap",pageTitle:"Mis asignaturas - MyVc"}}),e.state("panel.frases",{url:"^/frases",views:{maincontent:{templateUrl:"==areas/frases.tpl.html",controller:"FrasesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Frases"}]}}},data:{displayName:"Frases",icon_fa:"fa fa-graduation-cap",pageTitle:"Frases - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("MateriasCtrl",["$scope","toastr","$http","areas","$uibModal","$filter",function(e,a,t,r,n,o){var i,s;return e.creando=!1,e.editando=!1,e.currentmateria={},e.currenmateriaEdit={},e.areas=r,e.gridScope=e,e.cancelarCrear=function(){return e.creando=!1},e.cancelarEdit=function(){return e.editando=!1},e.crear=function(){return t.post("::materias",e.currentmateria).then(function(t){return e.gridOptions.data.push(t.data),delete e.currentmateria,a.success("Materia creada con éxito")},function(e){return a.error("Error creando","Problema")})},e.guardar=function(){return t.put("::materias/update/"+e.currentmateriaEdit.id,e.currentmateriaEdit).then(function(t){return e.currentmateriaEdit.area_id=t.data.area_id,delete e.currentmateriaEdit,a.success("Materia actualizada con éxito"),e.cancelarEdit()},function(e){return a.error("Error guardando","Problema")})},e.editar=function(a){return a.area=o("filter")(r,{id:a.area_id})[0],e.currentmateriaEdit=a,e.editando=!0},e.eliminar=function(a){return n.open({templateUrl:"==areas/removeMateria.tpl.html",controller:"RemovemateriaCtrl",resolve:{materia:function(){return a}}}).result.then(function(a){return e.gridOptions.data=o("filter")(e.gridOptions.data,{id:"!"+a.id})})},i='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',s='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',e.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,multiSelect:!1,columnDefs:[{field:"id",type:"number",maxWidth:50,enableFiltering:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:i+s,enableCellEdit:!1},{field:"materia",enableHiding:!1,filter:{condition:function(a,t,r){var n;return n=o("filter")(e.gridOptions.data,{materia:a}),o("filter")(n,{materia:t}).length>0}}},{field:"alias",displayName:"Alias"},{field:"area_id",displayName:"Area",editDropdownOptionsArray:r,cellFilter:"mapAreas:grid.appScope.areas",editableCellTemplate:"ui-grid/dropdownEditor",filter:{condition:function(a,t){var r;return r=o("filter")(e.areas,{nombre:a}),o("filter")(r,{id:t},!0).length>0}},editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{name:"nn",displayName:"",maxWidth:20,enableSorting:!1,enableFiltering:!1}],onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){return r!==n&&(e.currentmateriaEdit=a,e.guardar()),e.$apply()})}},t.get("::materias").then(function(a){var t,r,n,i,s;for(e.gridOptions.data=a.data.materias,e.areas=a.data.mat_por_areas,e.areas=o("orderBy")(e.areas,"orden"),s=[],r=0,n=(i=e.areas).length;r<n;r++)t=i[r],s.push(t.materias=o("orderBy")(t.materias,"orden"));return s}),e.onSortMaterias=function(e,r,n,o,i,s){var u,l,c,d,p,f,m,g,_,h;for(_=[],h=[],u={},console.log(n,e,s.area),d=c=0,f=r.length;c<f;d=++c)(g=r[d]).orden=d,(l={})[""+g.id]=d,_.push(l);if(u.partFrom={sortHash:_},r!==n){for(d=p=0,m=n.length;p<m;d=++p)(g=n[d]).orden=d,(l={})[""+g.id]=d,h.push(l);u.partTo={sortHash:h,area_id:s.area.id}}return t.put("::materias/update-orden",u).then(function(e){return!0},function(e){return a.warning("No se pudo ordenar","Problema"),!1})},e.onSortAreas=function(e,r,n,o,i){var s,u,l,c,d,p,f;for(f=[],console.log(e,r,n,o,i),d=c=0,p=r.length;c<p;d=++c)(s=r[d]).orden=d,(l={})[""+s.id]=d,f.push(l);return u={sortHash:f},t.put("::areas/update-orden",u).then(function(e){return!0},function(e){return a.warning("No se pudo ordenar","Problema"),!1})}}]).filter("mapAreas",["$filter",function(e){return function(a,t){var r;return a&&(r=e("filter")(t,{id:a})[0])?r.nombre:"Elija..."}}]).controller("RemovemateriaCtrl",["$scope","$uibModalInstance","materia","$http","toastr",function(e,a,t,r,n){return e.materia=t,e.ok=function(){return r.delete("::materias/destroy/"+t.id).then(function(e){return n.success("Materia "+t.nombre+" eliminada con éxito.","Eliminada")},function(e){return n.warning("Problema","No se pudo eliminar la Materia.")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AsignaturasCtrl",["$scope","$http","datosAsignaturas","$uibModal","$filter","App","AuthService","toastr",function(e,a,t,r,n,o,i,s){var u,l;return i.verificar_acceso(),e.creando=!1,e.editando=!1,e.currentasignatura={grupo:void 0,profesor:void 0},e.currenasignaturaEdit={},e.copiando=!1,e.asignaturas=[],e.materias=t.materias,e.grupos=t.grupos,e.profesores=t.profesores,a.get("::asignaturas/papelera").then(function(a){return e.asignaturas_eliminadas=a.data},function(e){return s.error("Error trayendo las asignaturas de papelera","Problema")}),e.restaurarAsignatura=function(e){if(!e.restaurando)return e.restaurando=!0,a.put("::asignaturas/restaurar",{asignatura_id:e.asignatura_id}).then(function(e){return s.success("Listo. Debes actualizar la página para ver los cambios.")},function(a){return e.restaurando=!1,s.error("Error restaurando","Problema")})},e.gridScope=e,e.seleccionaGrupo=function(a,t){var r;if(a=void 0===a?{id:"!"}:a,e.gridOptions.data=n("filter")(e.asignaturas,{grupo_id:a.id},!0),void 0!==e.currentasignatura.profesor)return r=e.currentasignatura.profesor.id,e.gridOptions.data=n("filter")(e.gridOptions.data,{profesor_id:r},!0)},e.mostrarTodas=function(a,t){return e.gridOptions.data=e.asignaturas},e.seleccionaProfe=function(a,t){var r;if(a){if(a=void 0===a?{profesor_id:"!"}:a,e.gridOptions.data=n("filter")(e.asignaturas,{profesor_id:a.profesor_id},!0),e.currentasignatura.grupo)return r=e.currentasignatura.grupo.id,e.gridOptions.data=n("filter")(e.gridOptions.data,{grupo_id:r},!0)}else if(e.currentasignatura.grupo)return r=e.currentasignatura.grupo.id,e.gridOptions.data=n("filter")(e.gridOptions.data,{grupo_id:r},!0)},e.filtrarAsignaturas=function(){var a,t;if(e.gridOptions.data=e.asignaturas,void 0!==e.currentasignatura.grupo&&(a=e.currentasignatura.grupo.id,e.gridOptions.data=n("filter")(e.gridOptions.data,{grupo_id:a},!0)),void 0!==e.currentasignatura.profesor)return t=e.currentasignatura.profesor.id,e.gridOptions.data=n("filter")(e.gridOptions.data,{profesor_id:t},!0)},e.cancelarCrear=function(){return e.creando=!1},e.cancelarEdit=function(){return e.editando=!1},e.copiarAsignaturas=function(){return e.copiando=!1,a.post("::asignaturas/copiar",{grupo_id_origen:e.currentasignatura.grupo.id,grupo_id_destino:e.currentasignatura.grupo_destino.id}).then(function(a){return e.copiando=!0,s.success("Asignaturas copiadas. Actualice")},function(e){return s.error("Error creando","Problema")})},e.crear=function(){return a.post("::asignaturas",e.currentasignatura).then(function(a){return e.asignaturas.push(a.data),e.filtrarAsignaturas(),e.cancelarCrear(),s.success("Asignatura creada con éxito")},function(e){return s.error("Error creando","Problema")})},e.guardar=function(){return a.put("::asignaturas/update/"+e.currentasignaturaEdit.id,e.currentasignaturaEdit).then(function(a){return e.currentasignaturaEdit.area_id=a.data.area_id,s.success("Asignatura actualizada con éxito"),e.cancelarEdit()},function(e){return s.error("Error guardando","Problema")})},e.editar=function(a){return a.materia=n("filter")(t.materias,{id:a.materia_id},!0)[0],a.grupo=n("filter")(t.grupos,{id:a.grupo_id},!0)[0],a.profesor=n("filter")(t.profesores,{profesor_id:a.profesor_id},!0)[0],e.currentasignaturaEdit=a,e.editando=!0},e.eliminar=function(a){return r.open({templateUrl:"==areas/removeAsignatura.tpl.html",controller:"RemoveAsignaturaCtrl",resolve:{asignatura:function(){return a}}}).result.then(function(a){return e.asignaturas=n("filter")(e.asignaturas,{id:"!"+a.id}),e.gridOptions.data=e.asignaturas,e.filtrarAsignaturas()})},u='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",width:60,enableFiltering:!1,enableCellEdit:!1,enableColumnMenu:!1},{name:"edicion",displayName:"Edición",width:70,enableSorting:!1,enableFiltering:!1,cellTemplate:u+l,enableCellEdit:!1,enableColumnMenu:!1},{field:"materia_id",displayName:"Materia",editDropdownOptionsArray:t.materias,cellFilter:"mapMaterias:grid.appScope.materias",filter:{condition:function(e,a){var r;return r=n("filter")(t.materias,{materia:e}),n("filter")(r,{id:a},!0).length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"materia",enableCellEditOnFocus:!0},{field:"grupo_id",displayName:"Grupos",editDropdownOptionsArray:t.grupos,cellFilter:"mapGrupos:grid.appScope.grupos",filter:{condition:function(e,a){var r;return r=n("filter")(t.grupos,{nombre:e}),n("filter")(r,{id:a},!0).length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre",enableCellEditOnFocus:!0},{field:"profesor_id",displayName:"Profesor",editDropdownOptionsArray:t.profesores,cellFilter:"mapProfesores:grid.appScope.profesores",filter:{condition:function(e,a){return n("filter")(t.profesores,function(t){var r,n,o;return r=!!t.nombres&&t.nombres.toLowerCase().indexOf(e.toLowerCase())>-1,n=!!t.apellidos&&t.apellidos.toLowerCase().indexOf(e.toLowerCase())>-1,o=t.profesor_id===a,(r||n)&&o}).length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"profesor_id",editDropdownValueLabel:"nombre_completo",enableCellEditOnFocus:!0},{field:"creditos",displayName:"Créditos",type:"number",maxWidth:50},{name:"nn",displayName:"",width:10,enableSorting:!1,enableFiltering:!1,enableColumnMenu:!1}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){return r!==n&&(e.currentasignaturaEdit=a,e.guardar()),e.$apply()})}},a.get("::asignaturas").then(function(a){return e.asignaturas=a.data,e.gridOptions.data=e.asignaturas})}]).filter("mapMaterias",["$filter",function(e){return function(a,t){var r;return a?(r=e("filter")(t,{id:a},!0)[0])?r.materia:"En papelera...":"Elija..."}}]).filter("mapGrupos",["$filter",function(e){return function(a,t){return a?e("filter")(t,{id:a},!0)[0].nombre:"Elija..."}}]).filter("mapProfesores",["$filter",function(e){return function(a,t){var r;return a&&(r=e("filter")(t,{profesor_id:a},!0)).length>0?r[0].nombres+" "+r[0].apellidos:"Elija..."}}]).controller("RemoveAsignaturaCtrl",["$scope","$uibModalInstance","asignatura","$http","toastr",function(e,a,t,r,n){return e.asignatura=t,e.ok=function(){return r.delete("::asignaturas/destroy/"+t.id).then(function(e){return n.success("asignatura "+t.nombre+" eliminada con éxito.","Eliminada")},function(e){return n.warning("Problema","No se pudo eliminar la asignatura.")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ListAsignaturasCtrl",["$scope","$http","toastr","$state","$cookies","$rootScope","AuthService","App","resolved_user","$filter","$uibModal",function(e,a,t,r,n,o,i,s,u,l,c){return e.UNIDAD=e.USER.unidad_displayname,e.GENERO_UNI=e.USER.genero_unidad,e.SUBUNIDAD=e.USER.subunidad_displayname,e.GENERO_SUB=e.USER.genero_subunidad,e.UNIDADES=e.USER.unidades_displayname,e.SUBUNIDADES=e.USER.subunidades_displayname,e.hasRoleOrPerm=i.hasRoleOrPerm,e.dato={},e.views=s.views+"areas/",e.mes=(new Date).getMonth(),e.profesor={},r.params.profesor_id?(e.profesor_id=r.params.profesor_id,a.get("::asignaturas/listasignaturas/"+r.params.profesor_id).then(function(a){return e.asignaturas=a.data.asignaturas,e.profesor=a.data.info_profesor,e.gruposcomportamientos=a.data.grados_comp,e.grupos=a.data.grupos,e.pedidos=a.data.pedidos,e.materias=a.data.materias},function(e){return t.error("No se pudo traer las asignaturas")})):a.get("::asignaturas/listasignaturas").then(function(a){var t,r,n,o,i;for(e.asignaturas=a.data.asignaturas,e.gruposcomportamientos=a.data.grados_comp,e.grupos=a.data.grupos,e.pedidos=a.data.pedidos,e.materias=a.data.materias,i=[],t=0,r=(o=e.pedidos).length;t<r;t++)1!==(n=o[t]).materia_to_add_accepted&&1!==n.asignatura_to_remove_accepted||(n.estado=":: APROBADO ::  "),0===n.materia_to_add_accepted||0===n.asignatura_to_remove_accepted?i.push(n.estado=":: RECHAZADO ::  "):i.push(void 0);return i},function(e){return t.error("No se pudo traer tus asignaturas")}),e.irAComportamiento=function(a){return r.params.profesor_id?localStorage.profesor_id=r.params.profesor_id:localStorage.profesor_id=e.USER.persona_id,r.go("panel.comportamiento",{grupo_id:a.id})},e.solicitarMateria=function(){if(e.dato.grupo)if(e.dato.materia){if(!(!e.dato.creditos>0))return a.put("::ChangesAskedAssignment/solicitar-materia",{grupo_id:e.dato.grupo.id,materia_id:e.dato.materia.id,creditos:e.dato.creditos}).then(function(a){return e.pedidos.push(a.data.pedido),t.success("Materia solicitada. Un administrador lo revisará.")},function(e){return t.error("No se pudo solicitar materia")});t.warning("Debes asignar la intensidad horaria.")}else t.warning("Debes seleccionar una materia.");else t.warning("Debes seleccionar un grupo.")},e.quitarSolicitud=function(r){return a.put("::ChangesAsked/destruir-pedido-asignatura",{asked_id:r.asked_id,assignment_id:r.assignment_id}).then(function(a){return e.pedidos=l("filter")(e.pedidos,{asked_id:"!"+r.asked_id}),t.success("Solicitada eliminada")},function(e){return t.error("No se pudo solicitar materia")})},e.noEsMia=function(a){var r,n,o,i;for(r=0,n=(i=e.pedidos).length;r<n;r++)if((o=i[r]).asignatura_to_remove_id===a.asignatura_id&&!o.asignatura_to_remove_accepted)return void t.info("Ya has hecho esta solicitud");return c.open({templateUrl:"==areas/asignaturaNoEsMia.tpl.html",controller:"AsignaturaNoEsMiaCtrl",resolve:{asignatura:function(){return a}}}).result.then(function(a){return t.success("Has solicitado remoción de asignatura."),e.pedidos.push(a.pedido)})},e.irDefinitivas=function(e){return localStorage.asignatura_id_def=e.asignatura_id,r.go("panel.definitivas_periodos",{profesor_id:r.params.profesor_id})},e.open=function(e){return r.go("panel.unidades",{asignatura_id:e.asignatura_id})}}]).controller("AsignaturaNoEsMiaCtrl",["$scope","$uibModalInstance","asignatura","$http","toastr","App",function(e,a,t,r,n,o){return e.asignatura=t,e.ok=function(){var e;return e={asignatura_id:t.asignatura_id},r.put("::ChangesAskedAssignment/pedir-quitar-asignatura",e).then(function(e){return a.close(e.data)},function(e){return n.error("Problema","No se pudo hacer solicitud.")})},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("FrasesCtrl",["$scope","toastr","$filter","$http","$uibModal","App","AuthService",function(e,a,t,r,n,o,i){var s;return i.verificar_acceso(),e.currentFrase={},e.currentFraseEdit={},e.creando=!1,e.gridScope=e,e.tipos=[{tipo_frase:"Debilidad"},{tipo_frase:"Amenaza"},{tipo_frase:"Oportunidad"},{tipo_frase:"Fortaleza"}],e.currentFrase.tipo_frase={tipo_frase:"Fortaleza"},e.cancelarCrear=function(){return e.creando=!1},e.crear=function(){return r.post("::frases/store",e.currentFrase).then(function(t){return e.gridOptions.data.push(t.data),e.currentFrase.frase="",e.cancelarCrear(),a.success("Frase creada con éxito")},function(e){return a.error("Error creando","Problema")})},e.guardar=function(){return r.put("::frases/update/"+e.currentFraseEdit.id,e.currentFraseEdit).then(function(t){return e.currentFraseEdit.frase=t.data.frase,a.success("Frase actualizada con éxito")},function(e){return a.error("Error guardando","Problema")})},e.eliminar=function(a){return n.open({templateUrl:o.views+"areas/removeFrase.tpl.html",controller:"RemoveFraseCtrl",resolve:{frase:function(){return a}}}).result.then(function(a){return e.gridOptions.data=t("filter")(e.gridOptions.data,{id:"!"+a.id})})},'<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',s='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',e.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",width:70,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:60,enableSorting:!1,enableFiltering:!1,cellTemplate:s,enableCellEdit:!1},{field:"tipo_frase",displayName:"Tipo",width:90,enableCellEdit:!1},{field:"frase",displayName:"Frase",minWidth:300}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,t,r,n){return r!==n&&(e.currentFraseEdit=a,e.guardar()),e.$apply()})}},r.get("::frases").then(function(a){return e.gridOptions.data=a.data})}]).controller("RemoveFraseCtrl",["$scope","$uibModalInstance","frase","$http","toastr",function(e,a,t,r,n){return e.frase=t,e.ok=function(){return r.delete("::frases/destroy/"+t.id).then(function(e){return n.success('frase "'+t.frase+'" eliminada con éxito.',"Eliminada")},function(e){return n.warning("Problema","No se pudo eliminar la frase.")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PaisesCtrl",["$scope",function(e){e.gridOptions={enableSorting:!0,columnDefs:[{field:"pais"},{field:"abreviación"},{field:"id"}],onRegisterApi:function(a){return e.gridApi=a}}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("CiudadesCtrl",["$scope","toastr","$http","paises","$filter",function(e,a,t,r,n){e.paises=r.data,e.datos={},e.creando_ciudad=!1,e.creando_departamento=!1,e.creando_pais=!1,e.ciudad_new="",e.departamento_new="",e.pais_new="",e.modificando_depart=!1,e.crearCiudad=function(){return e.creando_ciudad=!0,e.$broadcast("paisSeleccionadoEvent2")},e.crearDepartamento=function(){return e.creandodepartamento=!0},e.crearPais=function(){return e.creandopais=!0},e.guardarPais=function(r){return r?(r=r.toUpperCase(),e.creandopais=!0,t.post("::paises/store",{pais_new:r}).then(function(t){return a.success("Creado correctamente: "+r),e.paises=t.data,e.creandopais=!1,e.pais_new="",e.mostrarAgregarPais=!1},function(e){return a.error("No se pudo crear","Error")})):a.warning("Debes escribir el nombre del pais.")},e.guardarCiudad=function(r,o){var i;if(e.datos.pais)if(e.datos.departamento||""!==o){if(""!==r)return i=e.datos.departamento?departamento.departamento:o,t.post("::ciudades/guardar-ciudad",{ciudad:r,departamento:i,pais_id:e.datos.pais.id}).then(function(r){return a.success("Creado correctamente: "+r.data.ciudad),e.datos.departamento&&e.ciudades.push(r.data),e.creandociudad=!1,e.ciudad_new="",e.departamento_new="",e.guardar=!0,t.get("::paises").then(function(a){return e.paises=a.data,e.paisSelect(n("filter")(e.paises,{id:1})[0])},function(e){return a.error("No se pudo traer las ciudades.")})},function(e){return a.error("No se pudo crear","Error")});a.warning("Debe escribir la nueva ciudad.")}else a.warning("Debe seleccionar departamento o escribir uno nuevo.");else a.warning("Debes seleccionar un pais.")},e.escribeEnDepartamentoNew=function(){return e.datos.departamento=void 0},e.actualizarCiudad=function(e){return t.put("::ciudades/actualizar-ciudad",e).then(function(t){return a.success("Actualizado: "+e.ciudad),e.editandoCiudad=!1},function(e){return a.error("No se pudo actualizar","Error")})},e.actualizarDepartamento=function(r){return t.put("::ciudades/actualizar-departamento",r).then(function(t){var n,o,i;for(a.success("Actualizado: "+r.departamento),r.editandoDepart=!1,e.ciudad_new.pais,n=0,o=(i=e.ciudades).length;n<o;n++)i[n].departamento=r.departamento;return e.modificando_depart=!0},function(e){return a.error("No se pudo actualizar","Error")})},e.actualizarPais=function(e){return t.put("::paises/actualizar",e).then(function(t){return a.success("Actualizado: "+e.pais),e.editandoPais=!1,e.editandoAbrev=!1},function(e){return a.error("No se pudo actualizar","Error")})},e.paisSelect=function(a,r){return t.put("::ciudades/departamentos-by-id",{pais_id:a.id}).then(function(t){return e.departamentos=t.data.departamentos,void 0===e.datos.pais&&(e.datos.pais=a),e.$broadcast("paisSeleccionadoEvent"+r)})},e.paisSelect(n("filter")(e.paises,{id:1})[0],1),e.departamentoSelect=function(a,r){if(a)return e.departamento_new="",t.get("::ciudades/por-departamento/"+a.departamento).then(function(t){return e.ciudades=t.data,void 0===e.datos.departamento&&(e.datos.departamento=a),e.$broadcast("departamentoSeleccionadoEvent"+r)})},e.eliminarCiudad=function(r){return t.delete("::ciudades/destroy/"+r.id).then(function(t){return a.success("Ciudad enviada a la papelera.","Eliminado"),e.ciudades=n("filter")(e.ciudades,{id:"!"+r.id})},function(e){return a.warning("No se pudo enviar a la papelera.","Problema")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MensajesCtrl",["$scope","$rootScope","$interval",function(e,a,t){}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider",function(e){return e.state("panel.filemanager",{url:"/filemanager",views:{maincontent:{templateUrl:"==fileManager/fileManager.tpl.html",controller:"FileManagerCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Administrador de archivos"}]}}},data:{displayName:"Administrador de archivos",icon_fa:"fa fa-cube",pageTitle:"Imágenes - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("FileManagerCtrl",["$scope","Upload","$timeout","$filter","App","$http","Perfil","$uibModal","resolved_user","toastr","AuthService","ProfesoresServ",function(e,a,t,r,n,o,i,s,u,l,c,d){var p,f;e.USER=u,e.subir_intacta={},e.hasRoleOrPerm=c.hasRoleOrPerm,e.cantUp=10,e.tabFileManager="mis_img",e.views=n.views,e.search_alu="",function(){e.dato={imgUsuario:{id:e.USER.imagen_id,nombre:e.USER.imagen_nombre},imgOficial:{id:e.USER.foto_id,nombre:e.USER.foto_nombre}}}(),e.perfilPath=n.images+"perfil/",e.imgFiles=[],e.errorMsg="",e.fileReaderSupported=null!==window.FileReader&&(null===window.FileAPI||!1!==FileAPI.html5),e.dato.usuarioElegido=[],e.dato.tipo_a_cambiar="alumno",e.usuariosall=[],e.profesores=[],o.get("::myimages").then(function(a){var t,r,n,o,i;if(a=a.data,e.imagenes_privadas=a.imagenes_privadas,e.imagenes_publicas=a.imagenes_publicas,e.logo=a.logo,e.dato.imgParaUsuario=a.imagenes_privadas[0],e.grupos=a.grupos,e.profesores=a.profesores,localStorage.grupo_selected_imgs){for(i=[],r=0,n=(o=e.grupos).length;r<n;r++)(t=o[r]).id===parseInt(localStorage.grupo_selected_imgs)?(e.dato.grupo=t,i.push(e.grupoSelect(t))):i.push(void 0);return i}},function(e){return l.error("No se trajeron las imágenes.")}),e.hasRoleOrPerm(["profesor","admin"])&&(e.cantUp=2),localStorage.tabFileManager?e.tabFileManager=localStorage.tabFileManager:(localStorage.tabFileManager=e.tabFileManager,t(function(){return e.tabFileManager="mis_img"})),localStorage.tipo_img_a_cambiar?e.dato.tipo_a_cambiar=localStorage.tipo_img_a_cambiar:localStorage.tipo_img_a_cambiar="alumno",e.selectTab=function(a){return localStorage.tabFileManager=a,e.tabFileManager=localStorage.tabFileManager},e.cambiar_tipo_img_a_cambiar=function(e){return localStorage.tipo_img_a_cambiar=e},e.select_imagen_item=function(a){var t,r,n;for(t=0,r=(n=e.imagenes_privadas).length;t<r;t++)n[t].selected=!1;return a.selected=!0,e.dato.selectedImg=a},e.uploadFiles=function(a){var t,r,n,o,i;if(e.imagenes_privadas.length>2&&e.hasRoleOrPerm(["alumno","acudiente"])&&l.warning("No tiene permiso para subir más imágenes"),e.imgFiles=a,e.errorMsg="",a&&a.length){for(i=[],r=n=0,o=a.length;0<=o?n<o:n>o;r=0<=o?++n:--n)t=a[r],i.push(p(t));return i}},p=function(a){return e.errorMsg=null,f(a),e.generateThumb(a)},e.generateThumb=function(a){if(null!==a&&e.fileReaderSupported&&a.type.indexOf("image")>-1)return t(function(){var e;return(e=new FileReader).readAsDataURL(a),e.onload=function(e){return t(function(){return a.dataUrl=e.target.result})}})},f=function(t){var r;if(r=e.subir_intacta.intacta?"-intacta":"",!(t.size>1e7))return a.upload({url:n.Server+"myimages/store"+r,file:t}).progress(function(e){var a;return a=parseInt(100*e.loaded/e.total),t.porcentaje=a}).success(function(a,t,r,n){return e.subir_intacta.intacta?e.imagenes_publicas.push(a):e.imagenes_privadas.push(a)}).error(function(e){return console.log("Falla uploading: ",e)}).xhr(function(e){});e.errorMsg="Archivo excede los 10MB permitidos."},e.pedirCambioUsuario=function(a){return a.id?o.put("::images-users/cambiar-imagen-perfil/"+e.USER.user_id,{imagen_id:a.id}).then(function(t){return t=t.data,e.hasRoleOrPerm("admin")?(i.setImagen(t.imagen_id,a.nombre),e.$emit("cambianImgs",{image:t}),l.success("Imagen principal cambiada")):l.info("Ahora espera que un administrador acepte tu imagen","Solicitado")},function(e){return l.error("No se pudo cambiar imagen","Problema")}):l.warning("Selecciona una imagen")},e.pedirCambioOficial=function(a){return a.id?o.put("::images-users/cambiar-imagen-oficial/"+e.USER.user_id,{foto_id:a.id}).then(function(t){return t=t.data,e.hasRoleOrPerm("admin")?(i.setOficial(t.foto_id,a.nombre),e.$emit("cambianImgs",{foto:t}),l.success("Foto oficial cambiada")):l.info("Ahora espera que un administrador acepte tu imagen","Solicitado")},function(e){return l.error("No se pudo cambiar foto","Problema")}):l.warning("Selecciona una imagen")},e.pedirCambioFirma=function(a){var t;return a.id?(t={imgFirmaProfe:a.id},o.put("::perfiles/cambiarfirmaunprofe/"+e.USER.persona_id,t).then(function(a){return l.success("Firma cambiada con éxito"),e.USER.firma_id=a.data.id,e.USER.firma_nombre=a.data.nombre},function(e){return l.error("Error al asignar foto al profesor","Problema")})):l.warning("Selecciona una imagen")},e.cambiarLogoColegio=function(a){return o.put("::myimages/cambiarlogocolegio",{logo_id:a.id}).then(function(t){return l.success("Logo del colegio cambiado"),e.logo.logo=a.nombre,e.logo.logo_id=a.id,console.log(e.logo,a)},function(e){return l.error("No se pudo cambiar el logo","Problema")})},e.grupoSelect=function(a,t){return localStorage.grupo_selected_imgs=a.id,o.get("::grupos/listado/"+a.id).then(function(a){return a=a.data,e.alumnos=a,a[0].selected=!0,e.dato.alumnoElegido=a[0],e.alumSelect(e.dato.alumnoElegido)},function(e){return l.error("No se pudo traer los usuarios")})},e.rotarImagen=function(e){return o.put("::images-users/rotarimagen/"+e.id).then(function(a){return e.nombre="",l.success("Imagen rotada"),e.nombre=a.data+"?"+(new Date).getTime()},function(e){return l.error("Imagen no rotada")})},e.publicarImagen=function(a){return o.put("::myimages/publicar-imagen/"+a.id).then(function(t){return l.info("Ahora la imagen es pública"),e.imagenes_privadas=r("filter")(e.imagenes_privadas,{id:"!"+a.id}),e.imagenes_publicas.push(a)},function(e){return l.error("Imagen no publicada")})},e.privatizarImagen=function(a){return o.put("::myimages/privatizar-imagen/"+a.id).then(function(t){if(!(t=t.data).imagen)return l.info("Ahora la imagen es privada"),a.user_id===e.USER.user_id&&e.imagenes_privadas.push(a),e.imagenes_publicas=r("filter")(e.imagenes_publicas,{id:"!"+a.id});l.warning("No puede ser logo del año "+t.imagen.is_logo_of_year)},function(e){return l.error("Imagen no privatizada")})},e.borrarImagen=function(a,t,n){return s.open({templateUrl:"==fileManager/removeImage.tpl.html",controller:"RemoveImageCtrl",size:"md",resolve:{imagen:function(){return a},user_id:function(){return t},datos_imagen:function(){var r;return r={imagen_id:a.id,user_id:t},o.put("::myimages/datos-imagen",r).then(function(a){return e.datos_imagen=a.data},function(e){return l.error("Error al traer datos de imagen","Problema"),{}})}}}).result.then(function(a){return e.hasRoleOrPerm("admin")?(n?(e.imagenes_del_usuario=r("filter")(e.imagenes_del_usuario,{id:"!"+a.id}),e.dato.selectedImgDelUsuario=void 0):a.publica?e.imagenes_publicas=r("filter")(e.imagenes_publicas,{id:"!"+a.id}):e.imagenes_privadas=r("filter")(e.imagenes_privadas,{id:"!"+a.id}),l.success("La imagen ha sido removida.")):a.user_id===e.USER.user_id?(l.success("La imagen ha sido removida."),a.publica?e.imagenes_publicas=r("filter")(e.imagenes_publicas,{id:"!"+a.id}):e.imagenes_privadas=r("filter")(e.imagenes_privadas,{id:"!"+a.id})):l.info("Un administrador borrará la imagen ya que no fuiste tú quien la subió","Solicitado")})},e.cambiarImgUnUsuario=function(a,t){var n;if(!1,t?confirm("Esto quitará la imágen de tu lista. ¿Seguro que deseas cambiar la imagen de este usuario?"):confirm("¿Ya no quieres que esta sea su imagen de perfil?"))return n={},t&&(n.imagen_id=t.id),o.put("::images-users/cambiar-imagen-un-usuario/"+a.user_id,n).then(function(n){return t?(a.imagen_id=t.id,a.imagen_nombre=t.nombre,e.imagenes_privadas=r("filter")(e.imagenes_privadas,function(e){return e.id!==t.id}),e.dato.selectedImg=void 0,e.imagenes_del_usuario.push(t),l.success("Imagen asignada con éxito")):(a.imagen_id=null,a.imagen_nombre="default_male.png",l.success("Imagen quitada con éxito"))},function(e){return l.error("Error al asignar imagen a usuario","Problema")})},e.cambiarFotoUnUsuario=function(a,t){var n;if(!1,t?confirm("Esto quitará la imágen de tu lista. ¿Seguro que deseas cambiar la imagen de este usuario?"):confirm("¿Ya no quieres que esta sea su foto oficial?"))return n={},t&&(n.imagen_id=t.id),o.put("::images-users/cambiar-foto-un-usuario/"+a.user_id,n).then(function(n){return t?(a.imagen_id=t.id,a.foto_nombre=t.nombre,e.imagenes_privadas=r("filter")(e.imagenes_privadas,function(e){return e.id!==t.id}),e.dato.selectedImg=void 0,e.imagenes_del_usuario.push(t),l.success("Foto asignada con éxito")):(a.foto_id=null,a.foto_nombre="default_male.png",l.success("Foto quitada con éxito"))},function(e){return l.error("Error al asignar foto oficial","Problema")})},e.cambiarFirmaUnProfe=function(a,t){var n;return!1,(t?confirm("Esto quitará la imágen de tu lista. ¿Seguro que deseas asignar firma a este usuario?"):confirm("¿Ya no quieres que sea su firma?"))&&(n={},t&&(n.imagen_id=t.id)),o.put("::images-users/cambiar-firma-un-profe/"+a.profesor_id,n).then(function(n){return t?(a.firma_id=t.id,a.firma_nombre=t.nombre,e.imagenes_privadas=r("filter")(e.imagenes_privadas,function(e){return e.id!==t.id}),e.dato.selectedImg=void 0,e.imagenes_del_usuario.push(t),l.success("Firma asignada con éxito")):(a.firma_id=null,a.firma_nombre=null,l.success("Firma quitada con éxito"))},function(e){return l.error("Error al asignar firma","Problema")})},e.alumSelect=function(a){var t,r,n,i;for(r=0,n=(i=e.alumnos).length;r<n;r++)i[r].selected=!1;return a.selected=!0,e.dato.alumnoElegido=a,t={usuario_id:a.user_id},o.put("::images-users/imagenes-de-usuario",t).then(function(a){return e.imagenes_del_usuario=a.data,e.mostrando_opt_img_de_alum=!0},function(e){return l.error("Error trayendo imagenes del usuario","Problema")})},e.profeSelect=function(a,t){var r;return r={usuario_id:a.user_id},o.put("::images-users/imagenes-de-usuario",r).then(function(a){return e.imagenes_del_usuario=a.data,e.mostrando_opt_img_de_prof=!0},function(e){return l.error("Error trayendo imagenes del usuario","Problema")})},e.moveImgToMe=function(a,t){var n;return e.dato.selectedImgDelUsuario?(n={img_id:a.id},o.put("::images-users/move-img-to-me",n).then(function(t){return e.imagenes_privadas.push(a),e.imagenes_del_usuario=r("filter")(e.imagenes_del_usuario,function(e){return e.id!==a.id}),e.dato.selectedImgDelUsuario=void 0,l.success("Ahora la imagen te pertenece.")},function(e){return l.error("Error mover imagen","Problema")})):l.warning("Seleccione la imagen que quiere tomar.")}}]).filter("filterByNomApell",["Acentos",function(e){return function(a,t){var r,n,o,i,s,u;if(t){if(""!==t){for(n=[],t=e.remove(t),i=0,s=a.length;i<s;i++)r=a[i],u=e.remove(r.nombres),o=e.remove(r.apellidos),-1===u.indexOf(t)&&-1===o.toLowerCase().indexOf(t)||n.push(r);return n}return a}return a}}])}.call(this),function(){angular.module("myvcFrontApp").controller("RemoveImageCtrl",["$scope","$uibModalInstance","imagen","user_id","datos_imagen","App","$http","AuthService","toastr",function(e,a,t,r,n,o,i,s,u){e.imagesPath=o.images+"perfil/",e.imagen=t,e.datos_imagen=n,e.hasRoleOrPerm=s.hasRoleOrPerm,e.ok=function(){return i.delete("::myimages/destroy/"+t.id).then(function(e){return console.log("Proceso de eliminado exitoso")},function(e){return u.error("No se pudo eliminar la imagen.")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","USER_ROLES","PERMISSIONS",function(e,a,t){return e.state("panel.papelera",{url:"^/papelera",views:{maincontent:{templateUrl:"==papelera/papelera.tpl.html",controller:"PapeleraCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Papelera de reciclaje"}]}}},data:{displayName:"Papelera",icon_fa:"fa fa-trash",pageTitle:"Papelera - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("PapeleraCtrl",["$scope","App","$state","$http","$uibModal","$filter","toastr",function(e,a,t,r,n,o,i){var s,u,l,c,d,p;return e.restaurarAlum=function(a){return r.put("::alumnos/restore/"+a.alumno_id).then(function(){return e.gridAlumnos.data=o("filter")(e.gridAlumnos.data,{alumno_id:"!"+a.alumno_id}),i.success("Éxito","Alumno restaurado")},function(e){return i.error("No se restauró el alumno","Error")})},e.elimAlum=function(a){return n.open({templateUrl:"==papelera/forceRemoveAlumno.tpl.html",controller:"ForceRemoveAlumnoCtrl",resolve:{alumno:function(){return a}}}).result.then(function(a){return e.gridAlumnos.data=o("filter")(e.gridAlumnos.data,{alumno_id:"!"+a.alumno_id})})},s='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarAlum(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',u='<a uib-tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimAlum(row.entity)"><i class="fa fa-times "></i></a>',e.gridAlumnos={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"alumno_id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:110,enableSorting:!1,enableFiltering:!1,cellTemplate:s+u},{field:"nombres",enableHiding:!1},{field:"apellidos"},{field:"sexo",maxWidth:20},{field:"username",displayName:"Usuario"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date"},{field:"direccion",displayName:"Dirección"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a}},e.restaurarGrupo=function(a){return r.put("::grupos/restore/"+a.id).then(function(){return e.gridGrupos.data=o("filter")(e.gridGrupos.data,{id:"!"+a.id}),i.success("Éxito","Grupo restaurado")},function(e){return i.error("No se restauró el grupo","Error")})},e.elimGrupo=function(a){return n.open({templateUrl:"::papelera/forceRemoveGrupo.tpl.html",controller:"ForceRemoveGrupoCtrl",resolve:{grupo:function(){return a}}}).result.then(function(a){return e.gridGrupos.data=o("filter")(e.gridGrupos.data,{id:"!"+a.id})})},l='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarGrupo(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',c='<a uib-tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimGrupo(row.entity)"><i class="fa fa-times "></i></a>',e.gridGrupos={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:110,enableSorting:!1,enableFiltering:!1,cellTemplate:l+c},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura"},{field:"grado_id",maxWidth:20},{field:"titular_id",displayName:"Titular"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a}},r.get("::alumnos/trashed").then(function(a){return e.gridAlumnos.data=a.data},function(e){return i.warning("No se pudo traer los alumnos eliminados.")}),r.get("::grupos/trashed").then(function(a){return e.gridGrupos.data=a.data},function(e){return i.warning("No se pudo traer los grupos eliminados.")}),e.restaurarUnidad=function(a){return r.put("::unidades/restore/"+a.id).then(function(){return e.gridUnidad.data=o("filter")(e.gridUnidad.data,{id:"!"+a.id}),i.success("Éxito","Unidad restaurada")},function(e){return i.error("No se restauró la unidad","Error")})},e.elimUnidad=function(a){return n.open({templateUrl:"==papelera/forceRemoveUnidad.tpl.html",controller:"ForceRemoveUnidadCtrl",resolve:{unidad:function(){return a}}}).result.then(function(a){return e.gridUnidad.data=o("filter")(e.gridUnidad.data,{id:"!"+a.id})})},d='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarUnidad(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',p='<a uib-tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimUnidad(row.entity)"><i class="fa fa-times "></i></a>',e.gridUnidad={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:110,enableSorting:!1,enableFiltering:!1,cellTemplate:d+p},{field:"definicion",displayName:"Definición",enableHiding:!1},{field:"alias_materia",displayName:"Materia"},{field:"abrev_grupo",displayName:"Grupo"},{field:"numero_periodo",displayName:"Per",maxWidth:20},{field:"porcentaje",displayName:"Porc"}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a}},r.get("::unidades/trashed").then(function(a){return e.gridUnidad.data=a.data},function(e){return i.warning("No se pudo traer las unidades eliminados.")}),r.get("::unidades/trashed").then(function(a){return e.gridUnidad.data=a.data},function(e){return i.warning("No se pudo traer las unidades eliminadas.")})}])}.call(this),function(){angular.module("myvcFrontApp").controller("ForceRemoveAlumnoCtrl",["$scope","$uibModalInstance","alumno","$http","toastr",function(e,a,t,r,n){return e.alumno=t,e.ok=function(){return r.delete("::alumnos/forcedelete/"+t.alumno_id).then(function(e){return n.success("Alumno eliminado con éxito.","Eliminado")},function(e){return n.warning("No se pudo eliminar al alumno.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}]).controller("ForceRemoveGrupoCtrl",["$scope","$uibModalInstance","grupo","$http","toastr",function(e,a,t,r,n){return e.grupo=t,e.ok=function(){return r.delete("::grupos/forcedelete/"+t.id).then(function(e){return n.success("Grupo eliminado con éxito.","Eliminado")},function(e){return n.warning("No se pudo eliminar al grupo.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}]).controller("ForceRemoveUnidadCtrl",["$scope","$uibModalInstance","unidad","$http","toastr",function(e,a,t,r,n){return e.unidad=t,e.ok=function(){return r.delete("::unidades/forcedelete/"+t.id).then(function(e){return n.success("Unidad eliminada con éxito.","Eliminado")},function(e){return n.warning("No se pudo eliminar la unidad.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(e,a){return e.state("panel.bitacora",{url:"/bitacora",views:{maincontent:{templateUrl:`${a.views}bitacora/bitacora.tpl.html`,controller:"BitacoraCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Bitacora"}]}}},data:{displayName:"Bitacora",icon_fa:"fa fa-male",pageTitle:"Bitácora - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("BitacoraCtrl",["$scope","toastr","$state","$http","uiGridConstants","AuthService",function(e,a,t,r,n,o){var i;return e.data={},e.hasRoleOrPerm=o.hasRoleOrPerm,r.get("::contratos").then(function(a){return e.contratos=a.data},function(e){return a.error("No se trajeron los profesores contratados")}),r.get("::bitacoras").then(function(a){return e.gridOptions.data=a.data},function(e){return a.error("No se pudo traer la bitácora")}),e.seleccionaProfe=function(t,n){return r.get("::bitacoras/index/"+t.user_id).then(function(a){return e.gridOptions.data=a.data},function(e){return a.error("No se pudo traer la bitácora")})},i='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',e.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",width:60},{name:"edicion",displayName:"Edición",width:40,enableSorting:!1,enableFiltering:!1,cellTemplate:i,enableCellEdit:!1},{field:"descripcion",displayName:"Descripción",filter:{condition:n.filter.CONTAINS}},{field:"affected_element_type",displayName:"Tipo",minWidth:80,filter:{condition:n.filter.CONTAINS}},{field:"affected_element_old_value_int",displayName:"Anterior"},{field:"affected_element_new_value_int",displayName:"Nuevo"},{field:"created_at",displayName:"Fecha",width:150,filter:{condition:n.filter.CONTAINS}}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a}}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","USER_ROLES","PERMISSIONS",function(e,a,t){e.state("panel.usuarios",{url:"^/usuarios",views:{maincontent:{templateUrl:"==usuarios/usuarios.tpl.html",controller:"UsuariosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Usuarios"}]}}},data:{displayName:"Usuarios",icon_fa:"fa fa-user",needed_permissions:[t.can_edit_usuarios],pageTitle:"Usuarios - MyVc"}}).state("panel.user",{url:"^/user/:username",views:{maincontent:{templateUrl:"==usuarios/user.tpl.html",controller:"UserCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Perfil"}]}}},resolve:{perfilactual:["$http","$stateParams","$q","$state","toastr",function(e,a,t,r,n){var o,i;return o=t.defer(),(i=a.username)||""===i?e.get("::perfiles/username/"+i).then(function(e){return e.data[0].fecha_nac&&(e.data[0].fecha_nac=e.data[0].fecha_nac?new Date(e.data[0].fecha_nac.replace(/-/g,"/")):e.data[0].fecha_nac),o.resolve(e.data[0])},function(e){return o.reject(e)}):(n.warning("Lo sentimos, nombre de usuario no encontrado"),r.go("panel")),o.promise}]},data:{displayName:"Perfil",icon_fa:"fa fa-user"}}).state("panel.user.resumen",{url:"/r",views:{user_detail:{templateUrl:"==usuarios/userResumen.tpl.html",controller:"UserResumenCtrl"}},data:{displayName:"Resumen",icon_fa:"fa fa-user"}}).state("panel.user.configuracion",{url:"/c",views:{user_detail:{templateUrl:"==usuarios/userConfiguracion.tpl.html",controller:"UserConfiguracionCtrl"}},data:{displayName:"Configuración de perfil",icon_fa:"fa fa-user"}}).state("panel.usuarios.roles",{url:"/roles",views:{user_roles:{templateUrl:"==usuarios/roles.tpl.html",controller:"RolesCtrl"}},data:{displayName:"Roles",icon_fa:"fa fa-user-secret"}}).state("panel.usuarios.editar",{url:"/editar/:user_id",views:{edit_user:{templateUrl:"==usuarios/usuariosEdit.tpl.html",controller:"UsuariosEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-users",pageTitle:"Editar alumno - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserCtrl",["$scope","$http","$state","AuthService","Perfil","App","perfilactual","$filter",function(e,a,t,r,n,o,i,s){if(t.params.username,e.perfilactual=i,e.companieros=[],e.profesores=[],e.materias=[],e.canConfig=!1,e.hasRoleOrPerm=r.hasRoleOrPerm,e.perfilPath=o.images+"perfil/",e.setImagenPrincipal(),e.USER.user_id===e.perfilactual.user_id&&(e.canConfig=!0),e.setImagenPrincipal=function(){var a,t,r;return r=(a=o.images+"perfil/")+e.perfilactual.imagen_nombre,t=a+e.perfilactual.foto_nombre,e.imagenPrincipal=r,e.imagenOficial=t},function(){return a.get("::perfiles/profesormispersonas").then(function(a){return a=a.data,e.perfilactual=a[0],e.setImagenPrincipal()},function(e){return toastr.error("No se pudo traer el usuario"),t.transitionTo("panel")})},e.paisNacSelect=function(t,r){return a.get("::ciudades/departamentos/"+t.id).then(function(a){if(e.departamentosNac=a.data,void 0===e.perfilactual.pais_doc)return e.perfilactual.pais_doc=t,e.paisDocSelecionado(t)})},e.departNacSelect=function(t){return a.get("::ciudades/por-departamento/"+t.departamento).then(function(a){if(e.ciudadesNac=a.data,void 0===e.perfilactual.departamento_doc)return e.perfilactual.departamento_doc=t,e.departDocSeleccionado(t)})},e.paisDocSelecionado=function(t,r){return a.get("::ciudades/departamentos/"+t.id).then(function(a){return e.departamentos=a.data})},e.departDocSeleccionado=function(t){return a.get("::ciudades/por-departamento/"+t.departamento).then(function(a){return e.ciudades=a.data})},a.get("::paises").then(function(a){return e.paises=a.data}),a.get("::tiposdocumento").then(function(a){var t;if(e.tipos_doc=a.data,e.perfilactual.tipo_doc&&(t=s("filter")(e.tipos_doc,{id:e.perfilactual.tipo_doc})).length>0)return e.perfilactual.tipo_doc=t[0]}),null===e.perfilactual.ciudad_nac)e.perfilactual.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},e.paisNacSelect(e.perfilactual.pais_nac,e.perfilactual.pais_nac);else{if("N/A"===e.perfilactual.ciudad_nac)return;a.get("::ciudades/datosciudad/"+e.perfilactual.ciudad_nac).then(function(a){return e.paises=a.data.paises,e.departamentosNac=a.departamentos,e.ciudadesNac=a.ciudades,e.perfilactual.pais_nac=a.pais,e.perfilactual.departamento_nac=a.departamento,e.perfilactual.ciudad_nac=a.ciudad}),a.get("::ciudades/datosciudad/"+e.perfilactual.ciudad_doc).then(function(a){return e.paises=a.data.paises,e.departamentos=a.departamentos,e.ciudades=a.ciudades,e.perfilactual.pais_doc=a.pais,e.perfilactual.departamento_doc=a.departamento,e.perfilactual.ciudad_doc=a.ciudad})}return e.nameToShow=function(){return"Usu"===e.perfilactual.tipo?e.perfilactual.username.toUpperCase():e.perfilactual.nombres+" "+e.perfilactual.apellidos}}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserConfiguracionCtrl",["$scope","$http","$state","toastr","AuthService","Perfil","App","perfilactual",function(e,a,t,r,n,o,i,s){return n.verificar_acceso(),e.data={},e.comprobando=!1,e.mostrarErrorUsername=!1,e.mostrarErrorPassword=!1,e.canSaveUsername=!1,e.hasRoleOrPerm=n.hasRoleOrPerm,e.perfilPath=i.images+"perfil/",e.perfilactual=s,e.newusername="",e.passantiguo="",e.newpass="",e.newpassverif="",e.status={passCambiado:!1},e.nombresdeusuario=[],a.get("::perfiles/usernames").then(function(a){return e.nombresdeusuario=a.data},function(e){return r.error("No se trajeron los nombres de usuario")}),e.dateOptions={formatYear:"yyyy",allowInvalid:!0},e.guardarEmailRestore=function(e){return a.put("::perfiles/guardar-mi-email-restore",{email_restore:e}).then(function(e){return r.success("Email guardado con éxito")},function(e){return r.error("No se trajeron los nombres de usuario")})},e.$watch("newusername",function(e,a){}),e.comprobarusername=function(t){return e.canSaveUsername=!1,e.comprobando=!0,t.username&&(t=t.username),t===e.perfilactual.username?(r.warning("Copia un nombre de usuario diferente al que ya tienes"),void(e.comprobando=!1)):""===t?(r.warning("Debes copiar un nombre de usuario."),void(e.comprobando=!1)):a.get("::perfiles/comprobarusername/"+t).then(function(a){return(a=a.data)[0].existe?(r.warning("Nombre de usuario ya en uso."),e.mostrarErrorUsername=!0):(e.mostrarErrorUsername=!1,e.canSaveUsername=!0),e.comprobando=!1},function(a){return r.error("No se trajeron los nombres de usuario"),e.comprobando=!1})},e.guardar=function(){var t;return e.canSaveUsername=!1,t={nombres:e.perfilactual.nombres,apellidos:e.perfilactual.apellidos,sexo:e.perfilactual.sexo,fecha_nac:e.perfilactual.fecha_nac,celular:e.perfilactual.celular,tipo:e.perfilactual.tipo,email_persona:e.perfilactual.email_persona},a.put("::perfiles/update/"+e.perfilactual.persona_id,t).then(function(e){return r.success("Datos guardados")},function(a){return r.error("Datos NO guardados","Problema"),e.canSaveUsername=!0})},e.solicitarCambios=function(){return e.canSaveUsername=!1,a.put("::ChangesAsked/solicitar-cambios",e.perfilactual).then(function(e){return r.info("Debes esperar que un administrador acepte cambios","Solicitud realizada",{timeOut:8e3})},function(a){return r.error("Datos NO guardados","Problema"),e.canSaveUsername=!0})},e.CambiarUsername=function(t){return a.put("::perfiles/guardar-username/"+e.perfilactual.user_id,{username:t}).then(function(a){return r.success("Nombre de usuario guardado"),o.User().username=t,e.$emit("cambianImgs",{username:t})},function(e){return r.error("Nombre de usuario NO guardado","Problema")})},e.CambiarPass=function(t,n,o){var i;if(t===n){if(!(t.length<4))return e.cambiandoPass=!0,i={password:n,oldpassword:o},a.put("::perfiles/cambiarpassword/"+e.perfilactual.user_id,i).then(function(a){return r.success("Contraseña cambiada."),e.status.passCambiado=!1,e.cambiandoPass=!1},function(a){return(a=a.data).$error&&"Contraseña antigua es incorrecta"===a.error.message?r.warning(a.error.message):r.error("No se pudo cambiar la contraseña."),e.cambiandoPass=!1});r.warning("La contraseña debe tener mínimo 4 caracteres. Sin espacios ni Ñ ni tildes.")}else r.warning("Las contraseñas no coinciden")},e.CambiarCorreoRestore=function(){var t;return t={email_restore:e.email_restore},a.put("::perfiles/cambiaremailrestore/"+e.perfilactual.user_id,t).then(function(e){return r.success("Contraseña cambiada.")},function(e){return r.error("No se pudo cambiar la contraseña","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserResumenCtrl",["$scope","$http",function(e,a){return console.log("Perm control")}])}.call(this),function(){angular.module("myvcFrontApp").controller("UsuariosCtrl",["$scope","$http","$state","$rootScope","AuthService","Perfil","App","$uibModal","$filter","toastr",function(e,a,t,r,n,o,i,s,u,l){var c,d;return n.verificar_acceso(),e.editar=function(e){return t.go("panel.usuarios.editar",{usuario_id:e.user_id})},e.eliminar=function(a){return s.open({templateUrl:"==usuarios/removeUsuario.tpl.html",controller:"RemoveUsuarioCtrl",resolve:{usuario:function(){return a}}}).result.then(function(a){return e.gridOptions.data=u("filter")(e.gridOptions.data,{id:"!"+a.id})})},e.resetPass=function(e){return s.open({templateUrl:"==usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return e}}}).result.then(function(e){})},e.verRoles=function(e){return s.open({templateUrl:"==usuarios/verRoles.tpl.html",controller:"VerRolesCtrl",resolve:{usuario:function(){return e},roles:function(){return a.get("::roles")}}}).result.then(function(e){})},c='<a uib-tooltip="No cambies roles, consulta antes" class="btn btn-default btn-xs shiny" ng-click="grid.appScope.verRoles(row.entity)">Roles</a>',d='<a uib-tooltip="Resetear contraseña" tooltip-placement="right" class="btn btn-default btn-xs shiny" ng-click="grid.appScope.resetPass(row.entity)">Cambiar password</a>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enableGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"user_id",width:70,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:200,enableSorting:!1,enableFiltering:!1,cellTemplate:c+d,enableCellEdit:!1},{field:"username",displayName:"Usuario",filter:{condition:function(e,a,t){var r;return!!(r=t.entity).username&&r.username.toLowerCase().indexOf(e.toLowerCase())>-1}},enableHiding:!1},{field:"nombres",cellTemplate:'<div>{{row.entity.nombres + " " + row.entity.apellidos}}</div>',filter:{condition:function(e,a,t){var r;return!!(r=t.entity).nombres&&(r.nombres.toLowerCase().indexOf(e.toLowerCase())>-1||r.apellidos.toLowerCase().indexOf(e.toLowerCase())>-1)}}},{field:"sexo",width:70},{field:"roles",displayName:"Roles",enableCellEdit:!1,cellFilter:"mapRoles",filter:{condition:function(e,a){return u("filter")(a,{name:e}).length>0}}}],multiSelect:!1,onRegisterApi:function(t){return e.gridApi=t,t.edit.on.afterCellEdit(e,function(t,r,n,o){return n!==o&&("username"===r.field?a.put("::perfiles/guardar-username/"+t.user_id,{username:t.username}).then(function(e){return l.success("Nombre de Usuario actualizado con éxito","Actualizado")},function(e){return l.error("Cambio no guardado","Error")}):a.put("::perfiles/update/"+t.persona_id,t).then(function(e){return l.success("Usuario actualizado con éxito","Actualizado")},function(e){return l.error("Cambio no guardado","Error")})),e.$apply()})}},a.get("::perfiles/usuariosall?year_id="+e.USER.year_id).then(function(a){return e.gridOptions.data=a.data}),e.crearTodosLosUsuarios=function(){return a.put("::perfiles/creartodoslosusuarios").then(function(e){return l.success("Usuarios creados con éxito")},function(e){return l.error("No se pudo crear los usuarios","Problema")})}}]).filter("mapRoles",["$filter",function(e){return function(e,a){var t;return e?(t=[],angular.forEach(e,function(e,a){return t.push(e.name)}),t=t.join()):""}}]).controller("RemoveUsuarioCtrl",["$scope","$uibModalInstance","usuario","$http","toastr",function(e,a,t,r,n){return e.usuario=t,e.ok=function(){return r.delete("::perfiles/destroy/"+t.user_id).then(function(e){return n.success("Usuario eliminado con éxito.","Eliminado")},function(e){return n.warning("No se pudo eliminar al usuario.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}]).controller("ResetPassCtrl",["$scope","$uibModalInstance","usuario","$http","toastr",function(e,a,t,r,n){return e.usuario=t,e.newpassword="",e.showPassword=!1,e.ok=function(){return r.put("::perfiles/reset-password/"+t.user_id,{password:e.newpassword}).then(function(e){return n.success("Contraseña cambiada.")},function(e){return n.warning("No se pudo cambiar contraseña.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}]).controller("VerRolesCtrl",["$scope","$uibModalInstance","usuario","roles","$http","toastr",function(e,a,t,r,n,o){return e.usuario=t,e.roles=r.data,e.datos={selecteds:[]},e.datos.selecteds=t.roles,e.seleccionando=function(e,a){return n.put("::roles/addroletouser/"+e.id,{user_id:t.user_id}).then(function(e){return o.success("Rol agregado con éxito.")},function(e){return o.warning("No se pudo agregar el rol al usuario.","Problema")})},e.quitando=function(e,a){return n.put("::roles/removeroletouser/"+e.id,{user_id:t.user_id}).then(function(e){return o.success("Rol quitado con éxito.")},function(e){return o.warning("No se pudo quitar el rol al usuario.","Problema")})},e.ok=function(){return t.roles=e.datos.selecteds,a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("UsuariosEditCtrl",["$scope","$rootScope","$state","$http","toastr",function(e,a,t,r,n){e.data={},e.usuario={},e.tipos=[{tipo:"Alumno"},{tipo:"Profesor"},{tipo:"Acudiente"},{tipo:"Solo usuario"}],e.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],r.get("::usuarios/show/"+t.params.usuario_id).then(function(a){return e.usuario=a.data}),e.guardar=function(){return r.put("::alumnos/update/"+e.alumno.id,e.alumno).then(function(e){return n.success("Alumno actualizado correctamente")},function(e){return n.error("No se pudo guardar el alumno")})},e.paisNacSelect=function(a,t){return r.get("::ciudades/departamentos/"+a.id).then(function(t){if(e.departamentosNac=t,void 0===e.alumno.pais_doc)return e.alumno.pais_doc=a,e.paisSelecionado(a)})},e.departNacSelect=function(a){return r.get("::ciudades/por-departamento/"+a.departamento).get().then(function(t){if(e.ciudadesNac=t,void 0===e.alumno.departamento_doc)return e.alumno.departamento_doc=a,e.departSeleccionado(a)})},e.paisSelecionado=function(a,t){return r.get("::ciudades/departamentos/"+a.id).then(function(a){return e.departamentos=a.data})},e.departSeleccionado=function(a){return r.get("::ciudades/por-departamento/"+a.departamento).then(function(a){return e.ciudades=a.data})},e.dateOptions={formatYear:"yyyy"},e.restarEstrato=function(){if(e.alumno.estrato>0)return e.alumno.estrato=e.alumno.estrato-1},e.sumarEstrato=function(){if(e.alumno.estrato<10)return e.alumno.estrato=parseInt(e.alumno.estrato)+1}}])}.call(this),function(){angular.module("myvcFrontApp").controller("RolesCtrl",["$scope","$http","$state","$rootScope","AuthService","toastr","App","$filter",function(e,a,t,r,n,o,i,s){return n.verificar_acceso(),e.hasRoleOrPerm=n.hasRoleOrPerm,e.dato={},e.roles=[],e.permissions=[],a.get("::roles").then(function(a){return e.roles=a.data},function(e){return o.error("No se pudo traer los roles ",e)}),a.get("::permissions").then(function(a){return e.permissions=a.data},function(e){return o.error("No se pudo traer los permissions ",e)}),e.expand=function(e){return e.mostrandoPermisos=!0},e.collapse=function(e){return e.mostrandoPermisos=!1},e.addPermissions=function(e){return a.put("::roles/addpermission/"+e.id,{permission_id:e.newperm.id}).then(function(a){return e.perms.push(a.data),o.success("Permiso agregado al rol "+e.display_name)},function(e){return o.error("No se pudo agregar el permiso","Problema")})},e.removePermission=function(e,t){return a.put("::roles/removepermission/"+e.id,{permission_id:t.id}).then(function(a){return e.perms=s("filter")(e.perms,{id:"!"+t.id}),o.success("Permiso eliminado del rol "+e.display_name)},function(e){return o.error("No se pudo quitar el permiso","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PermissionsCtrl",["$scope","$http",function(e,a){return console.log("Perm control")}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(e,a,t){return e.state("panel.unidades",{url:"^/unidades/:asignatura_id",views:{maincontent:{templateUrl:"==unidades/unidades.tpl.html",controller:"UnidadesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:["AuthService","$q",function(e,a){var t;return t=a.defer(),e.verificar().then(function(e){return t.resolve(e.unidades_displayname)},function(e){return t.resolve("Unidades")}),t.promise}]}}},resolve:{usuario:["AuthService",function(e){return e.verificar()}]},data:{displayName:"Unidades",icon_fa:"fa fa-graduation-cap",pageTitle:"Unidades - MyVc",needed_permissions:[t.can_work_like_teacher,t.can_edit_unidades_subunidades]}}).state("panel.copiar",{url:"^/copiar",views:{maincontent:{templateUrl:"==unidades/copiar.tpl.html",controller:"CopiarCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Copiar"}]}}},data:{displayName:"Copiar",icon_fa:"fa fa-copy",pageTitle:"Copiar - MyVc",needed_permissions:[t.can_work_like_teacher,t.can_edit_unidades_subunidades]}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("UnidadesCtrl",["$scope","$uibModal","$http","$state","$filter","AuthService","toastr","resolved_user","$timeout",function(e,a,t,r,n,o,i,s,u){return o.verificar_acceso(),e.asignatura={},e.asignatura_id=r.params.asignatura_id,e.datos={},e.UNIDAD=e.USER.unidad_displayname,e.GENERO_UNI=e.USER.genero_unidad,e.SUBUNIDAD=e.USER.subunidad_displayname,e.GENERO_SUB=e.USER.genero_subunidad,e.UNIDADES=e.USER.unidades_displayname,e.SUBUNIDADES=e.USER.subunidades_displayname,e.hasRoleOrPerm=o.hasRoleOrPerm,e.activar_crear_unidad=!0,e.unidades=[],t.get("::unidades/de-asignatura-periodo/"+e.asignatura_id+"/"+e.USER.periodo_id).then(function(a){var t,r,o,i,s,u,l,c;if(a.data.length>0){for(t=0,o=(s=a.data).length;t<o;t++)for((c=s[t]).anim_bloqueada=!1,c.subunidades=n("orderBy")(c.subunidades,"orden"),e.bloquear_animacion(c),r=0,i=(u=c.subunidades).length;r<i;r++)(l=u[r]).anim_bloqueada=!1,e.bloquear_animacion(l);return e.unidades=a.data,e.unidades=n("orderBy")(e.unidades,"orden"),e.calcularPorcUnidades()}},function(a){return i.error("No se pudo traer las "+e.UNIDADES,"Problemas")}),t.get("::asignaturas/show/"+e.asignatura_id).then(function(a){if(a=a.data,e.asignatura=a,e.inicializado=!0,e.profesor_id=a.profesor_id,!a)return e.no_asignatura=!0},function(a){return i.error("No se pudo traer los datos de la asignatura"),e.no_asignatura=!0}),e.mostrarUnidadesEliminadas=function(){return e.mostrando_unidades_eliminadas?e.mostrando_unidades_eliminadas=!1:t.put("::unidades/eliminadas/"+e.asignatura_id).then(function(a){return a=a.data,e.unidades_eliminadas=a.unidades_eliminadas,e.subunidades_eliminadas=a.subunidades_eliminadas,e.mostrando_unidades_eliminadas=!0},function(a){return e.mostrando_unidades_eliminadas=!0,i.error("No se pudo traer las unidades eliminadas")})},e.restaurarUnidad=function(a){if(!a.restaurando)return a.restaurando=!0,t.put("::unidades/restore/"+a.id).then(function(t){return e.unidades.push(a),e.calcularPorcUnidades(),u(function(){return e.onSortUnidades(void 0,e.unidades)},100),i.success("Listo.")},function(e){return a.restaurando=!1,i.error("Error restaurando","Problema")})},e.mostrarSubunidadesEliminadas=function(){return e.mostrando_subunidades_eliminadas?e.mostrando_subunidades_eliminadas=!1:t.put("::subunidades/eliminadas/"+e.asignatura_id).then(function(a){return a=a.data,e.subunidades_eliminadas=a.subunidades,e.mostrando_subunidades_eliminadas=!0},function(a){return e.mostrando_subunidades_eliminadas=!0,i.error("No se pudo traer las subunidades eliminadas")})},e.restaurarSubunidad=function(e){if(!e.restaurando)return e.restaurando=!0,t.put("::subunidades/restore/"+e.id).then(function(e){return i.success("Listo. Recargue para ver los cambios")},function(a){return e.restaurando=!1,i.error("Error restaurando","Problema")})},e.copiarUnidades=function(){return e.asignatura.periodo_id=e.USER.periodo_id,e.asignatura.year_id=e.USER.year_id,localStorage.asignatura_a_copiar=JSON.stringify(e.asignatura),r.go("panel.copiar")},e.calcularPorcUnidades=function(){var a;return a=0,angular.forEach(e.unidades,function(e,t){var r;return a+=e.porcentaje,r=0,angular.forEach(e.subunidades,function(e,a){return r+=e.porcentaje}),e.subunidades.porc_subunidades=r,e.subunidades.unidad_id=e.id}),e.unidades.porc_unidades=a},e.crearUnidad=function(){return e.activar_crear_unidad=!1,e.newunidad.asignatura_id=e.asignatura.asignatura_id,t.post("::unidades",e.newunidad).then(function(a){var t;return(a=a.data).subunidades=[],a.obligatoria=0,a.anim_bloqueada=!1,e.unidades.push(a),t="creado","F"===e.GENERO_UNI&&(t="creada"),i.success(e.UNIDAD+" "+t+". Ahora agrégale "+e.SUBUNIDADES),e.newunidad.definicion="",e.calcularPorcUnidades(),e.activar_crear_unidad=!0,e.bloquear_animacion()},function(a){return i.error("No se pudo crear la unidad","Problemas"),e.activar_crear_unidad=!0})},e.actualizarUnidad=function(a){var r;return r={definicion:a.definicion,porcentaje:a.porcentaje},t.put("::unidades/update/"+a.id,r).then(function(t){var r;return r="actualizado","F"===e.GENERO_UNI&&(r="actualizada"),i.success(e.UNIDAD+" "+r+" con éxito."),a.editando=!1,e.calcularPorcUnidades()},function(a){return i.error("No se pudo actualizar "+e.UNIDAD,"Problemas")})},e.removeUnidad=function(t){return a.open({templateUrl:"==unidades/removeUnidad.tpl.html",controller:"RemoveUnidadCtrl",resolve:{unidad:function(){return t}}}).result.then(function(a){return e.unidades=n("filter")(e.unidades,{id:"!"+a.id}),e.calcularPorcUnidades(),u(function(){return e.onSortUnidades(void 0,e.unidades)},100)})},e.onSortUnidades=function(a,r,n,o,s){var u,l,c,d,p,f,m;for(f=[],d=c=0,p=r.length;c<p;d=++c)(m=r[d]).orden=d,(l={})[""+m.id]=d,f.push(l);return u={sortHash:f},t.put("::unidades/update-orden",u).then(function(e){return!0},function(e){return i.warning("No se pudo ordenar","Problema"),!1}),e.calcularPorcUnidades()},e.onStartSortUnidades=function(e,a,t,r){return console.log(e,a)},e.bloquear_animacion=function(e){if(e)return u(function(){return e.anim_bloqueada=!0},2e3)},e.activar_crear_subunidad=!0,e.onSortSubunidades=function(a,r,n,o,s){var u,l,c,d,p,f,m,g,_,h,v,b,y;if(r===n){for(h=[],d=c=0,m=r.length;c<m;d=++c)(y=r[d]).orden=d,(l={})[""+y.id]=d,h.push(l);u={sortHash:h},t.put("::subunidades/update-orden",u).then(function(e){return!0},function(e){return i.warning("No se pudo ordenar","Problema"),!1})}else{for(v=[],b=[],u={},d=p=0,g=r.length;p<g;d=++p)(y=r[d]).orden=d,(l={})[""+y.id]=d,v.push(l);for(v.length>0&&(u.unidad1_id=r.unidad_id,u.sortHash1=v),d=f=0,_=n.length;f<_;d=++f)(y=n[d]).orden=d,(l={})[""+y.id]=d,b.push(l);v.length>0&&(u.unidad2_id=n.unidad_id,u.sortHash2=b),t.put("::subunidades/update-orden-varias",u).then(function(e){return!0},function(e){return i.warning("No se pudo ordenar","Problema"),!1})}return e.calcularPorcUnidades()},e.addSubunidad=function(a){return e.activar_crear_subunidad=!1,a.newsubunidad?a.newsubunidad.definicion?(a.newsubunidad.porcentaje||(a.newsubunidad.porcentaje=0),a.newsubunidad.nota_default||(a.newsubunidad.nota_default=0),a.newsubunidad.unidad_id=a.id,a.newsubunidad.definicion=a.newsubunidad.definicion.trim(),t.post("::subunidades",a.newsubunidad).then(function(t){var r;return t.data.anim_bloqueada=!1,a.subunidades.push(t.data),r="creado","F"===e.GENERO_SUB&&(r="creada"),i.success(e.SUBUNIDAD+" "+r+" con éxito."),a.newsubunidad.definicion="",e.calcularPorcUnidades(),e.activar_crear_subunidad=!0,e.bloquear_animacion(t.data)},function(a){return i.error("No se pudo crear  "+("M"===e.GENERO_UNI?"el":"la")+scope.SUBUNIDAD,"Problemas"),e.activar_crear_subunidad=!0})):(i.warning("Debes escribir la difinición."),void(e.activar_crear_subunidad=!0)):(i.warning("Aún debes escribir."),void(e.activar_crear_subunidad=!0))},e.ir_a_notas=function(e){return r.go("panel.notas",e)},e.actualizarSubunidad=function(a){var r;return r={definicion:a.definicion,porcentaje:a.porcentaje,nota_default:a.nota_default,orden:a.orden},t.put("::subunidades/update/"+a.id,r).then(function(t){var r;return r="actualizado","F"===e.GENERO_SUB&&(r="actualizada"),i.success(e.SUBUNIDAD+" "+r+" con éxito."),a.editando=!1,e.calcularPorcUnidades()},function(a){return i.error("No se pudo actualizar "+e.SUBUNIDAD,"Problemas")})},e.removeSubunidad=function(t,r){return a.open({templateUrl:"==unidades/removeSubunidad.tpl.html",controller:"RemoveSubunidadCtrl",resolve:{subunidad:function(){return r}}}).result.then(function(a){return t.subunidades=n("filter")(t.subunidades,{id:"!"+r.id}),e.calcularPorcUnidades(),u(function(){return e.onSortSubunidades(void 0,void 0,t.subunidades)},100)})}}]).controller("RemoveUnidadCtrl",["$scope","$uibModalInstance","unidad","$http","toastr",function(e,a,t,r,n){return e.unidad=t,e.ok=function(){return r.delete("::unidades/destroy/"+t.id).then(function(e){return n.success("Unidad eliminada con éxito.","Eliminada")},function(e){return n.warning("No se pudo eliminar la unidad.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}]).controller("RemoveSubunidadCtrl",["$scope","$uibModalInstance","subunidad","$http","toastr",function(e,a,t,r,n){return e.subunidad=t,e.ok=function(){return r.delete("::subunidades/destroy/"+t.id).then(function(e){return n.success("Subunidad eliminada con éxito.","Eliminada")},function(e){return n.warning("No se pudo eliminar la subunidad.","Problema")}),a.close(t)},e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CopiarCtrl",["$scope","$uibModal","$http","$filter","$rootScope","AuthService","toastr","App","YearsServ",function(e,a,t,r,n,o,i,s,u){var l;return o.verificar_acceso(),e.hasRoleOrPerm=o.hasRoleOrPerm,e.configuracion={copiar_subunidades:!0,copiar_notas:!0},e.periodos=[],e.resultado="",l=e.USER.persona_id,e.urlTplSubunidades="==unidades/subunidadespop.tpl.html",e.profesores=[],!0===e.hasRoleOrPerm("admin")&&(e.conprofes=!0),t.get("::profesores/conyears").then(function(a){var t,r,n,o,i,s,u,c,d,p,f,m,g;if(e.profesores=a.data,localStorage.asignatura_a_copiar){if(e.asignatura_a_copiar=JSON.parse(localStorage.asignatura_a_copiar),e.asignatura_a_copiar.profesor_id){for(f=[],t=0,o=(c=e.profesores).length;t<o;t++){if((u=c[t]).id===e.asignatura_a_copiar.profesor_id)for(e.configuracion.profesor_from=u,e.years_copy=u.years,r=0,i=(d=e.years).length;r<i;r++)(g=d[r]).id===e.asignatura_a_copiar.year_id&&(e.configuracion.year_from=g,e.yearSelect(g));u.id===l?(e.years_copy_to=u.years,e.configuracion.year_to=u.years[u.years.length-1],f.push(e.yearToSelect(u.years[u.years.length-1]))):f.push(void 0)}return f}for(m=[],n=0,s=(p=e.profesores).length;n<s;n++)(u=p[n]).id===l?(e.years_copy_to=u.years,e.configuracion.year_to=u.years[u.years.length-1],m.push(e.yearToSelect(u.years[u.years.length-1]))):m.push(void 0);return m}},function(e){return i.error("No se pudo traer los profes con años",e)}),e.profesorSelect=function(a,t){return e.years_copy=a.years,e.configuracion.year_from=e.years_copy[e.years_copy.length-1],e.configuracion.periodo_from?(e.configuracion.periodo_from=e.configuracion.year_from.periodos[0],e.periodoSelect(e.configuracion.periodo_from)):e.periodos=e.configuracion.year_from.periodos},e.yearSelect=function(a,t){var r,n,o,i,s;if(e.periodos=a.periodos,e.asignatura_a_copiar&&e.asignatura_a_copiar.periodo_id){for(s=[],r=0,n=(i=e.periodos).length;r<n;r++)(o=i[r]).id===e.asignatura_a_copiar.periodo_id?(e.configuracion.periodo_from=o,s.push(e.periodoSelect(o))):s.push(void 0);return s}},e.periodoSelect=function(a,n){var o;return o=e.asignatura_a_copiar?e.asignatura_a_copiar.profesor_id:e.configuracion.profesor_from.id,t.get("::asignaturas/list-asignaturas-year/"+o+"/"+e.configuracion.periodo_from.id).then(function(a){var t,n,o,i,s,u;if(e.asignaturas=a.data,e.asignatura_a_copiar&&e.asignatura_a_copiar.asignatura_id)for(i=0,s=(u=e.asignaturas).length;i<s;i++)(o=u[i]).asignatura_id===e.asignatura_a_copiar.asignatura_id&&(e.configuracion.asignatura_from=o,e.asignaturaSelect(o));if(e.configuracion.asignatura_from)return n=e.configuracion.asignatura_from.asignatura_id,t=r("filter")(e.asignaturas,{asignatura_id:n})[0],e.configuracion.asignatura_from=t,e.asignaturaSelect(t)},function(e){return i.error("No se pudo traer las asignaturas origen")})},e.asignaturaSelect=function(a,t){var r,n,o;if(a&&a.unidades){for(r=0,n=(o=a.unidades.items).length;r<n;r++)o[r].seleccionada=!0;return e.unidades=a.unidades}return e.unidades=[]},e.profesorToSelect=function(a,t){if(e.years_copy_to=a.years,e.configuracion.periodo_to)return e.configuracion.periodo_to=e.configuracion.year_to.periodos[0],e.periodoToSelect(e.configuracion.periodo_to)},e.yearToSelect=function(a,t){return e.periodos_to=a.periodos},e.periodoToSelect=function(a,n){return!0===e.conprofes&&(l=e.configuracion.profesor_to.id),t.get("::asignaturas/list-asignaturas-year/"+l+"/"+e.configuracion.periodo_to.id).then(function(a){var t,n;if(a=a.data,e.asignaturas_to=a,e.configuracion.asignatura_to)return n=e.configuracion.asignatura_to.asignatura_id,t=r("filter")(e.asignaturas_to,{asignatura_id:n})[0],e.configuracion.asignatura_to=t,e.asignaturaToSelect(t)},function(e){return i.error("No se pudo traer las asignaturas destino, ",e)})},e.asignaturaToSelect=function(a,t){return a&&a.unidades?e.unidades_to=a.unidades:e.unidades_to=[],e.activar_btn_copiar=!0},e.copiar=function(){var a,n,o;if(e.activar_btn_copiar)return e.activar_btn_copiar=!1,n=r("filter")(e.unidades.items,{seleccionada:!0}),o=[],angular.forEach(n,function(e,a){return o.push(e.id)}),a={copiar_subunidades:e.configuracion.copiar_subunidades,copiar_notas:e.configuracion.copiar_notas,asignatura_to_id:e.configuracion.asignatura_to.asignatura_id,periodo_from_id:e.configuracion.periodo_from.id,periodo_to_id:e.configuracion.periodo_to.id,unidades_ids:o,grupo_from_id:e.configuracion.asignatura_from.grupo_id,grupo_to_id:e.configuracion.asignatura_to.grupo_id},t.put("::periodos/copiar",a).then(function(a){var t,r,o,s,u,l;for(a=a.data,i.success("Copiado con éxito"),e.activar_btn_copiar=!0,e.resultado="Unidades copiadas: "+a.unidades_copiadas+" - Subunidades copiadas: "+a.subunidades_copiadas+" - Notas copidas: "+a.notas_copiadas,t=0,o=n.length;t<o;t++)l=n[t],e.unidades_to.items.push(l);if(e.configuracion.asignatura_from.asignatura_id===e.configuracion.asignatura_to.asignatura_id&&e.configuracion.periodo_from.id===e.configuracion.periodo_to.id){for(u=[],r=0,s=n.length;r<s;r++)l=n[r],u.push(e.unidades.items.push(l));return u}},function(a){return i.error("No se pudieron copiar los datos"),e.activar_btn_copiar=!0})}}])}.call(this),function(){angular.module("myvcFrontApp").directive("unidadDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}unidades/unidadDir.tpl.html`,transclude:!0,scope:{unidad:"=",indice:"="},link:function(e,a,t){},controller:["$scope","$http","toastr","$uibModal","$filter",function(e,a,t,r,n){return e.activar_crear_subunidad=!0,e.onSortSubunidades=function(r,n,o,i,s){var u,l,c,d,p,f,m,g,_,h,v,b,y;if(n===o){for(h=[],d=c=0,m=n.length;c<m;d=++c)(y=n[d]).orden=d,(l={})[""+y.id]=d,h.push(l);u={sortHash:h},a.put("::subunidades/update-orden",u).then(function(e){return!0},function(e){return t.warning("No se pudo ordenar","Problema"),!1})}else{for(v=[],b=[],u={},d=p=0,g=n.length;p<g;d=++p)(y=n[d]).orden=d,(l={})[""+y.id]=d,v.push(l);for(v.length>0&&(u.unidad1_id=n.unidad_id,u.sortHash1=v),d=f=0,_=o.length;f<_;d=++f)(y=o[d]).orden=d,(l={})[""+y.id]=d,b.push(l);v.length>0&&(u.unidad2_id=o.unidad_id,u.sortHash2=b),a.put("::subunidades/update-orden-varias",u).then(function(e){return!0},function(e){return t.warning("No se pudo ordenar","Problema"),!1})}return e.$parent.calcularPorcUnidades()},e.addSubunidad=function(r){return e.activar_crear_subunidad=!1,r.newsubunidad.unidad_id=r.id,a.post("::subunidades",r.newsubunidad).then(function(a){var n;return r.subunidades.push(a.data),n="creado","F"===e.$parent.GENERO_SUB&&(n="creada"),t.success(e.$parent.SUBUNIDAD+" "+n+" con éxito."),r.newsubunidad.definicion="",e.$parent.calcularPorcUnidades(),e.activar_crear_subunidad=!0},function(a){return t.error("No se pudo crear  "+("M"===e.$parent.GENERO_UNI?"el":"la")+scope.$parent.SUBUNIDAD,"Problemas"),e.activar_crear_subunidad=!0})},e.actualizarSubunidad=function(r){var n;return n={definicion:r.definicion,porcentaje:r.porcentaje,nota_default:r.nota_default,orden:r.orden},a.put("::subunidades/update/"+r.id,n).then(function(a){var n;return n="actualizado","F"===e.$parent.GENERO_SUB&&(n="actualizada"),t.success(e.$parent.SUBUNIDAD+" "+n+" con éxito."),r.editando=!1,e.$parent.calcularPorcUnidades()},function(a){return t.error("No se pudo actualizar "+e.$parent.SUBUNIDAD,"Problemas")})},e.removeSubunidad=function(a,t){return r.open({templateUrl:"==unidades/removeSubunidad.tpl.html",controller:"RemoveSubunidadCtrl",resolve:{subunidad:function(){return t}}}).result.then(function(r){return a.subunidades=n("filter")(a.subunidades,{id:"!"+t.id}),e.$parent.calcularPorcUnidades()})}}]}}])}.call(this),function(){angular.module("myvcFrontApp").directive("contenteditable",function(){return{restrict:"A",require:"ngModel",link:function(e,a,t,r){var n;return n=function(){return r.$setViewValue(a.html())},r.$render=function(){return a.html(r.$viewValue||0)},a.bind("blur keyup change",function(){return e.$apply(n)})}}})}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(e,a,t,r){return e.state("panel.informes",{url:"^/informes",views:{maincontent:{templateUrl:"==informes/informes.tpl.html",controller:"InformesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Informes interactivos"}]}}},resolve:{resolved_user:["AuthService",function(e){return e.verificar()}],alumnos:["$http",function(e){return e.get("::alumnos/sin-matriculas")}]},data:{displayName:"Informes",icon_fa:"fa fa-print",pageTitle:"Informes - MyVc",needed_permissions:[r.can_work_like_teacher,r.can_work_like_admin]}}).state("panel.informes.boletines_periodo",{url:"/boletines_periodo/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes/boletinesPeriodo.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::boletines/detailed-notas/"+a.grupo_id,{requested_alumnos:i,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::boletines/detailed-notas/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::boletines/detailed-notas-group/"+a.grupo_id,{periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.boletines_periodo2",{url:"/boletines_periodo2/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/boletinesPeriodo2.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::boletines2/detailed-notas/"+a.grupo_id,{requested_alumnos:i,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::boletines2/detailed-notas/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::boletines2/detailed-notas-group/"+a.grupo_id,{periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.boletines_periodo3",{url:"/boletines_periodo3/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/boletinesPeriodo3.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::boletines3/detailed-notas/"+a.grupo_id,{requested_alumnos:i,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::boletines3/detailed-notas/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::boletines3/detailed-notas-group/"+a.grupo_id,{periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.boletines_periodo4",{url:"/boletines_periodo4/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/boletinesPeriodo4.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::boletines3/detailed-notas/"+a.grupo_id,{requested_alumnos:i,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::boletines3/detailed-notas/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::boletines3/detailed-notas-group/"+a.grupo_id,{periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.puestos_grupo_periodo",{url:"/puestos_grupo_periodo/:grupo_id",views:{report_content:{templateUrl:"==informes/puestosGrupoPeriodo.tpl.html",controller:"PuestosGrupoPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams",function(e,a){return e.put("::puestos/detailed-notas-periodo/"+a.grupo_id)}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{pageTitle:"Puestos periodo - MyVc"}}).state("panel.informes.puestos_grupo_year",{url:"/puestos_grupo_year/:grupo_id/:periodo_a_calcular",views:{report_content:{templateUrl:`${a.views}informes/puestosGrupoYear.tpl.html`,controller:"PuestosGrupoYearCtrl",resolve:{datos_puestos:["$http","$stateParams",function(e,a){var t;return t={grupo_id:a.grupo_id,periodo_a_calcular:a.periodo_a_calcular},e.put("::puestos/detailed-notas-year",t)}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Puestos del año",icon_fa:"fa fa-print",pageTitle:"Puestos del año - MyVc"}}).state("panel.informes.puestos_todos_periodo",{url:"/puestos_todos_periodo",views:{report_content:{templateUrl:"==informes/puestosTodosPeriodo.tpl.html",controller:"PuestosTodosPeriodoCtrl",resolve:{escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{pageTitle:"Puestos todos periodo - MyVc"}}).state("panel.informes.puestos_todos_year",{url:"/puestos_todos_year/:periodo_a_calcular",views:{report_content:{templateUrl:"==informes/puestosTodosYear.tpl.html",controller:"PuestosTodosYearCtrl",resolve:{escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{pageTitle:"Puestos todos año - MyVc"}}).state("panel.informes.planillas_grupo",{url:"/planillas_grupo/:grupo_id/:periodos_a_calcular",views:{report_content:{templateUrl:"==informes/planillas.tpl.html",controller:"PlanillasCtrl",resolve:{asignaturas:["$http","$stateParams",function(e,a){return e.get("::planillas/show-grupo/"+a.grupo_id)}]}}},data:{displayName:"Planillas grupo",icon_fa:"fa fa-print",pageTitle:"Planillas grupo - MyVc"}}).state("panel.informes.notas_perdidas_profesor",{url:"/notas_perdidas_profesor/:profesor_id/:periodo_a_calcular/:solo_periodo",views:{report_content:{templateUrl:"==informes/notasPerdidasProfesor.tpl.html",controller:"NotasPerdidasProfesorCtrl",resolve:{grupos:["$http","$stateParams",function(e,a){var t;return t=!!a.solo_periodo,e.put("::notas-perdidas/profesor-grupos",{profesor_id:a.profesor_id,periodo_a_calcular:a.periodo_a_calcular,solo_periodo:t})}]}}},data:{displayName:"Notas perdidas por profesor",icon_fa:"fa fa-print",pageTitle:"Notas perdidas por profesor - MyVc"}}).state("panel.informes.notas_perdidas_todos",{url:"/notas_perdidas_profesor/:periodo_a_calcular/:solo_periodo",views:{report_content:{templateUrl:"==informes/notasPerdidasTodos.tpl.html",controller:"NotasPerdidasTodosCtrl",resolve:{profesores:["$http","$stateParams",function(e,a){var t;return t=!!a.solo_periodo,e.put("::notas-perdidas/todos",{periodo_a_calcular:a.periodo_a_calcular,solo_periodo:t})}]}}},data:{displayName:"Todas las notas perdidas",icon_fa:"fa fa-print",pageTitle:"Notas perdidas todas - MyVc"}}).state("panel.informes.ver_ausencias",{url:"/ver_ausencias",views:{report_content:{templateUrl:"==informes/verAusencias.tpl.html",controller:"VerAusenciasCtrl",resolve:{grupos_ausencias:["$http","$stateParams",function(e,a){return e.get("::planillas/ver-ausencias")}]}}},data:{displayName:"Ausencias",icon_fa:"fa fa-print",pageTitle:"Ausencias - MyVc"}}).state("panel.informes.ver_simat",{url:"/ver_simat",views:{report_content:{templateUrl:"==informes/verSimat.tpl.html",controller:"VerSimatCtrl",resolve:{grupos_simat:["$http","$stateParams",function(e,a){return e.get("::planillas/ver-simat")}]}}},data:{displayName:"SIMAT",icon_fa:"fa fa-print",pageTitle:"SIMAT - MyVc"}}).state("panel.informes.planillas-ausencias-acudientes",{url:"/planillas-ausencias-acudientes",views:{report_content:{templateUrl:"==informes2/planillasAusenciasAcudientes.tpl.html",controller:"PlanillasAusenciasAcudientesCtrl",resolve:{grupos_acud:["$http","$stateParams",function(e,a){return e.put("::acudientes/planillas-ausencias")}]}}},data:{displayName:"Asistencia acudientes",icon_fa:"fa fa-print",pageTitle:"Planillas asistencia padres - MyVc"}}).state("panel.informes.ver_observador_vertical",{url:"/ver_observador_vertical/:grupo_id",params:{grupo_id:{value:null}},views:{report_content:{templateUrl:"==informes/verObservadorVertical.tpl.html",controller:"VerObservadorVerticalCtrl",resolve:{grupos_observador:["$http","$stateParams",function(e,a){return e.get("::observador/vertical/"+a.grupo_id)}]}}},data:{displayName:"Observador",icon_fa:"fa fa-print",pageTitle:"Observador - MyVc"}}).state("panel.informes.ver_observador_vertical_todos",{url:"/ver_observador_vertical_todos",views:{report_content:{templateUrl:"==informes/verObservadorVertical.tpl.html",controller:"VerObservadorVerticalCtrl",resolve:{grupos_observador:["$http","$stateParams",function(e,a){return e.get("::observador/vertical-todos")}]}}},data:{displayName:"Observador",icon_fa:"fa fa-print",pageTitle:"Observador - MyVc"}}).state("panel.informes.planillas_profesor",{url:"/planillas_profesor/:profesor_id/:periodos_a_calcular",views:{report_content:{templateUrl:"==informes/planillas.tpl.html",controller:"PlanillasCtrl",resolve:{asignaturas:["$http","$stateParams",function(e,a){return e.get("::planillas/show-profesor/"+a.profesor_id)}]}}},data:{displayName:"Planillas profesor",icon_fa:"fa fa-print",pageTitle:"Planillas profesor - MyVc"}}).state("panel.informes.control_tardanza_entrada",{url:"/control_tardanza_entrada",views:{report_content:{templateUrl:"==informes/controlTardanzaEntrada.tpl.html",controller:"ControlTardanzaEntradaCtrl",resolve:{grupos:["$http","$stateParams",function(e,a){return e.put("::planillas-ausencias/tardanza-entrada")}]}}},data:{displayName:"Control de tardanza entrada",icon_fa:"fa fa-print",pageTitle:"Control de tardanza entrada - MyVc"}}).state("panel.informes.control_asistencia_clase",{url:"/control_asistencia_clase",views:{report_content:{templateUrl:"==informes/controlAsistenciaClase.tpl.html",controller:"ControlAsistenciaClaseCtrl",resolve:{grupos:["$http","$stateParams",function(e,a){return e.put("::planillas-ausencias/tardanza-entrada")}]}}},data:{displayName:"Control asistencia a Clases",icon_fa:"fa fa-print",pageTitle:"Control asistencia a Clases - MyVc"}}).state("panel.informes.planillas_ausencias1",{url:"/planillas_ausencias1/:profesor_id",views:{report_content:{templateUrl:"==informes/planillasAusencias1.tpl.html",controller:"PlanillasAusencias1Ctrl",resolve:{asignaturas:["$http","$stateParams",function(e,a){return e.get("::planillas-ausencias/show-profesor/"+a.profesor_id)}]}}},data:{displayName:"Planillas profesor",icon_fa:"fa fa-print",pageTitle:"Planillas profesor - MyVc"}}).state("panel.informes.unidades_profesor",{url:"/unidades_profesor/:profesor_id",views:{report_content:{templateUrl:"==informes/unidadesProfesor.tpl.html",controller:"UnidadesProfesorCtrl",resolve:{asignaturas:["$http","$stateParams",function(e,a){return e.put("::unidades/de-profesor",{profesor_id:a.profesor_id})}]}}},data:{displayName:"Unidades profesor",icon_fa:"fa fa-print",pageTitle:"Unidades profesor - MyVc"}}).state("panel.informes.cumpleanos_por_meses",{url:"/cumpleanos_por_meses",views:{report_content:{templateUrl:"==informes/cumpleanosPorMeses.tpl.html",controller:"CumpleanosPorMesesCtrl",resolve:{meses_cumple:["$http","$stateParams",function(e,a){return e.put("::informes/cumpleanos-por-meses")}]}}},data:{displayName:"Cumpleaños por meses",icon_fa:"fa fa-print",pageTitle:"Cumpleaños por meses - MyVc"}}).state("panel.informes.boletines_finales",{url:"/boletines_finales/:grupo_id/year_selected/:year_selected",params:{grupo_id:{value:null},year_selected:{value:null}},views:{report_content:{templateUrl:"==informes/boletinesFinales.tpl.html",controller:"BoletinesFinalesCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::bolfinales/detailed-notas-year/"+a.grupo_id,{requested_alumnos:i,year_selected:a.year_selected}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::bolfinales/detailed-notas-year/"+o[0].grupo_id,{requested_alumnos:o,year_selected:a.year_selected}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::bolfinales/detailed-notas-year-group/"+a.grupo_id,{year_selected:a.year_selected}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Boletines finales",pageTitle:"Boletines finales - MyVc"}}).state("panel.informes.certificados_estudio",{url:"/certificados_estudio/:grupo_id",params:{grupo_id:{value:null}},views:{report_content:{templateUrl:"==informes/certificadosEstudio.tpl.html",controller:"CertificadosEstudioCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::bolfinales/detailed-notas-year/"+a.grupo_id,{requested_alumnos:i}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::bolfinales/detailed-notas-year/"+o[0].grupo_id,{requested_alumnos:o}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::bolfinales/detailed-notas-year/"+a.grupo_id).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Certificados de estudio",pageTitle:"Certificados de estudio - MyVc"}}).state("panel.informes.notas_actuales_alumnos",{url:"/notas_actuales_alumnos/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/notasActualesAlumnos.tpl.html",controller:"NotasActualesAlumnosCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::notas-actuales-alumnos/"+a.grupo_id,{requested_alumnos:i,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::notas-actuales-alumnos/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::notas-actuales-alumnos/group/"+a.grupo_id,{periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Notas actuales",pageTitle:"Notas actuales - MyVc"}}).state("panel.informes.notas_perdidas_actuales_alumnos",{url:"/notas_perdidas_actuales_alumnos/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/notasPerdidasActualesAlumnos.tpl.html",controller:"NotasActualesAlumnosCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(e,a,t,r){var n,o,i;return n=t.defer(),i=r.getObject("requested_alumnos"),o=r.getObject("requested_alumno"),i?e.put("::notas-actuales-alumnos/"+a.grupo_id,{requested_alumnos:i,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):o?e.put("::notas-actuales-alumnos/"+o[0].grupo_id,{requested_alumnos:o,periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}):e.put("::notas-actuales-alumnos/group/"+a.grupo_id,{periodo_a_calcular:a.periodo_a_calcular}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise}],escalas:["EscalasValorativasServ",function(e){return e.escalas()}]}}},data:{displayName:"Notas perdidas actuales",pageTitle:"Notas perdidas actuales - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(e,a,t,r){return e.state("panel.informes.listado_profesores",{url:"/listado_profesores",views:{report_content:{templateUrl:"==informes2/listadoProfesores.tpl.html",controller:"ListadoProfesoresCtrl",resolve:{profesores:["$http","$stateParams",function(e){return e.put("::profesores/listado")}]}}},data:{displayName:"Listado profesores",icon_fa:"fa fa-print",pageTitle:"Listado profesores - MyVc"}}).state("panel.informes.ver_cant_alumnos_por_grupos",{url:"/ver_cant_alumnos_por_grupos",views:{report_content:{templateUrl:"==informes2/verCantAlumnosPorGrupos.tpl.html",controller:"VerCantAlumnosPorGruposCtrl",resolve:{grupos:["$http","$stateParams",function(e){return e.put("::grupos/con-cantidad-alumnos")}]}}},data:{displayName:"Ver alumnos por grupos",icon_fa:"fa fa-print",pageTitle:"Ver alumnos por grupos - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("InformesCtrl",["$scope","$http","$state","$stateParams","$filter","App","AuthService","ProfesoresServ","alumnos","$timeout","$cookies","toastr","$interval","DownloadServ","Upload",function(e,a,t,r,n,o,i,s,u,l,c,d,p,f,m){var g,_,h,v,b;return i.verificar_acceso(),e.rowsAlum=[],u=u.data,e.$state=t,e.config={periodos_a_calcular:1,mostrar_foto:!0,show_firma_rector:!0,show_rojos:!0,show_porcentajes:!0,show_firma_titular:!0,periodo_a_calcular:e.USER.numero_periodo},e.filtered_alumnos=u,e.perfilPath=o.images+"perfil/",e.views=o.views,e.datos={grupo:""},a.put("::informes/datos").then(function(a){var r;if(a=a.data,e.year_actual=a.year,e.grupos=a.grupos,e.profesores=a.profesores,e.imgs_public=a.imagenes,e.periodos_grupos=a.periodos_grupos,a.periodos_desactualizados&&(e.periodos_desactualizados=a.periodos_desactualizados),t.params.grupo_id&&(r=parseInt(t.params.grupo_id),e.datos.grupo=n("filter")(e.grupos,{id:r},!0)[0],e.filtered_alumnos=n("filter")(u,{grupo_id:r},!0)),t.params.profesor_id)return r=parseInt(t.params.profesor_id),e.datos.profesor=n("filter")(e.profesores,{profesor_id:r},!0)[0]},function(e){return d.error("No se pudo traer los profesores")}),localStorage.tipo_boletin&&(e.tipo_boletin=localStorage.tipo_boletin),localStorage.tipo_boletin_final&&(e.tipo_boletin_final=localStorage.tipo_boletin_final),e.eligirTipo=function(a){return localStorage.tipo_boletin=a,e.tipo_boletin=a},e.eligirTipoFinal=function(a){return localStorage.tipo_boletin_final=a,e.tipo_boletin_final=a},e.range=function(e){return new Array(e)},c.getObject("config")?e.config=c.getObject("config"):(e.config.orientacion="vertical",e.config.cant_imagenes=7),c.getObject("requested_alumnos")&&((b=c.getObject("requested_alumnos")).length>0?(h=[],angular.forEach(b,function(e,a){var t;return t=n("filter")(u,{alumno_id:e.alumno_id},!0)[0],h.push(t)}),e.datos.selected_alumnos=h):e.datos.selected_alumno=b[0]),c.getObject("requested_alumno")&&(b=c.getObject("requested_alumno"),_=n("filter")(u,{alumno_id:b[0].alumno_id},!0)[0],e.datos.selected_alumno=_),e.$watch("config",function(a,t){return c.putObject("config",a),e.$broadcast("change_config")},!0),e.selectTab=function(a){return e.config.informe_tab_actual=a,c.putObject("config",e.config)},e.putConfigCookie=function(){return c.putObject("config",e.config)},e.calcularGrupoPeriodo=function(e,t){return e.desabilitado=!0,a.put("::definitivas_periodos/calcular-grupo-periodo",{grupo_id:e.grupo_id,periodo_id:t.id,num_periodo:t.numero}).then(function(a){return d.success(e.nombre+" calculado con éxito")},function(a){return e.desabilitado=!1,d.error("No se pudo calcular las definitivas del grupo "+e.nombre+", Per "+t.numero)})},e.calcularPeriodo=function(t){return e.porcentaje=0,t.bloqueado=!0,e.grupo_temp_calculado=!0,e.grupo_temp_indce=0,e.intervalo=p(function(){var r;if(e.grupo_temp_calculado)return e.grupo_temp_calculado=!1,r=t.grupos[e.grupo_temp_indce],e.porcentaje=parseInt(100*(e.grupo_temp_indce+1)/t.grupos.length),a.put("::definitivas_periodos/calcular-grupo-periodo",{grupo_id:r.grupo_id,periodo_id:t.id,num_periodo:t.numero}).then(function(a){if(d.success(r.nombre+" calculado con éxito"),e.grupo_temp_calculado=!0,e.grupo_temp_indce=e.grupo_temp_indce+1,e.grupo_temp_indce===t.grupos.length)return p.cancel(e.intervalo)},function(a){return e.grupo_temp_calculado=!0,d.warning("No se pudo calcular "+r.nombre+", Per "+t.numero+". Intentaremos de nuevo.")})},20)},e.verBoletinesGrupo=function(a){if("1"!==a&&1!==a||(a=""),c.remove("requested_alumnos"),c.remove("requested_alumno"),e.datos.grupo.id)return e.config.orientacion="vertical",t.go("panel.informes.boletines_periodo"+a,{grupo_id:e.datos.grupo.id,periodo_a_calcular:e.USER.numero_periodo},{reload:!0});d.warning("Debes seleccionar el grupo")},e.verBoletinesAlumnos=function(a){return"1"!==a&&1!==a||(a=""),e.datos.selected_alumnos.length>0?(e.config.orientacion="vertical",c.putObject("requested_alumnos",e.datos.selected_alumnos),t.go("panel.informes.boletines_periodo"+a,{grupo_id:e.datos.grupo.id,periodo_a_calcular:e.USER.numero_periodo},{reload:!0})):d.warning("Debes seleccionar al menos un alumno o cargar boletines del grupo completo")},e.verBoletinAlumno=function(a){return"1"!==a&&1!==a||(a=""),c.remove("requested_alumnos"),e.datos.selected_alumno?(c.putObject("requested_alumno",[e.datos.selected_alumno]),t.go("panel.informes"),e.config.orientacion="vertical",p(function(){return t.go("panel.informes.boletines_periodo"+a,{periodo_a_calcular:e.USER.numero_periodo})},1,1)):d.warning("Elige un alumno o carga el grupo completo")},e.verNotasActualesAlumno=function(){return c.remove("requested_alumno"),e.datos.selected_alumno?(c.putObject("requested_alumno",[e.datos.selected_alumno]),t.go("panel.informes"),e.config.orientacion="vertical",p(function(){return t.go("panel.informes.notas_actuales_alumnos",{periodo_a_calcular:e.USER.numero_periodo})},1,1)):d.warning("Debes seleccionar al menos un alumno")},e.verNotasActualesAlumnos=function(){return e.datos.selected_alumnos.length>0?(e.config.orientacion="vertical",c.putObject("requested_alumnos",e.datos.selected_alumnos),t.go("panel.informes.notas_actuales_alumnos",{grupo_id:e.datos.grupo.id,periodo_a_calcular:e.USER.numero_periodo},{reload:!0})):d.warning("Debes seleccionar al menos un alumno")},e.verNotasPerdidasActualesAlumno=function(){return e.datos.selected_alumno?(c.putObject("requested_alumno",[e.datos.selected_alumno]),t.go("panel.informes"),e.config.orientacion="vertical",p(function(){return t.go("panel.informes.notas_perdidas_actuales_alumnos",{periodo_a_calcular:e.USER.numero_periodo})},1,1)):d.warning("Debes seleccionar al menos un alumno")},e.verNotasPerdidasActualesAlumnos=function(){return e.datos.selected_alumnos.length>0?(e.config.orientacion="vertical",c.putObject("requested_alumnos",e.datos.selected_alumnos),t.go("panel.informes.notas_perdidas_actuales_alumnos",{grupo_id:e.datos.grupo.id,periodo_a_calcular:e.USER.numero_periodo},{reload:!0})):d.warning("Debes seleccionar al menos un alumno")},e.verListadoDocentes=function(){return e.config.orientacion="oficio_horizontal",t.go("panel.informes.listado_profesores")},e.excelListadoDocentes=function(){return f.download("::excel-docentes/docentes/"+e.USER.year+"/"+e.USER.year_id,"Listado docentes "+e.USER.year+".xls")},e.verCantAlumnosEnGrupos=function(){return e.config.orientacion="vertical",t.go("panel.informes.ver_cant_alumnos_por_grupos")},e.verPuestosPeriodo=function(){if(e.datos.grupo.id)return e.config.orientacion="vertical",t.go("panel.informes.puestos_grupo_periodo",{grupo_id:e.datos.grupo.id,periodos_a_calcular:e.config.periodos_a_calcular});d.warning("Debes seleccionar el grupo")},e.verPuestosYear=function(){if(e.datos.grupo.id)return e.config.orientacion="vertical",t.go("panel.informes.puestos_grupo_year",{grupo_id:e.datos.grupo.id,periodo_a_calcular:e.config.periodo_a_calcular});d.warning("Debes seleccionar el grupo")},e.verTodosPuestosPeriodo=function(){return localStorage.grupos_puestos=JSON.stringify(e.grupos),e.config.orientacion="vertical",t.go("panel.informes.puestos_todos_periodo",{periodos_a_calcular:e.config.periodos_a_calcular})},e.verTodosPuestosYear=function(){return localStorage.grupos_puestos=JSON.stringify(e.grupos),e.config.orientacion="vertical",t.go("panel.informes.puestos_todos_year",{periodo_a_calcular:e.config.periodo_a_calcular})},e.verPlanillasGrupo=function(){return e.datos.grupo.id?(e.config.orientacion="oficio_horizontal",t.go("panel.informes.planillas_grupo",{grupo_id:e.datos.grupo.id,periodos_a_calcular:e.config.periodos_a_calcular},{reload:!0})):d.warning("Elige un grupo")},e.verPlanillasProfe=function(){return e.datos.profesor?(e.config.orientacion="oficio_horizontal",t.go("panel.informes.planillas_profesor",{profesor_id:e.datos.profesor.profesor_id,periodos_a_calcular:e.config.periodos_a_calcular},{reload:!0})):d.warning("Elige un profesor")},e.verAusencias=function(){return t.go("panel.informes.ver_ausencias",{periodos_a_calcular:e.config.periodos_a_calcular},{reload:!0})},e.verSimat=function(){return f.download("::simat/alumnos","Alumnos con acudientes "+e.USER.year+".xls"),t.go("panel.informes.ver_simat",{reload:!0})},e.importarSimat=function(a,t){if(e.f=a,e.errFile=t&&t[0],a)return a.upload=m.upload({url:o.Server+"importar/algo/"+e.USER.year,data:{file:a}}),a.upload.then(function(e){return l(function(){return a.result=e.data})},function(a){if(a.status>0)return e.errorMsg=a.status+": "+a.data},function(e){return a.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},e.verObservadorVertical=function(){if(e.datos.grupo.id)return t.go("panel.informes.ver_observador_vertical",{grupo_id:e.datos.grupo.id},{reload:!0});d.warning("Debes seleccionar el grupo")},e.verObservadorVerticalTodos=function(){return t.go("panel.informes.ver_observador_vertical_todos",{reload:!0})},e.verPlanillasControlTardanzas=function(){return e.config.orientacion="oficio_horizontal",t.go("panel.informes.control_tardanza_entrada",{reload:!0})},e.verPlanillasAsistenciaClase=function(){return e.config.orientacion="oficio_horizontal",t.go("panel.informes.control_asistencia_clase",{reload:!0})},e.verNotasPerdidasProfesor=function(a){return e.datos.profesor?(e.config.orientacion="carta_horizontal",t.go("panel.informes.notas_perdidas_profesor",{profesor_id:e.datos.profesor.profesor_id,periodo_a_calcular:e.config.periodo_a_calcular,solo_periodo:a},{reload:!0})):d.warning("Elige un profesor")},e.verNotasPerdidasTodos=function(a){return e.config.orientacion="carta_horizontal",t.go("panel.informes.notas_perdidas_todos",{periodo_a_calcular:e.config.periodo_a_calcular,solo_periodo:a},{reload:!0})},e.verCumpleanosPorMeses=function(){return e.config.orientacion="carta_horizontal",t.go("panel.informes.cumpleanos_por_meses")},e.mostrarUnidadesProfe=function(){return e.datos.profesor?(e.config.orientacion="vertical",t.go("panel.informes.unidades_profesor",{profesor_id:e.datos.profesor.profesor_id},{reload:!0})):d.warning("Elige un profesor")},e.verAusencias=function(){return t.go("panel.informes.ver_ausencias",{periodos_a_calcular:e.config.periodos_a_calcular},{reload:!0})},e.selectGrupo=function(a){return a?e.filtered_alumnos=n("filter")(u,{grupo_id:a.id},!0):(e.filtered_alumnos=u,c.putObject("requested_alumno",""),c.putObject("requested_alumnos","")),e.datos.selected_alumnos="",e.datos.selected_alumno=""},e.selectAlumnos=function(e){},e.selectAlumno=function(e){},e.$on("cambia_descripcion",function(a,t){return e.descripcion_informe=t}),e.pdfMaker=function(){var e;return e={content:[["Este es un ejemplo de reporte en pdf"],{table:{headerRows:1,widths:["*","auto",100,"*"],body:[["No","Primero","Segundo","Tercero"],["0","No me gusta!!","No queda bonito","FACILMENTE!"],["1",{text:"En negrita",bold:!0},"Así que ","me mordió la vaca"]]}}]},pdfMake.createPdf(e).open()},e.verBoletinesFinalesGrupo=function(){var a;if(c.remove("requested_alumnos"),c.remove("requested_alumno"),e.datos.grupo.id)return a={grupo_id:e.datos.grupo.id,periodos_a_calcular:e.config.periodos_a_calcular},2!==e.tipo_boletin_final&&"2"!==e.tipo_boletin_final||(a.year_selected=!0),t.go("panel.informes.boletines_finales",a,{reload:!0});d.warning("Debes seleccionar el grupo")},e.verBoletinesFinalesAlumnos=function(){var a;return e.datos.selected_alumnos.length>0?(c.putObject("requested_alumnos",e.datos.selected_alumnos),a={grupo_id:e.datos.grupo.id,periodos_a_calcular:e.config.periodos_a_calcular},2!==e.tipo_boletin_final&&"2"!==e.tipo_boletin_final||(a.year_selected=!0),t.go("panel.informes.boletines_finales",a,{reload:!0})):d.warning("Debes seleccionar al menos un alumno o cargar boletines del grupo completo")},e.verBoletinFinalAlumno=function(){return e.datos.selected_alumno?(c.remove("requested_alumnos"),c.putObject("requested_alumno",[e.datos.selected_alumno]),t.go("panel.informes"),p(function(){var a;return a={grupo_id:e.datos.grupo.id,periodos_a_calcular:e.config.periodos_a_calcular},2!==e.tipo_boletin_final&&"2"!==e.tipo_boletin_final||(a.year_selected=!0),t.go("panel.informes.boletines_finales",a)},1,1)):d.warning("Elige un alumno o carga el grupo completo")},e.verCertificadosEstudioGrupo=function(){if(c.remove("requested_alumnos"),c.remove("requested_alumno"),e.datos.grupo.id)return t.go("panel.informes.certificados_estudio",{grupo_id:e.datos.grupo.id},{reload:!0});d.warning("Debes seleccionar el grupo")},e.verCertificadosEstudioAlumnos=function(){return e.datos.selected_alumnos.length>0?(c.putObject("requested_alumnos",e.datos.selected_alumnos),t.go("panel.informes.certificados_estudio",{grupo_id:e.datos.grupo.id,periodos_a_calcular:e.config.periodos_a_calcular},{reload:!0})):d.warning("Debes seleccionar al menos un alumno o cargar boletines del grupo completo")},e.verCertificadosEstudioAlumno=function(){return e.datos.selected_alumno?(c.remove("requested_alumnos"),c.putObject("requested_alumno",[e.datos.selected_alumno]),t.go("panel.informes"),p(function(){return t.go("panel.informes.certificados_estudio")},1,1)):d.warning("Elige un alumno o carga el grupo completo")},e.meses=[{nombre:"Enero"},{nombre:"Febrero"},{nombre:"Marzo"},{nombre:"Abril"},{nombre:"Mayo"},{nombre:"Junio"},{nombre:"Julio"},{nombre:"Agosto"},{nombre:"Septiembre"},{nombre:"Octubre"},{nombre:"Noviembre"},{nombre:"Diciembre"}],e.numYearActual=e.USER.year,g=[31,28,31,30,31,30,31,31,30,31,30,31],v=function(e,a){return 1!==a||e%4!=0||e%100==0&&e%400!=0?g[a]:29},e.getAllDaysInMonth=function(a){var t,r,n,o,i;for(o=[],t=r=1,i=v(e.numYearActual,a);1<=i?r<=i:r>=i;t=1<=i?++r:--r)0!==(n=new Date(e.numYearActual,parseInt(a),t).getDay())&&6!==n&&o.push(t);return o}}]).filter("fechaHoraStringShort",["$filter",function(e){return function(a,t){return a?(a=new Date(a),a=isNaN(a)?new Date(a):new Date(t),a=e("date")(a,"MMMdd H:mm")):""}}])}.call(this),function(){angular.module("myvcFrontApp").controller("BoletinesPeriodoCtrl",["$scope","alumnosDat","escalas","$uibModal","$cookieStore","$state",function(e,a,t,r,n,o){var i,s,u,l,c,d,p,f;if(e.grupo=a[0],e.year=a[1],e.alumnos=a[2],e.escalas=t,o.is("panel.boletin_acudiente")&&(parseInt(o.params.periodo_a_calcular)!==e.USER.numero_periodo&&o.go("panel.boletin_acudiente",{periodo_a_calcular:e.USER.numero_periodo},{reload:!0}),$("body").on("contextmenu",e=>event.preventDefault())),e.year.mostrar_puesto_boletin)for(u=0,c=(p=e.alumnos).length;u<c;u++)(i=p[u]).texto_puesto=" - Puesto: "+i.puesto+"/"+e.grupo.cantidad_alumnos;if(e.config=n.get("config"),e.requested_alumnos=n.get("requested_alumnos"),e.requested_alumno=n.get("requested_alumno"),void 0===e.config?e.config={mostrar_foto:!0}:void 0===e.config.mostrar_foto&&(e.config.mostrar_foto=!0),e.alumnos[0].asignaturas)e.alumnos[0].asignaturas.length<14?e.ancho_chart=50*e.alumnos[0].asignaturas.length:e.ancho_chart=40*e.alumnos[0].asignaturas.length;else{for(s=0,l=0,d=(f=e.alumnos[0].areas).length;l<d;l++)s+=f[l].cant;e.ancho_chart=s<14?50*s:40*s}return e.ancho_chart>800&&(e.ancho_chart=800),e.$on("change_config",function(){return e.config=n.get("config")}),e.requested_alumnos?e.$emit("cambia_descripcion","Mostrando "+e.alumnos.length+" boletines de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.requested_alumno?e.$emit("cambia_descripcion","Mostrando un boletin de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.$emit("cambia_descripcion",e.alumnos.length+" boletines del grupo "+e.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").directive("boletinAlumnoDir",["App","Perfil","$filter",function(e,a,t){return{restrict:"EA",templateUrl:"==informes/boletinAlumnoDir.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(t,r,n){var o,i,s,u,l;for(t.USER=a.User(),t.USER.nota_minima_aceptada=parseInt(t.USER.nota_minima_aceptada),t.perfilPath=e.images+"perfil/",t.views=e.views,t.options={chart:{type:"discreteBarChart",height:180,width:t.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.0f")(e)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},l=[],i=0,s=(u=t.alumno.asignaturas).length;i<s;i++)o=u[i],l.push({label:o.alias_materia,value:o.nota_asignatura});return t.data=[{key:"Definitivas de asignaturas",values:l}]}}}]).directive("boletinAlumnoDir2",["App","Perfil","$filter",function(e,a,t){return{restrict:"EA",templateUrl:"==informes2/boletinAlumnoDir2.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(t,r,n){var o,i,s,u,l;for(t.USER=a.User(),t.USER.nota_minima_aceptada=parseInt(t.USER.nota_minima_aceptada),t.perfilPath=e.images+"perfil/",t.views=e.views,t.options={chart:{type:"discreteBarChart",height:180,width:t.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.0f")(e)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},l=[],i=0,s=(u=t.alumno.asignaturas).length;i<s;i++)o=u[i],l.push({label:o.alias_materia,value:o.nota_asignatura});return t.data=[{key:"Definitivas de asignaturas",values:l}]}}}]).directive("boletinAlumnoDir3",["App","Perfil","$filter",function(e,a,t){return{restrict:"EA",templateUrl:"==informes2/boletinAlumnoDir3.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(t,r,n){var o,i,s,u,l,c,d,p;for(t.USER=a.User(),t.USER.nota_minima_aceptada=parseInt(t.USER.nota_minima_aceptada),t.perfilPath=e.images+"perfil/",t.views=e.views,t.options={chart:{type:"discreteBarChart",height:180,width:t.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.0f")(e)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},p=[],i=0,u=(c=t.alumno.areas).length;i<u;i++)for(s=0,l=(d=c[i].asignaturas).length;s<l;s++)o=d[s],p.push({label:o.alias_materia,value:o["nota_final_per"+t.USER.numero_periodo]});return t.data=[{key:"Definitivas de asignaturas",values:p}]}}}]).directive("boletinAlumnoDir4",["App","Perfil","$filter",function(e,a,t){return{restrict:"EA",templateUrl:"==informes2/boletinAlumnoDir4.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(t,r,n){return t.USER=a.User(),t.USER.nota_minima_aceptada=parseInt(t.USER.nota_minima_aceptada),t.perfilPath=e.images+"perfil/",t.views=e.views}}}]).filter("cantPerdidasPer",[function(){return function(e,a,t){return this.suma=0,angular.forEach(e,function(e,t){if(a=parseFloat(a),parseFloat(e.id)===a)return this.suma=this.suma+e.cantNotasPerdidas}),0===this.suma?"":this.suma}}]).directive("dynamic",["$compile",function(e){return{restrict:"A",replace:!0,link:function(a,t,r){return a.$watch(r.dynamic,function(r){return t.html(r),e(t.contents())(a)})}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PuestosGrupoPeriodoCtrl",["$scope","$state","alumnosDat","escalas","$cookieStore",function(e,a,t,r,n){return t=t.data,e.fechahora=new Date,e.grupo=t.grupo,e.year=t.year,e.alumnos=t.alumnos,e.escalas=r,e.config=n.get("config"),e.$on("change_config",function(){return e.config=n.get("config")}),e.alumnos_materias=[],e.add_alum_materia=function(a,t){return e.alumnos_materias.push({asignatura:a,alumno:t})}}]).controller("PuestosTodosPeriodoCtrl",["$scope","$state","escalas","$cookieStore","$http","toastr",function(e,a,t,r,n,o){return e.fechahora=new Date,e.escalas=t,e.grupos_puestos_temp=JSON.parse(localStorage.grupos_puestos),e.grupos_puestos=[],angular.forEach(e.grupos_puestos_temp,function(a,t){return n.put("::puestos/detailed-notas-periodo/"+a.id).then(function(t){return a.year=t.data.year,a.alumnos=t.data.alumnos,a.grupo=t.data.grupo,e.grupos_puestos.push(a)},function(){return o.error("No se trajo grupo "+a.nombre)})}),e.config=r.get("config"),e.$on("change_config",function(){return e.config=r.get("config")}),e.alumnos_materias=[],e.add_alum_materia=function(a,t){return e.alumnos_materias.push({asignatura:a,alumno:t})}}]).controller("PuestosTodosYearCtrl",["$scope","$state","escalas","$cookieStore","$http","toastr","$stateParams",function(e,a,t,r,n,o,i){return e.fechahora=new Date,e.escalas=t,e.grupos_puestos_temp=JSON.parse(localStorage.grupos_puestos),e.grupos_puestos=[],angular.forEach(e.grupos_puestos_temp,function(a,t){return n.put("::puestos/detailed-notas-year",{grupo_id:a.id,periodo_a_calcular:i.periodo_a_calcular}).then(function(t){return a.year=t.data.year,a.alumnos=t.data.alumnos,a.grupo=t.data.grupo,e.grupos_puestos.push(a)},function(){return o.error("No se trajo grupo "+a.nombre)})}),e.config=r.get("config"),e.$on("change_config",function(){return e.config=r.get("config")}),e.alumnos_materias=[],e.add_alum_materia=function(a,t){return e.alumnos_materias.push({asignatura:a,alumno:t})}}])}.call(this),function(){angular.module("myvcFrontApp").filter("puestoAlumno",[function(){return function(e,a){var t;return t=0,angular.forEach(a,function(a){if(e.promedio<a.promedio)return t+=1}),t}}]).filter("notasAsignatura",[function(){return function(e,a){var t;return t="",angular.forEach(e,function(e){return t=t+'<div class="ellipsis350"><b>Per'+a+": "+e.definicion_unidad+"</b></div>",angular.forEach(e.subunidades,function(e,a){if(e.nota)return t=t+(a+1)+". "+e.definicion_subunidad+"<b> => "+e.nota.nota+"</b><br>"})}),t}}]).filter("notasPerdidasAsignaturas",["$filter",function(e){return function(a){return this.cantidad_perdidas=0,angular.forEach(a,function(a){return this.cantidad_perdidas=this.cantidad_perdidas+e("notasPerdidasAsignatura")(a.unidades,!0)}),this.cantidad_perdidas}}]).filter("notasPerdidasAsignatura",["Perfil",function(e){return function(a,t,r){var n;return this.unidades_response=[],this.cantidad_perdidas=0,angular.forEach(a,function(a){var t;if(this.subunis=[],angular.forEach(a.subunidades,function(a){if(a.nota)if(a.nota.nota||0===a.nota.nota){if(a.nota.nota<e.User().nota_minima_aceptada)return this.subunis.push(a)}else if(a.nota<e.User().nota_minima_aceptada)return this.subunis.push(a)},this),this.cantidad_perdidas=this.cantidad_perdidas+this.subunis.length,this.subunis.length>0)return t={unidad_id:a.unidad_id,definicion_unidad:a.definicion_unidad,valor_unidad:a.valor_unidad,orden_unidad:a.orden_unidad,nota_unidad:a.nota_unidad,subunidades:this.subunis},this.unidades_response.push(t)},this),t?this.cantidad_perdidas:(n="",angular.forEach(unidades_response,function(e){return n=n+'<div class="ellipsis350"><b>Per'+r+": "+e.definicion_unidad+"</b></div>",angular.forEach(e.subunidades,function(e,a){return n=n+'<span class="ellipsis250">'+(a+1)+". "+e.definicion_subunidad+" </span><b> => "+e.nota.nota+"</b><br>"})}),n)}}]).filter("notasPerdidasAsignaturaPeriodo",["$filter",function(e){return function(a,t){var r,n,o,i;for(i=0,n=0,o=a.length;n<o;n++)r=a[n],i+=e("notasPerdidasAsignatura")(r.unidades,!0);return i}}]).filter("promAsig",["$filter",function(e){return function(e,a){var t,r,n,o,i,s,u,l;for(u=0,r=0,n=0,i=e.length;n<i;n++)for(o=0,s=(l=e[n].asignaturas).length;o<s;o++)(t=l[o]).asignatura_id===a&&(r++,u+=t.nota_asignatura);return u/r}}]).filter("promGrupoPer",["$filter",function(e){return function(e){var a,t,r;for(r=0,a=0,t=e.length;a<t;a++)r+=e[a].promedio;return r/e.length}}]).filter("notasPerdidasGrupoPer",["$filter",function(e){return function(a){var t,r,n,o;for(r=0,n=0,o=a.length;n<o;n++)t=a[n],r+=e("notasPerdidasAsignaturaPeriodo")(t.asignaturas,!0);return r}}])}.call(this),function(){angular.module("myvcFrontApp").filter("promGrupoYear",[function(){return function(e){var a,t,r;for(r=0,a=0,t=e.length;a<t;a++)r+=e[a].promedio_year;return Math.round(r/e.length)}}]).filter("promAsigYear",["$filter",function(e){return function(e,a){var t,r,n,o,i,s,u,l;for(u=0,t=0,r=0,o=e.length;r<o;r++)for(n=0,i=(l=e[r].notas_asig).length;n<i;n++)(s=l[n]).asignatura_id===a&&(t++,u+=parseFloat(s.nota_final_year));return Math.round(u/t)}}]).filter("notasAsignaturaYear",["$filter",function(e){return function(a){var t,r,n,o;for(0,t="",r=0,n=a.length;r<n;r++)o=a[r],t+=e("notasAsignatura")(o.unidades,o.numero);return t}}]).filter("notasPerdidasAsignaturaYear",["$filter",function(e){return function(a,t){var r,n,o,i,s;for(r=0,n="",o=0,i=a.length;o<i;o++)s=a[o],t?r+=e("notasPerdidasAsignatura")(s.unidades,t,s.numero):n+=e("notasPerdidasAsignatura")(s.unidades,!1,s.numero);return t?r:n}}]).filter("notasPerdidasAsignaturasYear",["$filter",function(e){return function(a){return this.cantidad_perdidas=0,angular.forEach(a,function(a){return this.cantidad_perdidas=this.cantidad_perdidas+e("notasPerdidasAsignaturaYear")(a.periodos,!0)}),this.cantidad_perdidas}}]).filter("notasPerdidasGrupoYear",["$filter",function(e){return function(e){var a,t,r;for(a=0,t=0,r=e.length;t<r;t++)a+=e[t].perdidos_year;return a}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PuestosGrupoYearCtrl",["$scope","datos_puestos","escalas","$cookieStore",function(e,a,t,r){return a=a.data,e.fechahora=new Date,e.grupo=a.grupo,e.year=a.year,e.alumnos=a.alumnos,e.escalas=t,e.config=r.get("config"),e.$on("change_config",function(){return e.config=r.get("config")}),e.alumnos_materias=[],e.add_alum_materia=function(a,t){return e.alumnos_materias.push({asignatura:a,alumno:t})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PlanillasCtrl",["$scope","App","Perfil","asignaturas","$state",function(e,a,t,r,n){var o,i,s,u,l;for(r=r.data,e.USER=t.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.year=r[0],e.asignaturas=r[1],e.perfilPath=a.images+"perfil/",e.unidadesdefault=["  ","  ","  ","  ","  "],e.subunidadesdefault=["  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  "],s=0,u=(l=e.asignaturas).length;s<u;s++)(i=l[s]).alumnos_temp=i.alumnos,i.alumnos_temp.length<32?i.alumnos1=i.alumnos_temp:i.alumnos_temp.length<37?(i.alumnos1=i.alumnos_temp.splice(0,27),i.alumnos2=i.alumnos_temp.splice(0,20)):i.alumnos_temp.length<62&&(i.alumnos1=i.alumnos_temp.splice(0,31),i.alumnos2=i.alumnos_temp.splice(0,32));return n.params.profesor_id?(o=e.asignaturas[0],e.$emit("cambia_descripcion",e.asignaturas.length+" planillas  del profesor "+o.nombres_profesor+" "+o.apellidos_profesor)):n.params.grupo_id?(o=e.asignaturas[0],e.$emit("cambia_descripcion",e.asignaturas.length+" planillas  del grupo "+o.nombre_grupo)):void 0}]).controller("ControlTardanzaEntradaCtrl",["$scope","App","Perfil","$state","grupos",function(e,a,t,r,n){var o,i,s,u,l,c,d,p,f;for(e.USER=t.User(),d=n.data[0],e.year=d,e.grupos=d.grupos,e.perfilPath=a.images+"perfil/",e.numberColumExt=21,e.numberColumInt=4,e.getNumber=function(e){return new Array(e)},s=0,l=(p=e.grupos).length;s<l;s++)for(i=0,u=0,c=(f=p[s].alumnos).length;u<c;u++)o=f[u],3===++i?(o.gris=!0,i=0):o.gris=!1;return e.$emit("cambia_descripcion","Planillas para el control de tardanzas en la entrada."),e.dato={},e.mesSeleccionado=function(){return"-1"===e.mesMostrar?e.numberColumExt=21:(e.dato.mes=""+e.mesMostrar,e.dias=e.getAllDaysInMonth(e.dato.mes),e.numberColumExt=e.dias.length)}}]).controller("ControlAsistenciaClaseCtrl",["$scope","App","Perfil","$state","grupos",function(e,a,t,r,n){var o,i,s,u,l,c,d,p,f;for(e.USER=t.User(),d=n.data[0],e.year=d,e.grupos=d.grupos,e.perfilPath=a.images+"perfil/",e.getNumber=function(e){return new Array(e)},s=0,l=(p=e.grupos).length;s<l;s++)for(i=0,u=0,c=(f=p[s].alumnos).length;u<c;u++)o=f[u],3===++i?(o.gris=!0,i=0):o.gris=!1;return e.$emit("cambia_descripcion","Planillas para de asistencia a clase."),e.dato={},e.mesSeleccionado=function(){return"-1"===e.mesMostrar?e.numberColumExt=21:(e.dato.mes=""+e.mesMostrar,e.dias=e.getAllDaysInMonth(e.dato.mes),e.numberColumExt=e.dias.length)},d=new Date,e.mesMostrar=d.getMonth(),e.mesSeleccionado()}])}.call(this),function(){angular.module("myvcFrontApp").controller("UnidadesProfesorCtrl",["$scope","App","Perfil","asignaturas","$state","toastr","$http",function(e,a,t,r,n,o,i){return e.asignaturas=r.data.asignaturas,e.info_profe=r.data.info_profesor,e.USER=t.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.perfilPath=a.images+"perfil/",e.editarUnidad=function(e){return e.editando=!0},e.cancelarEditUnidad=function(e){return e.editando=!1},e.guardarCambiosUnidad=function(e){return i.put("::unidades/update/"+e.id,e).then(function(a){return o.success("Cambios guardados"),e.editando=!1},function(e){return o.error("No se pudo guardar cambios")})},e.editarSubunidad=function(e){return e.editando=!0},e.cancelarEditSubunidad=function(e){return e.editando=!1},e.guardarCambiosSubunidad=function(e){return i.put("::subunidades/update/"+e.id,e).then(function(a){return o.success("Cambios guardados"),e.editando=!1},function(e){return o.error("No se pudo guardar cambios")})},e.asignaturas[0],e.$emit("cambia_descripcion",e.asignaturas.length+" asignaturas del profesor "+e.info_profe.nombres_profesor+" "+e.info_profe.apellidos_profesor)}])}.call(this),function(){angular.module("myvcFrontApp").controller("BoletinesFinalesCtrl",["$scope","alumnosDat","escalas","$cookieStore",function(e,a,t,r){return e.grupo=a[0],e.year=a[1],e.alumnos=a[2],e.escalas=t,e.config=r.get("config"),e.requested_alumnos=r.get("requested_alumnos"),e.requested_alumno=r.get("requested_alumno"),e.$on("change_config",function(){return e.config=r.get("config")}),e.requested_alumnos?e.$emit("cambia_descripcion","Mostrando "+e.alumnos.length+" boletines de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.requested_alumno?e.$emit("cambia_descripcion","Mostrando un boletin de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.$emit("cambia_descripcion",e.alumnos.length+" boletines del grupo "+e.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").directive("boletinFinalAlumnoDir",["App","Perfil",function(e,a){return{restrict:"EA",templateUrl:"==informes/boletinFinalAlumnoDir.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(t,r,n){return t.USER=a.User(),t.USER.nota_minima_aceptada=parseInt(t.USER.nota_minima_aceptada),t.perfilPath=e.images+"perfil/",t.views=e.views}}}]).filter("promedioPeriodo",[function(){return function(e,a){var t,r,n,o,i,s,u;for(u=0,r=0,o=e.length;r<o;r++)for(n=0,i=(s=e[r].definitivas).length;n<i;n++)(t=s[n]).periodo_id&&parseFloat(t.periodo_id)===parseFloat(a)&&(u+=parseFloat(t.DefMateria));return u/e.length}}])}.call(this),function(){angular.module("myvcFrontApp").directive("editNotasMatYearDir",["App","Perfil",function(e,a){return{restrict:"EA",templateUrl:"==informes/editNotasMatYearDir.tpl.html",scope:{asignatura:"=",alumno:"=",alumnosasigs:"="},controller:["$scope","App","$http","EscalasValorativasServ","AuthService","toastr",function(e,t,r,n,o,i){var s;return e.USER=a.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.perfilPath=t.images+"perfil/",e.periodos_materia=[],e.solo_notas_perdidas=!0,e.hasRoleOrPerm=o.hasRoleOrPerm,n.escalas().then(function(a){return e.escalas=a}),s={alumno_id:e.alumno.alumno_id,asignatura_id:e.asignatura.asignatura_id,periodos_a_calcular:"de_usuario"},r.put("::editnota/alum-asignatura",s).then(function(a){return e.periodos_materia=a.data},function(e){}),e.cambiaNota=function(e,a){return r.put("::notas/update/"+e.id,{nota:e.nota}).then(function(a){return i.success("Cambiada: "+e.nota)},function(a){return i.error("No pudimos guardar la nota "+e.nota)})}}]}}])}.call(this),function(){angular.module("myvcFrontApp").directive("certificadoEstudioDir",["App","Perfil",function(e,a){return{restrict:"EA",templateUrl:"==informes/certificadoEstudioDir.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(t,r,n){var o,i;return t.USER=a.User(),t.USER.nota_minima_aceptada=parseInt(t.USER.nota_minima_aceptada),t.perfilPath=e.images+"perfil/",t.views=e.views,i=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],o=new Date,t.fecha_dia=o.getDate(),t.fecha_mes=i[o.getMonth()],t.fecha_year=o.getFullYear()}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CertificadosEstudioCtrl",["$scope","$state","alumnosDat","escalas","$cookieStore",function(e,a,t,r,n){return e.grupo=t[0],e.year=t[1],e.alumnos=t[2],e.escalas=r,e.config=n.get("config"),e.requested_alumnos=n.get("requested_alumnos"),e.requested_alumno=n.get("requested_alumno"),e.$on("change_config",function(){return e.config=n.get("config")}),e.requested_alumnos?e.$emit("cambia_descripcion","Mostrando "+e.alumnos.length+" boletines de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.requested_alumno?e.$emit("cambia_descripcion","Mostrando un boletin de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.$emit("cambia_descripcion",e.alumnos.length+" boletines del grupo "+e.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").controller("NotasPerdidasProfesorCtrl",["$scope","App","Perfil","grupos","$state","$stateParams",function(e,a,t,r,n,o){return e.grupos=r.data,e.periodo_a_calcular=o.periodo_a_calcular,e.USER=t.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.perfilPath=a.images+"perfil/",e.$emit("cambia_descripcion","Notas pendientes ")}]).controller("NotasPerdidasTodosCtrl",["$scope","App","Perfil","profesores","$state","$stateParams",function(e,a,t,r,n,o){return e.profesores=r.data,e.periodo_a_calcular=o.periodo_a_calcular,e.USER=t.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.perfilPath=a.images+"perfil/",e.$emit("cambia_descripcion","Notas pendientes ")}]).controller("VerAusenciasCtrl",["$scope","App","Perfil","grupos_ausencias","$state",function(e,a,t,r,n){return e.grupos_ausencias=r.data,e.USER=t.User(),e.perfilPath=a.images+"perfil/",e.$emit("cambia_descripcion","Ausencias y tardanzas a la institución ")}]).controller("VerSimatCtrl",["$scope","App","Perfil","grupos_simat","$state",function(e,a,t,r,n){return e.grupos_simat=r.data,e.USER=t.User(),e.perfilPath=a.images+"perfil/",e.$emit("cambia_descripcion","Ausencias y tardanzas a la institución ")}]).controller("VerObservadorVerticalCtrl",["$scope","App","Perfil","grupos_observador","$state",function(e,a,t,r,n){return e.grupos_observador=r.data,e.editor_options={allowedContent:!0,entities:!1},e.onEditorReady=function(){return console.log("Editor listo")},e.USER=t.User(),e.perfilPath=a.images+"perfil/",e.$emit("cambia_descripcion","Observador del alumno ")}]).controller("PlanillasAusenciasAcudientesCtrl",["$scope","App","Perfil","grupos_acud","$state",function(e,a,t,r,n){var o,i,s,u,l;for(e.grupos_acud=r.data.grupos_acud,e.year=r.data.year,e.USER=t.User(),e.perfilPath=a.images+"perfil/",e.fecha_hoy=new Date,e.texto_informativo={},i=localStorage.txt_informativo_asist_padres,e.texto_informativo.texto=i||"<b>PLANILLA ASISTENCIA ASAMBLEA DE PADRES</b><br>",e.cambia_texto_informativo=function(){return localStorage.txt_informativo_asist_padres=e.texto_informativo.texto},e.editor_options={allowedContent:!0,entities:!1},s=0,u=(l=e.grupos_acud).length;s<u;s++)(o=l[s]).alumnos_temp=o.alumnos,o.alumnos_temp.length<24?o.alumnos1=o.alumnos_temp:o.alumnos_temp.length<50?(o.alumnos1=o.alumnos_temp.splice(0,23),o.alumnos2=o.alumnos_temp.splice(0,27)):asign.alumnos_temp.length<75&&(o.alumnos1=o.alumnos_temp.splice(0,23),o.alumnos2=o.alumnos_temp.splice(0,27),o.alumnos3=o.alumnos_temp.splice(0,27));return e.$emit("cambia_descripcion","Planilla de asistencia de padres ")}]).directive("compile",["$compile","$timeout",function(e,a){return{restrict:"A",link:function(t,r,n){return a(function(){return e(r.contents())(t)})}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("NotasActualesAlumnosCtrl",["$scope","App","Perfil","alumnosDat","escalas","$cookieStore",function(e,a,t,r,n,o){var i,s,u,l,c,d,p,f,m,g,_,h,v,b,y,w,C,N,A;for(e.USER=t.User(),e.USER.nota_minima_aceptada=parseInt(e.USER.nota_minima_aceptada),e.perfilPath=a.images+"perfil/",e.views=a.views,e.grupo=r[0],e.year=r[1],e.alumnos=r[2],e.escalas=n,e.config=o.get("config"),e.requested_alumnos=o.get("requested_alumnos"),e.requested_alumno=o.get("requested_alumno"),u=0,p=(b=e.alumnos).length;u<p;u++)for((i=b[u]).cant_perdidas=0,l=0,f=(y=i.periodos).length;l<f;l++)for((v=y[l]).cant_perdidas=0,c=0,m=(w=v.asignaturas).length;c<m;c++)for((s=w[c]).cant_perdidas=0,d=0,g=(C=s.unidades).length;d<g;d++)for((A=C[d]).cant_perdidas=0,h=0,_=(N=A.subunidades).length;h<_;h++)N[h].nota<e.USER.nota_minima_aceptada&&(A.cant_perdidas+=1,s.cant_perdidas+=1,v.cant_perdidas+=1,i.cant_perdidas+=1);return e.$on("change_config",function(){return e.config=o.get("config")}),e.requested_alumnos?e.$emit("cambia_descripcion","Mostrando "+e.alumnos.length+" boletines de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.requested_alumno?e.$emit("cambia_descripcion","Mostrando un boletin de "+e.grupo.cantidad_alumnos+" del grupo "+e.grupo.nombre_grupo):e.$emit("cambia_descripcion",e.alumnos.length+" boletines del grupo "+e.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").controller("ListadoProfesoresCtrl",["$scope","App","Perfil","profesores","$state",function(e,a,t,r,n){return e.USER=t.User(),e.profesores=r.data.profesores,e.year=r.data.year,e.perfilPath=a.images+"perfil/",e.$emit("cambia_descripcion",e.profesores.length+"  profesores.")}]).controller("VerCantAlumnosPorGruposCtrl",["$scope","App","Perfil","grupos","$state",function(e,a,t,r,n){var o,i,s,u;for(e.USER=t.User(),e.grupos_cantidades=r.data.grupos,e.periodos_total=r.data.periodos_total,e.perfilPath=a.images+"perfil/",e.cant_total_alumnos=0,i=0,s=(u=e.grupos_cantidades).length;i<s;i++)o=u[i],e.cant_total_alumnos=e.cant_total_alumnos+o.cant_alumnos;return e.$emit("cambia_descripcion",e.grupos_cantidades.length+"  grupos.")}])}.call(this),function(){angular.module("myvcFrontApp").filter("decimales",[function(){return function(e,a){return(e=(e=parseFloat(e))%1==0?e.toFixed(0):e.toFixed(a)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]).filter("decimales_if",[function(){return function(e,a){var t;return t=(e=(e=parseFloat(e))%1==0?e.toFixed(0):e.toFixed(a)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),t=parseFloat(t)}}]).filter("setDecimal",[function(){return function(e,a){var t;return isNaN(e)?e:(t="1"+Array(+(a>0&&a+1)).join("0"),Math.round(e*t)/t)}}]).filter("formatNumberDocumento",["$filter",function(e){return function(a){return!isNaN(a)&&angular.isNumber(+a)?e("number")(a,0):a}}])}.call(this),function(){angular.module("myvcFrontApp").filter("materiasPerdidasYear",[function(){return function(e,a,t){return a?(this.alumnos_response=[],angular.forEach(e,function(e,r){if(this.cant_asig_perdidas=0,angular.forEach(e.notas_asig,function(e,a){if(Math.round(e.nota_final_year)<t)return this.cant_asig_perdidas++}),this.cant_asig_perdidas>=a)return this.alumnos_response.push(e)}),alumnos_response):e}}]).filter("materiasPerdidas",[function(){return function(e,a,t){return a?(this.alumnos_response=[],angular.forEach(e,function(e,r){if(this.cant_asig_perdidas=0,angular.forEach(e.asignaturas,function(e,a){if(Math.round(e.nota_asignatura)<t)return this.cant_asig_perdidas++}),this.cant_asig_perdidas>=a)return this.alumnos_response.push(e)}),alumnos_response):e}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(e,a,t){e.state("panel.actividades.votaciones",{url:"/votaciones",views:{actividades_content:{templateUrl:`${a.views}votaciones/votacionesInicio.tpl.html`,controller:"VotacionesInicioCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Votaciones"}]}}},data:{displayName:"Votaciones",icon_fa:"fa fa-legal",pageTitle:"Votaciones - MyVc"}}),e.state("panel.actividades.votaciones.config",{url:"/config",views:{votaciones_view:{templateUrl:`${a.views}votaciones/votaciones.tpl.html`,controller:"VotacionesCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Configuración - MyVc"}]}}},data:{displayName:"Configuración",icon_fa:"fa fa-legal",pageTitle:"Configuración - MyVc"}}).state("panel.actividades.votaciones.participantes",{url:"/participantes",views:{votaciones_view:{templateUrl:`${a.views}votaciones/participantes.tpl.html`,controller:"ParticipantesCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Participantes"}]}}},data:{needed_permissions:[t.can_edit_participantes],displayName:"Participantes",icon_fa:"fa fa-legal",pageTitle:"Participantes - MyVc"}}).state("panel.actividades.votaciones.candidatos",{url:"/candidatos",views:{votaciones_view:{templateUrl:`${a.views}votaciones/candidatos.tpl.html`,controller:"CandidatosCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Candidatos"}]}}},data:{needed_permissions:[t.can_edit_candidatos],pageTitle:"Candidatos - MyVc"}}).state("panel.actividades.votaciones.votar",{url:"/votar",views:{votaciones_view:{templateUrl:`${a.views}votaciones/votar.tpl.html`,controller:"VotarCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Votar"}]}}},data:{pageTitle:"Votar - MyVc"}}).state("panel.actividades.votaciones.votarprueba",{url:"/prueba",views:{votaciones_view:{templateUrl:`${a.views}votaciones/votarprueba.tpl.html`,controller:"VotarPruebaCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Prueba votación"}]}}},data:{pageTitle:"Prueba votación - MyVc"}}).state("panel.actividades.votaciones.resultados",{url:"/resultados",views:{votaciones_view:{templateUrl:`${a.views}votaciones/resultados.tpl.html`,controller:"ResultadosCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Resultados"}]}}},data:{pageTitle:"Resultados - MyVc"}}).state("panel.actividades.votaciones.tarjetones",{url:"/tarjetones",views:{votaciones_view:{templateUrl:`${a.views}votaciones/tarjetones.tpl.html`,controller:"TarjetonesCtrl"},headerContent:{templateUrl:`${a.views}panel/panelHeader.tpl.html`,controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Tarjetones"}]}}},data:{pageTitle:"Tarjetones - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotacionesCtrl",["$scope","$filter","$http","resolved_user","App","toastr",function(e,a,t,r,n,o){var i,s,u,l,c,d,p,f;e.data={},e.editing=!1,e.gridScope=e,e.votacionEdit={},e.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:"",aspiraciones:[{aspiracion:"",abrev:""}]},e.date={dateOptions:{startingDay:1}},e.addAspiracion=function(){return e.votacion.aspiraciones.push({aspiracion:"",abrev:""})},e.removeAspiracion=function(a){return e.votacion.aspiraciones.splice(a,1)},e.addAspiracionEdit=function(a){return t.post("::aspiraciones/store",{votacion_id:a}).then(function(a){return o.success("Aspiración creada."),e.votacionEdit.aspiraciones.push({id:a.data.id,aspiracion:"",abrev:""})},function(e){return o.error("No se pudo crear aspiración.")})},e.updateAspiracionEdit=function(e){return t.put("::aspiraciones/update",e).then(function(e){return o.success("Aspiración modificada.")},function(e){return o.error("No se pudo modificar aspiración.")})},e.removeAspiracionEdit=function(r){return t.delete("::aspiraciones/destroy/"+r.id).then(function(t){return o.success("Aspiración eliminada."),e.votacionEdit.aspiraciones=a("filter")(e.votacionEdit.aspiraciones,{id:"!"+r.id})},function(e){return o.error("No se pudo eliminar aspiración.")})},e.editar=function(a){return e.editing=!0,e.votacionEdit=a},e.eliminar=function(r){return t.delete("::votaciones/destroy/"+r.id).then(function(t){return e.gridOptions.data=a("filter")(e.gridOptions.data,{id:"!"+r.id})},function(e){return o.error("No se pudo eliminar.")})},e.cambiarInAction=function(a){return t.put("::votaciones/set-in-action",{id:a.id,in_action:a.in_action}).then(function(t){var r,n,i,s;if(a.in_action)for(r=0,n=(i=e.gridOptions.data).length;r<n;r++)s=i[r],a.id!==s.id&&(s.in_action=!1);else a.in_action=!1;return o.success("Cambiado")},function(e){return o.error("No se pudo poner en acción.")})},e.cambiarVotanProfes=function(e){return t.put("::votaciones/set-votan-profes",{id:e.id,votan_profes:e.votan_profes}).then(function(e){return o.success("Cambiado")},function(e){return o.error("No se pudo cambiar votan profes.")})},e.cambiarVotanAcudientes=function(e){return t.put("::votaciones/set-votan-acudientes",{id:e.id,votan_acudientes:e.votan_acudientes}).then(function(e){return o.success("Cambiado")},function(e){return o.error("No se pudo cambiar votan acudientes.")})},e.cambiarLocked=function(e){return t.put("::votaciones/set-locked",{id:e.id,locked:e.locked}).then(function(e){return o.success("Cambiado")},function(e){return o.error("No se pudo cambiar bloqueo.")})},e.cambiarPermisoVerResults=function(e){return t.put("::votaciones/set-permiso-ver-results",{id:e.id,can_see_results:e.can_see_results}).then(function(e){return o.success("Cambiado")},function(e){return o.error("No se pudo cambiar el permiso.")})},e.cambiarEventoActual=function(a){return t.put("::votaciones/set-actual",{id:a.id,actual:a.actual}).then(function(t){var r,n,i,s;if(a.actual)for(r=0,n=(i=e.gridOptions.data).length;r<n;r++)s=i[r],a.id!==s.id&&(s.actual=!1);else a.actual=!1;return o.success("Cambiado")},function(e){return o.error("No se pudo volver actual.")})},c='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',d='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',s="==votaciones/botonEventoActual.tpl.html",l="==votaciones/botonEventoLocked.tpl.html",f="==votaciones/botonVotanProfes.tpl.html",u="==votaciones/botonVotanAcudientes.tpl.html",i="==votaciones/botonEventoInAction.tpl.html",p="==votaciones/botonPermisoVerResults.tpl.html",e.gridOptions={enableSorting:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"id",displayName:"Id",width:40,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:c+d,enableCellEdit:!1},{field:"nombre",enableHiding:!1,minWidth:110},{field:"locked",displayName:"Bloqueado",cellTemplate:l,minWidth:80},{field:"votan_profes",displayName:"Profes votan",minWidth:80,cellTemplate:f},{field:"votan_acudientes",displayName:"Acudientes votan",minWidth:80,cellTemplate:u},{field:"actual",displayName:"Actual",cellTemplate:s,minWidth:80},{field:"in_action",displayName:"En acción",cellTemplate:i,minWidth:80},{field:"can_see_results",displayName:"Permiso",cellTemplate:p,minWidth:80},{field:"fecha_inicio",displayName:"Inicia",cellFilter:"date:mediumDate",type:"date",minWidth:80},{field:"fecha_fin",displayName:"Termina",cellFilter:"date:mediumDate",type:"date",minWidth:80}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a,a.edit.on.afterCellEdit(e,function(a,r,n,i){return n!==i&&t.put("::votaciones/update/"+a.id,a).then(function(e){return o.success("Evento actualizado con éxito","Actualizado")},function(e){return o.error("Cambio no guardado","Error")}),e.$apply()})}},t.get("::votaciones").then(function(a){return e.gridOptions.data=a.data},function(e){return o.error("Error trayendo los eventos.")}),e.crear=function(){return t.post("::votaciones/store",e.votacion).then(function(a){return(a=a.data).actual&&angular.forEach(e.gridOptions.data,function(e,a){return e.actual=0}),e.gridOptions.data.push(a)},function(e){return o.error("Falló al intentar guardar")})},e.guardar=function(){return t.post("::votaciones/update/"+e.votacionEdit.id,e.votacionEdit).then(function(e){return o.success("Se hizo el put de la votación")},function(e){return o.error("Falló al intentar guardar")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotacionesInicioCtrl",["$scope","$rootScope","$interval","resolved_user","App","AuthService","$state",function(e,a,t,r,n,o,i){o.verificar_acceso(),e.hasRoleOrPerm=o.hasRoleOrPerm,e.USER=r,i.is("panel.actividades.votaciones")&&(e.hasRoleOrPerm(["alumno","acudiente"])&&i.go("panel.actividades.votaciones.votar"),e.hasRoleOrPerm(["admin","profesor"])&&i.go("panel.actividades.votaciones.config"))}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("CandidatosCtrl",["$scope","$filter","$http","toastr","App",function(e,a,t,r,n){e.perfilPath=n.images+"perfil/",e.aspiraciones=[],e.allinscritos=[],t.get("::candidatos/conaspiraciones").then(function(a){return e.aspiraciones=a.data},function(e){return r.error("No se pudo traer las aspiraciones","Problema")}),t.get("::participantes/allinscritos").then(function(a){return e.allinscritos=a.data},function(e){return r.error("No se pudo traer los inscritos","Problema")}),e.crearCandidato=function(e){var a;return(a={}).user_id=e.newParticip.user_id,a.plancha=e.newParticip.plancha,a.numero=e.newParticip.numero,a.aspiracion_id=e.id,t.post("::candidatos/store",a).then(function(a){return a=a.data,e.candidatos=a,e.newParticip=null,r.success("Candidato creado con éxito")},function(e){return"Candidato ya inscrito"===e.data.error.message?r.warning("Candidato ya inscrito en esta aspiración"):r.warning("No se pudo crear el candidato","Problema")})},e.eliminarCandidato=function(e,n){return t.delete("::candidatos/destroy/"+e).then(function(t){return n.candidatos=a("filter")(n.candidatos,{candidato_id:"!"+e}),r.success("Candidato removido de la candidatura")},function(e){return r.error("No se pudo quitar de la candidatura","Problema")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ParticipantesCtrl",["$scope","$filter","$http","toastr",function(e,a,t,r){var n,o;e.editing=!1,e.gridScope=e,e.participante={},e.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},e.eliminar=function(n){return t.delete("::participantes/destroy/"+n.id).then(function(t){return r.success("Se ha eliminado."),e.gridOptions.data=a("filter")(e.gridOptions.data,{id:"!"+t.data.id})},function(e){return r.error("No se pudo eliminar.")})},e.cambiarLocked=function(e){return t.put("::participantes/set-locked",{id:e.id,locked:e.locked}).then(function(e){return r.success("Cambiado")},function(e){return r.error("No se pudo cambiar bloqueo.")})},o='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',n="==votaciones/botonEventoLocked.tpl.html",e.gridOptions={enableSorting:!0,showGridFooter:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:o,enableCellEdit:!1},{field:"nombres",displayName:"nombres",enableCellEdit:!1,minWidth:80},{field:"apellidos",displayName:"apellidos",enableCellEdit:!1},{field:"nombre_grupo",displayName:"Grado",enableCellEdit:!1},{field:"username",displayName:"Usuario",enableCellEdit:!1},{field:"votados",displayName:"Votados",enableCellEdit:!1},{field:"completo",displayName:"Completo",enableCellEdit:!1},{field:"locked",displayName:"Bloqueado",cellTemplate:n,minWidth:80}],multiSelect:!1,onRegisterApi:function(a){return e.gridApi=a}},t.put("::participantes/datos").then(function(a){return a=a.data,e.gridOptions.data=a.participante,e.grupos=a.grupos,e.votacion=a.votacion,e.datos.grupo_profes_acudientes=a.partic_gr},function(e){return r.warning("Asegúrate de tener al menos un evento como actual.")}),e.guardarInscripciones=function(){return e.guardando_inscrip=!0,t.put("::participantes/guardar-inscripciones",{grupos:e.grupos}).then(function(a){return r.success("Inscripciones guardadas."),e.guardando_inscrip=!1},function(a){return r.error("Error al intentar guardar Inscripciones."),e.guardando_inscrip=!1})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotarCtrl",["$scope","$http","toastr",function(e,a,t){e.votaciones=[],e.indexVotando=0,a.get("::votaciones/en-accion-inscrito").then(function(a){var r,n,o,i;if((a=a.data).msg)return t.warning(a.msg,"Atención");for(e.votaciones=a,i=[],r=0,n=(o=e.votaciones).length;r<n;r++)o[r].completos?i.push(e.indexVotando++):i.push(void 0);return i}),e.$on("termineDeVotar",function(){return e.indexVotando++,e.$broadcast("terminaVotacion",e.indexVotando)})}]).controller("chooseCandidatoCtrl",["$scope","$http","$uibModalInstance","App","candidato","aspiracion","votacion_id","toastr",function(e,a,t,r,n,o,i,s){return e.candidato=n,e.aspiracion=o,e.imagesPath=r.images+"perfil/",e.ok=function(){var e;return(e={}).votacion_id=i,n.voto_blanco?(e.blanco_aspiracion_id=o.id,e.voto_blanco=!0):e.candidato_id=n.candidato_id,a.post("::votos/store",e).then(function(e){return(e=e.data).msg?s.info(e.msg):s.success("Voto guardado con éxito"),t.close(e)},function(e){return(e=e.data).data&&e.data.msg?s.error(e.data.msg):s.error("No se pudo guardar el voto."),t.dismiss("Error al guardar")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotarPruebaCtrl",["$scope","$filter","$http","App","$state","$uibModal","$window",function(e,a,t,r,n,o,i){e.hover=!1,e.aspiraciones=[],e.maxi=n.params.maxi,e.windowHeight=$(i).height()-100,e.wzStep=0,e.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},t.get("::votaciones/actual").then(function(a){if(e.votacion=a.data,e.votacion.locked)return e.toastr.warning("La votación actual está bloqueada")}),t.get("::candidatos/conaspiraciones").then(function(a){return e.aspiraciones=a.data},function(a){return e.toastr.error("No se pudo traer las aspiraciones","Problema")}),t.get("::participantes/allinscritos").then(function(a){return e.allinscritos=a.data},function(a){return e.toastr.error("No se pudo traer los inscritos","Problema")}),e.currentImg="default_male.jpg",e.imagesPath=r.images+"perfil/",e.mostrarImagen=function(a){return a.iluminado=!0,e.currentImg=a.imagen_nombre},e.ocultarImagen=function(e){return e.iluminado=!1},e.nextAspiracion=function(){if(e.wzStep<e.aspiraciones.length)return e.wzStep+=1},e.prevAspiracion=function(){if(e.wzStep>0)return e.wzStep-=1},e.goAspiracion=function(a){if(e.wzStep=parseInt(e.wzStep),(a=parseInt(a))<e.wzStep)return e.wzStep=a},e.open=function(a,t){if(!e.votacion.locked)return o.open({templateUrl:"==votaciones/chooseCandidato.tpl.html",controller:"chooseCandidatoCtrl",resolve:{candidato:function(){return a},aspiracion:function(){return t},votacion_id:function(){return e.votacion.id}}}).result.then(function(a){return t.votado.push(a),e.nextAspiracion()},function(){});e.toastr.warning("La votación actual está bloqueada")}}]).controller("chooseCandidatoPruebaCtrl",["$scope","$http","$uibModalInstance","App","candidato","aspiracion","toastr",function(e,a,t,r,n,o,i){return e.candidato=n,e.aspiracion=o,e.imagesPath=r.images+"perfil/",e.ok=function(){var e;return{}.candidato_id=n.candidato_id,e={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:"",completo:!1},i.success("Voto guardado con éxito"),t.close(e)},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("votarPanelDir",["App","Perfil","$http",function(e,a,t){return{restrict:"EA",templateUrl:"==votaciones/votarPanel.tpl.html",scope:{votacion:"="},controller:["$scope","App","toastr","$window","$uibModal",function(e,t,r,n,o){e.USER=a.User(),e.hover=!1,e.maxi=!1,e.windowHeight=$(n).height()-100,e.wzStep=0,e.currentImg="default_male.jpg",e.imagesPath=t.images+"perfil/",e.$parent.$index===e.$parent.indexVotando&&(e.maxi=!0),e.$on("terminaVotacion",function(a,t){if(e.$parent.$index===t)return e.maxi=!0}),e.votacion.completos&&(e.wzStep=e.votacion.aspiraciones.length),e.mostrarImagen=function(a){return a.iluminado=!0,e.currentImg=a.imagen_nombre},e.ocultarImagen=function(e){return e.iluminado=!1},e.nextAspiracion=function(){if(e.wzStep<e.votacion.aspiraciones.length)return e.wzStep+=1},e.prevAspiracion=function(){if(e.wzStep>0)return e.wzStep-=1},e.goAspiracion=function(a){if(e.wzStep=parseInt(e.wzStep),(a=parseInt(a))<e.wzStep)return e.wzStep=a},e.open=function(a,t){if(e.votacion.locked)r.warning("La votación está bloqueada.");else{if(!e.votacion.locked_votacion)return o.open({templateUrl:"==votaciones/chooseCandidato.tpl.html",controller:"chooseCandidatoCtrl",resolve:{candidato:function(){return a},aspiracion:function(){return t},votacion_id:function(){return e.votacion.id}}}).result.then(function(a){var n,o,i,s;for(t.votado=!0,n=0,o=0,i=(s=e.votacion.aspiraciones).length;o<i;o++)s[o].votado&&n++;return e.votacion.aspiraciones.length===n&&(e.$emit("termineDeVotar"),e.maxi=!1,r.info("Ahora continúa con la siguiente votación.")),e.nextAspiracion()},function(){});r.warning("Usted está bloqueado en esta votación.")}}}]}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ResultadosCtrl",["$scope","$http","App","toastr",function(e,a,t,r){e.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},e.imagesPath=t.images+"perfil/",a.put("::votos/show").then(function(a){return e.votaciones=a.data.votaciones,e.year=a.data.year},function(e){return r.error("Error trayendo las votaciones.")})}]).controller("TarjetonesCtrl",["$scope","$http","App","toastr",function(e,a,t,r){e.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},e.imagesPath=t.images+"perfil/",a.put("::votos/show").then(function(a){return e.votaciones=a.data.votaciones,e.year=a.data.year},function(e){return r.error("Error trayendo las votaciones.")})}])}.call(this),function(){angular.module("myvcFrontApp").directive("loader",[function(){return{restrict:"E",templateUrl:"==directives/loader.tpl.html",scope:{cargando:"="},link:function(e,a,t){}}}])}.call(this),angular.module("uiBreadcrumbs",["ui.router","myvcFrontApp"]).directive("uiBreadcrumbs",["$interpolate","$state","App",function(e,a,t){return{restrict:"E",templateUrl:t.views+"directives/uiBreadcrumbs.tpl.html",scope:{displaynameProperty:"@"},link:function(t){function r(){for(var e=[],r=a.$current;r&&""!==r.name;){var i=n(r),s=o(r);!1!==i&&e.push({displayName:i,route:r.name,icon_fa:s}),r=r.parent}e.reverse(),t.breadcrumbs=e}function n(a){var r,n,o;if(!t.displaynameProperty)return a.name;for(o=t.displaynameProperty.split("."),n=a,r=0;r<o.length;r++){if(!angular.isDefined(n[o[r]]))return a.name;if(!1===n[o[r]])return!1;n=n[o[r]]}return e(n)(a.locals.globals)}function o(a){var t;return t=a,angular.isDefined(t.data.icon_fa)?!1!==t.data.icon_fa&&(t=t.data.icon_fa,e(t)(a.locals.globals)):""}t.breadcrumbs=[],""!==a.$current.name&&r(),t.$on("$stateChangeSuccess",function(){r()})}}}]),function(){angular.module("myvcFrontApp").directive("sidebarMenu",["$rootScope","AuthService","$http","$uibModal","Perfil","ProfesoresServ","$window","$state",function(e,a,t,r,n,o,i,s){return{restrict:"E",replace:!0,templateUrl:"==directives/sidebarMenu.tpl.html",scope:{cargando:"="},link:function(e,a,t){return e.$watch(function(){return i.innerWidth},function(e){return e>880?a.removeClass("hide"):a.addClass("hide")})},controller:["$scope","$attrs","$state","App",function(i,s,u,l){return i.perfilPath=l.images+"perfil/",this.groups=[],i.hasRoleOrPerm=a.hasRoleOrPerm,i.$state=e.$state,i.persona_id=n.User().persona_id,i.hasRoleOrPerm(["Admin","Profesor"])&&t.get("::grupos").then(function(e){return i.grupos=e.data},function(e){return toastr.error("No se pudo traer los grupos del menú")}),o.contratos().then(function(e){return i.profesores=e},function(e){return toastr.error("No se pudo traer los profesores del menú")}),i.listarAsignaturas=function(){return r.open({templateUrl:"==areas/listasignaturasPop.tpl.html",controller:"ListasignaturasPopCtrl"}).result.then(function(e){})},i.irDefinitivas=function(e){return u.go("panel.definitivas_periodos",{profesor_id:e})},i.ir_a_informes=function(){return u.go("panel.informes")},this.clikeando=function(){},this.closeOthers=function(e){return angular.forEach(this.groups,function(e){if(!0===e.menuIsOpen)return e.menuIsOpen=!1})},this.addGroup=function(e){var a;return a=this,this.groups.push(e),e.$on("$destroy",function(t){return a.removeGroup(e)})},this.removeGroup=function(e){var a;if(-1!==(a=this.groups.indexOf(e)))return this.groups.splice(a,1)},this}]}}]).directive("subMenu",[function(){return{require:"^sidebarMenu",restrict:"A",replace:!0,scope:!0,link:function(e,a,t,r){return e.menuIsOpen=!!t.menuIsOpen&&e.$eval(t.menuIsOpen),t.hija?(!0===e.menuIsOpen&&a.addClass("open"),e.toggleOpen=function(){return!1===e.menuIsOpen?(a.addClass("open"),e.menuIsOpen=!0):(a.removeClass("open"),e.menuIsOpen=!1)}):(r.addGroup(e),e.$watch("menuIsOpen",function(e){return!0===e?a.addClass("open"):a.removeClass("open")}),e.toggleOpen=function(){return!1===e.menuIsOpen?(r.closeOthers(e),e.menuIsOpen=!0):e.menuIsOpen=!1})}}}]).directive("myDropDown",["$document",function(e){return{restrict:"A",replace:!0,scope:!0,link:function(e,a,t){e.menuIsOpen=!!t.menuIsOpen&&e.$eval(t.menuIsOpen),!0===e.menuIsOpen&&a.addClass("open"),e.toggleOpen=function(){!0===e.menuIsOpen?(a.addClass("open"),e.menuIsOpen=!0):(a.removeClass("open"),e.menuIsOpen=!1)}}}}]).directive("stopEvent",[function(){return{restrict:"A",link:function(e,a,t){return a.bind(t.stopEvent,function(e){return e.stopPropagation()})}}}]).directive("toggle",function(){var e,a,t,r;return"selected",a={},e=function(e,t){if(a[e]=a[e]||[],-1===a[e].indexOf(t))return a[e].push(t)},t=function(e,t){var r;if(-1!==(r=(a[e]||[]).indexOf(t)))return a[e].splice(r,1)},r=function(e,t){return angular.forEach(a[e]||[],function(e){return e.removeClass("selected")}),t.addClass("selected")},{restrict:"A",link:function(a,n,o){var i;return i=o.toggle||"default",e(i,n),n.on("click",function(){return a.$apply(function(){return r(i,n)})}),a.$on("$destroy",function(){return n.off(),t(i,n)})}}}).controller("ListasignaturasPopCtrl",["$scope","$uibModalInstance","$http","toastr","$state",function(e,a,t,r,n){return e.selectAsignatura=function(e,t){return n.go("panel.notas",{asignatura_id:e,profesor_id:t}),a.close(e)},t.get("::asignaturas/listasignaturas-alone").then(function(a){return e.asignaturas=a.data},function(e){return r.error("No se pudo traer tus asignaturas")}),e.cancel=function(){return a.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("updateTitle",["$rootScope","$timeout",function(e,a){return{link:function(t,r){var n;return n=function(e,t,n){var o;return o="MyVc",t.data&&t.data.pageTitle&&(o=t.data.pageTitle),n&&n.username&&(o=n.username+" - MyVc"),a(function(){return r.text(o)},0,!1)},e.$on("$stateChangeSuccess",n)}}}])}.call(this),function(){angular.module("myvcFrontApp").directive("notaRapida",["$rootScope","toastr","EscalasValorativasServ",function(e,a,t){return{restrict:"AE",transclude:!0,templateUrl:"==directives/notaRapida.tpl.html",link:function(r,n,o){return r.valorNotaRapida=100,e.notaRapida.enable?r.activado=!0:r.activado=!1,r.activar=function(){if(!r.activado)return r.activado=!0,e.notaRapida.enable=r.activado,a.info("Nota rápida activada","ACTIVADA")},r.desactivar=function(){return r.activado=!1,e.notaRapida.enable=r.activado,a.info("Nota rápida desactivada","DESACTIVADA")},r.clickInput=function(){if(!$("#input-nota-rapida").is(":focus"))return $("#input-nota-rapida").focus()},r.$on("keydown:27",function(e,a){return r.desactivar()}),t.escalas().then(function(e){return r.escalas=e},function(e){return console.log("No se trajeron las escalas valorativas",e)}),r.setValor=function(a){return e.notaRapida.valorNota=a,r.activar()}}}}]).directive("cambiamodel",["$rootScope",function(e){return{restrict:"A",link:function(a,t,r){return a.$watch(r.ngModel,function(a){return console.log(a),e.notaRapida.valorNota=a})}}}]).directive("keypressEvents",["$document","$rootScope",function(e,a){return{restrict:"A",link:function(){return e.bind("keypress keydown",function(e){if(27===e.which)return a.$broadcast("keydown:27",e)})}}}]).filter("range",function(){return function(e,a,t){var r,n,o,i;for(t=parseInt(t),r=n=o=a=parseInt(a),i=t;o<=i?n<=i:n>=i;r=o<=i?++n:--n)e.push(r);return e}}).run(["$templateCache",function(e){return e.put("/tmpls/draggable-default","<div ng-transclude></div>")}]).directive("draggable",[function(){return{restrict:"AE",transclude:!0,replace:!0,scope:{},templateUrl:function(e,a){return angular.isDefined(a.template)?a.template:"/tmpls/draggable-default"},link:function(e,a,t){var r,n,o;return a=$(a),e.obj={id:null,content:"",group:null},e.placeholder=!1,e.obj.content=a.html(),angular.isDefined(t.id)&&(e.obj.id=t.id),angular.isDefined(t.placeholder)&&(e.placeholder=e.$eval(t.placeholder)),o=angular.isDefined(t.options)?e.$eval(t.options):{},angular.isDefined(t.group)&&(e.obj.group=t.group,o.stack="."+t.group),r={start:function(a,t){e.placeholder&&t.helper.wrap('<div class="dragging"></div>'),e.$apply(function(){e.$emit("draggable.started",{obj:e.obj})})},drag:function(a){e.$apply(function(){e.$emit("draggable.dragging")})},stop:function(a,t){e.placeholder&&t.helper.unwrap(),e.$apply(function(){e.$emit("draggable.stopped")})}},n=angular.extend({},o,r),a.draggable(n)}}}])}.call(this),function(){angular.module("myvcFrontApp").directive("withpaddingDir",["$rootScope","$state",function(e,a){return{link:function(t,r){var n,o;return n=function(e,t,n){return a.includes("panel.actividades")||a.includes("panel.mis_actividades")?$(r).addClass("no-padding"):$(r).removeClass("no-padding")},o=function(e,t){return a.includes("panel.actividades")||a.includes("panel.mis_actividades")?$(r).addClass("no-padding"):$(r).removeClass("no-padding")},e.$on("$stateChangeSuccess",n),e.$on("$viewContentLoaded",o)}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("Perfil",["App","$q","$cookies","$http",function(e,a,t,r){var n;return n={},{setUser:function(e){return n=e},User:function(){return n},save:function(){return n.save()},id:function(){return n.user_id},idioma:function(){return n.idioma_system},setImagen:function(e,a){return n.imagen_id=e,n.imagen_nombre=a},setOficial:function(e,a){return n.foto_id=e,n.foto_nombre=a},nameToShow:function(){return"Usuario"===n.tipo?n.username.toUpperCase():n.nombres+" "+n.apellidos},deleteUser:function(){return n={}}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("AuthService",["$state","$http","$cookies","Perfil","$rootScope","AUTH_EVENTS","$q","$filter","toastr",function(e,a,t,r,n,o,i,s,u){var l;return(l={}).verificar=function(){var e;return e=i.defer(),r.User().user_id?e.resolve(r.User()):t.get("xtoken")?void 0!==t.get("xtoken")&&"undefined"!==t.get("xtoken")&&"[object Object]"!==t.get("xtoken")?l.login_from_token().then(function(a){return r.setUser(a),e.resolve(a)},function(a){return console.log("No se logueó from token"),e.reject(a)}):(l.borrarToken(),e.reject("Token mal estructurado.")):(console.log("No hay token"),e.resolve("No hay token."),n.$broadcast(o.notAuthenticated)),e.promise},l.verificar_acceso=function(){var a,t;return r.User().user_id||e.go("login"),!(t=e.current).data.needed_permissions||(a=t.data.needed_permissions,l.isAuthorized(a)?void 0:(n.lastState=t.name,l.isAuthenticated()?n.$broadcast(o.notAuthorized):e.transitionTo("login")))},l.login_credentials=function(r){var s;return s=i.defer(),l.borrarToken(),a.post("::login/credentials",r).then(function(e){var r;return(r=e.data).el_token?(t.put("xtoken",r.el_token),a.defaults.headers.common.Authorization="Bearer "+t.get("xtoken"),localStorage.logueando="token_verificado",s.resolve(r.el_token)):(n.$broadcast(o.loginFailed),s.reject("Error en login"))},function(a){return n.$broadcast(o.loginFailed),a?a.status?400===a.status?u.error("Datos inválidos","",{timeOut:8e3}):-1===a.status?u.error("No parece haber comunicación con el servidor","",{timeOut:8e3}):500===a.status&&u.error("No parece haber comunicación con la Base de datos","",{timeOut:8e3}):a.data?a.data.error&&("Token expirado"===a.data.error||"token_expired"===a.error?(u.warning("La sesión ha expirado"),"login"!==e.current.name&&e.go("login")):n.$broadcast(o.loginFailed)):u.error("No parece haber comunicación con el servidor"):u.error("No parece haber comunicación con el servidor"),s.reject("Error en login")}),s.promise},l.login_from_token=function(){var e;return e=i.defer(),a.defaults.headers.common.Authorization="Bearer "+t.get("xtoken"),a.post("::login").then(function(a){var t;return t=a.data,n.$broadcast(o.loginSuccess),e.resolve(t)},function(a){return e.reject("Error en login con token.")}),e.promise},l.logout=function(){return a.put("::login/logout",{user_id:r.User().user_id}).then(function(e){return console.log("Sesión cerrada")},function(e){return console.log("No se registró el cierre de sesión.")}),n.lastState=null,n.lastStateParam=null,r.deleteUser(),l.borrarToken(),delete localStorage.logueando,e.transitionTo("login")},l.borrarToken=function(){return t.remove("xtoken"),delete a.defaults.headers.common.Authorization},l.isAuthenticated=function(){return!!r.User().user_id},l.isAuthorized=function(e){var a,t;return!!(t=r.User()).is_superuser||(angular.isArray(e)||(e=[e]),angular.isArray(t.perms)?(a=[],angular.forEach(e,function(e){if(-1!==t.perms.indexOf(e))return a.push(e)}),l.isAuthenticated()&&a.length>0):!(e.length>0))},l.hasRoleOrPerm=function(e,a){var t;if(!angular.isArray(e)){if(!e)return!1;e=[e]}return t=[],angular.forEach(e,function(e){var a;if([],(a=s("filter")(r.User().roles,{name:e}))&&a.length>0)return t.push(e)}),t.length>0},l}])}.call(this),function(){angular.module("myvcFrontApp").factory("NotasServ",["$http","$q",function(e,a){var t;return(t={}).detalladas=function(t,r,n){var o;return o=a.defer(),e.put("::notas/detailed",{asignatura_id:t,profesor_id:r,con_asignaturas:n}).then(function(e){return o.resolve(e.data)},function(e){return o.reject(e)}),o.promise},t}]).factory("EscalasValorativasServ",["$http","$q","$filter",function(e,a,t){var r,n;return r=[],(n={}).escalas=function(){var t;return t=a.defer(),r.length>0?t.resolve(r):e.get("::escalas").then(function(e){var a,n,o;for(n=0,o=(r=e.data).length;n<o;n++)(a=r[n]).orden=parseInt(a.orden),a.perdido=parseInt(a.perdido),a.porc_final=parseInt(a.porc_final),a.porc_inicial=parseInt(a.porc_inicial),a.id=parseInt(a.id),a.year_id=parseInt(a.year_id);return t.resolve(r)},function(e){return t.reject(e)}),t.promise},n.escala_maxima=function(){return t("orderBy")(r,"orden")[r.length-1]},n}]).factory("AusenciasServ",["$http","$q",function(e,a){var t;return(t={}).detalladas=function(t){var r;return r=a.defer(),e.get("::ausencias/detailed/"+t).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise},t}]).factory("ComportamientoServ",["$http","$q",function(e,a){var t;return(t={}).detallados=function(t){var r;return r=a.defer(),e.get("::nota_comportamiento/detailed/"+t).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise},t}])}.call(this),function(){angular.module("myvcFrontApp").factory("ProfesoresServ",["$http","$q",function(e,a){var t;return(t={}).profesores=[],t.contratos=function(){var r;return r=a.defer(),t.profesores.length>0?r.resolve(t.profesores):e.get("::contratos").then(function(e){return t.profesores=e.data,r.resolve(t.profesores)},function(e){return console.log("No se trajeron los profesores contratados. ",e),r.reject(e.data)}),r.promise},t}])}.call(this),function(){angular.module("myvcFrontApp").factory("YearsServ",["$http","$q",function(e,a){var t;return t=[],{getYears:function(){var r;return r=a.defer(),t.length>0?r.resolve(t):e.get("::years").then(function(e){return t=e.data,r.resolve(t)},function(e){return r.reject(e)}),r.promise}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("DownloadServ",["$http","$q",function(e,a){var t;return(t={}).download=function(t,r){var n;return n=a.defer(),e.get(t,{responseType:"blob"}).then(function(e){var a,t,o,i;return console.log("Entraaaaaa",e),i=e.headers("Content-Type"),(t=e.headers("Content-Disposition"))&&(o=t.match(/.*filename=\"?([^;\"]+)\"?.*/))[1]&&(r=o[1]),r=r.replace(/[<>:"\/\\|?*]+/g,"_"),a=new Blob([e.data],{type:i}),window.saveAs(a,r),n.resolve(r)},function(e){return console.log(e),n.reject(e)}),n.promise},t.download2=function(t,r){var n;return n=a.defer(),e.get(t,{responseType:"arraybuffer"}).then(function(e){var a,t;return a=new Blob([e],{type:"Type:application/vnd.ms-excel; charset=UTF-8"}),t=URL.createObjectURL(a),window.open(t),n.resolve(r)},function(e){return console.log("Pailaaassss",e),n.reject(e)}),n.promise},t}])}.call(this),function(){angular.module("myvcFrontApp").factory("Acentos",["App",function(e){return{remove:function(e){return e=e.toLowerCase().replace(/á/g,"a").replace(/â/g,"a").replace(/é/g,"e").replace(/è/g,"e").replace(/í/g,"i").replace(/ì/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ü/g,"u").replace(/ç/g,"c")}}}])}.call(this),angular.module("ngLocale",[],["$provide",function(e){var a="one",t="other";e.value("$locale",{DATETIME_FORMATS:{AMPMS:["a. m.","p. m."],DAY:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ERANAMES:["antes de Cristo","después de Cristo"],ERAS:["a. C.","d. C."],FIRSTDAYOFWEEK:0,MONTH:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],SHORTDAY:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],SHORTMONTH:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],STANDALONEMONTH:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d MMM y H:mm:ss",mediumDate:"d MMM y",mediumTime:"H:mm:ss",short:"d/M/yy H:mm",shortDate:"d/M/yy",shortTime:"H:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"es-es",localeID:"es_ES",pluralCat:function(e,r){return 1==e?a:t}})}]);