!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,d){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap='#"+f+"']")[0],!!g&&c(g)):!1):(/^(input|select|textarea|button|object)$/.test(h)?!b.disabled:"a"===h?b.href||d:d)&&c(b)}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}a.ui=a.ui||{},a.extend(a.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({scrollParent:function(b){var c=this.css("position"),d="absolute"===c,e=b?/(auto|scroll|hidden)/:/(auto|scroll)/,f=this.parents().filter(function(){var b=a(this);return d&&"static"===b.css("position")?!1:e.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&f.length?f:a(this[0].ownerDocument||document)},uniqueId:function(){var a=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(c){return b(c,!isNaN(a.attr(c,"tabindex")))},tabbable:function(c){var d=a.attr(c,"tabindex"),e=isNaN(d);return(e||d>=0)&&b(c,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(b,c){function d(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),f&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var e="Width"===c?["Left","Right"]:["Top","Bottom"],f=c.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(b){return void 0===b?g["inner"+c].call(this):this.each(function(){a(this).css(f,d(this,b)+"px")})},a.fn["outer"+c]=function(b,e){return"number"!=typeof b?g["outer"+c].call(this,b):this.each(function(){a(this).css(f,d(this,b,!0,e)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(b){if(void 0!==b)return this.css("zIndex",b);if(this.length)for(var c,d,e=a(this[0]);e.length&&e[0]!==document;){if(c=e.css("position"),("absolute"===c||"relative"===c||"fixed"===c)&&(d=parseInt(e.css("zIndex"),10),!isNaN(d)&&0!==d))return d;e=e.parent()}return 0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;e<f.length;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}};var d=0,e=Array.prototype.slice;a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{d=a._data(e,"events"),d&&d.remove&&a(e).triggerHandler("remove")}catch(g){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(b){for(var c,d,f=e.call(arguments,1),g=0,h=f.length;h>g;g++)for(c in f[g])d=f[g][c],f[g].hasOwnProperty(c)&&void 0!==d&&(a.isPlainObject(d)?b[c]=a.isPlainObject(b[c])?a.widget.extend({},b[c],d):a.widget.extend({},d):b[c]=d);return b},a.widget.bridge=function(b,c){var d=c.prototype.widgetFullName||b;a.fn[b]=function(f){var g="string"==typeof f,h=e.call(arguments,1),i=this;return g?this.each(function(){var c,e=a.data(this,d);return"instance"===f?(i=e,!1):e?a.isFunction(e[f])&&"_"!==f.charAt(0)?(c=e[f].apply(e,h),c!==e&&void 0!==c?(i=c&&c.jquery?i.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+f+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+f+"'")}):(h.length&&(f=a.widget.extend.apply(null,[f].concat(h))),this.each(function(){var b=a.data(this,d);b?(b.option(f||{}),b._init&&b._init()):a.data(this,d,new c(f,this))})),i}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.uuid=d++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===c&&this.destroy()}}),this.document=a(c.style?c.ownerDocument:c.document||c),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;f<d.length-1;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),b&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.unbind(c).undelegate(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}});var f=(a.widget,!1);a(document).mouseup(function(){f=!1});a.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!f){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var c=this,d=1===b.which,e="string"==typeof this.options.cancel&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;return d&&!e&&this._mouseCapture(b)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(b)!==!1,!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return c._mouseMove(a)},this._mouseUpDelegate=function(a){return c._mouseUp(a)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),f=!0,!0)):!0}},_mouseMove:function(b){if(this._mouseMoved){if(a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button)return this._mouseUp(b);if(!b.which)return this._mouseUp(b)}return(b.which||b.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),f=!1,!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});a.widget("ui.draggable",a.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(a,b){this._super(a,b),"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(b){var c=this.options;return this._blurActiveElement(b),this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(this._blockFrames(c.iframeFix===!0?"iframe":c.iframeFix),!0):!1)},_blockFrames:function(b){this.iframeBlocks=this.document.find(b).map(function(){var b=a(this);return a("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(b){var c=this.document[0];if(this.handleElement.is(b.target))try{c.activeElement&&"body"!==c.activeElement.nodeName.toLowerCase()&&a(c.activeElement).blur()}catch(d){}},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===a(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(b),this.originalPosition=this.position=this._generatePosition(b,!1),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._normalizeRightBottom(),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_refreshOffsets:function(a){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:a.pageX-this.offset.left,top:a.pageY-this.offset.top}},_mouseDrag:function(b,c){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b,!0),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1},_mouseUp:function(b){return this._unblockFrames(),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),this.handleElement.is(b.target)&&this.element.focus(),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper),e=d?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var b=this.offsetParent.offset(),c=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==c&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options,f=this.document[0];return this.relativeContainer=null,e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(f).width()-this.helperProportions.width-this.margins.left,(a(f).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*c}},_generatePosition:function(a,b){var c,d,e,f,g=this.options,h=this._isRootNode(this.scrollParent[0]),i=a.pageX,j=a.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(d=this.relativeContainer.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,a.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),a.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),a.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),a.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f),"y"===g.axis&&(i=this.originalPageX),"x"===g.axis&&(j=this.originalPageY)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d,this],!0),/^(drag|start|stop)/.test(b)&&(this.positionAbs=this._convertPositionTo("absolute"),d.offset=this.positionAbs),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c,d){var e=a.extend({},c,{item:d.element});d.sortables=[],a(d.options.connectToSortable).each(function(){var c=a(this).sortable("instance");c&&!c.options.disabled&&(d.sortables.push(c),c.refreshPositions(),c._trigger("activate",b,e))})},stop:function(b,c,d){var e=a.extend({},c,{item:d.element});d.cancelHelperRemoval=!1,a.each(d.sortables,function(){var a=this;a.isOver?(a.isOver=0,d.cancelHelperRemoval=!0,a.cancelHelperRemoval=!1,a._storedCSS={position:a.placeholder.css("position"),top:a.placeholder.css("top"),left:a.placeholder.css("left")},a._mouseStop(b),a.options.helper=a.options._helper):(a.cancelHelperRemoval=!0,a._trigger("deactivate",b,e))})},drag:function(b,c,d){a.each(d.sortables,function(){var e=!1,f=this;f.positionAbs=d.positionAbs,f.helperProportions=d.helperProportions,f.offset.click=d.offset.click,f._intersectsWith(f.containerCache)&&(e=!0,a.each(d.sortables,function(){return this.positionAbs=d.positionAbs,this.helperProportions=d.helperProportions,this.offset.click=d.offset.click,this!==f&&this._intersectsWith(this.containerCache)&&a.contains(f.element[0],this.element[0])&&(e=!1),e})),e?(f.isOver||(f.isOver=1,d._parent=c.helper.parent(),f.currentItem=c.helper.appendTo(f.element).data("ui-sortable-item",!0),f.options._helper=f.options.helper,f.options.helper=function(){return c.helper[0]},b.target=f.currentItem[0],f._mouseCapture(b,!0),f._mouseStart(b,!0,!0),f.offset.click.top=d.offset.click.top,f.offset.click.left=d.offset.click.left,f.offset.parent.left-=d.offset.parent.left-f.offset.parent.left,f.offset.parent.top-=d.offset.parent.top-f.offset.parent.top,d._trigger("toSortable",b),d.dropped=f.element,a.each(d.sortables,function(){this.refreshPositions()}),d.currentItem=d.element,f.fromOutside=d),f.currentItem&&(f._mouseDrag(b),c.position=f.position)):f.isOver&&(f.isOver=0,f.cancelHelperRemoval=!0,f.options._revert=f.options.revert,f.options.revert=!1,f._trigger("out",b,f._uiHash(f)),f._mouseStop(b,!0),f.options.revert=f.options._revert,f.options.helper=f.options._helper,f.placeholder&&f.placeholder.remove(),c.helper.appendTo(d._parent),d._refreshOffsets(b),c.position=d._generatePosition(b,!0),d._trigger("fromSortable",b),d.dropped=!1,a.each(d.sortables,function(){this.refreshPositions()}))})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c,d){var e=a("body"),f=d.options;e.css("cursor")&&(f._cursor=e.css("cursor")),e.css("cursor",f.cursor)},stop:function(b,c,d){var e=d.options;e._cursor&&a("body").css("cursor",e._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("opacity")&&(f._opacity=e.css("opacity")),e.css("opacity",f.opacity)},stop:function(b,c,d){var e=d.options;e._opacity&&a(c.helper).css("opacity",e._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1)),c.scrollParentNotHidden[0]!==c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(b,c,d){var e=d.options,f=!1,g=d.scrollParentNotHidden[0],h=d.document[0];g!==h&&"HTML"!==g.tagName?(e.axis&&"x"===e.axis||(d.overflowOffset.top+g.offsetHeight-b.pageY<e.scrollSensitivity?g.scrollTop=f=g.scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(g.scrollTop=f=g.scrollTop-e.scrollSpeed)),e.axis&&"y"===e.axis||(d.overflowOffset.left+g.offsetWidth-b.pageX<e.scrollSensitivity?g.scrollLeft=f=g.scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(g.scrollLeft=f=g.scrollLeft-e.scrollSpeed))):(e.axis&&"x"===e.axis||(b.pageY-a(h).scrollTop()<e.scrollSensitivity?f=a(h).scrollTop(a(h).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(h).scrollTop())<e.scrollSensitivity&&(f=a(h).scrollTop(a(h).scrollTop()+e.scrollSpeed))),e.axis&&"y"===e.axis||(b.pageX-a(h).scrollLeft()<e.scrollSensitivity?f=a(h).scrollLeft(a(h).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(h).scrollLeft())<e.scrollSensitivity&&(f=a(h).scrollLeft(a(h).scrollLeft()+e.scrollSpeed)))),f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c,d){var e=d.options;d.snapElements=[],a(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!==d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=d.options,p=o.snapTolerance,q=c.offset.left,r=q+d.helperProportions.width,s=c.offset.top,t=s+d.helperProportions.height;for(m=d.snapElements.length-1;m>=0;m--)i=d.snapElements[m].left-d.margins.left,j=i+d.snapElements[m].width,k=d.snapElements[m].top-d.margins.top,l=k+d.snapElements[m].height,i-p>r||q>j+p||k-p>t||s>l+p||!a.contains(d.snapElements[m].item.ownerDocument,d.snapElements[m].item)?(d.snapElements[m].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=!1):("inner"!==o.snapMode&&(e=Math.abs(k-t)<=p,f=Math.abs(l-s)<=p,g=Math.abs(i-r)<=p,h=Math.abs(j-q)<=p,e&&(c.position.top=d._convertPositionTo("relative",{top:k-d.helperProportions.height,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i-d.helperProportions.width}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j}).left)),n=e||f||g||h,"outer"!==o.snapMode&&(e=Math.abs(k-s)<=p,f=Math.abs(l-t)<=p,g=Math.abs(i-q)<=p,h=Math.abs(j-r)<=p,e&&(c.position.top=d._convertPositionTo("relative",{top:k,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l-d.helperProportions.height,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j-d.helperProportions.width}).left)),!d.snapElements[m].snapping&&(e||f||g||h||n)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=e||f||g||h||n)}}),a.ui.plugin.add("draggable","stack",{start:function(b,c,d){var e,f=d.options,g=a.makeArray(a(f.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});g.length&&(e=parseInt(a(g[0]).css("zIndex"),10)||0,a(g).each(function(b){a(this).css("zIndex",e+b)}),this.css("zIndex",e+g.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("zIndex")&&(f._zIndex=e.css("zIndex")),e.css("zIndex",f.zIndex)},stop:function(b,c,d){var e=d.options;e._zIndex&&a(c.helper).css("zIndex",e._zIndex)}});a.ui.draggable}),function(a,b){"use strict";function c(a){if(!("clientX"in a||"clientY"in a)){var b=a.touches||a.originalEvent.touches;b&&b.length&&(a.clientX=b[0].clientX,a.clientY=b[0].clientY),a.preventDefault()}}function d(a){if(a=a[0],a.previousElementSibling)return b.element(a.previousElementSibling);
for(var c=a.previousSibling;null!=c&&1!=c.nodeType;)c=c.previousSibling;return b.element(c)}function e(a,b){var c=d(a);c.length>0?c.after(b):a.parent().prepend(b)}function f(a,c){return a instanceof b.element&&(a=a[0]),null!==i?a[i](c):void 0}var g=b.module("angular-sortable-view",[]);g.directive("svRoot",[function(){function a(a,b,c){return c?a.x-b.x<0:a.y-b.y<0}function b(a){return g[a]}function c(a){delete g[a]}var d,g=Object.create(null);return{restrict:"A",controller:["$scope","$attrs","$interpolate","$parse",function(h,i,j,k){var l=j(i.svRoot)(h)||h.$id;g[l]||(g[l]=[]);var m,n,o,p,q,r,s=!1,t=k(i.svOnSort);i.svOnStart=i.$$element[0].attributes["sv-on-start"],i.svOnStart=i.svOnStart&&i.svOnStart.value,i.svOnStop=i.$$element[0].attributes["sv-on-stop"],i.svOnStop=i.svOnStop&&i.svOnStop.value;var u=k(i.svOnStart),v=k(i.svOnStop);if(this.sortingInProgress=function(){return d},i.svGrid){if(s="true"===i.svGrid?!0:"false"===i.svGrid?!1:null,null===s)throw"Invalid value of sv-grid attribute"}else h.$watchCollection(function(){return b(l)},function(a){s=!1;var b=a.filter(function(a){return!a.container}).map(function(a){return{part:a.getPart().id,y:a.element[0].getBoundingClientRect().top}}),c=Object.create(null);b.forEach(function(a){c[a.part]?c[a.part].push(a.y):c[a.part]=[a.y]}),Object.keys(c).forEach(function(a){c[a].sort(),c[a].forEach(function(b,d){d<c[a].length-1&&b>0&&b===c[a][d+1]&&(s=!0)})})});this.$moveUpdate=function(c,g,i,j,k,t,v){var w=i[0].getBoundingClientRect();"element"===c.tolerance&&(g={x:~~(w.left+w.width/2),y:~~(w.top+w.height/2)}),d=!0,m=[],n||(k?(n=k.clone(),n.removeClass("ng-hide")):(n=j.clone(),n.addClass("sv-visibility-hidden"),n.addClass("sv-placeholder"),n.css({height:w.height+"px",width:w.width+"px"})),j.after(n),j.addClass("ng-hide"),q=j,o=c,p=i,u(h,{$helper:{element:p},$part:t.model(t.scope),$index:v,$item:t.model(t.scope)[v]}),h.$root&&h.$root.$$phase||h.$apply()),p[0].reposition({x:g.x+document.body.scrollLeft-g.offset.x*w.width,y:g.y+document.body.scrollTop-g.offset.y*w.height}),b(l).forEach(function(b,d){if(null==c.containment||f(b.element,c.containment)||f(b.element,c.containment+" *")){var e=b.element[0].getBoundingClientRect(),h={x:~~(e.left+e.width/2),y:~~(e.top+e.height/2)};b.container||!b.element[0].scrollHeight&&!b.element[0].scrollWidth||m.push({element:b.element,q:(h.x-g.x)*(h.x-g.x)+(h.y-g.y)*(h.y-g.y),view:b.getPart(),targetIndex:b.getIndex(),after:a(h,g,s)}),b.container&&!b.element[0].querySelector("[sv-element]:not(.sv-placeholder):not(.sv-source)")&&m.push({element:b.element,q:(h.x-g.x)*(h.x-g.x)+(h.y-g.y)*(h.y-g.y),view:b.getPart(),targetIndex:0,container:!0})}});var x=n[0].getBoundingClientRect(),y={x:~~(x.left+x.width/2),y:~~(x.top+x.height/2)};m.push({q:(y.x-g.x)*(y.x-g.x)+(y.y-g.y)*(y.y-g.y),element:n,placeholder:!0}),m.sort(function(a,b){return a.q-b.q}),m.forEach(function(a,b){0!==b||a.placeholder||a.container?0===b&&a.container?(r=a,a.element.append(n)):a.element.removeClass("sv-candidate"):(r=a,a.element.addClass("sv-candidate"),a.after?a.element.after(n):e(a.element,n))})},this.$drop=function(a,b,c){function e(){if(d=!1,n.remove(),p.remove(),q.removeClass("ng-hide"),m=void 0,n=void 0,c=void 0,p=void 0,q=void 0,v(h,{$part:a.model(a.scope),$index:b,$item:a.model(a.scope)[b]}),r){r.element.removeClass("sv-candidate");var e=a.model(a.scope).splice(b,1),f=r.targetIndex;r.view===a&&r.targetIndex>b&&f--,r.after&&f++,r.view.model(r.view.scope).splice(f,0,e[0]),(r.view!==a||b!==f)&&t(h,{$partTo:r.view.model(r.view.scope),$partFrom:a.model(a.scope),$item:e[0],$indexTo:f,$indexFrom:b,$modeloPadre:r.view.scope.$parent})}r=void 0,h.$root&&h.$root.$$phase||h.$apply()}if(n)if(c.revert){var f=n[0].getBoundingClientRect(),g=p[0].getBoundingClientRect(),i=Math.sqrt(Math.pow(g.top-f.top,2)+Math.pow(g.left-f.left,2)),j=+c.revert*i/200;j=Math.min(j,+c.revert),["-webkit-","-moz-","-ms-","-o-",""].forEach(function(a){"undefined"!=typeof p[0].style[a+"transition"]&&(p[0].style[a+"transition"]="all "+j+"ms ease")}),setTimeout(e,j),p.css({top:f.top+document.body.scrollTop+"px",left:f.left+document.body.scrollLeft+"px"})}else e()},this.addToSortableElements=function(a){b(l).push(a)},this.removeFromSortableElements=function(a){var d=b(l),e=d.indexOf(a);e>-1&&(d.splice(e,1),0===d.length&&c(l))}}]}}]),g.directive("svPart",["$parse",function(a){return{restrict:"A",require:"^svRoot",controller:["$scope",function(a){a.$ctrl=this,this.getPart=function(){return a.part},this.$drop=function(b,c){a.$sortableRoot.$drop(a.part,b,c)}}],scope:!0,link:function(b,c,d,e){if(!d.svPart)throw new Error("no model provided");var f=a(d.svPart);if(!f.assign)throw new Error("model not assignable");b.part={id:b.$id,element:c,model:f,scope:b},b.$sortableRoot=e;var g={element:c,getPart:b.$ctrl.getPart,container:!0};e.addToSortableElements(g),b.$on("$destroy",function(){e.removeFromSortableElements(g)})}}}]),g.directive("svElement",["$parse",function(a){return{restrict:"A",require:["^svPart","^svRoot"],controller:["$scope",function(a){a.$ctrl=this}],link:function(d,e,f,g){function h(h){function i(a){c(a),n||(e.parent().prepend(q),n=!0),g[1].$moveUpdate(k,{x:a.clientX,y:a.clientY,offset:t},q,e,m,g[0].getPart(),d.$index)}if(c(h),!g[1].sortingInProgress()&&(0==h.button||"mousedown"!==h.type)){n=!1;var k=a(f.svElement)(d);if(k=b.extend({},{tolerance:"pointer",revert:200,containment:"html"},k),k.containment)var p=j.call(e,k.containment)[0].getBoundingClientRect();var q,r=e,s=e[0].getBoundingClientRect();l||(l=g[0].helper),m||(m=g[0].placeholder),l?(q=l.clone(),q.removeClass("ng-hide"),q.css({left:s.left+document.body.scrollLeft+"px",top:s.top+document.body.scrollTop+"px"}),r.addClass("sv-visibility-hidden")):(q=r.clone(),q.addClass("sv-helper").css({left:s.left+document.body.scrollLeft+"px",top:s.top+document.body.scrollTop+"px",width:s.width+"px"})),q[0].reposition=function(a){var b=a.x,c=a.y,d=q[0].getBoundingClientRect(),e=document.body;p&&(c<p.top+e.scrollTop&&(c=p.top+e.scrollTop),c+d.height>p.top+e.scrollTop+p.height&&(c=p.top+e.scrollTop+p.height-d.height),b<p.left+e.scrollLeft&&(b=p.left+e.scrollLeft),b+d.width>p.left+e.scrollLeft+p.width&&(b=p.left+e.scrollLeft+p.width-d.width)),this.style.left=b-e.scrollLeft+"px",this.style.top=c-e.scrollTop+"px"};var t={x:(h.clientX-s.left)/s.width,y:(h.clientY-s.top)/s.height};o.addClass("sv-sorting-in-progress"),o.on("mousemove touchmove",i).on("mouseup touchend touchcancel",function u(a){o.off("mousemove touchmove",i),o.off("mouseup touchend touchcancel",u),o.removeClass("sv-sorting-in-progress"),n&&g[0].$drop(d.$index,k),e.removeClass("sv-visibility-hidden")})}}var i={element:e,getPart:g[0].getPart,getIndex:function(){return d.$index}};g[1].addToSortableElements(i),d.$on("$destroy",function(){g[1].removeFromSortableElements(i)});var k=e;k.on("mousedown touchstart",h),d.$watch("$ctrl.handle",function(a){a&&(k.off("mousedown touchstart",h),k=a,k.on("mousedown touchstart",h))});var l;d.$watch("$ctrl.helper",function(a){a&&(l=a)});var m;d.$watch("$ctrl.placeholder",function(a){a&&(m=a)});var n,o=(b.element(document.body),b.element(document.documentElement))}}}]),g.directive("svHandle",function(){return{require:"?^svElement",link:function(a,b,c,d){d&&(d.handle=b.add(d.handle))}}}),g.directive("svHelper",function(){return{require:["?^svPart","?^svElement"],link:function(a,b,c,d){b.addClass("sv-helper").addClass("ng-hide"),d[1]?d[1].helper=b:d[0]&&(d[0].helper=b)}}}),g.directive("svPlaceholder",function(){return{require:["?^svPart","?^svElement"],link:function(a,b,c,d){b.addClass("sv-placeholder").addClass("ng-hide"),d[1]?d[1].placeholder=b:d[0]&&(d[0].placeholder=b)}}}),b.element(document.head).append(["<style>.sv-helper{position: fixed !important;z-index: 99999;margin: 0 !important;}.sv-candidate{}.sv-placeholder{}.sv-sorting-in-progress{-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.sv-visibility-hidden{visibility: hidden !important;opacity: 0 !important;}</style>"].join(""));var h=document.documentElement,i=h.matches?"matches":h.matchesSelector?"matchesSelector":h.webkitMatches?"webkitMatches":h.webkitMatchesSelector?"webkitMatchesSelector":h.msMatches?"msMatches":h.msMatchesSelector?"msMatchesSelector":h.mozMatches?"mozMatches":h.mozMatchesSelector?"mozMatchesSelector":null;if(null==i)throw"This browser doesn't support the HTMLElement.matches method";var j=b.element.prototype.closest||function(a){for(var c=this[0].parentNode;c!==document.documentElement&&!c[i](a);)c=c.parentNode;return c[i](a)?b.element(c):b.element()};"function"!=typeof b.element.prototype.add&&(b.element.prototype.add=function(a){var c,d=b.element();for(a=b.element(a),c=0;c<this.length;c++)d.push(this[c]);for(c=0;c<a.length;c++)d.push(a[c]);return d})}(window,window.angular),function(){"use strict";angular.module("myvcFrontApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngSanitize","ngTouch","ui.bootstrap","ui.router","ui.select","angular-loading-bar","ckeditor","uiBreadcrumbs","toastr","http-auth-interceptor","ui.grid","ui.grid.edit","ui.grid.resizeColumns","ui.grid.exporter","ui.grid.selection","ui.grid.cellNav","ui.grid.autoResize","ui.grid.pinning","ui.grid.expandable","ui.grid.moveColumns","ngFileUpload","FBAngular","nvd3","angular-sortable-view"]).constant("App",function(){var a,b,c;return a=location.protocol+"//"+location.hostname+"/",c=a+"5myvc/public/",b=location.origin+"/myvc_front/",{Server:c,views:"views/",images:c+"images/",perfilPath:c+"images/perfil/",imgSharedPath:c+"images/shared/",parentescos:[{parentesco:"Padre"},{parentesco:"Madre"},{parentesco:"Hermano"},{parentesco:"Hermana"},{parentesco:"Abuelo"},{parentesco:"Abuela"},{parentesco:"Tío"},{parentesco:"Tía"},{parentesco:"Primo(a)"},{parentesco:"Otro"}],religiones:["Adventista","Católico","Pentecostal","Cuadrangular","Testigo de Jehová","Mormón","Otra","Ninguna"],tipos_sangre:["AB+","AB-","A+","A-","B+","B-","O+","O-"]}}()).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",alumno:"alumno",acudiente:"acudiente",profesor:"profesor",guest:"guest"}).constant("PERMISSIONS",{can_work_like_admin:"can_work_like_admin",can_work_like_teacher:"can_work_like_teacher",can_work_like_student:"can_work_like_student",can_work_like_acudiente:"can_work_like_acudiente",can_accept_images:"can_accept_images",can_edit_alumnos:"can_edit_alumnos",can_edit_usuarios:"can_edit_usuarios",can_edit_notas:"can_edit_notas",can_edit_years:"can_edit_years",can_edit_periodos:"can_edit_periodos",can_edit_paises:"can_edit_paises",can_edit_ciudades:"can_edit_ciudades",can_edit_disciplinas:"can_edit_disciplinas",can_edit_profesores:"can_edit_profesores",can_edit_eventos:"can_edit_eventos",can_edit_votaciones:"can_edit_votaciones",can_edit_aspiraciones:"can_edit_aspiraciones",can_edit_participantes:"can_edit_participantes",can_edit_candidatos:"can_edit_candidatos",can_edit_unidades_subunidades:"can_edit_unidades_subunidades"})}.call(this),function(){angular.module("myvcFrontApp").config(["$cookiesProvider","$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider","$httpProvider","$locationProvider","App","PERMISSIONS","$intervalProvider","$rootScopeProvider","USER_ROLES","toastrConfig","uiSelectConfig",function(a,b,c,d,e,f,g,h,i,j,k,l,m){return e.defaults.headers.post["X-CSRFToken"]=a.csrftoken,e.defaults.headers.put["X-CSRFToken"]=a.csrftoken,e.defaults.useXDomain=!0,e.defaults.xsrfCookieName="csrftoken",e.defaults.xsrfHeaderName="X-CSRFToken",delete e.defaults.headers.common["X-Requested-With"],e.interceptors.push(["$q",function(a){return{request:function(a){var b;return b=a.url.split("::"),b.length>1?a.url=g.Server+b[1]:(b=a.url.split("=="),b.length>1&&(a.url=g.views+b[1])),a}}}]),m.theme="select2",m.resetSearchInput=!0,d.strictMode(!1),c.otherwise("/login"),c.when("/user/:username",["$match","$state",function(a,b){return b.transitionTo("panel.user.resumen",a)}]),b.state("main",{url:"/",views:{principal:{templateUrl:g.views+"main/main.tpl.html",controller:"MainCtrl"}},data:{displayName:"principal",icon_fa:"",pageTitle:"Construcción - MyVc"}}).state("login",{url:"/login",views:{principal:{templateUrl:""+g.views+"login/login.tpl.html",controller:"LoginCtrl"}},data:{displayName:"Login",icon_fa:"fa fa-user",pageTitle:"Ingresar a MyVc"}}).state("reset-password",{url:"/reset-password/:numero/:username",views:{principal:{templateUrl:""+g.views+"login/reset-password.tpl.html",controller:"ResetPasswordCtrl"}},data:{displayName:"Resetear",icon_fa:"fa fa-user",pageTitle:"Ingreso a MyVc"}}).state("logout",{url:"/logout",views:{principal:{templateUrl:""+g.views+"login/logout.tpl.html",controller:"LogoutCtrl"}},data:{displayName:"Logout",icon_fa:"fa fa-user"}}).state("panel",{url:"/panel",views:{principal:{templateUrl:""+g.views+"panel/panel.tpl.html",controller:"PanelCtrl"}},resolve:{resolved_user:["AuthService",function(a){return a.verificar()}]},data:{displayName:"Inicio",icon_fa:"fa fa-home",pageTitle:"Bienvenido - MyVc"}}),angular.extend(l,{allowHtml:!0,closeButton:!0,extendedTimeOut:1e3,preventOpenDuplicates:!1,maxOpened:3,tapToDismiss:!0,target:"body",timeOut:4e3}),this}]).filter("capitalize",function(){return function(a,b){return a?a.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}):""}})}.call(this),function(){angular.module("myvcFrontApp").run(["$rootScope","cfpLoadingBar","$state","$stateParams","$cookies","Perfil","AuthService","AUTH_EVENTS","toastr",function(a,b,c,d,e,f,g,h,i){return a.$state=c,a.$stateParams=d,a.lastState=null,a.lastStateParam=null,a.notaRapida={enable:!1,valorNota:0},a.menucompacto=!1,a.$on("event:auth-loginRequired",function(a){return console.log("Acceso no permitido, vamos a loguear",a),c.transitionTo("login")}),a.ingresar=function(){return null===a.lastState||"login"===a.lastState||"/"===a.lastState||"main"===a.lastState?c.transitionTo("panel"):c.transitionTo(a.lastState,a.lastStateParam)},a.$on("event:auth-loginConfirmed",function(){return console.log("Logueado con éxito!"),a.ingresar()}),a.$on("$stateChangeStart",function(b,c,d,e,f){return null===a.lastState||"logout"!==c.name&&"login"!==c.name&&"main"!==c.name?(a.lastState=c.name,a.lastStateParam=d):void 0}),a.$on("$stateChangeSuccess",function(b,d,e,f,g){return a.pageTitle=c.current.name}),a.$on("$stateChangeError",function(b,d,e,f,g){return console.log("Evento fallido: ",b),i.warning("Lo sentimos, hubo un error o no puedes acceder a esta vista"),"panel"!==a.lastState?c.transitionTo("panel"):void 0}),a.$on(h.loginSuccess,function(){var b;return b=f.User(),b?b.votaciones?(1===b.votaciones.length?i.success("Hay 1 votación en ejecución."):i.success("Hay "+b.votaciones.length+" votaciones en ejecución."),c.go("panel.actividades.votaciones.votar")):a.ingresar():void 0}),a.$on(h.loginFailed,function(a){}),a.$on(h.notAuthenticated,function(a){return i.warning("No está autorizado.","Acceso exclusivo"),console.log("Evento notAuthenticated: ",a),c.transitionTo("login")}),a.$on(h.notAuthorized,function(b){return i.warning("No está autorizado para entrar a esta vista","Restringido"),c.go("panel"),console.log("Evento notAuthorized: ",b,a.lastState)})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ApplicationController",["$scope",function(a){return a.isLoginPage=!1,Date.prototype.yyyymmdd=function(){var a,b;return b=this.getMonth()+1,a=this.getDate(),[this.getFullYear(),(b>9?"":"0")+b,(a>9?"":"0")+a].join("-")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MainCtrl",["$scope","$window","$interval",function(a,b,c){}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PanelCtrl",["$scope","$http","$state","$cookies","$rootScope","AuthService","Perfil","App","resolved_user","toastr","cfpLoadingBar","$window",function(a,b,c,d,e,f,g,h,i,j,k,l){a.USER=i,a.pageTitle=e.pageTitle,a.perfilPath=h.images+"perfil/",a.logoPathDefault="images/Logo_MyVc_Header.gif",a.logoPath="images/Logo_Colegio_Header.gif",b.get(a.logoPath).then(function(){return console.log("logoPath  existe")},function(){return a.logoPath=a.logoPathDefault}),e.menucompacto="true"===localStorage.menucompacto?!0:!1,k.complete(),f.verificar_acceso(),a.USER.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.date=new Date,b.get("::years").then(function(b){return a.years=b.data},function(a){return j.error("No se trajeron los años")}),b.get("::periodos").then(function(b){return a.periodos=b.data},function(a){return j.error("No se trajeron los periodos")}),a.setImagenPrincipal=function(){var b,c,d,e,f;return d=h.images+"perfil/",c=a.USER.imagen_nombre,b=a.USER.foto_nombre,f=d+c,e=d+b,a.imagenPrincipal=f,a.imagenOficial=e},a.setImagenPrincipal(),a.nameToShow=g.nameToShow,a.usuario=function(){return g.User().username},a.toggleCompactMenu=function(){return e.menucompacto=!e.menucompacto,localStorage.menucompacto=e.menucompacto},a.seeDropdownPeriodos=!1,a.togglePeriodos=function(){return a.seeDropdownPeriodos=!a.seeDropdownPeriodos,console.log(a.seeDropdownPeriodos)},a.cambiarPeriodo=function(c){return b.put("::periodos/useractive/"+c.id).then(function(b){return j.success("Periodo cambiado con éxito al perido "+c.numero,"Cambiado"),a.USER.periodo_id=c.id,a.USER.numero_periodo=c.numero,l.location.reload()},function(a){return j.warning("No se pudo cambiar de periodo.","Problema")})},a.cambiarYear=function(c){return b.put("::years/useractive/"+c.id).then(function(b){return b=b.data,a.USER.year_id=c.id,a.USER.year=c.year,a.USER.numero_periodo=b.numero,a.USER.periodo_id=b.id,j.success("Año cambiado con éxito: "+c.year,"Cambiado"),l.location.reload()},function(a){return j.warning("No se pudo cambiar el año.","Problema")})},a.logout=function(){return f.logout()},a.goFileManager=function(){return c.go("panel.filemanager")},a.indexChar=function(a){return String.fromCharCode(65+a)},a.$on("cambianImgs",function(b,c){return a.USER=g.User(),a.setImagenPrincipal()})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","USER_ROLES","PERMISSIONS",function(a,b,c){a.state("panel.alumnos",{url:"^/alumnos",views:{maincontent:{templateUrl:"==alumnos/alumnos.tpl.html",controller:"AlumnosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Alumnos"}]}}},data:{displayName:"Alumnos",icon_fa:"fa fa-male",needed_permissions:[c.can_work_like_teacher,c.can_work_like_admin,c.can_edit_alumnos],pageTitle:"Alumnos - MyVc"}}).state("panel.mensajes",{url:"^/mensajes",views:{maincontent:{templateUrl:"==mensajes/mensajes.tpl.html",controller:"MensajesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Mensajes"}]}}},data:{displayName:"Mensajes",icon_fa:"fa fa-envelope"}}).state("panel.years",{url:"^/years",views:{maincontent:{templateUrl:"==colegio/years.tpl.html",controller:"YearsCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Años"}]}}},data:{displayName:"Años",icon_fa:"fa fa-graduation-cap",needed_permissions:[c.can_work_like_admin],pageTitle:"Años - MyVc"}}).state("panel.paises",{url:"^/paises",views:{maincontent:{templateUrl:"==paises/paises.tpl.html",controller:"PaisesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Paises"}]}}},data:{displayName:"Paises",icon_fa:"fa fa-flag-checkered",needed_permissions:[c.can_work_like_admin],pageTitle:"Paises - MyVc"}}).state("panel.profesores",{url:"^/profesores",views:{maincontent:{templateUrl:"==profesores/profesores.tpl.html",controller:"ProfesoresCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Profesores"}]}}},data:{displayName:"Profesores",icon_fa:"fa fa-graduation-cap",needed_permissions:[c.can_work_like_admin],pageTitle:"Profesores - MyVc"}}).state("panel.ciudades",{url:"/ciudades",views:{maincontent:{templateUrl:"==ciudades/ciudades.tpl.html",controller:"CiudadesCtrl",resolve:{paises:["$http",function(a){return a.get("::paises")}]}},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Ciudades"}],paises:["$http",function(a){return a.get("::paises")}]}}},data:{displayName:"Ciudades",icon_fa:"fa fa-map-marker",needed_permissions:[c.can_work_like_admin],pageTitle:"Ciudades - MyVc"}}).state("panel.disciplinas",{url:"/disciplinas",views:{maincontent:{templateUrl:"==disciplinas/disciplinas.tpl.html",controller:"DisciplinasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Disciplinas"}]}}},data:{displayName:"Disciplinas",icon_fa:"fa fa-align-justify",pageTitle:"Disciplinas - MyVc"}}).state("panel.eventos",{url:"/eventos",views:{maincontent:{templateUrl:"==eventos/eventos.tpl.html",controller:"EventosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Eventos"}]}}},data:{displayName:"Eventos",icon_fa:"fa fa-laptop",needed_permissions:[c.can_work_like_admin],pageTitle:"Eventos - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PanelHeaderCtrl",["$scope","titulo","$state","$stateParams","Fullscreen","$rootScope",function(a,b,c,d,e,f){a.titulo=b,f.reload=function(){return c.go(c.current,d,{reload:!0})},a.setFullScreen=function(){return e.toggleAll()}}])}.call(this),function(){angular.module("myvcFrontApp").directive("anunciosDir",["App","$http","toastr","$uibModal","$state",function(a,b,c,d,e){return{restrict:"E",templateUrl:""+a.views+"panel/anunciosDir.tpl.html",link:function(c,d,f){return c.perfilPath=a.images+"perfil/",e.is("panel")?b.get("::ChangesAsked/to-me").then(function(a){return c.changes_asked=a.data},function(a){return console.log(a)}):void 0},controller:"AnunciosDirCtrl"}}]).controller("AnunciosDirCtrl",["$scope","$uibModal","AuthService","$http","toastr","$filter",function(a,b,c,d,e,f){return a.hasRoleOrPerm=c.hasRoleOrPerm,a.verDetalles=function(a){var b;return a.mostrando?a.mostrando=!1:(a.mostrando=!0,a.detalles?void 0:(b={asked_id:a.asked_id},d.put("::ChangesAsked/ver-detalles",b).then(function(b){return a.detalles=b.data.detalles},function(a){return console.log("Error trayendo detalles",a)})))},a.rechazarCambio=function(a,c){var d;return d=b.open({templateUrl:"==panel/rechazarAsked.tpl.html",controller:"RechazarAskedCtrl",resolve:{asked:function(){return a},tipo:function(){return c}}}),d.result.then(function(b){return e.info("Pedido rechazado."),a.finalizado=b.finalizado,"img_perfil"===c&&(a.detalles.image_id_accepted=!1),"foto_oficial"===c&&(a.detalles.foto_id_accepted=!1),"img_delete"===c&&(a.detalles.image_to_delete_accepted=!1),"nombres"===c&&(a.detalles.nombres_accepted=!1),"apellidos"===c&&(a.detalles.apellidos_accepted=!1),"sexo"===c&&(a.detalles.sexo_accepted=!1),"fecha_nac"===c?a.detalles.fecha_nac_accepted=!1:void 0})},a.aprobarCambio=function(a,c,d){var f;return f=b.open({templateUrl:"==panel/aceptarAsked.tpl.html",controller:"AceptarAskedCtrl",resolve:{asked:function(){return a},tipo:function(){return c},valor_nuevo:function(){return d}}}),f.result.then(function(b){return e.success("Pedido aceptado."),a.finalizado=b.finalizado,"img_perfil"===c&&(a.detalles.image_id_accepted=!0),"img_delete"===c&&(a.detalles.image_to_delete_accepted=!0),"nombres"===c&&(a.detalles.nombres_accepted=!0),"apellidos"===c&&(a.detalles.apellidos_accepted=!0),"sexo"===c&&(a.detalles.sexo_accepted=!0),"fecha_nac"===c&&(a.detalles.fecha_nac_accepted=!0),"foto_oficial"===c&&(a.detalles.foto_id_accepted=!0,a.foto_nombre=a.detalles.foto_new_nombre),"asignatura"===c?a.finalizado=!0:void 0})},a.eliminarSolicitudes=function(a){var c;return c=b.open({templateUrl:"==panel/eliminarAsked.tpl.html",controller:"EliminarAskedCtrl",resolve:{asked:function(){return a}}}),c.result.then(function(b){return e.success("Pedido eliminado."),a.finalizado=!0})},a.verDetalleDeMiSesion=function(a){return d.put("::historiales/sesion",{historial_id:a.id,tipo:a.tipo}).then(function(c){var d;return d=b.open({templateUrl:"==panel/modalDetallesSesion.tpl.html",controller:"ModalDetallesSesionCtrl",resolve:{historial:function(){return c.data.historial}}}),d.result.then(function(b){return console.log(a)})},function(a){return e.error("No se pudo traer el detalle")})},a.eliminarIntentoFallido=function(b){var c;return c=!1,c=confirm("¿Está seguro de eliminar este registro?"),c?d["delete"]("::bitacoras/destroy/"+b.id).then(function(c){return e.success("Eliminado. Recargue para ver los cambios."),b.eliminada=!0,a.changes_asked.intentos_fallidos=f("filter")(a.changes_asked.intentos_fallidos,{id:"!"+b.id},!0)},function(a){return e.error("No se pudo eliminar")}):void 0}}]).controller("AceptarAskedCtrl",["$scope","$uibModalInstance","asked","tipo","valor_nuevo","$http","toastr","App",function(a,b,c,d,e,f,g,h){return a.imagesPath=h.images+"perfil/",a.asked=c,a.aceptarAsignatura=function(){var a;return a={pedido:c,tipo:d,asker_id:c.asked_by_user_id},f.put("::ChangesAsked/aceptar-asignatura",a).then(function(a){return b.close(a.data)},function(a){return g.warning("Problema","No se pudo aceptar petición.")})},a.ok=function(){var h;return c.assignment_id?a.aceptarAsignatura():(h={asked_id:c.asked_id,data_id:c.detalles.data_id,tipo:d,valor_nuevo:e,asker_id:c.asked_by_user_id},c.alumno_id&&(h.alumno_id=c.alumno_id),f.put("::ChangesAsked/aceptar-alumno",h).then(function(a){return b.close(a.data)},function(a){return g.warning("Problema","No se pudo aceptar petición.")}))},a.cancel=function(){return b.dismiss("cancel")}}]).controller("RechazarAskedCtrl",["$scope","$uibModalInstance","asked","tipo","$http","toastr","App",function(a,b,c,d,e,f,g){return a.imagesPath=g.images+"perfil/",a.asked=c,a.ok=function(){var a,g,h;return g=c.detalles?c.detalles.data_id:c.assignment_id,a=c.detalles.assignment_id,h={asked_id:c.asked_id,data_id:g,assignment_id:a,tipo:d,asker_id:c.asked_by_user_id},e.put("::ChangesAsked/rechazar",h).then(function(a){return b.close(a.data)},function(a){return f.error("Problema","No se pudo rechazar petición.")})},a.cancel=function(){return b.dismiss("cancel")}}]).controller("EliminarAskedCtrl",["$scope","$uibModalInstance","asked","$http","toastr","App",function(a,b,c,d,e,f){return a.imagesPath=f.images+"perfil/",a.asked=c,a.ok=function(){var a;return a={asked_id:c.asked_id,data_id:c.detalles.data_id},d.put("::ChangesAsked/destruir",a).then(function(a){return b.close(a.data)},function(a){return e.error("Problema","No se pudo eliminar peticiones.")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ModalDetallesSesionCtrl",["$scope","$uibModalInstance","historial","$http","toastr","App","$filter",function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;return a.imagesPath=f.images+"perfil/",a.historial=c,c.logout_at?(h=new Date(c.created_at),j=new Date(c.logout_at),i=j.getTime()-h.getTime(),l=parseInt(i%1e3/100),n=parseInt(i/1e3%60),m=parseInt(i/6e4%60),k=parseInt(i/36e5%24),k=10>k?"0"+k:k,m=10>m?"0"+m:m,n=10>n?"0"+n:n,a.duracion=k+":"+m+":"+n):a.duracion="No cerró sesión.",a.ok=function(){var c;return asked.assignment_id?a.aceptarAsignatura():(c={asked_id:asked.asked_id,data_id:asked.detalles.data_id,tipo:tipo,valor_nuevo:valor_nuevo,asker_id:asked.asked_by_user_id},asked.alumno_id&&(c.alumno_id=asked.alumno_id),d.put("::ChangesAsked/aceptar-alumno",c).then(function(a){return b.close(a.data)},function(a){return e.warning("Problema","No se pudo aceptar petición.")}))},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("YearsCtrl",["App","$scope","$http","$uibModal","$state","ProfesoresServ","$cookies","$rootScope","$filter","toastr",function(a,b,c,d,e,f,g,h,i,j){b.perfilPath=a.images+"perfil/",b.status={open_year:!0},c.get("::years/colegio").then(function(a){var c,d,e,g,h,i,k,l;for(a=a.data,k=a.years,e=0,h=k.length;h>e;e++)for(c=k[e],l=c.periodos,g=0,i=l.length;i>g;g++)d=l[g],d.fecha_inicio=new Date(d.fecha_inicio),d.fecha_fin=new Date(d.fecha_fin),d.fecha_plazo=new Date(d.fecha_plazo);return b.years=a.years,b.certificados=a.certificados,b.imagenes=a.imagenes,f.contratos().then(function(a){return b.profesores=a,b.fixControles()},function(a){return j.error("No se pudo traer los profesores")})},function(a){return j.error("No se trajeron los años")}),b.fixControles=function(){var a,c,d,e,f,g;for(a=b.years.length-1,b.newcertif={},b.newYear={nombre_colegio:b.years[a].nombre_colegio,abrev_colegio:b.years[a].abrev_colegio,year:b.years[a].year+1,actual:!0,alumnos_can_see_notas:!0,nota_minima_aceptada:b.years[a].nota_minima_aceptada,resolucion:b.years[a].resolucion,codigo_dane:b.years[a].codigo_dane,telefono:b.years[a].telefono,celular:b.years[a].celular,unidad_displayname:b.years[a].unidad_displayname,unidades_displayname:b.years[a].unidades_displayname,genero_unidad:b.years[a].genero_unidad,subunidad_displayname:b.years[a].subunidad_displayname,subunidades_displayname:b.years[a].subunidades_displayname,genero_subunidad:b.years[a].genero_subunidad},f=b.years,g=[],d=0,e=f.length;e>d;d++)c=f[d],c.ocultando=c.actual?!1:!0,c.rector=i("filter")(b.profesores,{profesor_id:c.rector_id},!0)[0],c.secretario=i("filter")(b.profesores,{profesor_id:c.secretario_id},!0)[0],g.push(c.tesorero=i("filter")(b.profesores,{profesor_id:c.tesorero_id},!0)[0]);return g},b.addPeriodo=function(a){var b;return b=d.open({templateUrl:"==colegio/addPeriodo.tpl.html",controller:"AddPeriodoCtrl",resolve:{year:function(){return a}}}),b.result.then(function(b){return a.periodos.push(b)})},b.removePeriodo=function(a,b){var c;return c=d.open({templateUrl:"==colegio/removePeriodo.tpl.html",controller:"RemovePeriodoCtrl",resolve:{periodo:function(){return b}}}),c.result.then(function(b){return a.periodos=i("filter")(a.periodos,{id:"!"+b.id})})},b.toggleBloquearNotas=function(a,b){return c.put("::years/alumnos-can-see-notas",{can:b,year_id:a}).then(function(a){return j.success(a.data)},function(a){return j.warning("No se pudo bloquear o desbloquear el sistema.","Problema")})},b.toggleBloquearProfesEditAlumnos=function(a,b){return c.put("::years/profes-can-edit-alumnos",{can:b,year_id:a}).then(function(a){return j.success(a.data)},function(a){return j.warning("No se pudo bloquear o desbloquear la edición.","Problema")})},b.toggleMostrarPuestoEnBoletin=function(a,b){return c.put("::years/toggle-mostrar-puestos-en-boletin",{can:b,year_id:a}).then(function(a){return j.success(a.data)},function(a){return j.warning("No se pudo bloquear o desbloquear la edición.","Problema")})},b.toggleMostrarNotaComportamientoEnBoletin=function(a,b){return c.put("::years/toggle-mostrar-nota-comport-en-boletin",{can:b,year_id:a}).then(function(a){return j.success(a.data)},function(a){return j.warning("No se pudo cambiar.","Problema")})},b.toggleIgnorarNotasPerdidas=function(a,b){return c.put("::years/toggle-ignorar-notas-perdidas",{can:b,year_id:a}).then(function(a){return j.success(a.data)},function(a){return j.warning("No se pudo bloquear o desbloquear la edición.","Problema")})},b.restarNewYear=function(){return b.newYear.year>1990?b.newYear.year=b.newYear.year-1:void 0},b.sumarNewYear=function(){return b.newYear.year<3e3?b.newYear.year=b.newYear.year+1:void 0},b.restarNewNota=function(){return b.newYear.nota_minima_aceptada>0?b.newYear.nota_minima_aceptada=b.newYear.nota_minima_aceptada-.1:void 0},b.sumarNewNota=function(){return b.newYear.nota_minima_aceptada<1e3?b.newYear.nota_minima_aceptada=b.newYear.nota_minima_aceptada+.1:void 0;
},b.actualPeriodo=function(a,b){return c.put("::periodos/establecer-actual/"+b.id).then(function(c){var d,e,f,g;for(j.success("Periodo "+b.numero+" establecido como actual."),g=a.periodos,e=0,f=g.length;f>e;e++)d=g[e],d.actual=!1;return b.actual=!0},function(a){return j.warning("No se pudo establecer como actual.","Problema")})},b.crearNewYear=function(){return c.post("::years/store",b.newYear).then(function(a){var c,d,e,f;for(j.success("Año "+b.newYear.year+" creado. Por favor configúrelo."),b.nonuevo=!1,f=b.years,d=0,e=f.length;e>d;d++)c=f[d],c.actual=0;return b.years.push(a.data)},function(a){return j.warning("No se pudo crear año.","Problema")})},b.guardar_cambios=function(a){return a.rector_id=a.rector?a.rector.profesor_id:null,a.secretario_id=a.secretario?a.secretario.profesor_id:null,a.tesorero_id=a.tesorero?a.tesorero.profesor_id:null,c.put("::years/guardar-cambios",a).then(function(a){return j.success("Cambios guardados.")},function(a){return j.warning("No se pudo guardar cambios.","Problema")})},b.deleteYear=function(a){var c;return c=d.open({templateUrl:"==colegio/removeYear.tpl.html",controller:"RemoveYearCtrl",resolve:{year:function(){return a}}}),c.result.then(function(a){return b.years=i("filter")(b.years,{id:"!"+a.id})})},b.cambiarFechaInicio=function(a,b){return c.put("::periodos/cambiar-fecha-inicio",{periodo_id:a.id,fecha:b}).then(function(a){return j.success("Fecha guardada.")},function(a){return j.warning("No se pudo guardar fecha.","Problema")})},b.cambiarFechaFin=function(a,b){return c.put("::periodos/cambiar-fecha-fin",{periodo_id:a.id,fecha:b}).then(function(a){return j.success("Fecha guardada.")},function(a){return j.warning("No se pudo guardar fecha.","Problema")})},b.toggleProfesPuedenEditarNotas=function(a,b){return c.put("::periodos/toggle-profes-pueden-editar-notas",{periodo_id:a.id,pueden:b}).then(function(a){return j.success("Cambiado.")},function(a){return j.warning("No se pudo guardar fecha.","Problema")})},b.toggleProfesPuedenNivelar=function(a,b){return c.put("::periodos/toggle-profes-pueden-nivelar",{periodo_id:a.id,pueden:b}).then(function(a){return j.success("Cambiado.")},function(a){return j.warning("No se pudo guardar fecha.","Problema")})}}]).controller("RemoveYearCtrl",["$scope","$uibModalInstance","year","$http","toastr",function(a,b,c,d,e){return a.year=c,a.ok=function(){return d["delete"]("::years/delete/"+c.id).then(function(a){return e.success("Año "+c.year+" enviado a la papelera."),b.close(c)},function(a){return e.warning("No se pudo eliminar el año.","Problema"),b.dismiss()})},a.cancel=function(){return b.dismiss("cancel")}}]).controller("RemovePeriodoCtrl",["$scope","$uibModalInstance","periodo","$http","toastr",function(a,b,c,d,e){return a.periodo=c,a.ok=function(){return d["delete"]("::periodos/destroy/"+c.id).then(function(a){return e.success("Periodo eliminado con éxito.","Eliminado"),b.close(c)},function(a){return e.warning("No se pudo eliminar el periodo.","Problema"),b.dismiss()})},a.cancel=function(){return b.dismiss("cancel")}}]).controller("AddPeriodoCtrl",["$scope","$uibModalInstance","year","$http","toastr",function(a,b,c,d,e){return a.year=c,a.new_periodo={},a.year_id=a.year.id,a.ok=function(){return d.post("::periodos/store/"+c.id,a.new_periodo).then(function(a){return e.success("Periodo creado con éxito.","Creado"),b.close(a.data)},function(a){return e.warning("No se pudo crear el periodo.","Problema"),b.dismiss()})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("configuracionCertificados",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"colegio/configCertificados.tpl.html",link:function(a,b,c){},controller:"ConfigCertificadosCtrl"}}]).controller("ConfigCertificadosCtrl",["$scope","App","$http","$state","toastr","uiGridConstants","$filter",function(a,b,c,d,e,f,g){var h,i,j;a.newcertif={encabezado_width:0,encabezado_height:0,encabezado_margin_top:0,encabezado_margin_left:0,piepagina_width:0,piepagina_height:0,piepagina_margin_bottom:0,piepagina_margin_left:0},a.creando_certificado=!1,a.editando=!1,a.currentCertif={},a.certificado={},j=g("filter")(a.certificados,{id:a.year.config_certificado_estudio_id}),j&&j.length>0&&(a.certificado.config_actual=j[0]),a.crearConfig=function(){return a.creando_certificado=!0},a.cancelConfig=function(){return a.creando_certificado=!1},h='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',i='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!1,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:50,enableCellEdit:!1,enableColumnMenu:!1},{field:"nombre",displayName:"Nombre",enableSorting:!1,enableColumnMenu:!1},{name:"edicion",displayName:"Edición",width:60,enableSorting:!1,enableFiltering:!1,cellTemplate:h+i,enableCellEdit:!1,enableColumnMenu:!1},{field:"encabezado_width",displayName:"AnchoE",filter:{condition:f.filter.CONTAINS}},{field:"encabezado_height",displayName:"AltoE",filter:{condition:f.filter.CONTAINS}},{field:"encabezado_margin_top",displayName:"MargenEArr",filter:{condition:f.filter.CONTAINS}},{field:"encabezado_margin_left",displayName:"MargenEIzq",filter:{condition:f.filter.CONTAINS}},{field:"piepagina_width",displayName:"AnchoP"},{field:"piepagina_height",displayName:"AltoP"},{field:"piepagina_margin_left",displayName:"MargenPIzq"},{field:"piepagina_margin_bottom",displayName:"MargenPAba"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,d,f,g){return f!==g&&c.put("::certificados/update",b).then(function(a){return e.success("Certificado modificado","Actualizado")},function(a){return e.error("Cambio no guardado","Error")}),a.$apply()})}},a.gridOptions.data=a.certificados,a.guardar=function(){return c.post("::certificados/store",a.newcertif).then(function(b){return e.success("Certificado creado."),a.creando_certificado=!1,a.certificados.push(b.data),a.gridOptions.data=a.certificados},function(a){return e.error("Certificado no guardado","Error")})},a.editar=function(b){var c,d;return a.editando=!0,a.currentCertif=b,c=g("filter")(a.imagenes,{id:b.encabezado_img_id}),d=g("filter")(a.imagenes,{id:b.piepagina_img_id}),c.length>0&&(c=c[0],a.currentCertif.encabezado_img=c),d.length>0?(d=d[0],a.currentCertif.piepagina_img=d):void 0},a.cancelEdit=function(){return a.editando=!1},a.actualizar=function(){return c.put("::certificados/update",a.currentCertif).then(function(b){return e.success("Certificado modificado","Actualizado"),a.editando=!1},function(a){return e.error("Cambio no guardado","Error")})},a.eliminar=function(b){return c["delete"]("::certificados/destroy/"+b.id).then(function(c){return e.success("Certificado eliminado."),a.certificados=g("filter")(a.certificados,{id:"!"+b.id}),a.gridOptions.data=a.certificados},function(a){return e.error("Certificado no eliminado","Error")})},a.certificadoSelect=function(b,d){return c.put("::certificados/actual",{config_certificado_estudio_id:b.id,year_id:a.year.id}).then(function(a){return e.success("Certificado actual cambiado.")},function(a){return e.error("Certificado no cambiado","Error")})}}])}.call(this),function(){angular.module("myvcFrontApp").directive("configuracionEscalas",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"colegio/configEscalas.tpl.html",link:function(a,b,c){},controller:"ConfigEscalasCtrl"}}]).controller("ConfigEscalasCtrl",["$scope","App","$http","$state","$cookies","toastr","uiGridConstants","$filter",function(a,b,c,d,e,f,g,h){var i;a.creando_escala=!1,i='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminarEscala(row.entity)"><i class="fa fa-trash "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:50,enableCellEdit:!1,enableColumnMenu:!1},{field:"desempenio",displayName:"Desempeño",enableSorting:!1,enableColumnMenu:!1},{name:"eliminar",displayName:"Elimin",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:i,enableCellEdit:!1,enableColumnMenu:!1},{field:"descripcion",displayName:"Descripción"},{field:"porc_inicial",displayName:"Valor inicial"},{field:"porc_final",displayName:"Valor final"},{field:"orden",type:"number"},{field:"perdido",type:"boolean",cellTemplate:'<input type="checkbox" ng-model="row.entity.perdido" ng-true-value="1" ng-false-value="0">'},{field:"valoracion",displayName:"Valoración"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,d,e,g){return e!==g&&c.put("::escalas/update",b).then(function(a){return f.success("Escala modificada","Actualizada")},function(a){return f.error("Cambio no guardado","Error")}),a.$apply()})}},a.gridOptions.data=a.year.escalas,a.crearEscala=function(){return c.post("::escalas/store").then(function(b){return f.success("Escala creada."),a.creando_escala=!1,a.year.escalas.push(b.data),a.gridOptions.data=a.year.escalas},function(a){return f.error("Escala no guardada","Error")})},a.eliminarEscala=function(b){return c["delete"]("::escalas/destroy/"+b.id).then(function(c){return f.success("Escala eliminada."),a.year.escalas=h("filter")(a.year.escalas,{id:"!"+b.id}),a.gridOptions.data=a.year.escalas},function(a){return f.error("Escala no eliminada","Error")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(a,b,c){a.state("panel.alumnos.nuevo",{url:"/nuevo",views:{edit_alumno:{templateUrl:""+b.views+"alumnos/alumnosNew.tpl.html",controller:"AlumnosNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo alumno"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-male",pageTitle:"Nuevo alumno - MyVc",needed_permissions:[c.can_work_like_admin,c.can_edit_alumnos]}}).state("panel.alumnos.editar",{url:"/editar/:alumno_id",views:{edit_alumno:{templateUrl:""+b.views+"alumnos/alumnosEdit.tpl.html",controller:"AlumnosEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-users",pageTitle:"Editar alumno - MyVc",needed_permissions:[c.can_work_like_admin,c.can_edit_alumnos]}}).state("panel.listalumnos",{url:"^/listalumnos/:grupo_id",param:{grupo_id:null},views:{maincontent:{templateUrl:""+b.views+"alumnos/listAlumnos.tpl.html",controller:"ListAlumnosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Listado de alumnos"}]}}},data:{displayName:"Listado",icon_fa:"fa fa-users",pageTitle:"Listado alumnos - MyVc",needed_permissions:[c.can_work_like_teacher]}}).state("panel.matriculas",{url:"^/matriculas",views:{maincontent:{templateUrl:""+b.views+"alumnos/matriculas.tpl.html",controller:"MatriculasCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas de alumnos"}]}}},data:{displayName:"matriculas",icon_fa:"fa fa-users",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[c.can_work_like_teacher,c.can_work_like_admin,c.can_edit_alumnos]}}),a.state("panel.matriculas.nuevo",{url:"/nuevo",views:{edit_alumno:{templateUrl:""+b.views+"alumnos/alumnosNew.tpl.html",controller:"AlumnosNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo alumno"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-male",pageTitle:"Nuevo alumno - MyVc",needed_permissions:[c.can_work_like_teacher,c.can_work_like_admin,c.can_edit_alumnos]}}).state("panel.matriculas.detalles",{url:"^/matriculas/detalles/:alumno_id",param:{alumno_id:null},views:{matricula_detalle:{templateUrl:""+b.views+"alumnos/matriculasDetalles.tpl.html",controller:"MatriculasDetallesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas detalladas"}]}}},data:{displayName:"detalles",icon_fa:"fa fa-pencil",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[c.can_work_like_admin]}}).state("panel.alumnos.matricula_detalles",{url:"^/alumnos/matricula_detalles/:alumno_id",param:{alumno_id:null},views:{matricula_detalle:{templateUrl:""+b.views+"alumnos/matriculasDetalles.tpl.html",controller:"MatriculasDetallesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas detalladas"}]}}},data:{displayName:"detalles",icon_fa:"fa fa-pencil",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[c.can_work_like_admin]}}).state("panel.matriculas.detalles.periodos",{url:"^/matriculas/detalles/:alumno_id/periodos",param:{alumno_id:null},views:{matricula_detalle_periodos:{templateUrl:""+b.views+"alumnos/matriculasDetallesPeriodos.tpl.html",controller:"MatriculasDetallesPeriodosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Matrículas detalladas"}]}}},data:{displayName:"periodos",icon_fa:"fa fa-ioxhost",pageTitle:"Matrículas alumnos - MyVc",needed_permissions:[c.can_work_like_admin]}}).state("panel.cartera",{url:"^/cartera",views:{maincontent:{templateUrl:""+b.views+"alumnos/cartera.tpl.html",controller:"CarteraCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Cartera"}]}}},data:{displayName:"cartera",icon_fa:"fa fa-money",pageTitle:"Cartera - MyVc",needed_permissions:[c.can_work_like_teacher]}}).state("panel.cartera.editar",{url:"/editar/:alumno_id",views:{edit_alumno:{templateUrl:""+b.views+"alumnos/alumnosEdit.tpl.html",controller:"AlumnosEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"editar",icon_fa:"fa fa-users",pageTitle:"Editar alumno - MyVc",needed_permissions:[c.can_work_like_teacher]}}).state("panel.acudientes",{url:"^/acudientes",views:{maincontent:{templateUrl:""+b.views+"alumnos/acudientes.tpl.html",controller:"AcudientesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Acudientes"}]}}},data:{displayName:"Acudientes",icon_fa:"fa fa-users",pageTitle:"Acudientes - MyVc",needed_permissions:[c.can_work_like_teacher]}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AlumnosCtrl",["$scope","App","$rootScope","$state","$interval","uiGridConstants","uiGridEditConstants","$uibModal","$filter","AuthService","toastr","$http",function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;j.verificar_acceso(),j.hasRoleOrPerm("Profesor")&&!a.USER.profes_can_edit_alumnos&&(k.warning("No tienes permiso para editar alumnos"),d.transitionTo("panel")),a.dato={},a.dato.mostrartoolgrupo=!0,a.gridScope=a,a.views=b.views,a.perfilPath=b.images+"perfil/",a.year_ant=a.USER.year-1,a.gridOptions={},a.gridOptionsSinMatricula={},a.paises=[],a.religiones=b.religiones,a.tipos_sangre=b.tipos_sangre,a.mostrar_pasado=!1,a.mostrar_retirados=!1,a.parentescos=b.parentescos,a.dato.grupo="",l.get("::grupos/con-paises-tipos").then(function(b){var c,d,e,f,g,h;for(d=0,localStorage.matr_grupo&&(d=parseInt(localStorage.matr_grupo)),a.grupos=b.data.grupos,a.paises=b.data.paises,a.tipos_doc=b.data.tipos_doc,g=a.grupos,h=[],e=0,f=g.length;f>e;e++)c=g[e],parseInt(c.id)===parseInt(d)?(a.dato.grupo=c,h.push(a.selectGrupo(a.dato.grupo))):h.push(void 0);return h}),a.selectGrupo=function(b){var c,d,e,f,g,h,i,j,m;for(localStorage.matr_grupo=b.id,a.dato.grupo=b,j=a.grupos,f=0,h=j.length;h>f;f++)d=j[f],d.active=!1;for(b.active=!0,e=[],m=a.grupos,g=0,i=m.length;i>g;g++)d=m[g],d.orden_grado===b.orden_grado-1&&e.push(d);return c=e.length>0?e[0].grado_id:null,a.traerAlumnnosConGradosAnterior=function(){return l.put("::matriculas/alumnos-con-grado-anterior",{grupo_actual:b,grado_ant_id:c,year_ant:a.year_ant}).then(function(b){var c,d,e,f,g,h,i,j,m,n,o,p,q,r,s,t,u,v,w;for(a.gridOptions.data=b.data.AlumnosActuales,a.AlumnosDesertRetir=b.data.AlumnosDesertRetir,a.gridOptionsSinMatricula.data=b.data.AlumnosSinMatricula,r=a.gridOptions.data,f=0,h=r.length;h>f;f++){for(c=r[f],c.estado_ant=c.estado,c.fecha_retiro_ant=c.fecha_retiro,c.fecha_retiro=c.fecha_retiro?new Date(c.fecha_retiro.replace(/-/g,"/")):c.fecha_retiro,c.fecha_matricula_ant=c.fecha_matricula,c.fecha_matricula=c.fecha_matricula?new Date(c.fecha_matricula.replace(/-/g,"/")):c.fecha_matricula,c.fecha_nac=c.fecha_nac?new Date(c.fecha_nac.replace(/-/g,"/")):c.fecha_nac,s=a.tipos_doc,g=0,i=s.length;i>g;g++)e=s[g],e.id===c.tipo_doc&&(c.tipo_doc=e);for(t=c.subGridOptions.data,o=0,j=t.length;j>o;o++)d=t[o],d.fecha_nac_ant=d.fecha_nac,d.fecha_nac=d.fecha_nac?new Date(d.fecha_nac.replace(/-/g,"/")):d.fecha_nac;c.subGridOptions.onRegisterApi=function(b){return b.edit.on.afterCellEdit(a,function(b,c,d,e){var f;if(d!==e){if("sexo"===c.field&&(d=d.toUpperCase(),"M"!==d&&"F"!==d))return k.warning("Debe usar M o F"),void(b.sexo=e);if("email"===c.field&&(f=/\S+@\S+\.\S+/,!f.test(d)))return k.warning("Email no válido"),void(b.email=e);l.put("::acudientes/guardar-valor",{parentesco_id:b.parentesco_id,acudiente_id:b.id,user_id:b.user_id,propiedad:c.field,valor:d}).then(function(a){return k.success("Acudiente actualizado con éxito")},function(a){return b[c.field]=e,k.error("Cambio no guardado","Error")})}return a.$apply()})}}for(u=a.AlumnosDesertRetir,p=0,m=u.length;m>p;p++)c=u[p],c.estado_ant=c.estado,c.fecha_retiro_ant=c.fecha_retiro,c.fecha_retiro=c.fecha_retiro?new Date(c.fecha_retiro.replace(/-/g,"/")):c.fecha_retiro,c.fecha_matricula_ant=c.fecha_matricula,c.fecha_matricula=c.fecha_matricula?new Date(c.fecha_matricula.replace(/-/g,"/")):c.fecha_matricula;for(v=a.gridOptionsSinMatricula.data,w=[],q=0,n=v.length;n>q;q++)c=v[q],c.estado_ant=c.estado,c.fecha_retiro_ant=c.fecha_retiro,c.fecha_retiro=c.fecha_retiro?new Date(c.fecha_retiro.replace(/-/g,"/")):c.fecha_retiro,c.fecha_matricula_ant=c.fecha_matricula,w.push(c.fecha_matricula=c.fecha_matricula?new Date(c.fecha_matricula.replace(/-/g,"/")):c.fecha_matricula);return w})},a.traerAlumnnosConGradosAnterior()},a.editar=function(a){return d.go("panel.alumnos.editar",{alumno_id:a.alumno_id})},a.eliminar=function(b){var c;return c=h.open({templateUrl:"==alumnos/removeAlumno.tpl.html",controller:"RemoveAlumnoCtrl",resolve:{alumno:function(){return b}}}),c.result.then(function(b){return a.gridOptions.data=i("filter")(a.gridOptions.data,{alumno_id:"!"+b.alumno_id})},function(){})},a.agregarAcudiente=function(b){var d;return delete c.acudiente_cambiar,d=h.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return b},paises:function(){return a.paises},tipos_doc:function(){return a.tipos_doc},parentescos:function(){return a.parentescos}}}),d.result.then(function(a){return b.subGridOptions.data.splice(b.subGridOptions.data.length-1,0,a)},function(){})},a.cambiarAcudiente=function(b,d){var e;return c.acudiente_cambiar=d,e=h.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return b},paises:function(){return a.paises},tipos_doc:function(){return a.tipos_doc},parentescos:function(){return a.parentescos}}}),e.result.then(function(a){var c,e,f,g,h,i;for(h=b.subGridOptions.data,i=[],c=f=0,g=h.length;g>f;c=++f)e=h[c],e&&e.id===d.id?i.push(b.subGridOptions.data.splice(c,1,a)):i.push(void 0);return i},function(){})},a.quitarAcudiente=function(a,b){var c;return c=h.open({templateUrl:"==alumnos/quitarAcudienteModalConfirm.tpl.html",controller:"QuitarAcudienteModalConfirmCtrl",resolve:{alumno:function(){return a},acudiente:function(){return b}}}),c.result.then(function(b){var c,d,e,f,g,h;for(g=a.subGridOptions.data,h=[],c=e=0,f=g.length;f>e;c=++e)d=g[c],d&&d.id===b.id?h.push(a.subGridOptions.data.splice(c,1)):h.push(void 0);return h},function(){})},a.cambiarCiudad=function(b,c){var d;return d=h.open({templateUrl:"==alumnos/cambiarCiudadModal.tpl.html",controller:"CambiarCiudadModalCtrl",resolve:{persona:function(){return b},paises:function(){return a.paises},tipo_ciudad:function(){return c},tipo_persona:function(){return b.subGridOptions?"alumno":"acudiente"}}}),d.result.then(function(a){return b=a})},a.cambiarPazysalvo=function(a){var b;return a.pazysalvo=!a.pazysalvo,a.alumno_id||(a.alumno_id=a.id),b={alumno_id:a.alumno_id,propiedad:"pazysalvo",valor:a.pazysalvo},l.put("::alumnos/guardar-valor",b).then(function(a){return console.log("Cambios guardados")},function(b){return a.pazysalvo=!a.pazysalvo,k.error("Cambio no guardado","Error")})},a.resetPass=function(a){var c;return c=h.open({templateUrl:b.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return a}}}),c.result.then(function(a){})},a.eliminarMatricula=function(a){return l["delete"]("::matriculas/destroy/"+a.matricula_id).then(function(b){return a.currentyear=0,k.success("Alumno desmatriculado"),a},function(a){return k.error("No se pudo desmatricular","Problema")})},x="",y='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',q='<span style="padding-left: 2px; padding-top: 4px;" class="btn-group">'+x+y+"</span>",D="==directives/botonesMatricularMas.tpl.html",v="==alumnos/botonEditReligion.tpl.html",E="==directives/botonPazysalvo.tpl.html",G="==directives/botonesResetPassword.tpl.html",s="==directives/botonCiudadNac.tpl.html",r="==directives/botonCiudadDoc.tpl.html",t="==directives/botonCiudadResid.tpl.html",F="==directives/botonTipoDoc.tpl.html",w="==alumnos/botonEditUsername.tpl.html",u="==alumnos/botonEditEps.tpl.html",o="'==alumnos/popoverAlumnoGrid.tpl.html'",p="'mouseenter'",m="' '",n='uib-popover-template="views+'+o+'" popover-trigger="'+p+'" popover-title="{{ row.entity.nombres + '+m+' + row.entity.apellidos }}" popover-popup-delay="500" popover-append-to-body="true"',H='<input type="checkbox" ng-model="row.entity.nuevo" ng-true-value="1" ng-false-value="0" ng-change="grid.appScope.toggleNuevo(row.entity)">',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Alumnos - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,expandableRowTemplate:"==alumnos/expandableRowTemplate.tpl.html",expandableRowHeight:110,expandableRowScope:{agregarAcudiente:a.agregarAcudiente,quitarAcudiente:a.quitarAcudiente,cambiarAcudiente:a.cambiarAcudiente,resetPass:a.resetPass,cambiarCiudad:a.cambiarCiudad,cambiaUsernameCheck:a.cambiaUsernameCheck},columnDefs:[{field:"no",pinnedLeft:!0,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>',width:40,enableCellEdit:!1},{field:"nombres",minWidth:130,pinnedLeft:!0,filter:{condition:function(a,b,c){var d;return d=c.entity,d.nombres.toLowerCase().indexOf(a.toLowerCase())>-1}},enableHiding:!1,cellTemplate:'<div class="ui-grid-cell-contents" style="padding: 0px;" '+n+'><img ng-src="{{grid.appScope.perfilPath + row.entity.foto_nombre}}" style="width: 35px" />{{row.entity.nombres}}</div>'},{field:"apellidos",minWidth:110,filter:{condition:f.filter.CONTAINS}},{name:"edicion",displayName:"Elimi",width:54,enableSorting:!1,enableFiltering:!1,cellTemplate:q,enableCellEdit:!1,enableColumnMenu:!0},{field:"sexo",displayName:"Sex",width:40},{field:"grupo_id",displayName:"Matrícula",enableCellEdit:!1,cellTemplate:D,minWidth:180,enableFiltering:!1},{field:"fecha_matricula",displayName:"Fecha matrícula",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"no_matricula",displayName:"# matrícula",minWidth:80,enableColumnMenu:!0},{field:"username",filter:{condition:f.filter.CONTAINS},displayName:"Usuario",cellTemplate:G,editableCellTemplate:w,minWidth:135},{field:"deuda",displayName:"Deuda",type:"number",cellFilter:'currency:"$":0',minWidth:70},{field:"nuevo",displayName:"Nuevo?",type:"number",minWidth:70},{field:"pazysalvo",displayName:"A paz?",cellTemplate:E,minWidth:60,enableCellEdit:!1},{field:"religion",displayName:"Religión",minWidth:70,editableCellTemplate:v},{field:"tipo_doc",displayName:"Tipo documento",minWidth:120,cellTemplate:F,enableCellEdit:!1},{field:"documento",minWidth:100,cellFilter:"formatNumberDocumento"},{field:"ciudad_doc",displayName:"Ciud Docu",minWidth:120,cellTemplate:r,enableCellEdit:!1},{field:"tipo_sangre",displayName:"RH",minWidth:70},{field:"estrato",minWidth:70,type:"number"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"ciudad_nac",displayName:"Ciud Nacimi",minWidth:120,cellTemplate:s,enableCellEdit:!1},{field:"direccion",displayName:"Dirección",minWidth:80},{field:"barrio",minWidth:80},{field:"ciudad_resid",displayName:"Ciud Resid",minWidth:120,cellTemplate:t,enableCellEdit:!1},{field:"telefono",displayName:"Teléfono",minWidth:80},{field:"celular",displayName:"Celular",minWidth:80},{field:"eps",displayName:"EPS",minWidth:100,editableCellTemplate:u}],multiSelect:!1,exporterHeaderFilter:function(a){return"A paz?"===a?"Paz y salvo":"Matrícula"===a?"Grupo":a},exporterFieldCallback:function(b,c,d,e){return"no"===d.name?b.renderContainers.body.visibleRowCache.indexOf(c)+1:"grupo_id"===d.name?a.dato.grupo.nombre:"ciudad_nac"===d.name?c.entity.ciudad_nac_nombre:"pazysalvo"===d.name?e?"Si":"No":"tipo_doc"===d.name&&e&&e.tipo?e.tipo:e},onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){if(d!==e){if(b.alumno_id||(b.alumno_id=fila.id),"sexo"===c.field&&(d=d.toUpperCase(),"M"!==d&&"F"!==d))return k.warning("Debe usar M o F"),void(b.sexo=e);if("fecha_matricula"===c.field)return a.cambiarFechaMatricula(b);if("tipo_sangre"===c.field&&(d=d.toUpperCase(),!(a.tipos_sangre.indexOf(d)>-1)))return k.warning("Debe usar: "+a.tipos_sangre.join(" ")),void(b.tipo_sangre=e);if("estrato"===c.field&&(0>d||d>9))return k.warning("Valor no admitido"),void(b.estrato=e);if("documento"===c.field&&10!==d.length&&0!==d.length)return void k.warning("Debe ser de diez dígitos");if("nuevo"===c.field)return parseInt(d)<0||parseInt(d)>1?(b[c.field]=e,void k.warning("Coloque 1 si es nuevo, 0 si estuvo el año pasado.")):void l.put("::matriculas/toggle-nuevo",{matricula_id:b.matricula_id,is_nuevo:d}).then(function(a){return k.success("Cambiado")},function(a){return k.error("No se cambió si era nuevo o no","Problema"),b[c.field]=e});l.put("::alumnos/guardar-valor",{alumno_id:b.alumno_id,propiedad:c.field,valor:d}).then(function(a){return k.success("Alumno(a) actualizado con éxito")},function(a){return b[c.field]=e,k.error("Cambio no guardado","Error")})}return"religion"!==c.field?a.$apply():void 0})}},z='<label ng-click="grid.appScope.setNewAsistente(row.entity)" uib-tooltip="Inscribir como asistente" tooltip-append-to-body="true" class="btn btn-success shiny btn-xs">Asis</label>',A='<label ng-click="grid.appScope.matricularUno(row.entity, true)" uib-tooltip="Matricular" tooltip-append-to-body="true" tooltip-popup-delay="1000" class="btn btn-success shiny btn-xs">Matric</label>',B='<label ng-click="grid.appScope.matricularEn(row.entity)" uib-tooltip="Matricular en..." tooltip-append-to-body="true" tooltip-placement="right" class="btn btn-success shiny btn-xs">Otro grupo...</label>',C='<span style="padding-left: 2px; padding-top: 4px;" class="btn-group">'+z+A+B+"</span>",a.gridOptionsSinMatricula={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,columnDefs:[{field:"no",cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>',width:40},{field:"nombres",minWidth:120,filter:{condition:function(a,b,c){var d;return d=c.entity,d.nombres.toLowerCase().indexOf(a.toLowerCase())>-1}},enableHiding:!1,cellTemplate:'<div class="ui-grid-cell-contents" style="padding: 0px;" '+n+'><img ng-src="{{grid.appScope.perfilPath + row.entity.foto_nombre}}" style="width: 35px" />{{row.entity.nombres}}</div>'},{field:"apellidos",minWidth:80,filter:{condition:f.filter.CONTAINS}},{field:"sexo",displayName:"Sex",width:40},{field:"grupo_id",displayName:"Matrícula",cellTemplate:C,minWidth:180,enableFiltering:!1},{field:"fecha_matricula",displayName:"Fecha matrícula",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"no_matricula",displayName:"# matrícula",minWidth:80,enableColumnMenu:!0},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"telefono",displayName:"Teléfono",minWidth:70}],multiSelect:!0},a.religionSelected=function(b,c){return a.religiones.indexOf(b.religion)>-1?a.$broadcast(g.events.END_CELL_EDIT):void 0},a.religionEditPressEnter=function(b){return a.$broadcast(g.events.END_CELL_EDIT)},a.tipoDocSeleccionado=function(a,b){var c,d;return c={propiedad:"tipo_doc",valor:a.id},d="acudientes",b.subGridOptions?(d="alumnos",c.alumno_id=b.alumno_id):(c.acudiente_id=b.acudiente_id,c.parentesco_id=b.parentesco_id,c.user_acud_id=b.user_id),l.put("::"+d+"/guardar-valor",c).then(function(a){return k.success("Alumno(a) actualizado con éxito","Actualizado")},function(a){return b.tipo_doc=oldValue,k.error("Cambio no guardado","Error")})},a.matricularUno=function(b,c){var d;return a.dato.grupo.id?(d={alumno_id:b.alumno_id,grupo_id:a.dato.grupo.id,year_id:a.USER.year_id},l.post("::matriculas/matricularuno",d).then(function(d){return d=d.data,b.matricula_id=d.id,b.grupo_id=d.grupo_id,b.estado="MATR",b.fecha_matricula_ant=d.fecha_matricula.date,b.fecha_matricula=new Date(d.fecha_matricula.date),k.success("Alumno matriculado con éxito","Matriculado"),c&&a.traerAlumnnosConGradosAnterior(),b},function(a){return k.error("No se pudo matricular el alumno.","Error")})):void k.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},a.cambiaUsernameCheck=function(b){return a.verificandoUsername=!0,l.put("::users/usernames-check",{texto:b}).then(function(b){return a.username_match=b.data.usernames,a.verificandoUsername=!1,a.username_match.map(function(a){return a.username})})},a.cambiaEpsCheck=function(b){return a.verificandoEps=!0,l.put("::alumnos/eps-check",{texto:b}).then(function(b){return a.eps_match=b.data.eps,a.verificandoEps=!1,a.eps_match.map(function(a){return a.eps})})},a.reMatricularUno=function(b){var c;return a.dato.grupo.id?(c={matricula_id:b.matricula_id},l.put("::matriculas/re-matricularuno",c).then(function(a){return a=a.data,k.success("Alumno rematriculado","Matriculado"),b},function(a){return k.error("No se pudo matricular el alumno.","Error")})):void k.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},a.matricularEn=function(b){var c;return c=h.open({templateUrl:"==alumnos/matricularEn.tpl.html",controller:"MatricularEnCtrl",resolve:{alumno:function(){return b},grupos:function(){return a.grupos},year_id:function(){return a.USER.year_id}}}),c.result.then(function(b){return console.log("Cierra"),a.traerAlumnnosConGradosAnterior()})},a.setAsistente=function(b){return l.put("::matriculas/set-asistente",{matricula_id:b.matricula_id,grupo_id:a.dato.grupo.grupo_id}).then(function(a){return k.success("Guardado como asistente");
},function(a){return k.error("No se pudo guardar como asistente","Error")})},a.setNewAsistente=function(b){return l.put("::matriculas/set-new-asistente",{alumno_id:b.alumno_id,grupo_id:a.dato.grupo.id}).then(function(b){return console.log("Cambios guardados"),a.traerAlumnnosConGradosAnterior()},function(a){return k.error("No se pudo crear asistente","Error")})},a.cambiarFechaRetiro=function(a){return l.put("::matriculas/cambiar-fecha-retiro",{matricula_id:a.matricula_id,fecha_retiro:a.fecha_retiro}).then(function(a){return k.success("Fecha retiro guardada")},function(b){return a.fecha_retiro=a.fecha_retiro_ant,k.error("No se pudo guardar la fecha","Error")})},a.cambiarFechaMatricula=function(a){return l.put("::matriculas/cambiar-fecha-matricula",{matricula_id:a.matricula_id,fecha_matricula:a.fecha_matricula}).then(function(a){return k.success("Fecha matrícula guardada")},function(b){return a.fecha_matricula=a.fecha_matricula_ant,k.error("No se pudo guardar la fecha","Error")})},a.desertar=function(a){var b;return b=a.fecha_retiro,null===a.fecha_retiro_ant&&(b=new Date,a.fecha_retiro=b),l.put("::matriculas/desertar",{matricula_id:a.matricula_id,fecha_retiro:a.fecha_retiro}).then(function(a){return k.success("Alumno desertado")},function(a){return k.error("No se pudo desertar","Problema")})},a.retirar=function(a){var b;return b=a.fecha_retiro,null===a.fecha_retiro_ant&&(b=new Date,a.fecha_retiro=b),l.put("::matriculas/retirar",{matricula_id:a.matricula_id,fecha_retiro:a.fecha_retiro}).then(function(a){return k.success("Alumno retirado")},function(a){return k.error("No se pudo desmatricular","Problema")})},a.buscar_por_nombre=function(){return""===a.texto_a_buscar?void k.warning("Escriba término a buscar"):l.put("::buscar/por-nombre",{texto_a_buscar:a.texto_a_buscar}).then(function(b){return a.alumnos_encontrados=b.data},function(a){return k.error("No se pudo buscar","Problema")})},a.$on("alumnoguardado",function(b,c){return a.gridOptions.data.push(c)})}]).controller("RemoveAlumnoCtrl",["$scope","$uibModalInstance","alumno","$http","toastr","App",function(a,b,c,d,e,f){return a.alumno=c,a.perfilPath=f.images+"perfil/",a.ok=function(){return d["delete"]("::alumnos/destroy/"+c.alumno_id).then(function(a){return e.success("Alumno enviado a la papelera.","Eliminado")},function(a){return e.warning("No se pudo enviar a la papelera.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("selectorGrupoDir",["App","Perfil",function(a,b){return{restrict:"EA",templateUrl:"==grados/selectorGrupoDir.tpl.html",controller:["$scope","App",function(a,b){}]}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AlumnosNewCtrl",["$scope","$rootScope","toastr","$http","$filter","$state",function(a,b,c,d,e,f){a.data={},a.$state=f,a.alumno={no_matricula:"",nombres:"",apellidos:"",sexo:"M",documento:"",fecha_nac:new Date("2000-06-26"),tipo_sangre:{},eps:"",telefono:"",celular:"",direccion:"",barrio:"",estrato:1,email:"@gmail.com",foto:"perfil/default_male.jpg",pazysalvo:!0,deuda:0,pais_nac:{id:1,pais:"COLOMBIA",abrev:"CO"}},a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],d.get("::paises").then(function(b){return b=b.data,a.paises=b,a.pais_nac=b[0],a.paisNacSelect(b[0],a.pais_nac)},function(){return console.log("No se pudo traer los paises")}),d.get("::grupos").then(function(b){return a.grupos=b.data},function(){return console.log("No se pudo traer los grupos")}),d.get("::tiposdocumento").then(function(b){return a.tipos_doc=b.data}),a.crear=function(){return a.alumno.fecha_nac=e("date")(a.alumno.fecha_nac,"yyyy-MM-dd"),d.post("::alumnos/store",a.alumno).then(function(b){return c.success("Alumno "+b.data.nombres+" creado"),a.$emit("alumnoguardado",b.data)},function(a){return c.warning("No se pudo guardar alumno","Problema")})},a.paisNacSelect=function(b,c){return d.get("::ciudades/departamentos/"+b.id).then(function(c){return a.departamentosNac=c.data,"undefined"==typeof a.alumno.pais_doc?(a.alumno.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return d.get("::ciudades/por-departamento/"+b.departamento).then(function(c){return a.ciudadesNac=c.data,"undefined"==typeof a.alumno.departamento_doc?(a.alumno.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b,c){return d.get("::ciudades/departamentos/"+b.id).then(function(b){return a.departamentos=b.data})},a.departSeleccionado=function(b){return d.get("::ciudades/por-departamento/"+b.departamento).then(function(b){return a.ciudades=b.data})},a.dateOptions={formatYear:"yy"},a.restarEstrato=function(){return a.alumno.estrato>0?a.alumno.estrato=a.alumno.estrato-1:void 0},a.sumarEstrato=function(){return a.alumno.estrato<10?a.alumno.estrato=a.alumno.estrato+1:void 0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AlumnosEditCtrl",["$scope","$state","$http","toastr",function(a,b,c,d){a.data={},a.alumno={},a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],c.get("::alumnos/show/"+b.params.alumno_id).then(function(b){return a.alumno=b.data,b.data.user&&(a.alumno.username=b.data.user.username),b.data.user&&(a.alumno.email2=b.data.user.email),a.alumno.ciudad_nac_id=b.data.ciudad_nac,a.alumno.ciudad_doc_id=b.data.ciudad_doc,null===a.alumno.ciudad_nac?(a.alumno.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisNacSelect(a.alumno.pais_nac,a.alumno.pais_nac)):c.get("::ciudades/datosciudad/"+a.alumno.ciudad_nac_id).then(function(b){return a.paises=b.data.paises,a.departamentosNac=b.departamentos,a.ciudadesNac=b.ciudades,a.alumno.pais_nac=b.pais,a.alumno.departamento_nac=b.departamento,a.alumno.ciudad_nac=b.ciudad}),a.alumno.ciudad_doc>0?c.get("::ciudades/datosciudad/"+a.alumno.ciudad_doc_id).then(function(b){return a.paises=b.data.paises,a.departamentos=b.departamentos,a.ciudades=b.ciudades,a.alumno.pais_doc=b.pais,a.alumno.departamento_doc=b.departamento,a.alumno.ciudad_doc=b.ciudad}):void 0}),c.get("::paises").then(function(b){return a.paises=b.data}),c.get("::tiposdocumento").then(function(b){return a.tipos_doc=b.data}),a.guardar=function(){return c.put("::alumnos/update/"+a.alumno.id,a.alumno).then(function(a){return d.success("Alumno actualizado correctamente")},function(a){return d.error("No se pudo guardar el alumno")})},a.paisNacSelect=function(b,d){return c.get("::ciudades/departamentos/"+b.id).then(function(c){return a.departamentosNac=c.data,"undefined"==typeof a.alumno.pais_doc?(a.alumno.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return c.get("::ciudades/por-departamento/"+b.departamento).then(function(c){return a.ciudadesNac=c.data,"undefined"==typeof a.alumno.departamento_doc?(a.alumno.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b,d){return c.get("::ciudades/departamentos/"+b.id).then(function(b){return a.departamentos=b.data})},a.departSeleccionado=function(b){return c.get("::ciudades/por-departamento/"+b.departamento).then(function(b){return a.ciudades=b.data})},a.dateOptions={formatYear:"yyyy"},a.restarEstrato=function(){return a.alumno.estrato>0?a.alumno.estrato=a.alumno.estrato-1:void 0},a.sumarEstrato=function(){return a.alumno.estrato<10?a.alumno.estrato=parseInt(a.alumno.estrato)+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ListAlumnosCtrl",["$scope","App","$rootScope","$state","$interval","uiGridConstants","uiGridEditConstants","$uibModal","$filter","AuthService","toastr","$http","$stateParams",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A;return j.verificar_acceso(),a.dato={},a.dato.mostrartoolgrupo=!0,a.gridScope=a,a.views=b.views,a.perfilPath=b.images+"perfil/",a.year_ant=a.USER.year-1,a.gridOptions={},a.gridOptionsSinMatricula={},a.paises=[],a.religiones=b.religiones,a.tipos_sangre=b.tipos_sangre,a.mostrar_pasado=!1,a.mostrar_retirados=!1,a.es_titular=!0,a.parentescos=b.parentescos,a.dato.grupo="",l.get("::grupos/con-paises-tipos").then(function(b){var c,d,e,f,g,h;for(d=0,m.grupo_id&&(localStorage.matr_grupo=parseInt(m.grupo_id),d=parseInt(localStorage.matr_grupo)),a.grupos=b.data.grupos,a.paises=b.data.paises,a.tipos_doc=b.data.tipos_doc,a.grupos_titularia=b.data.grupos_titularia,g=a.grupos,h=[],e=0,f=g.length;f>e;e++)c=g[e],parseInt(c.id)===parseInt(d)?(a.dato.grupo=c,h.push(a.selectGrupo(a.dato.grupo))):h.push(void 0);return h}),a.selectGrupo=function(b){var c,d,e,f;for(localStorage.matr_grupo=b.id,a.dato.grupo=b,f=a.grupos,d=0,e=f.length;e>d;d++)c=f[d],c.active=!1;return b.active=!0,j.hasRoleOrPerm("Profesor")&&(b.es_titular?a.es_titular=!0:a.es_titular=!1),a.traerAlumnnos=function(){return l.put("::grupos/alumnos-con-datos",{grupo_actual:b}).then(function(b){var c,d,e,f,g,h,i,j,m,n,o,p;for(a.gridOptions.data=b.data.AlumnosActuales,n=a.gridOptions.data,f=0,i=n.length;i>f;f++){for(c=n[f],c.fecha_nac=c.fecha_nac?new Date(c.fecha_nac.replace(/-/g,"/")):c.fecha_nac,o=a.tipos_doc,g=0,j=o.length;j>g;g++)e=o[g],e.id===c.tipo_doc&&(c.tipo_doc=e);for(p=c.subGridOptions.data,h=0,m=p.length;m>h;h++)d=p[h],d.fecha_nac_ant=d.fecha_nac,d.fecha_nac=d.fecha_nac?new Date(d.fecha_nac.replace(/-/g,"/")):d.fecha_nac;if(!a.es_titular)return;c.subGridOptions.onRegisterApi=function(b){return b.edit.on.afterCellEdit(a,function(b,c,d,e){var f;if(d!==e){if("sexo"===c.field&&(d=d.toUpperCase(),"M"!==d&&"F"!==d))return k.warning("Debe usar M o F"),void(b.sexo=e);if("email"===c.field&&(f=/\S+@\S+\.\S+/,!f.test(d)))return k.warning("Email no válido"),void(b.email=e);l.put("::acudientes/guardar-valor",{parentesco_id:b.parentesco_id,acudiente_id:b.id,user_id:b.user_id,propiedad:c.field,valor:d}).then(function(a){return k.success("Acudiente actualizado con éxito")},function(a){return b[c.field]=e,k.error("Cambio no guardado","Error")})}return a.$apply()})}}})},a.traerAlumnnos()},a.agregarAcudiente=function(b){var d;return a.es_titular?(delete c.acudiente_cambiar,d=h.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return b},paises:function(){return a.paises},tipos_doc:function(){return a.tipos_doc},parentescos:function(){return a.parentescos}}}),d.result.then(function(a){return b.subGridOptions.data.splice(b.subGridOptions.data.length-1,0,a)},function(){})):void k.warning("No eres titular","No puedes editar.")},a.cambiarAcudiente=function(b,d){var e;return a.es_titular?(c.acudiente_cambiar=d,e=h.open({templateUrl:"==alumnos/newAcudienteModal.tpl.html",controller:"NewAcudienteModalCtrl",resolve:{alumno:function(){return b},paises:function(){return a.paises},tipos_doc:function(){return a.tipos_doc},parentescos:function(){return a.parentescos}}}),e.result.then(function(a){var c,e,f,g,h,i;for(h=b.subGridOptions.data,i=[],c=f=0,g=h.length;g>f;c=++f)e=h[c],e&&e.id===d.id?i.push(b.subGridOptions.data.splice(c,1,a)):i.push(void 0);return i},function(){})):void k.warning("No eres titular","No puedes editar.")},a.quitarAcudiente=function(b,c){var d;return a.es_titular?(d=h.open({templateUrl:"==alumnos/quitarAcudienteModalConfirm.tpl.html",controller:"QuitarAcudienteModalConfirmCtrl",resolve:{alumno:function(){return b},acudiente:function(){return c}}}),d.result.then(function(a){var c,d,e,f,g,h;for(g=b.subGridOptions.data,h=[],c=e=0,f=g.length;f>e;c=++e)d=g[c],d&&d.id===a.id?h.push(b.subGridOptions.data.splice(c,1)):h.push(void 0);return h},function(){})):void k.warning("No eres titular","No puedes editar.")},a.cambiarCiudad=function(b,c){var d;return a.es_titular?(d=h.open({templateUrl:"==alumnos/cambiarCiudadModal.tpl.html",controller:"CambiarCiudadModalCtrl",resolve:{persona:function(){return b},paises:function(){return a.paises},tipo_ciudad:function(){return c},tipo_persona:function(){return b.subGridOptions?"alumno":"acudiente"}}}),d.result.then(function(a){return b=a})):void k.warning("No eres titular","No puedes editar.")},a.cambiarPazysalvo=function(b){var c;return a.es_titular?(b.pazysalvo=!b.pazysalvo,b.alumno_id||(b.alumno_id=b.id),c={alumno_id:b.alumno_id,propiedad:"pazysalvo",valor:b.pazysalvo},l.put("::alumnos/guardar-valor",c).then(function(a){return console.log("Cambios guardados")},function(a){return b.pazysalvo=!b.pazysalvo,k.error("Cambio no guardado","Error")})):void k.warning("No eres titular","No puedes editar.")},a.resetPass=function(c){var d;return a.es_titular?(d=h.open({templateUrl:b.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return c}}}),d.result.then(function(a){})):void k.warning("No eres titular","No puedes editar.")},a.religionSelected=function(b,c){return a.es_titular?a.religiones.indexOf(b.religion)>-1?a.$broadcast(g.events.END_CELL_EDIT):void 0:void k.warning("No eres titular","No puedes editar.")},a.religionEditPressEnter=function(b){return a.$broadcast(g.events.END_CELL_EDIT)},a.tipoDocSeleccionado=function(b,c){var d,e;return a.es_titular?(d={propiedad:"tipo_doc",valor:b.id},e="acudientes",c.subGridOptions?(e="alumnos",d.alumno_id=c.alumno_id):(d.acudiente_id=c.acudiente_id,d.parentesco_id=c.parentesco_id,d.user_acud_id=c.user_id),l.put("::"+e+"/guardar-valor",d).then(function(a){return k.success("Alumno(a) actualizado con éxito","Actualizado")},function(a){return k.error("Cambio no guardado.","Error")})):void k.warning("No eres titular","No puedes editar.")},a.cambiaUsernameCheck=function(b){return a.es_titular?(a.verificandoUsername=!0,l.put("::users/usernames-check",{texto:b}).then(function(b){return a.username_match=b.data.usernames,a.verificandoUsername=!1,a.username_match.map(function(a){return a.username})})):void k.warning("No eres titular","No puedes editar.")},a.cambiaEpsCheck=function(b){return a.es_titular?(a.verificandoEps=!0,l.put("::alumnos/eps-check",{texto:b}).then(function(b){return a.eps_match=b.data.eps,a.verificandoEps=!1,a.eps_match.map(function(a){return a.eps})})):void k.warning("No eres titular","No puedes editar.")},x="",v="==alumnos/botonEditReligion.tpl.html",y="==directives/botonPazysalvo.tpl.html",A="==directives/botonesResetPassword.tpl.html",s="==directives/botonCiudadNac.tpl.html",r="==directives/botonCiudadDoc.tpl.html",t="==directives/botonCiudadResid.tpl.html",z="==directives/botonTipoDoc.tpl.html",w="==alumnos/botonEditUsername.tpl.html",u="==alumnos/botonEditEps.tpl.html",p="'==alumnos/popoverAlumnoGrid.tpl.html'",q="'mouseenter'",n="' '",o='uib-popover-template="views+'+p+'" popover-trigger="'+q+'" popover-title="{{ row.entity.nombres + '+n+' + row.entity.apellidos }}" popover-popup-delay="500" popover-append-to-body="true"',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Alumnos - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,expandableRowTemplate:"==alumnos/expandableRowTemplate.tpl.html",expandableRowHeight:110,expandableRowScope:{agregarAcudiente:a.agregarAcudiente,quitarAcudiente:a.quitarAcudiente,cambiarAcudiente:a.cambiarAcudiente,resetPass:a.resetPass,cambiarCiudad:a.cambiarCiudad,cambiaUsernameCheck:a.cambiaUsernameCheck},columnDefs:[{field:"no",pinnedLeft:!0,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>',width:40,enableCellEdit:!1},{field:"nombres",minWidth:130,pinnedLeft:!0,filter:{condition:function(a,b,c){var d;return d=c.entity,d.nombres.toLowerCase().indexOf(a.toLowerCase())>-1}},enableHiding:!1,cellTemplate:'<div class="ui-grid-cell-contents" style="padding: 0px;" '+o+'><img ng-src="{{grid.appScope.perfilPath + row.entity.foto_nombre}}" style="width: 35px" />{{row.entity.nombres}}</div>'},{field:"apellidos",minWidth:110,filter:{condition:f.filter.CONTAINS}},{field:"sexo",displayName:"Sex",width:40},{field:"no_matricula",displayName:"# matrícula",minWidth:80,enableColumnMenu:!0},{field:"username",filter:{condition:f.filter.CONTAINS},displayName:"Usuario",cellTemplate:A,editableCellTemplate:w,minWidth:135},{field:"deuda",displayName:"Deuda",type:"number",cellFilter:'currency:"$":0',minWidth:70},{field:"pazysalvo",displayName:"A paz?",cellTemplate:y,minWidth:60,enableCellEdit:!1},{field:"religion",displayName:"Religión",minWidth:70,editableCellTemplate:v},{field:"tipo_doc",displayName:"Tipo documento",minWidth:120,cellTemplate:z,enableCellEdit:!1},{field:"documento",minWidth:100,cellFilter:"formatNumberDocumento"},{field:"ciudad_doc",displayName:"Ciud Docu",minWidth:120,cellTemplate:r,enableCellEdit:!1},{field:"tipo_sangre",displayName:"RH",minWidth:70},{field:"estrato",minWidth:70,type:"number"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date",minWidth:100},{field:"ciudad_nac",displayName:"Ciud Nacimi",minWidth:120,cellTemplate:s,enableCellEdit:!1},{field:"direccion",displayName:"Dirección",minWidth:70},{field:"barrio",minWidth:70},{field:"ciudad_resid",displayName:"Ciud Resid",minWidth:120,cellTemplate:t,enableCellEdit:!1},{field:"telefono",displayName:"Teléfono",minWidth:80},{field:"eps",displayName:"EPS",minWidth:100,editableCellTemplate:u}],multiSelect:!1,exporterHeaderFilter:function(a){return"A paz?"===a?"Paz y salvo":"Matrícula"===a?"Grupo":a},exporterFieldCallback:function(b,c,d,e){return"no"===d.name?b.renderContainers.body.visibleRowCache.indexOf(c)+1:"grupo_id"===d.name?a.dato.grupo.nombre:"ciudad_nac"===d.name?c.entity.ciudad_nac_nombre:"pazysalvo"===d.name?e?"Si":"No":"tipo_doc"===d.name&&e&&e.tipo?e.tipo:e},onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){if(d!==e){if(j.hasRoleOrPerm("Profesor")&&a.USER.profes_can_edit_alumnos){if(!a.es_titular)return b[c.field]=e,void k.warning("No eres el titular")}else if(!j.hasRoleOrPerm("Admin"))return b[c.field]=e,void k.warning("Actualmente no hay permiso para editar");if(b.alumno_id||(b.alumno_id=fila.id),"sexo"===c.field&&(d=d.toUpperCase(),"M"!==d&&"F"!==d))return k.warning("Debe usar M o F"),void(b.sexo=e);if("fecha_matricula"===c.field)return a.cambiarFechaMatricula(b);if("tipo_sangre"===c.field&&(d=d.toUpperCase(),!(a.tipos_sangre.indexOf(d)>-1)))return k.warning("Debe usar: "+a.tipos_sangre.join(" ")),void(b.tipo_sangre=e);if("estrato"===c.field&&(0>d||d>9))return k.warning("Valor no admitido"),void(b.estrato=e);if("documento"===c.field&&10!==d.length&&0!==d.length)return void k.warning("Debe ser de diez dígitos");l.put("::alumnos/guardar-valor",{alumno_id:b.alumno_id,propiedad:c.field,valor:d}).then(function(a){return k.success("Alumno(a) actualizado con éxito")},function(a){return b[c.field]=e,k.error("Cambio no guardado","Error")})}return"religion"!==c.field?a.$apply():void 0})}}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MatriculasCtrl",["$scope","App","$state","$interval","$uibModal","$filter","AuthService","toastr","$http",function(a,b,c,d,e,f,g,h,i){g.verificar_acceso(),a.dato={sortMatricula:!1,sortMatriculaReverse:!1,sortNombres:!1,sortNombresReverse:!1,sortType:"apellidos",sortReverse:!1},a.dato_f={sortMatricula:!1,sortMatriculaReverse:!1,sortNombres:!1,sortNombresReverse:!1,sortType:"apellidos",sortReverse:!1},a.alumnos_encontrados=[],a.texto_a_buscar="",a.year_ant=a.USER.year-1,a.perfilPath=b.images+"perfil/",a.views=b.views,a.alumnos_all=[],a.dato.grupo="",i.get("::grupos").then(function(b){var c,d,e,f,g;for(d=0,localStorage.matr_grupo&&(d=parseInt(localStorage.matr_grupo)),a.grupos=b.data,g=a.grupos,e=0,f=g.length;f>e;e++)c=g[e],c.id===d&&(a.dato.grupo=c);return a.traerAlumnos(a.dato.grupo)}),a.editar=function(a){return c.go("panel.alumnos.editar",{alumno_id:a.alumno_id})},a.onGrupoSelect=function(b,c){return b?(localStorage.setItem("matr_grupo",b.id),a.traerAlumnos(b)):void 0},a.traerAlumnos=function(b){var c,d,e,f,g,h;for(e=[],h=a.grupos,f=0,g=h.length;g>f;f++)d=h[f],d.orden_grado===b.orden_grado-1&&e.push(d);return c=e.length>0?e[0].grado_id:null,i.put("::matriculas/alumnos-grado-anterior",{grupo_actual:b,grado_ant_id:c,year_ant:a.year_ant}).then(function(b){var c,d,e,f,g;for(a.alumnos_all=b.data,f=a.alumnos_all,g=[],d=0,e=f.length;e>d;d++)c=f[d],c.estado_ant=c.estado,c.fecha_retiro_ant=c.fecha_retiro,c.fecha_retiro=new Date(c.fecha_retiro),c.fecha_matricula_ant=c.fecha_matricula,g.push(c.fecha_matricula=new Date(c.fecha_matricula));return g})},a.matricularUno=function(b){var c;return a.dato.grupo.id?(c={alumno_id:b.alumno_id,grupo_id:a.dato.grupo.id,year_id:a.USER.year_id},i.post("::matriculas/matricularuno",c).then(function(a){return a=a.data,b.matricula_id=a.id,b.grupo_id=a.grupo_id,b.estado="MATR",b.fecha_matricula_ant=a.fecha_matricula.date,b.fecha_matricula=new Date(a.fecha_matricula.date),h.success("Alumno matriculado con éxito","Matriculado"),b},function(a){return h.error("No se pudo matricular el alumno.","Error")})):void h.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},a.reMatricularUno=function(b){var c;return a.dato.grupo.id?(c={matricula_id:b.matricula_id},i.put("::matriculas/re-matricularuno",c).then(function(a){return a=a.data,h.success("Alumno rematriculado","Matriculado"),b},function(a){return h.error("No se pudo matricular el alumno.","Error")})):void h.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},a.matricularEn=function(b){var c;return c=e.open({templateUrl:"==alumnos/matricularEn.tpl.html",controller:"MatricularEnCtrl",resolve:{alumno:function(){return b},grupos:function(){return a.grupos},year_id:function(){return a.USER.year_id}}}),c.result.then(function(a){return console.log("Cierra")})},a.setAsistente=function(b){return i.put("::matriculas/set-asistente",{matricula_id:b.matricula_id,grupo_id:a.dato.grupo.grupo_id}).then(function(a){return h.success("Guardado como asistente")},function(a){return h.error("No se pudo guardar como asistente","Error")})},a.setNewAsistente=function(b){return i.put("::matriculas/set-new-asistente",{alumno_id:b.alumno_id,grupo_id:a.dato.grupo.id}).then(function(a){return console.log("Cambios guardados")},function(a){return h.error("No se pudo crear asistente","Error")})},a.cambiarFechaRetiro=function(a){return i.put("::matriculas/cambiar-fecha-retiro",{matricula_id:a.matricula_id,fecha_retiro:a.fecha_retiro}).then(function(a){return h.success("Fecha retiro guardada")},function(b){return a.fecha_retiro=a.fecha_retiro_ant,h.error("No se pudo guardar la fecha","Error")})},a.cambiarFechaMatricula=function(a){return i.put("::matriculas/cambiar-fecha-matricula",{matricula_id:a.matricula_id,fecha_matricula:a.fecha_matricula}).then(function(a){return h.success("Fecha matricula guardada")},function(b){return a.fecha_matricula=a.fecha_matricula_ant,h.error("No se pudo guardar la fecha","Error")})},a.desertar=function(a){var b;return b=a.fecha_retiro,null===a.fecha_retiro_ant&&(b=new Date,a.fecha_retiro=b),i.put("::matriculas/desertar",{matricula_id:a.matricula_id,fecha_retiro:a.fecha_retiro}).then(function(a){return h.success("Alumno desertado")},function(a){return h.error("No se pudo desertar","Problema")})},a.retirar=function(a){var b;return b=a.fecha_retiro,null===a.fecha_retiro_ant&&(b=new Date,a.fecha_retiro=b),i.put("::matriculas/retirar",{matricula_id:a.matricula_id,fecha_retiro:a.fecha_retiro}).then(function(a){return h.success("Alumno retirado")},function(a){return h.error("No se pudo desmatricular","Problema")})},a.buscar_por_nombre=function(){return""===a.texto_a_buscar?void h.warning("Escriba término a buscar"):i.put("::buscar/por-nombre",{texto_a_buscar:a.texto_a_buscar}).then(function(b){return a.alumnos_encontrados=b.data},function(a){return h.error("No se pudo buscar","Problema")})},a.filterActuales=function(b){return b.grupo_id===a.dato.grupo.id},a.filterNOActuales=function(b){return b.grupo_id!==a.dato.grupo.id}}]).controller("MatricularEnCtrl",["$scope","$uibModalInstance","alumno","grupos","year_id","$http","toastr",function(a,b,c,d,e,f,g){var h,i,j,k,l;for(a.alumno=c,a.grupos=d,a.dato={},localStorage.matr_grupo&&(i=parseInt(localStorage.matr_grupo)),l=a.grupos,j=0,k=l.length;k>j;j++)h=l[j],h.id===i&&(a.dato.grupo=h);return a.ok=function(){var c;return a.dato.grupo.id?(c={alumno_id:a.alumno.alumno_id,grupo_id:a.dato.grupo.id,year_id:e},f.post("::matriculas/matricular-en",c).then(function(c){return c=c.data,"Ya matriculado"===c?void g.warning("Ya tiene matrícula en ese grupo"):(a.alumno.matricula_id=c.id,a.alumno.grupo_id=c.grupo_id,g.success("Alumno matriculado con éxito","Matriculado"),b.close(a.alumno))},function(a){return g.error("No se pudo matricular el alumno.","Error")})):void g.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MatriculasDetallesCtrl",["$scope","App","$state","$uibModal","$filter","AuthService","toastr","$http",function(a,b,c,d,e,f,g,h){f.verificar_acceso(),a.year_ant=a.USER.year-1,a.perfilPath=b.images+"perfil/",a.views=b.views,a.matricula_detalle=!1,a.matric_cargando=!1,a.detallesAlumno=function(){return h.put("::detalles/alumno",{year_id:a.USER.year_id,alumno_id:parseInt(c.params.alumno_id)}).then(function(b){return a.matriculas=b.data})},a.detallesAlumno(),a.matricSeleccionada=function(b){var c,d,e,f,g;for(g=a.matriculas,e=0,f=g.length;f>e;e++)d=g[e],d.matricula_id===b.matricula_id?d.seleccionada=!0:d.seleccionada=!1;return c={alumno_id:b.alumno_id,year_id:b.year_id,matricula_id:b.matricula_id},a.matric_cargando=!0,a.matricula_detalle=!1,h.put("::detalles/grupos-periodos",c).then(function(c){var d,e,f,g,h;for(c=c.data,a.matricula_detalle=c,a.matric_cargando=!1,g=a.matricula_detalle,h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(d.year=b.year);return h})},a.eliminarMatric=function(b){var c;return c=!1,c=confirm("¿Está seguro que quiere eliminar la matricula "+b+" definitivamente?"),c?h.put("::detalles/eliminar-matricula-destroy",{matricula_id:b}).then(function(c){return 0===parseInt(c.data)?g.warning("No se eliminó matricula"):(g.success("Matricula "+b+" eliminada."),a.matriculas=e("filter")(a.matriculas,{matricula_id:"!"+b},!0))},function(a){return g.error("No se pudo eliminar la matricula "+b,"Error")}):void 0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").directive("matriculasDetallesPeriodosDir",[function(){return{restrict:"E",templateUrl:"==alumnos/matriculasDetallesPeriodos.tpl.html",controller:"MatriculasDetallesPeriodosCtrl"}}]).controller("MatriculasDetallesPeriodosCtrl",["$scope","App","$rootScope","$state","$interval","uiGridConstants","$uibModal","$filter","AuthService","toastr","$http",function(a,b,c,d,e,f,g,h,i,j,k){a.eliminarNotasPeriodo=function(a,b){var c;return c=confirm("¿Está seguro? estas notas no se podrán recuperar si las borra."),c?k.put("::detalles/eliminar-notas-periodo",{alumno_id:parseInt(d.params.alumno_id),grupo_id:b.id,periodo_id:a.id}).then(function(a){return 0===parseInt(a.data)?j.warning("No se eliminó ninguna nota"):j.success("Notas eliminadas: "+a.data)},function(a){return j.error("No se pudo eliminar las notas","Error")}):void 0},a.eliminarMatriculaDestroy=function(b,c){var d;return d=!1,d=1===b.length?confirm("Solo queda esta matricula para este grupo, ¿Está seguro que quiere eliminarla definitivamente?"):confirm("¿Está seguro que quiere eliminar la matricula "+c+" definitivamente?"),d?k.put("::detalles/eliminar-matricula-destroy",{matricula_id:c}).then(function(d){return 0===parseInt(d.data)?j.warning("No se eliminó matricula"):(j.success("Matricula "+c+" eliminada."),a.matriculas=h("filter")(a.matriculas,{matricula_id:"!"+c}),b=h("filter")(b,{matricula_id:"!"+c})),a.$parent.detallesAlumno()},function(a){return j.error("No se pudo eliminar la matricula "+c,"Error")}):void 0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("CarteraCtrl",["$scope","App","$state","$interval","$uibModal","$filter","AuthService","toastr","$http","uiGridConstants",function(a,b,c,d,e,f,g,h,i,j){var k,l,m;g.verificar_acceso(),a.dato={},a.gridOptions={},a.perfilPath=b.images+"perfil/",a.views=b.views,a.gridScope=a,a.dato.grupo="",i.get("::grupos").then(function(b){var c,d,e,f,g;for(d=0,localStorage.matr_grupo&&(d=parseInt(localStorage.matr_grupo)),a.grupos=b.data,g=a.grupos,e=0,f=g.length;f>e;e++)c=g[e],c.id===d&&(a.dato.grupo=c);return a.traerAlumnos(a.dato.grupo)}),a.onGrupoSelect=function(b,c){return b?(localStorage.setItem("matr_grupo",b.id),a.traerAlumnos(b)):void 0},a.editar=function(a){return console.log(a.alumno_id),c.go("panel.cartera.editar",{alumno_id:a.alumno_id})},k='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l="==directives/botonesPazysalvo.tpl.html",m="==directives/botonesResetPassword.tpl.html",a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEdit:!0,enableCellEditOnFocus:!0,columnDefs:[{name:"no",displayName:"No",width:45,enableCellEdit:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row)+1}}</div>'},{name:"edicion",displayName:"Edición",width:30,enableSorting:!1,enableFiltering:!1,cellTemplate:k,enableCellEdit:!1,enableColumnMenu:!0},{field:"foto_nombre",displayName:"Foto",cellTemplate:'<img width="35px" ng-src="{{grid.appScope.perfilPath + grid.getCellValue(row, col)}}">',width:40},{field:"nombres",minWidth:80,filter:{condition:function(a,b,c){var d;return d=c.entity,d.nombres.toLowerCase().indexOf(a.toLowerCase())>-1}},enableHiding:!1},{field:"apellidos",minWidth:80,filter:{condition:j.filter.CONTAINS}},{field:"sexo",width:60},{field:"nombre_grupo",displayName:"Grupo"},{field:"username",filter:{condition:j.filter.CONTAINS},displayName:"Usuario",cellTemplate:m,minWidth:150},{field:"deuda",displayName:"Deuda",cellTemplate:l,minWidth:150}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&("sexo"===c.field?"M"===d||"F"===d?i.put("::alumnos/update/"+b.alumno_id,b).then(function(a){return h.success("Alumno(a) actualizado con éxito","Actualizado")},function(a){return h.error("Cambio no guardado","Error")}):(h.warning("Debe usar M o F"),b.sexo=e):i.put("::alumnos/update/"+b.alumno_id,b).then(function(a){return h.success("Alumno(a) actualizado con éxito","Actualizado")},function(a){return h.error("Cambio no guardado","Error")})),a.$apply()})}},a.traerAlumnos=function(b){return i.put("::cartera/alumnos",{grupo_actual:b}).then(function(b){return a.gridOptions.data=b.data,a.gridOptions.columnDefs[6].visible=!1,a.gridApi.grid.refresh()})},a.cambiarPazysalvo=function(a){return a.pazysalvo=!a.pazysalvo,i.put("::alumnos/update/"+a.alumno_id,a).then(function(a){return console.log("Cambios guardados")},function(b){return a.pazysalvo=!a.pazysalvo,h.error("Cambio no guardado","Error")})},a.resetPass=function(a){var c;return c=e.open({templateUrl:b.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return a}}}),c.result.then(function(a){})},a.traerSoloDeudores=function(b){return i.put("::cartera/solo-deudores",{year_id:a.USER.year_id}).then(function(b){return a.gridOptions.data=b.data,a.gridOptions.columnDefs[6].visible=!0,a.gridApi.grid.refresh()})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("AcudientesCtrl",["$scope","App","$state","$interval","$uibModal","$filter","AuthService","toastr","$http","uiGridConstants",function(a,b,c,d,e,f,g,h,i,j){var k,l,m;g.verificar_acceso(),a.dato={},a.gridOptions={},a.perfilPath=b.images+"perfil/",a.views=b.views,a.gridScope=a,a.dato.grupo="",i.get("::grupos").then(function(b){var c,d,e,f,g;
for(c=0,localStorage.acud_grupo&&(c=parseInt(localStorage.acud_grupo)),a.grupos=b.data,g=a.grupos,e=0,f=g.length;f>e;e++)d=g[e],d.id===c&&(a.dato.grupo=d);return a.traerAcudientes(a.dato.grupo)}),a.onGrupoSelect=function(b,c){return b?(localStorage.setItem("acud_grupo",b.id),a.traerAcudientes(b)):void 0},a.editar=function(a){return console.log(a),c.go("panel.acudientes.editar",{acudiente_id:a.acudiente_id})},k='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l="==directives/botonesPazysalvo.tpl.html",m="==directives/botonesResetPassword.tpl.html",a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEdit:!0,enableCellEditOnFocus:!0,columnDefs:[{name:"no",displayName:"No",width:45,enableCellEdit:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row)+1}}</div>'},{name:"edicion",displayName:"Edición",width:30,enableSorting:!1,enableFiltering:!1,cellTemplate:k,enableCellEdit:!1,enableColumnMenu:!0},{field:"foto_nombre",displayName:"Foto",cellTemplate:'<img width="35px" ng-src="{{grid.appScope.perfilPath + grid.getCellValue(row, col)}}">',width:40},{field:"nombres",minWidth:80,filter:{condition:function(a,b,c){var d;return d=c.entity,d.nombres.toLowerCase().indexOf(a.toLowerCase())>-1}},enableHiding:!1},{field:"apellidos",minWidth:80,filter:{condition:j.filter.CONTAINS}},{field:"sexo",width:60},{field:"nombre_grupo",displayName:"Grupo"},{field:"username",filter:{condition:j.filter.CONTAINS},displayName:"Usuario",cellTemplate:m,minWidth:150},{field:"deuda",displayName:"Deuda",cellTemplate:l,minWidth:150}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&("sexo"===c.field?"M"===d||"F"===d?i.put("::alumnos/update/"+b.alumno_id,b).then(function(a){return h.success("Alumno(a) actualizado con éxito","Actualizado")},function(a){return h.error("Cambio no guardado","Error")}):(h.warning("Debe usar M o F"),b.sexo=e):i.put("::alumnos/update/"+b.alumno_id,b).then(function(a){return h.success("Alumno(a) actualizado con éxito","Actualizado")},function(a){return h.error("Cambio no guardado","Error")})),a.$apply()})}},a.traerAcudientes=function(b){return i.put("::acudientes/datos",{grupo_actual:b}).then(function(b){return a.gridOptions.data=b.data,a.gridOptions.columnDefs[6].visible=!1,a.gridApi.grid.refresh()})},a.cambiarPazysalvo=function(a){return a.pazysalvo=!a.pazysalvo,i.put("::alumnos/update/"+a.alumno_id,a).then(function(a){return console.log("Cambios guardados")},function(b){return a.pazysalvo=!a.pazysalvo,h.error("Cambio no guardado","Error")})},a.resetPass=function(a){var c;return c=e.open({templateUrl:b.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return a}}}),c.result.then(function(a){})}}]).controller("QuitarAcudienteModalConfirmCtrl",["$scope","$uibModalInstance","alumno","acudiente","$http","toastr","App",function(a,b,c,d,e,f,g){return a.alumno=c,a.acudiente=d,a.perfilPath=g.images+"perfil/",a.ok=function(){return e.put("::acudientes/quitar-parentesco-alumno",{alumno_id:c.alumno_id,parentesco_id:d.parentesco_id}).then(function(a){return f.success("Alumno enviado a la papelera.","Eliminado"),b.close(d)},function(a){return f.warning("No se pudo enviar a la papelera.","Problema")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NewAcudienteModalCtrl",["$scope","App","$uibModalInstance","alumno","paises","tipos_doc","parentescos","$http","toastr","$filter","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k){return a.alumno=d,a.paises=e,a.parentescos=g,a.datos={},a.tipos_doc=f,a.crearTabSelected=!1,a.selectTabSelected=!0,a.perfilPath=b.images+"perfil/",a.acudiente={sexo:"M",parentesco:a.parentescos[0],tipo_doc:a.tipos_doc[0]},a.acudientes=[],a.selectCrearTab=function(){return a.crearTabSelected=!0,a.selectTabSelected=!1},a.selectSelectTab=function(){return a.crearTabSelected=!1,a.selectTabSelected=!0},a.cancel=function(){return c.dismiss("cancel")},a.$on("modal.closing",function(a,b,c){switch(b){case"backdrop click":case"escape key press":if(!confirm("¿Seguro que quiere cerrar sin guardar acudiente?"))return a.preventDefault()}}),h.put("::acudientes/ultimos").then(function(b){return a.sin_repetir(b.data)}),a.refreshAcudientes=function(b){return b?h.put("::acudientes/buscar",{termino:b}).then(function(b){return a.sin_repetir(b.data)},function(a){return i.warning("No se pudo encontrar nada.","Problema")}):void 0},a.sin_repetir=function(b){var c,e,f,g,h,i,j,k;for(f=[],g=0,i=b.length;i>g;g++){for(c=b[g],a.existe=!1,k=d.subGridOptions.data,h=0,j=k.length;j>h;h++)e=k[h],e.id===c.id&&(a.existe=!0);a.existe||f.push(c)}return a.acudientes=f},a.paisNacSelect=function(b,c){return h.get("::ciudades/departamentos/"+b.id).then(function(b){return a.departamentosNac=b.data})},a.departNacSelect=function(b){return h.get("::ciudades/por-departamento/"+b.departamento).then(function(c){return a.ciudadesNac=c.data,"undefined"==typeof a.acudiente.departamento_doc?(a.acudiente.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b,c){return h.get("::ciudades/departamentos/"+b.id).then(function(c){var d,e,f,g,h;if(a.departamentos=c.data,"undefined"==typeof a.acudiente.pais_nac){for(g=a.paises,h=[],e=0,f=g.length;f>e;e++)d=g[e],d.id===b.id?(a.acudiente.pais_nac=d,h.push(a.paisNacSelect(d))):h.push(void 0);return h}})},a.departSeleccionado=function(b){return h.get("::ciudades/por-departamento/"+b.departamento).then(function(b){return a.ciudades=b.data})},a.dateOptions={formatYear:"yy"},a.restarEstrato=function(){return a.alumno.estrato>0?a.alumno.estrato=a.alumno.estrato-1:void 0},a.sumarEstrato=function(){return a.alumno.estrato<10?a.alumno.estrato=a.alumno.estrato+1:void 0},a.crearAcudiente=function(){return a.acudiente.alumno_id=d.alumno_id,h.post("::acudientes/crear",a.acudiente).then(function(a){return i.success("Acudiente creado con éxito."),c.close(a.data)},function(a){return i.warning("No se pudo crear al alumno.","Problema")})},a.seleccionarAcudiente=function(){var b;return b={acudiente_id:a.datos.acudiente.id,alumno_id:d.alumno_id,parentesco:a.acudiente.parentesco.parentesco,ocupacion:a.acudiente.ocupacion},k.acudiente_cambiar&&(b.parentesco_acudiente_cambiar_id=k.acudiente_cambiar.parentesco_id),h.put("::acudientes/seleccionar-parentesco",b).then(function(a){return i.success("Acudiente seleccionado."),delete k.acudiente_cambiar,c.close(a.data)},function(a){return i.warning("No se pudo seleccionar.","Problema")})},a.ocupacionCheck=function(b){return a.verificandoOcupacion=!0,h.put("::acudientes/ocupaciones-check",{texto:b}).then(function(b){return a.ocupaciones_match=b.data.ocupaciones,a.verificandoOcupacion=!1,a.ocupaciones_match.map(function(a){return a.ocupacion})})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CambiarCiudadModalCtrl",["$scope","$uibModalInstance","persona","paises","tipo_ciudad","tipo_persona","$http","toastr","$filter",function(a,b,c,d,e,f,g,h,i){return a.persona=c,a.paises=d,a.tipo_ciudad=e,a.modificarCiudades=!1,a.datos={},a.creando_ciudad=!1,a.creando_departamento=!1,a.creando_pais=!1,a.ciudad_new="",a.departamento_new="",a.pais_new="",a.modificando_depart=!1,a.crearCiudad=function(){return a.creando_ciudad=!0,a.$broadcast("paisSeleccionadoEvent2")},a.crearDepartamento=function(){return a.creandodepartamento=!0},a.crearPais=function(){return a.creandopais=!0},a.guardarCiudad=function(b,c){var d;return a.datos.pais?a.datos.departamento||""!==c?""===b?void h.warning("Debe escribir la nueva ciudad."):(d=a.datos.departamento?departamento.departamento:c,g.post("::ciudades/guardar-ciudad",{ciudad:b,departamento:d,pais_id:a.datos.pais.id}).then(function(b){return h.success("Creado correctamente: "+b.data.ciudad),a.datos.departamento&&a.ciudades.push(b.data),a.creandociudad=!1,a.ciudad_new="",a.departamento_new="",a.guardar=!0,g.get("::paises").then(function(b){return a.paises=b.data,a.paisSelect(i("filter")(a.paises,{id:1})[0])},function(a){return h.error("No se pudo traer las ciudades.")})},function(a){return h.error("No se pudo crear","Error")})):void h.warning("Debe seleccionar departamento o escribir uno nuevo."):void h.warning("Debes seleccionar un pais.")},a.guardarPais=function(){return g.post("::paises/guardar",a.pais_new).then(function(b){return h.success("Creado correctamente: "+b.data.paisnuevo),a.paises.push(b.data),a.paisSelect(a.ciudad_new.pais)},function(a){return h.error("No se pudo crear","Error")})},a.escribeEnDepartamentoNew=function(){return a.datos.departamento=void 0},a.actualizarCiudad=function(a){return g.put("::ciudades/actualizar-ciudad",a).then(function(b){return h.success("Actualizado: "+a.ciudad),a.editandoCiudad=!1},function(a){return h.error("No se pudo actualizar","Error")})},a.actualizarDepartamento=function(b){return g.put("::ciudades/actualizar-departamento",b).then(function(c){var d,e,f,g,i;for(h.success("Actualizado: "+b.departamento),b.editandoDepart=!1,e=a.ciudad_new.pais,i=a.ciudades,f=0,g=i.length;g>f;f++)d=i[f],d.departamento=b.departamento;return a.modificando_depart=!0},function(a){return h.error("No se pudo actualizar","Error")})},a.actualizarPais=function(a){return g.put("::paises/actualizar",a).then(function(b){return h.success("Actualizado: "+a.pais),a.editandoPais=!1,a.editandoAbrev=!1},function(a){return h.error("No se pudo actualizar","Error")})},a.paisSelect=function(b,c){return g.put("::ciudades/departamentos-by-id",{pais_id:b.id}).then(function(d){return a.departamentos=d.data.departamentos,"undefined"==typeof a.datos.pais&&(a.datos.pais=b),a.$broadcast("paisSeleccionadoEvent"+c)})},a.paisSelect(i("filter")(a.paises,{id:1})[0],1),a.departamentoSelect=function(b,c){return b?(a.departamento_new="",g.get("::ciudades/por-departamento/"+b.departamento).then(function(d){return a.ciudades=d.data,"undefined"==typeof a.datos.departamento&&(a.datos.departamento=b),a.$broadcast("departamentoSeleccionadoEvent"+c)})):void 0},a.eliminarCiudad=function(b){return g["delete"]("::ciudades/destroy/"+b.id).then(function(c){return h.success("Ciudad enviada a la papelera.","Eliminado"),a.ciudades=i("filter")(a.ciudades,{id:"!"+b.id})},function(a){return h.warning("No se pudo enviar a la papelera.","Problema")})},a.ok=function(d){var i,j;if(!a.seleccionandoCiudad)return a.seleccionandoCiudad=!0,i=a.datos.ciudad,d&&(i=d),j={propiedad:e,valor:i.id},"acudiente"===f?(j.acudiente_id=c.id,j.parentesco_id=c.parentesco_id,j.user_acud_id=c.user_id):j.alumno_id=c.alumno_id,g.put("::"+f+"s/guardar-valor",j).then(function(a){return h.success("Seleccionado."),c[e+"_nombre"]=i.ciudad,c[e]=i.id,b.close(c)},function(a){return h.warning("No se pudo seleccionar.","Problema")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(a,b,c,d){return a.state("panel.notas",{url:"^/notas/:asignatura_id/:profesor_id",views:{maincontent:{templateUrl:"==notas/notas.tpl.html",controller:"NotasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas"}]}}},resolve:{escalas:["EscalasValorativasServ",function(a){return a.escalas()}]},data:{displayName:"Notas",icon_fa:"fa fa-graduation-cap",needed_permissions:[d.can_work_like_teacher,d.can_work_like_admin,d.can_edit_notas],pageTitle:"Notas - MyVc"}}).state("panel.definitivas_periodos",{url:"^/definitivas-periodos/:profesor_id",params:{profesor_id:{value:null}},views:{maincontent:{templateUrl:"==notas/definitivasPeriodos.tpl.html",controller:"DefinitivasPeriodosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Definitivas periodos"}]}}},resolve:{escalas:["EscalasValorativasServ",function(a){return a.escalas()}],asignaturas_definitivas:["$http","AuthService","$stateParams",function(a,b,c){return b.hasRoleOrPerm(["alumno","acudiente"])?"Sin alumnos":c.profesor_id?a.get("::definitivas_periodos",{params:{profesor_id:c.profesor_id}}):a.get("::definitivas_periodos")}]},data:{displayName:"Notas",icon_fa:"fa fa-graduation-cap",needed_permissions:[d.can_work_like_teacher,d.can_work_like_admin,d.can_edit_notas],pageTitle:"Definitivas - MyVc"}}).state("panel.comportamiento",{url:"^/comportamiento/:grupo_id",views:{maincontent:{templateUrl:"==notas/comportamiento.tpl.html",controller:"ComportamientoCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Comportamiento"}]}}},resolve:{comportamiento:["ComportamientoServ","$stateParams",function(a,b){return a.detallados(b.grupo_id)}]},data:{displayName:"Comportamiento",icon_fa:"fa fa-street-view",needed_permissions:[d.can_work_like_teacher,d.can_work_like_admin,d.can_edit_notas],pageTitle:"Comportamiento - MyVc"}}).state("panel.notas_alumno",{url:"^/notas_alumno/:alumno_id",params:{alumno_id:{value:null}},views:{maincontent:{templateUrl:"==notas/notasAlumno.tpl.html",controller:"NotasAlumnoCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas alumno"}]}}},resolve:{alumnos:["$http","AuthService","resolved_user",function(a,b,c){return b.hasRoleOrPerm(["alumno","acudiente"])?"Sin alumnos":a.get("::alumnos/sin-matriculas")}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]},data:{displayName:"Notas alumno",icon_fa:"fa fa-graduation-cap",needed_permissions:[d.can_work_like_student,d.can_work_like_teacher,d.can_work_like_admin,d.can_edit_notas],pageTitle:"Notas alumno - MyVc"}}).state("panel.notas_perdidas_profesor_edit",{url:"^/notas_perdidas_profesor_edit",views:{maincontent:{templateUrl:"==notas/notasPerdidasProfesorEdit.tpl.html",controller:"NotasPerdidasProfesorEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas perdidas a editar"}]}}},data:{displayName:"Notas perdidas a editar",icon_fa:"fa fa-graduation-cap",needed_permissions:[d.can_work_like_teacher,d.can_work_like_admin,d.can_edit_notas],pageTitle:"Notas perdidas a editar - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").filter("juicioValorativo",[function(){return function(a,b,c){var d;return d={},angular.forEach(b,function(b){return a>=b.porc_inicial&&a<=b.porc_final?(d.desempenio=b.desempenio,d.valoracion=b.valoracion):void 0}),c?d.desempenio:d.valoracion}}]).filter("soloAsignaturasConPerdidas",["$filter",function(a){return function(b,c){return c?(this.asignaturas_resp=[],angular.forEach(b,function(b){var c;return c=a("soloUnidadesConPerdidas")(b.unidades,!0),c.length?this.asignaturas_resp.push(b):void 0}),this.asignaturas_resp):b}}]).filter("soloUnidadesConPerdidas",["$filter",function(a){return function(b,c){return c?(this.unidades_resp=[],angular.forEach(b,function(b){var c;return c=a("soloSubunidadesPerdidas")(b.subunidades,!0),c.length?this.unidades_resp.push(b):void 0}),this.unidades_resp):b}}]).filter("soloSubunidadesPerdidas",["Perfil",function(a){return function(b,c){return c?(this.subunidades_resp=[],angular.forEach(b,function(b){return b.nota&&b.nota.nota<a.User().nota_minima_aceptada?this.subunidades_resp.push(b):void 0}),this.subunidades_resp):b}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NotasCtrl",["$scope","toastr","$http","$uibModal","$state","$rootScope","$filter","App","AuthService","$timeout","EscalasValorativasServ","$stateParams","NotasServ",function(a,b,c,d,e,f,g,h,i,j,k,l,m){i.verificar_acceso(),a.asignatura={},a.asignatura_id=e.params.asignatura_id,a.datos={},a.UNIDAD=a.USER.unidad_displayname,a.SUBUNIDAD=a.USER.subunidad_displayname,a.UNIDADES=a.USER.unidades_displayname,a.SUBUNIDADES=a.USER.subunidades_displayname,a.perfilPath=h.images+"perfil/",a.views=h.views,a.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.ocultando_ausencias=!0,a.ausencia_edit={},a.tardanza_edit={},a.alumno_aus_tard_edit={},a.opts_picker={minDate:new Date("1/1/2017"),showWeeks:!1,startingDay:0},a.hasRoleOrPerm=i.hasRoleOrPerm,m.detalladas(l.asignatura_id,l.profesor_id,!0).then(function(b){return a.asignatura=b.asignatura,a.alumnos=b.alumnos,a.unidades=b.unidades,a.asignaturas=b.asignaturas,a.arreglarDatos()},function(a){return b.error("No se pudo traer las notas con asignaturas.")}),k.escalas().then(function(b){return a.escalas=b},function(a){return console.log("No se trajeron las escalas valorativas",a)}),a.escala_maxima=k.escala_maxima(),a.arreglarDatos=function(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;for(a.subunidadesunidas=[],u=a.unidades,h=0,m=u.length;m>h;h++)for(g=u[h],0===g.subunidades.length&&a.subunidadesunidas.push({empty:!0}),v=g.subunidades,i=0,n=v.length;n>i;i++)e=v[i],a.subunidadesunidas.push(e);for(localStorage.ocultando_ausencias&&(a.ocultando_ausencias="true"===localStorage.ocultando_ausencias),localStorage.historial_activado&&(a.historial_activado="true"===localStorage.historial_activado),w=a.alumnos,k=0,o=w.length;o>k;k++){for(b=w[k],x=b.ausencias,l=0,p=x.length;p>l;l++)d=x[l],d.fecha_hora&&(d.fecha_hora=new Date(d.fecha_hora));for(y=b.tardanzas,s=0,q=y.length;q>s;s++)f=y[s],f.fecha_hora&&(f.fecha_hora=new Date(f.fecha_hora))}for(z=a.asignaturas,t=0,r=z.length;r>t;t++)c=z[t],parseInt(c.asignatura_id)===parseInt(a.asignatura.asignatura_id)&&(c.active=!0);return j(function(){return localStorage.tab_horiz_or_verti&&"vertical"===localStorage.tab_horiz_or_verti?a.setTabVertically():a.setTabHorizontally()},1)},a.setTabVertically=function(){var b;return localStorage.tab_horiz_or_verti="vertical",a.tab_horiz_or_verti="vertical",b=angular.element("table tr"),angular.forEach(b,function(a,b){var c,d;return c=angular.element(a),d=c.find(".input-nota"),angular.forEach(d,function(a,b){var c;return c=angular.element(a),c.attr("tabindex",b+1)})}),a.eleFocus&&a.eleFocus.focus?a.eleFocus.focus():void 0},a.setTabHorizontally=function(){var b;return localStorage.tab_horiz_or_verti="horizontal",a.tab_horiz_or_verti="horizontal",b=angular.element(".input-nota"),angular.forEach(b,function(a,b){var c;return c=angular.element(a),c.attr("tabindex",b+1)}),a.eleFocus?a.eleFocus.focus():void 0},a.onInputFocus=function(b){return a.eleFocus=b.currentTarget},a.traerNotasDeAsignatura=function(b){var c,d,f,g;for(e.go(".",{asignatura_id:b.asignatura_id},{notify:!1}),m.detalladas(b.asignatura_id,b.profesor_id,!1).then(function(b){return a.asignatura=b.asignatura,a.alumnos=b.alumnos,a.unidades=b.unidades,a.arreglarDatos()}),g=a.asignaturas,d=0,f=g.length;f>d;d++)c=g[d],c.active=!1;return b.active=!0,a.asignatura_id=b.asignatura_id},a.toggleHistorial=function(){return a.historial_activado=!a.historial_activado,localStorage.historial_activado=a.historial_activado,a.historial_activado?b.info("Ahora dale doble click a la nota que quieres ver"):void 0},a.toggleAusencias=function(){return a.ocultando_ausencias=!a.ocultando_ausencias,localStorage.ocultando_ausencias=a.ocultando_ausencias},a.cambiaAusencia=function(d){var e,f,h,i,j,k,l,m,n,o;if(d.ausencias_count>d.ausencias.length){for(i=d.ausencias_count-d.ausencias.length,n=[],h=j=0,l=i-1;l>=0?l>=j:j>=l;h=l>=0?++j:--j)f={alumno_id:d.alumno_id,asignatura_id:a.asignatura_id,cantidad_ausencia:1},n.push(c.post("::ausencias/store",f).then(function(a){return a=a.data,d.ausencias.push(a)},function(a){return b.warning("No se pudo agregar ausencia.","Problema")}));return n}if(d.ausencias_count<d.ausencias.length){for(i=d.ausencias.length-d.ausencias_count,o=[],h=k=0,m=i-1;m>=0?m>=k:k>=m;h=m>=0?++k:--k)e=d.ausencias[d.ausencias.length-h-1].id,o.push(c["delete"]("::ausencias/destroy/"+e).then(function(a){return a=a.data,d.ausencias=g("filter")(d.ausencias,{id:"!"+a.id})},function(a){return b.warning("No se pudo quitar ausencia.","Problema")}));return o}},a.cambiaTardanza=function(d){var e,f,h,i,j,k,l,m,n,o;if(d.tardanzas_count>d.tardanzas.length){for(h=d.tardanzas_count-d.tardanzas.length,n=[],f=j=0,l=h-1;l>=0?l>=j:j>=l;f=l>=0?++j:--j)e={alumno_id:d.alumno_id,asignatura_id:a.asignatura_id,cantidad_tardanza:1},n.push(c.post("::ausencias/store",e).then(function(a){return a=a.data,d.tardanzas.push(a)},function(a){return b.warning("No se pudo agregar tardanza.","Problema")}));return n}if(d.tardanzas_count<d.tardanzas.length){for(h=d.tardanzas.length-d.tardanzas_count,o=[],f=k=0,m=h-1;m>=0?m>=k:k>=m;f=m>=0?++k:--k)i=d.tardanzas[d.tardanzas.length-f-1].id,o.push(c["delete"]("::ausencias/destroy/"+i).then(function(a){return a=a.data,d.tardanzas=g("filter")(d.tardanzas,{id:"!"+a.id})},function(a){return b.warning("No se pudo quitar tardanza.","Problema")}));return o}},a.clickAusenciaObject=function(b,c){return b.backup=b.fecha_hora,b.fecha_hora?b.fecha_hora=new Date(b.fecha_hora):b.fecha_hora=new Date,a.ausencia_edit=b,a.alumno_aus_tard_edit=c,b.isOpen=!b.isOpen},a.clickTardanzaObject=function(b,c){return b.backup=b.fecha_hora,b.fecha_hora?b.fecha_hora=new Date(b.fecha_hora):b.fecha_hora=new Date,a.tardanza_edit=b,a.alumno_aus_tard_edit=c,b.isOpen=!b.isOpen},a.guardarCambioAusencia=function(d){var e;return e={ausencia_id:d.id,fecha_hora:g("date")(d.fecha_hora,"yyyy-MM-dd HH:mm:ss")},c.put("::ausencias/guardar-cambios-ausencia",e).then(function(b){return b=b.data,alumno.tardanzas.push(b),a.ausencia_edit.isOpen=!1,a.tardanza_edit.isOpen=!1},function(a){return b.warning("No se pudo agregar tardanza.","Problema")})},a.cancelarCambioAusencia=function(a){return a.isOpen=!1},a.cancelarCambioTardanza=function(a){return a.isOpen=!1},a.eliminarAusencia=function(a,d){return c["delete"]("::ausencias/destroy/"+a.id).then(function(b){return b=b.data,d.ausencias=g("filter")(d.ausencias,{id:"!"+b.id}),a.isOpen=!1},function(a){return b.warning("No se pudo quitar ausencia.","Problema")})},a.eliminarTardanza=function(a,d){return c["delete"]("::ausencias/destroy/"+a.id).then(function(b){return b=b.data,d.tardanzas=g("filter")(d.tardanzas,{id:"!"+b.id}),a.isOpen=!1},function(a){return b.warning("No se pudo quitar tardanza.","Problema")})},a.cambiaNotaDef=function(d,e,f){return e>a.escala_maxima.porc_final||"undefined"===e||void 0===e?void b.error("No puede ser mayor de "+a.escala_maxima.porc_final,"NO guardada",{timeOut:8e3}):c.put("::definitivas_periodos/update",{nf_id:f,nota:e}).then(function(a){return d.nota_final.manual||(d.nota_final.manual=1),b.success("Cambiada: "+e)},function(a){return b.error("No pudimos guardar la nota "+e,"",{timeOut:8e3})})},a.toggleNotaFinalRecuperada=function(a,d,e){return c.put("::definitivas_periodos/toggle-recuperada",{nf_id:e,recuperada:d}).then(function(c){return d&&!a.nota_final.manual?(a.nota_final.manual=1,b.success("Indicará que es recuperada, así que también será manual.")):d?b.success("Recuperada"):b.success("No recuperada")},function(a){return b.error("No pudimos cambiar.","",{timeOut:8e3})})},a.toggleNotaFinalManual=function(a,d,e){return c.put("::definitivas_periodos/toggle-manual",{nf_id:e,manual:d}).then(function(c){return!d&&a.nota_final.recuperada?(a.nota_final.recuperada=!1,b.success("Será automática y no recuperada.")):d?b.success("Nota manual."):b.success("Ahora la calculará el sistema.")},function(a){return b.error("No pudimos cambiar.","",{timeOut:8e3})})},a.cambiaNota=function(d,e){return d.nota>a.escala_maxima.porc_final||"undefined"===d.nota||void 0===d.nota?void b.error("No puede ser mayor de "+a.escala_maxima.porc_final,"NO guardada",{timeOut:8e3}):c.put("::notas/update/"+d.id,{nota:d.nota}).then(function(a){return b.success("Cambiada: "+d.nota),d.updated_at=d.updated_at},function(a){return b.error("No pudimos guardar la nota "+d.nota,"",{timeOut:8e3})})},a.showFrases=function(b){var e;return e=d.open({templateUrl:"==notas/showFrases.tpl.html",controller:"ShowFrasesCtrl",size:"lg",resolve:{alumno:function(){return b},frases:function(){return c.get("::frases")},asignatura:function(){return a.asignatura},USER:function(){return a.USER}}}),e.result.then(function(a){})},a.promedioTotal=function(a){var b,c,d,e,f,h;for(b=0,h=a.notas,e=0,f=h.length;f>e;e++)c=h[e],d=c.nota*c.subunidad_porc*c.unidad_porc,b+=d;return a.total_definit=parseInt(g("number")(b,0)),g("number")(b,1)},a.verDetalleNota=function(b,c){var e;a.historial_activado&&(e=d.open({templateUrl:"==notas/notaDetalleModal.tpl.html",controller:"NotaDetalleModalCtrl",resolve:{alumno:function(){return c},nota:function(){return b}}}),e.result.then(function(a){return"Eliminada"===a?b.eliminada=!0:void 0},function(){}))},a.verifClickNotaRapida=function(b){j(function(){var c;return f.notaRapida.enable?(b.backup?f.notaRapida.valorNota!==b.nota?(b.backup=b.nota,b.nota=f.notaRapida.valorNota):(c=b.backup,b.backup=b.nota,b.nota=c):(b.backup=b.nota,b.nota=f.notaRapida.valorNota),a.cambiaNota(b)):void 0})},a.columnaNotaRapida=function(d){j(function(){var e,g,h,i,j,k,l,m;if(f.notaRapida.enable){for(l=a.alumnos,m=[],j=0,k=l.length;k>j;j++)e=l[j],m.push(function(){var j,k,l,m;for(l=e.notas,m=[],j=0,k=l.length;k>j;j++)h=l[j],h.subunidad_id===d?(h.backup?f.notaRapida.valorNota!==h.nota?(h.backup=h.nota,h.nota=f.notaRapida.valorNota):(i=h.backup,h.backup=h.nota,h.nota=i):(h.backup=h.nota,h.nota=f.notaRapida.valorNota),g=0,m.push(c.put("::notas/update/"+h.id,{nota:h.nota}).then(function(c){return g+=1,g===a.alumnos.length-1?b.success(g+1+" notas guardadas."):void 0},function(a){return b.error("No pudimos guardar la nota "+h.nota,"",{timeOut:8e3})}))):m.push(void 0);return m}());return m}return b.info("Activa la Nota Rápida para cambiar todas las notas de esta columna.")})},a.filaNotaRapida=function(a,d){j(function(){var d,e,g,h,i,j,k;if(f.notaRapida.enable){for(j=a.notas,k=[],h=0,i=j.length;i>h;h++)e=j[h],e.backup?f.notaRapida.valorNota!==e.nota?(e.backup=e.nota,e.nota=f.notaRapida.valorNota):(g=e.backup,e.backup=e.nota,e.nota=g):(e.backup=e.nota,e.nota=f.notaRapida.valorNota),d=0,k.push(c.put("::notas/update/"+e.id,{nota:e.nota}).then(function(c){return d+=1,d===a.notas.length-1?b.success(d+1+" notas guardadas."):void 0},function(a){return b.error("No pudimos guardar la nota "+e.nota,"",{timeOut:8e3})}));return k}return b.info("Activa la Nota Rápida para cambiar todas las notas de este alumno.")})}}]).controller("ShowFrasesCtrl",["$scope","$uibModalInstance","alumno","frases","asignatura","$http","toastr","$filter","USER",function(a,b,c,d,e,f,g,h,i){return a.alumno=c,a.frases=d.data,a.asignatura=e,a.USER=i,a.alumno.newFrase="",f.get("::frases_asignatura/show/"+c.alumno_id+"/"+e.asignatura_id).then(function(b){return a.frases_asignatura=b.data},function(a){return g.warning("No se pudo traer frases.","Problema")}),a.addFrase=function(){var b;return""!==a.alumno.newFrase?(b={alumno_id:c.alumno_id,frase:a.alumno.newFrase,asignatura_id:a.asignatura.asignatura_id},f.post("::frases_asignatura/store",b).then(function(b){return a.frases_asignatura=b.data,g.success("Frase añadida.")},function(a){return g.warning("No se pudo añadir frase.","Problema")})):g.warning("No ha copiado ninguna frase")},a.addFrase_id=function(){var b;return a.alumno.newFrase_by_id?(b={alumno_id:c.alumno_id,frase_id:a.alumno.newFrase_by_id.id,asignatura_id:a.asignatura.asignatura_id},f.post("::frases_asignatura/store/"+a.alumno.newFrase_by_id.id,b).then(function(b){return g.success("Frase añadida."),a.frases_asignatura=b.data},function(a){return g.warning("No se pudo añadir frase.","Problema")})):g.warning("No ha seleccionado frase")},a.quitarFrase=function(b){return f["delete"]("::frases_asignatura/destroy/"+b.id).then(function(c){return g.success("Frase quitada"),a.frases_asignatura=h("filter")(a.frases_asignatura,{id:"!"+b.id})},function(a){return g.warning("No se pudo quitar la frase.","Problema")})},a.ok=function(){return b.close(c)}}]).controller("NotaDetalleModalCtrl",["$scope","$uibModalInstance","alumno","nota","AuthService","$http","toastr","$filter",function(a,b,c,d,e,f,g,h){return a.alumno=c,a.nota=d,a.hasRoleOrPerm=e.hasRoleOrPerm,f.put("::historiales/nota-detalle",{nota_id:d.id}).then(function(b){return a.cambios=b.data.cambios,a.nota_detalle=b.data.nota},function(a){return g.warning("No se pudo traer el historial.","Problema")}),a.eliminarNota=function(){return f["delete"]("::notas/destroy/"+d.id).then(function(a){return g.success("Nota eliminada","Puede recargar y será creada de nuevo"),b.close("Eliminada")},function(a){return g.error("No se pudo eliminar nota.","Problema")})},a.ok=function(){return b.close(c)}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("DefinitivasPeriodosCtrl",["$scope","toastr","$http","$uibModal","$state","$rootScope","$filter","App","asignaturas_definitivas","AuthService","$timeout","EscalasValorativasServ",function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q;for(j.verificar_acceso(),a.asignatura={},a.asignatura_id=e.params.asignatura_id,a.datos={},a.UNIDAD=a.USER.unidad_displayname,a.SUBUNIDAD=a.USER.subunidad_displayname,a.UNIDADES=a.USER.unidades_displayname,a.SUBUNIDADES=a.USER.subunidades_displayname,a.perfilPath=h.images+"perfil/",a.views=h.views,a.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.opts_picker={minDate:new Date("1/1/2017"),showWeeks:!1,startingDay:0},a.dato={asignatura:{}},a.ocultando_ausencias=!0,a.escala_maxima=l.escala_maxima(),a.selectAsignatura=function(b){var c,d,e,f;for(localStorage.asignatura_id_def=b.asignatura_id,a.dato.asignatura=b,f=a.asignaturas,d=0,e=f.length;e>d;d++)c=f[d],c.active=!1;return b.active=!0},"Sin alumnos"===i&&(b.warning("No parece que tengas acceso"),e.go("panel")),a.asignaturas=i.data,n=0,a.USER.is_superuser&&(0===a.asignaturas.length?b.warning("Profesor no tiene asignaturas"):a.dato.asignatura.nombres_profesor=a.asignaturas[0].nombres_profesor),localStorage.asignatura_id_def&&(n=parseInt(localStorage.asignatura_id_def)),q=a.asignaturas,o=0,p=q.length;p>o;o++)m=q[o],parseInt(m.asignatura_id)===parseInt(n)&&(a.dato.asignatura=m,a.selectAsignatura(a.dato.asignatura));a.cambiaNotaDef=function(d,e,f,g){return e>a.escala_maxima.porc_final||"undefined"===e||void 0===e?void b.error("No puede ser mayor de "+a.escala_maxima.porc_final,"NO guardada",{timeOut:8e3}):f?c.put("::definitivas_periodos/update",{nf_id:f,nota:e}).then(function(a){return b.success("Cambiada: "+e)},function(a){return b.error("No pudimos guardar la nota "+e,"",{timeOut:8e3})}):c.put("::definitivas_periodos/update",{alumno_id:d.alumno_id,nota:e,asignatura_id:a.dato.asignatura.asignatura_id,periodo:g}).then(function(a){return b.success("Creada: "+e),a=a.data[0],d["nf_id_"+g]=a.id,d["nfinal"+g(NaN)]=0,d["periodo_id"+g]=a.periodo_id,d["recuperada_"+g]=0,d["manual_"+g]=1},function(a){return b.error("No pudimos guardar la nota "+e,"",{timeOut:8e3})})},a.toggleNotaRecuperada=function(a,d,e,f){return c.put("::definitivas_periodos/toggle-recuperada",{nf_id:e,recuperada:d}).then(function(c){return d&&!a["manual_"+f]?(a["manual_"+f]=1,b.success("Indicará que es recuperada, así que también será manual.")):d?b.success("Recuperada"):b.success("No recuperada")},function(a){return b.error("No pudimos guardar la recuperación.",{timeOut:8e3})})},a.toggleNotaManual=function(a,d,e,f){return c.put("::definitivas_periodos/toggle-manual",{nf_id:e,manual:d}).then(function(c){return!d&&a["recuperada_"+f]?(a["recuperada_"+f]=0,b.success("Será automática y no recuperada.")):d?b.success("Nota manual."):b.success("Ahora la calculará el sistema.")},function(a){return b.error("No pudimos guardar la recuperación.",{timeOut:8e3})})},a.promedioTotalDef=function(b){var c;return c=(b.nota_final_per1+b.nota_final_per2+b.nota_final_per3+b.nota_final_per4)/4,b.nota_requerida=0,b.total_definit=0,c<a.nota_minima_aceptada&&(b.nota_requerida=g("number")(a.nota_minima_aceptada-c,0)),
b.total_definit=parseFloat(g("number")(c,1)),b.total_definit},a.toggleAusencias=function(){return a.ocultando_ausencias=!a.ocultando_ausencias,localStorage.ocultando_ausencias=a.ocultando_ausencias},a.cambiaAusencia=function(d){var e,f,h,i,j,k,l,m,n,o;if(d.ausencias_count>d.ausencias.length){for(i=d.ausencias_count-d.ausencias.length,n=[],h=j=0,l=i-1;l>=0?l>=j:j>=l;h=l>=0?++j:--j)f={alumno_id:d.alumno_id,asignatura_id:a.asignatura_id,cantidad_ausencia:1},n.push(c.post("::ausencias/store",f).then(function(a){return a=a.data,d.ausencias.push(a)},function(a){return b.warning("No se pudo agregar ausencia.","Problema")}));return n}if(d.ausencias_count<d.ausencias.length){for(i=d.ausencias.length-d.ausencias_count,o=[],h=k=0,m=i-1;m>=0?m>=k:k>=m;h=m>=0?++k:--k)e=d.ausencias[d.ausencias.length-h-1].id,o.push(c["delete"]("::ausencias/destroy/"+e).then(function(a){return a=a.data,d.ausencias=g("filter")(d.ausencias,{id:"!"+a.id})},function(a){return b.warning("No se pudo quitar ausencia.","Problema")}));return o}},a.cambiaTardanza=function(d){var e,f,h,i,j,k,l,m,n,o;if(d.tardanzas_count>d.tardanzas.length){for(h=d.tardanzas_count-d.tardanzas.length,n=[],f=j=0,l=h-1;l>=0?l>=j:j>=l;f=l>=0?++j:--j)e={alumno_id:d.alumno_id,asignatura_id:a.asignatura_id,cantidad_tardanza:1},n.push(c.post("::ausencias/store",e).then(function(a){return a=a.data,d.tardanzas.push(a)},function(a){return b.warning("No se pudo agregar tardanza.","Problema")}));return n}if(d.tardanzas_count<d.tardanzas.length){for(h=d.tardanzas.length-d.tardanzas_count,o=[],f=k=0,m=h-1;m>=0?m>=k:k>=m;f=m>=0?++k:--k)i=d.tardanzas[d.tardanzas.length-f-1].id,o.push(c["delete"]("::ausencias/destroy/"+i).then(function(a){return a=a.data,d.tardanzas=g("filter")(d.tardanzas,{id:"!"+a.id})},function(a){return b.warning("No se pudo quitar tardanza.","Problema")}));return o}},a.clickAusenciaObject=function(b,c){return b.backup=b.fecha_hora,b.fecha_hora?b.fecha_hora=new Date(b.fecha_hora):b.fecha_hora=new Date,a.ausencia_edit=b,a.alumno_aus_tard_edit=c,b.isOpen=!b.isOpen},a.clickTardanzaObject=function(b,c){return b.backup=b.fecha_hora,b.fecha_hora?b.fecha_hora=new Date(b.fecha_hora):b.fecha_hora=new Date,a.tardanza_edit=b,a.alumno_aus_tard_edit=c,b.isOpen=!b.isOpen},a.guardarCambioAusencia=function(d){var e;return e={ausencia_id:d.id,fecha_hora:g("date")(d.fecha_hora,"yyyy-MM-dd HH:mm:ss")},c.put("::ausencias/guardar-cambios-ausencia",e).then(function(b){return b=b.data,alumno.tardanzas.push(b),a.ausencia_edit.isOpen=!1,a.tardanza_edit.isOpen=!1},function(a){return b.warning("No se pudo agregar tardanza.","Problema")})},a.cancelarCambioAusencia=function(a){return a.isOpen=!1},a.cancelarCambioTardanza=function(a){return a.isOpen=!1},a.eliminarAusencia=function(a,d){return c["delete"]("::ausencias/destroy/"+a.id).then(function(b){return b=b.data,d.ausencias=g("filter")(d.ausencias,{id:"!"+b.id}),a.isOpen=!1},function(a){return b.warning("No se pudo quitar ausencia.","Problema")})},a.eliminarTardanza=function(a,d){return c["delete"]("::ausencias/destroy/"+a.id).then(function(b){return b=b.data,d.tardanzas=g("filter")(d.tardanzas,{id:"!"+b.id}),a.isOpen=!1},function(a){return b.warning("No se pudo quitar tardanza.","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("NotasAlumnoCtrl",["$scope","toastr","$http","$uibModal","$state","alumnos","escalas","$rootScope","$filter","App","AuthService","Perfil","EscalasValorativasServ",function(a,b,c,d,e,f,g,h,i,j,k,l,m){if(k.verificar_acceso(),a.hasRoleOrPerm=k.hasRoleOrPerm,f=f.data,"Sin alumnos"===!f&&(a.filtered_alumnos=f),a.perfilPath=j.images+"perfil/",a.views=j.views,a.datos={grupo:""},a.USER=l.User(),a.USER.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.escalas=g,a.config={solo_notas_perdidas:!0},a.hasRoleOrPerm(["alumno","acudiente"])||c.get("::grupos").then(function(b){return b=b.data,a.grupos=b}),m.escalas().then(function(b){return a.escalas=b},function(a){return console.log("No se trajeron las escalas valorativas",a)}),a.escala_maxima=m.escala_maxima(),a.verNotasAlumno=function(d){return d||(d=a.datos.selected_alumno.alumno_id),c.get("::notas/alumno/"+d).then(function(c){return c=c.data,c[0]?a.periodos=c[0].periodos:(a.periodos=void 0,b.warning("Sin matrícula este año."))},function(a){return b.warning("Lo sentimos, No se trajeron las notas")})},e.params.alumno_id){if("Alumno"===a.USER.tipo)return void b.warning("No puedes ver otras notas");a.verNotasAlumno(e.params.alumno_id)}return"Alumno"===a.USER.tipo&&a.USER.pazysalvo&&a.verNotasAlumno(a.USER.persona_id),a.cambiaNotaDef=function(d,e,f){return e>a.escala_maxima.porc_final||"undefined"===e||void 0===e?void b.error("No puede ser mayor de "+a.escala_maxima.porc_final,"NO guardada",{timeOut:8e3}):c.put("::definitivas_periodos/update",{nf_id:f,nota:e}).then(function(a){return d.manual||(d.manual=1),b.success("Cambiada: "+e)},function(a){return b.error("No pudimos guardar la nota "+e,"",{timeOut:8e3})})},a.toggleNotaFinalRecuperada=function(a,d,e){return c.put("::definitivas_periodos/toggle-recuperada",{nf_id:e,recuperada:d}).then(function(c){return d&&!a.manual?(a.manual=1,b.success("Indicará que es recuperada, así que también será manual.")):d?b.success("Recuperada"):b.success("No recuperada")},function(a){return b.error("No pudimos cambiar.","",{timeOut:8e3})})},a.toggleNotaFinalManual=function(a,d,e){return c.put("::definitivas_periodos/toggle-manual",{nf_id:e,manual:d}).then(function(c){return!d&&a.nota_final.recuperada?(a.nota_final.recuperada=!1,b.success("Será automática y no recuperada.")):d?b.success("Nota manual."):b.success("Ahora la calculará el sistema.")},function(a){return b.error("No pudimos cambiar.","",{timeOut:8e3})})},a.cambiaNota=function(a,d){return c.put("::notas/update/"+a.id,{nota:a.nota}).then(function(c){return c=c.data,b.success("Cambiada: "+a.nota)},function(c){return b.error("No pudimos guardar la nota "+a.nota,"",{timeOut:8e3})})},a.selectGrupo=function(b){return b?a.filtered_alumnos=i("filter")(f,{grupo_id:b.id},!0):(a.filtered_alumnos=f,$cookieStore.put("requested_alumno","")),a.datos.selected_alumno=""}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NotasPerdidasProfesorEditCtrl",["$scope","toastr","$http","$uibModal","$state","$filter","App","AuthService",function(a,b,c,d,e,f,g,h){h.verificar_acceso(),a.hasRoleOrPerm=h.hasRoleOrPerm,a.datos={},a.grupos=[],a.profesores=[],a.perfilPath=g.images+"perfil/",a.views=g.views,h.hasRoleOrPerm(["profesor"])?c.put("::notas-perdidas/profesor-grupos",{profesor_id:a.USER.persona_id,periodo_a_calcular:a.USER.numero_periodo}).then(function(b){return a.grupos=b.data},function(a){return b.error("No se trajeron las notas")}):c.get("::contratos").then(function(b){return a.profesores=b.data},function(a){return b.error("No se trajeron los profesores")}),a.verNotasPerdidasProfesor=function(){return a.datos.profesor?c.put("::notas-perdidas/profesor-grupos",{profesor_id:a.datos.profesor.profesor_id,periodo_a_calcular:10}).then(function(b){return a.grupos=b.data},function(a){return b.error("No se trajeron las notas")}):b.warning("Debes elegir profesor")},a.cambiaNota=function(a){return c.put("::notas/update/"+a.nota_id,{nota:a.nota}).then(function(c){return c=c.data,b.success("Cambiada: "+a.nota)},function(c){return b.error("No pudimos guardar la nota "+a.nota,"",{timeOut:8e3})})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ComportamientoCtrl",["$scope","$filter","$state","comportamiento","$uibModal","App","$http","AuthService","toastr",function(a,b,c,d,e,f,g,h,i){return h.verificar_acceso(),a.perfilPath=f.images+"perfil/",a.profesor_id=localStorage.profesor_id,a.frases=d[0],a.alumnos=d[1],a.grupo=d[2],a.hasRoleOrPerm=h.hasRoleOrPerm,a.tipos=[{tipo_frase:"Todas"},{tipo_frase:"Debilidad"},{tipo_frase:"Amenaza"},{tipo_frase:"Oportunidad"},{tipo_frase:"Fortaleza"}],a.addFrase=function(a){var b;return a.agregando_frase=!0,a.newfrase?(b={comportamiento_id:a.nota.id,frase_id:a.newfrase.id},g.post("::definiciones_comportamiento/store",b).then(function(b){return i.success("Frase agregada con éxito"),a.newfrase.definicion_id=b.data.id,a.definiciones.push(a.newfrase),a.newfrase=null,a.agregando_frase=!1},function(b){return i.error("No se pudo agregar la frase","Problema"),a.agregando_frase=!1})):void i.warning("Debe seleccionar frase")},a.addFraseEscrita=function(a){var b;return a.agregando_frase=!0,""!==a.newfrase_escrita?(b={comportamiento_id:a.nota.id,frase:a.newfrase_escrita},g.post("::definiciones_comportamiento/store-escrita",b).then(function(b){return i.success("Frase agregada con éxito"),a.newfrase_escrita="",a.definiciones.push(b.data),a.agregando_frase=!1},function(b){return i.error("No se pudo agregar la frase","Problema"),a.agregando_frase=!1})):void i.warning("Debe escribir la frase")},a.cambiaNota=function(a){var b;return b=a.nota,g.put("::nota_comportamiento/update/"+a.id,{nota:a.nota}).then(function(b){return i.success("Nota cambiada: "+a.nota)},function(c){return i.error("No pudimos guardar la nota "+a.nota),a.nota=b})},a.quitarFrase=function(a,c){var d;return d=a.definicion_id?a.definicion_id:a.id,g["delete"]("::definiciones_comportamiento/destroy/"+d).then(function(e){return i.success("Definicion quitada"),a.definicion_id?c.definiciones=b("filter")(c.definiciones,{definicion_id:"!"+d}):c.definiciones=b("filter")(c.definiciones,{id:"!"+d})},function(a){return i.error("No pudimos quitar frase","Problema")})}}]).filter("porTipoFrase",[function(){return function(a,b){var c,d,e,f;if("Todas"===b||void 0===b)return a;for(d=[],e=0,f=a.length;f>e;e++)c=a[e],b===c.tipo_frase&&d.push(c);return d}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(a,b,c){a.state("panel.actividades",{url:"^/actividades?grupo_id&asign_id&compartidas",params:{grupo_id:null,asign_id:null,compartidas:null},views:{maincontent:{templateUrl:""+b.views+"actividades/actividades.tpl.html",controller:"ActividadesCtrl",resolve:{datos:["$q","$http","$stateParams",function(a,b,c){var d,e;return d=a.defer(),c.compartidas?b.put("::actividades/compartidas").then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)}):(e={grupo_id:c.grupo_id,asign_id:c.asign_id},b.put("::actividades/datos",e).then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)})),d.promise}]}},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Actividades"}]}}},data:{displayName:"Actividades",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Actividades - MyVc"}}),a.state("panel.respuestas",{url:"^/respuestas?actividad_id",params:{actividad_id:null},views:{maincontent:{templateUrl:""+b.views+"actividades/respuestas.tpl.html",controller:"RespuestasCtrl",resolve:{datos:["$q","$http","$stateParams",function(a,b,c){var d,e;return d=a.defer(),e={actividad_id:c.actividad_id},b.put("::respuestas/actividad",e).then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)}),d.promise}]}},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Respuestas"}]}}},data:{displayName:"Respuestas",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Respuestas - MyVc"}}),a.state("panel.mis_actividades",{url:"^/mis-actividades?alumno_id&asign_id",params:{alumno_id:null,asign_id:null},views:{maincontent:{templateUrl:""+b.views+"actividades/misActividades.tpl.html",controller:"MisActividadesCtrl",resolve:{datos:["$q","$http","$stateParams",function(a,b,c){var d,e;return d=a.defer(),e={alumno_id:c.alumno_id,asign_id:c.asign_id},b.put("::mis-actividades/datos",e).then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)}),d.promise}]}},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Mis actividades"}]}}},data:{displayName:"Mis actividades",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Mis actividades - MyVc"}}),a.state("panel.mi_actividad",{url:"^/mi-actividad?actividad_id",params:{actividad_id:null},views:{maincontent:{templateUrl:""+b.views+"actividades/miActividad.tpl.html",controller:"MiActividadCtrl",resolve:{datos:["$q","$http","$stateParams",function(a,b,c){var d,e;return d=a.defer(),e={actividad_id:c.actividad_id},b.put("::mis-actividades/mi-actividad",e).then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)}),d.promise}]}},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Actividad"}]}}},data:{displayName:"Actividad",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Actividad - MyVc"}}).state("panel.editar_actividad",{url:"^/editar-actividad?actividad_id",params:{actividad_id:null},views:{maincontent:{templateUrl:""+b.views+"actividades/editarActividad.tpl.html",controller:"EditarActividadCtrl",resolve:{datos:["$q","$http","$stateParams",function(a,b,c){var d,e;return e=a.defer(),d=0,d=c.actividad_id?c.actividad_id:localStorage.pregunta_edit.actividad_id,b.put("::actividades/edicion",{actividad_id:c.actividad_id}).then(function(a){var b,c,d,f,g;if(localStorage.pregunta_edit)for(g=a.data.actividad.preguntas,d=0,f=g.length;f>d;d++)b=g[d],c=JSON.parse(localStorage.pregunta_edit),b.id===c.id&&(localStorage.pregunta_edit=JSON.stringify(b));return e.resolve(a.data)},function(a){return e.reject(a)}),e.promise}]}},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar actividad"}]}}},data:{displayName:"Editar actividad",icon_fa:"fa fa-soccer-ball-o",pageTitle:"Editar actividad - MyVc"}}).state("panel.editar_actividad.pregunta",{url:"/pregunta?pregunta_id",views:{preguntacontent:{templateUrl:""+b.views+"actividades/editarPregunta.tpl.html",controller:"EditarPreguntaCtrl",resolve:{datos:["$q","$http","$stateParams","$location",function(a,b,c,d){var e,f;return e=a.defer(),c.pregunta_id?b.put("::preguntas/edicion",{pregunta_id:c.pregunta_id}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a)}):localStorage.pregunta_edit?(f=JSON.parse(localStorage.pregunta_edit),e.resolve(f)):(console.log("No se ha provisto id ni pregunta"),e.reject("No se ha provisto id ni pregunta")),e.promise}]}},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Pregunta"}]}}},data:{displayName:"Pregunta",icon_fa:"fa fa-question",pageTitle:"Pregunta - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ActividadesCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(a,b,c,d,e,f,g,h,i,j,k){h.verificar_acceso(),a.grupo_id=j.grupo_id,a.asign_id=j.asign_id,a.compartidas=j.compartidas,a.grupos=i.grupos,a.otras_asignaturas=i.otras_asignaturas,a.mis_asignaturas=i.mis_asignaturas,a.$state=d,a.actv_alumnos=i.actv_alumnos,a.actv_profes=i.actv_profes,a.actv_acudi=i.actv_acudi,a.actv_x_respon=i.actv_x_respon,a.perfilPath=b.images+"perfil/",a.views=b.views,c.menucompacto=!0,j.asign_id&&(a.grupo_id=i.grupo_id),a.crear=function(a){return e.post("::actividades/crear",{asignatura_id:a}).then(function(a){return a=a.data,k.success("Actividad creada","Ahora a editar"),d.go("panel.editar_actividad",{actividad_id:a.id})},function(a){return k.error("No se pudo crear actividad.","Error")})},a.eliminarActividad=function(a,c){var d;return d=f.open({templateUrl:b.views+"actividades/removeActividad.tpl.html",controller:"RemoveActividadCtrl",resolve:{actividad:function(){return a}}}),d.result.then(function(a){return c.actividades=g("filter")(c.actividades,{id:"!"+a.id})})}}]).controller("RemoveActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(a,b,c,d,e){return a.actividad=c,a.ok=function(){return d["delete"]("::actividades/destroy/"+c.id).then(function(a){return e.success("Actividad enviada a la papelera.","Eliminado")},function(a){return e.warning("No se pudo enviar a la papelera.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("EditarActividadCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","toastr","$stateParams","$timeout","$location","$anchorScroll",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w;for(h.verificar_acceso(),a.actividad_id=k.actividad_id,a.datos={selected_grupos:[]},a.mostrando_detalles_actividad=!0,a.perfilPath=b.images+"perfil/",a.views=b.views,a.actividad=i.actividad,a.grupos=i.grupos,a.compartidas=i.compartidas,v=a.compartidas,r=0,t=v.length;t>r;r++)for(p=v[r],w=a.grupos,s=0,u=w.length;u>s;s++)q=w[s],q.id===p.grupo_id&&a.datos.selected_grupos.push(q);a.actividad.finaliza_at?a.actividad.finaliza_at=new Date(a.actividad.finaliza_at):a.actividad.finaliza_at=new Date,a.actividad.inicia_at?a.actividad.inicia_at=new Date(a.actividad.inicia_at):a.actividad.inicia_at=new Date,a.actividad.para_alumnos=a.actividad.para_alumnos?!0:!1,a.actividad.para_profesores=a.actividad.para_profesores?!0:!1,a.actividad.para_acudientes=a.actividad.para_acudientes?!0:!1,a.editor_options={allowedContent:!0,entities:!1},a.restar=function(b){return a.actividad[b]>0?a.actividad[b]=a.actividad[b]-1:void 0},a.sumar=function(b){return a.actividad[b]<1e3?a.actividad[b]=parseInt(a.actividad[b])+1:void 0},a.onEditorReady=function(){return console.log("Editor listo")},o=function(a){return 10>a&&(a="0"+a),a},a.ftime_to_string=function(a){var b,c,d,e,f;return c=o(a.getHours()),d=o(a.getMinutes()),f=o(a.getSeconds()),b=a.yyyymmdd(),e=b+"T"+c+":"+d+":"+f+".000Z"},a.guardarActividad=function(b){var c,f;return c=a.ftime_to_string(a.actividad.finaliza_at),a.actividad.finaliza_at_str=c,f=a.ftime_to_string(a.actividad.inicia_at),a.actividad.inicia_at_str=f,e.put("::actividades/guardar",a.actividad).then(function(c){return c=c.data,j.success("Cambios guardados"),b?d.go("panel.actividades",{asign_id:a.actividad.asignatura_id}):void 0},function(a){return j.error("No se pudo guardar cambios")})},a.editar_pregunta=function(b){return d.go("panel.editar_actividad",{actividad_id:a.actividad.id}),localStorage.pregunta_edit=JSON.stringify(b),l(function(){return d.go("panel.editar_actividad.pregunta")})},a.crearPregunta=function(){return i={actividad_id:a.actividad_id},e.post("::preguntas/crear",i).then(function(b){return b=b.data,a.actividad.preguntas.push(b),a.editar_pregunta(b)},function(a){return j.error("No se pudo crear pregunta")})},a.cambios_pregunta_guardados=function(b){return a.actividad.preguntas=g("filter")(a.actividad.preguntas,{id:"!"+b.id}),a.actividad.preguntas.push(b),a.actividad.preguntas=g("orderBy")(a.actividad.preguntas,"orden")},a.duplicar_pregunta=function(b){return b.orden=a.actividad.preguntas.length,e.put("::preguntas/duplicar-pregunta",b).then(function(b){return b=b.data,j.success("Pregunta duplicada"),a.actividad.preguntas.push(b),l(function(){return m.hash("end-preguntas"),n()})},function(a){return j.error("No se pudo duplicar")})},a.on_sort_preguntas=function(a,b,c,d,f){var g,h,k,l,m,n;for(l=[],h=m=0,n=b.length;n>m;h=++m)k=b[h],k.orden=h,g={},g[""+k.id]=h,l.push(g);return i={sortHash:l},e.put("::preguntas/update-orden",i).then(function(a){return!0},function(a){return j.warning("No se pudo ordenar","Problema"),!1})},a.para_alumnos_toggle=function(b){return e.put("::actividades/para-alumnos-toggle",{actividad_id:a.actividad.id,para_alumnos:b}).then(function(a){return b?j.success("Debe haber al menos un grupo seleccionado"):j.info("No la realizarán los alumnos")},function(a){return j.warning("No se pudo guardar cambio","Problema"),!1})},a.para_profesores_toggle=function(b){return e.put("::actividades/para-profesores-toggle",{actividad_id:a.actividad.id,para_profesores:b}).then(function(a){return b?j.success("La realizarán los docentes"):j.info("No la realizarán los docentes")},function(a){return j.warning("No se pudo guardar cambio","Problema"),!1})},a.para_acudientes_toggle=function(b){return e.put("::actividades/para-acudientes-toggle",{actividad_id:a.actividad.id,para_acudientes:b}).then(function(a){return b?j.success("La realizarán los acudientes"):j.info("No la realizarán los acudientes")},function(a){return j.warning("No se pudo guardar cambio","Problema"),!1})},a.toggle_compartida=function(b){return e.put("::actividades/set-compartida",{actividad_id:a.actividad.id,compartida:b}).then(function(a){return j.success("Compartida: "+b)},function(a){return j.warning("No se pudo establecer compartida","Problema"),!1})},a.select_grupo_compartido=function(b){return e.put("::actividades/insert-grupo-compartido",{actividad_id:a.actividad.id,grupo_id:b.id}).then(function(a){return j.success("Grupo agregado")},function(a){return j.warning("No se pudo agregar grupo","Problema"),!1})},a.quitando_grupo_compartido=function(b){return e.put("::actividades/quitando-grupo-compartido",{actividad_id:a.actividad.id,grupo_id:b.id}).then(function(a){return j.success("Grupo quitado")},function(a){return j.warning("No se pudo quitar grupo","Problema"),!1})},a.ver_preguntas=function(){return a.mostrando_preguntas=!0,a.mostrando_detalles_actividad=!1},a.ver_detalles_actividad=function(){return a.mostrando_detalles_actividad=!0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MisActividadesCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o;if(h.verificar_acceso(),a.grupo_id=j.grupo_id,a.asign_id=j.asign_id,a.grupos=i.grupos,a.otras_asignaturas=i.otras_asignaturas,a.mis_asignaturas=i.mis_asignaturas,a.perfilPath=b.images+"perfil/",a.views=b.views,c.menucompacto=!0,j.asign_id)for(o=a.mis_asignaturas,m=0,n=o.length;n>m;m++)l=o[m],l.asignatura_id===parseInt(a.asign_id)&&(a.actividades=l.actividades,a.asignatura=l);a.crear=function(a){return e.post("::actividades/crear",{asignatura_id:a}).then(function(a){return a=a.data,k.success("Actividad creada","Ahora a editar"),d.go("panel.editar_actividad",{actividad_id:a.id})},function(a){return k.error("No se pudo crear actividad.","Error")})},a.eliminarActividad=function(a,c){var d;return d=f.open({templateUrl:b.views+"actividades/removeActividad.tpl.html",controller:"RemoveActividadCtrl",resolve:{actividad:function(){return a}}}),d.result.then(function(a){return c.actividades=g("filter")(c.actividades,{id:"!"+a.id})})}}]).controller("RemoveActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(a,b,c,d,e){return a.actividad=c,a.ok=function(){return d["delete"]("::actividades/destroy/"+c.id).then(function(a){return e.success("Actividad enviada a la papelera.","Eliminado")},function(a){return e.warning("No se pudo enviar a la papelera.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MiActividadCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(a,b,c,d,e,f,g,h,i,j,k){h.verificar_acceso(),a.actividad_id=j.actividad_id,a.perfilPath=b.images+"perfil/",a.views=b.views,a.actividad=i.actividad,a.actividad_resuelta=i.actividad_resuelta,c.menucompacto=!0,a.seleccionar_opcion=function(b,c){var d,f,g,h;for(i={actividad_resuelta_id:a.actividad_resuelta.id,pregunta_id:b.id,tipo_pregunta:b.tipo_pregunta,opcion_id:c.id,opcion_cuadricula_id:null},a.actividad.one_by_one||e.put("::mis-actividades/seleccionar-opcion",i).then(function(){return k.success("Selección guardada")},function(){return k.error("No se pudo guardar selección")}),h=b.opciones,f=0,g=h.length;g>f;f++)d=h[f],d.seleccionada=!1;return c.seleccionada=!0},a.finalizar_actividad=function(){var c;return c=f.open({templateUrl:b.views+"actividades/finalizarActividad.tpl.html",controller:"FinalizarActividadCtrl",resolve:{actividad:function(){return a.actividad}}}),c.result.then(function(b){return d.go("panel.mis_actividades",{alumno_id:a.USER.persona_id})})}}]).controller("FinalizarActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(a,b,c,d,e){return a.actividad=c,a.ok=function(){return d.put("::mis-actividades/finalizar-actividad",{actividad_resuelta_id:c.actividad_resuelta_id}).then(function(){return e.info("Has finalizado actividad"),b.close(c)},function(){return e.error("No se pudo guardar selección")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("EditarPreguntaCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","toastr","$stateParams","$location","$anchorScroll","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){h.verificar_acceso(),a.pregunta_id=k.pregunta_id,a.perfilPath=b.images+"perfil/",a.views=b.views,a.pregunta=i,a.editor_options={allowedContent:!0,entities:!1},n(function(){return l.hash("scroll-pregunta"),m()}),a.onEditorReady=function(){return console.log("Editor listo")},a.guardar_cambios=function(b){return e.put("::preguntas/guardar",a.pregunta).then(function(c){return c=c.data,a.$parent.cambios_pregunta_guardados(a.pregunta),j.success("Cambios guardados"),b?d.go("panel.editar_actividad",{actividad_id:a.pregunta.actividad_id}):void 0},function(a){return j.error("No se pudo guardar cambios")})},a.restar=function(b){return a.pregunta[b]>0?a.pregunta[b]=a.pregunta[b]-1:void 0},a.sumar=function(b){return a.pregunta[b]<1e3?a.pregunta[b]=parseInt(a.pregunta[b])+1:void 0},a.cancelar=function(){return d.go("panel.editar_actividad",{actividad_id:a.pregunta.actividad_id})},a.add_opcion=function(){var b,c;return b=a.pregunta.opciones.length,c={definicion:"Opcion "+(b+1),orden:b,pregunta_id:a.pregunta.id,is_correct:!1},e.put("::opciones/add-opcion",c).then(function(b){return b=b.data,j.success("Opción agregada"),a.pregunta.opciones.push(b)},function(a){return j.error("No se pudo agregar")})},a.toggle_opcion_otra=function(b){return e.put("::preguntas/toggle-opcion-otra",{id:a.pregunta.id,opcion_otra:b}).then(function(c){return c=c.data,j.success("Opción OTRA agregada"),a.pregunta.opcion_otra=b},function(a){return j.error("No se pudo agregar OTRA")})},a.setOpcionCorrect=function(b){return e.put("::opciones/set-opcion-correct",b).then(function(c){var d,e,f,g,h;for(c=c.data,g=a.pregunta.opciones,h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(d.is_correct=b===d?!0:!1);return h},function(a){return j.error("No se pudo establecer correcta")})},a.eliminarOpcion=function(b){return e["delete"]("::opciones/destroy/"+b.id).then(function(c){return c=c.data,j.success("Opción eliminada"),a.pregunta.opciones=g("filter")(a.pregunta.opciones,{id:"!"+b.id})},function(a){return j.error("No se pudo establecer correcta")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("RespuestasCtrl",["$scope","App","$rootScope","$state","$http","$uibModal","$filter","AuthService","datos","$stateParams","toastr",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t,u,v,w;for(h.verificar_acceso(),a.actividad_id=j.actividad_id,a.perfilPath=b.images+"perfil/",a.views=b.views,a.plantilla=a.views+"notas/popoverAlumnoInfo.tpl.html?"+Math.random().toString(36).slice(2),a.actividad=i.actividad,a.grupos=i.grupos,c.menucompacto=!0,a.alumnos_unidos=[],u=a.grupos,o=0,r=u.length;r>o;o++)for(m=u[o],v=m.alumnos,p=0,s=v.length;s>p;p++)l=v[p],a.alumnos_unidos.push(l);for(a.cantOpcMaxi=0,w=a.actividad.preguntas,q=0,t=w.length;t>q;q++)n=w[q],a.cantOpcMaxi=n.opciones.length>a.cantOpcMaxi?n.opciones.length:a.cantOpcMaxi;a.getOpcionesMaximas=function(){return new Array(a.cantOpcMaxi)},a.finalizar_actividad=function(){var c;return c=f.open({templateUrl:b.views+"actividades/finalizarActividad.tpl.html",controller:"FinalizarActividadCtrl",resolve:{actividad:function(){return a.actividad}}}),c.result.then(function(b){return d.go("panel.mis_actividades",{alumno_id:a.USER.persona_id})})}}]).controller("FinalizarActividadCtrl",["$scope","$uibModalInstance","actividad","$http","toastr",function(a,b,c,d,e){return a.actividad=c,a.ok=function(){return d.put("::mis-actividades/finalizar-actividad",{actividad_resuelta_id:c.actividad_resuelta_id}).then(function(){return e.info("Has finalizado actividad"),b.close(c)},function(){return e.error("No se pudo guardar selección")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider",function(a){a.state("panel.profesores.nuevo",{url:"/nuevo",views:{edit_profesor:{templateUrl:"==profesores/profesoresNew.tpl.html",controller:"ProfesoresNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo profesor"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Profesor nuevo - MyVc"}}).state("panel.profesores.editar",{url:"/editar/:profe_id",views:{edit_profesor:{templateUrl:"==profesores/profesoresEdit.tpl.html",controller:"ProfesoresEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar profesor - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ProfesoresCtrl",["$scope","$uibModal","toastr","uiGridConstants","$http","$state","App","$filter",function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n;a.gridScope=a,a.current_year=a.USER.year_id,a.views=g.views,a.perfilPath=g.images+"perfil/",a.editar=function(a){return f.go("panel.profesores.editar",{profe_id:a.id})},a.eliminar=function(c){var d;return d=b.open({templateUrl:"==profesores/removeProfesor.tpl.html",controller:"RemoveProfesorCtrl",resolve:{profesor:function(){return c}}}),d.result.then(function(b){return a.gridOptions.data=h("filter")(a.gridOptions.data,{alumno_id:"!"+b.alumno_id})})},j='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',k='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',l="==profesores/botonContratar.tpl.html",n="==directives/botonesResetPassword.tpl.html",i="==profesores/botonEditUsername.tpl.html",a.gridOptions={enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Todos los docentes - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",displayName:"Id",width:50,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:j+k,enableCellEdit:!1},{name:"contrato",displayName:"Contrato",width:75,enableSorting:!1,enableFiltering:!1,cellTemplate:l,enableCellEdit:!1},{field:"nombres",enableHiding:!1,minWidth:100},{field:"apellidos",minWidth:100},{field:"sexo",maxWidth:40},{field:"fecha_nac",displayName:"Nacimiento",minWidth:100},{field:"username",filter:{condition:d.filter.CONTAINS},displayName:"Usuario",cellTemplate:n,editableCellTemplate:i,minWidth:135},{field:"email_usu",displayName:"Email",minWidth:100},{field:"celular",minWidth:100}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,d,f,g){return f!==g&&e.put("::profesores/update/"+b.id,b).then(function(a){return c.success("Profesor actualizado con éxito","Actualizado")},function(a){return c.error("Cambio no guardado","Error");
}),a.$apply()})}},e.get("::profesores").then(function(b){return a.gridOptions.data=b.data}),a.$on("profesorcreado",function(b,c){return a.gridOptions.data.push(c)}),a.quitarContrato=function(b){return e["delete"]("::contratos/destroy/"+b).then(function(d){var e;return c.success("Quitado de este año "+a.USER.year),a.gridCurrentOptions.data=h("filter")(a.gridCurrentOptions.data,{contrato_id:"!"+b}),e=h("filter")(a.gridOptions.data,{contrato_id:b})[0],e.year_id=null},function(a){return c.error("No se pudo agregar el profesor al presente año","Problema")})},a.contratar=function(b){return e.post("::contratos",{profesor_id:b.id}).then(function(d){var e;return c.success(b.nombres+" contratado para este año"),d=d.data[0],a.gridCurrentOptions.data.push(d),e=h("filter")(a.gridOptions.data,{id:d.profesor_id})[0],e.year_id=a.current_year,e.contrato_id=d.contrato_id},function(a){return a.data.contratado?c.warning("Este profesor ya está contratado"):c.error("No se pudo agregar el profesor al presente año","Problema")})},m='<a uib-tooltip="Quitar de año actual" tooltip-placement="left" class="btn btn-default btn-xs shiny danger" ng-click="grid.appScope.quitarContrato(row.entity.contrato_id)"><i class="fa fa-times "></i></a>',a.gridCurrentOptions={enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["edicion"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Docentes contratados - MyVC.csv",enableGridMenu:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"profesor_id",displayName:"Id",width:50,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:m,enableCellEdit:!1},{field:"nombres",enableHiding:!1,minWidth:100},{field:"apellidos",minWidth:100},{field:"sexo",width:40},{field:"fecha_nac",displayName:"Nacimiento",minWidth:100},{field:"username",filter:{condition:d.filter.CONTAINS},displayName:"Usuario",cellTemplate:n,editableCellTemplate:i,minWidth:135},{field:"email_usu",displayName:"Email",minWidth:100},{field:"celular",minWidth:100}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,d,f,g){return f!==g&&e.put("::profesores/update/"+b.profesor_id,b).then(function(a){return c.success("Profesor actualizado con éxito","Actualizado")},function(a){return c.error("Cambio no guardado","Error")}),a.$apply()})}},e.get("::contratos").then(function(b){return a.gridCurrentOptions.data=b.data},function(a){return c.error("No se trajeron los profesores contratados")}),a.cambiaUsernameCheck=function(b){return a.verificandoUsername=!0,e.put("::users/usernames-check",{texto:b}).then(function(b){return a.username_match=b.data.usernames,a.verificandoUsername=!1,a.username_match.map(function(a){return a.username})})},a.resetPass=function(a){var c;return c=b.open({templateUrl:g.views+"usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return a}}}),c.result.then(function(a){})}}]).controller("RemoveProfesorCtrl",["$scope","$uibModalInstance","profesor","$http","toastr",function(a,b,c,d,e){return a.profesor=c,a.ok=function(){return d["delete"]("::profesores/destroy/"+c.id).then(function(a){return e.success("Profesor enviado a la papelera.","Eliminado")},function(a){return e.warning("No se pudo enviar a la papelera.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ProfesoresNewCtrl",["$scope","$http","toastr","$filter",function(a,b,c,d){a.profesor={sexo:"M",fecha_nac:new Date("1990-01-01")},a.estados_civiles=[{estado_civil:"Soltero"},{estado_civil:"Casado"},{estado_civil:"Divorciado"},{estado_civil:"Viudo"}],b.get("::paises").then(function(b){return a.paises=b.data}),b.get("::tiposdocumento").then(function(b){return a.tipos_doc=b.data}),a.crear=function(){return a.profesor.fecha_nac=d("date")(a.profesor.fecha_nac,"yyyy-MM-dd"),b.post("::profesores/store",a.profesor).then(function(b){return c.success("Profesor creado"),a.$emit("profesorcreado",b.data)},function(a){return c.error("Profesor NO creado","Problema")})},a.paisNacSelect=function(c,d){return b.get("::ciudades/departamentos/"+c.id).then(function(b){return a.departamentosNac=b.data,"undefined"==typeof a.profesor.pais_doc?(a.profesor.pais_doc=c,a.paisSelecionado(c)):void 0})},a.departNacSelect=function(c){return b.get("::ciudades/por-departamento/"+c.departamento).then(function(b){return a.ciudadesNac=b.data,"undefined"==typeof a.profesor.departamento_doc?(a.profesor.departamento_doc=c,a.departSeleccionado(c)):void 0})},a.paisSelecionado=function(c,d){return b.get("::ciudades/departamentos/"+c.id).then(function(b){return a.departamentos=b.data})},a.departSeleccionado=function(c){return b.get("::ciudades/por-departamento/"+c.departamento).then(function(b){return a.ciudades=b.data})},a.dateOptions={formatYear:"yy"}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ProfesoresEditCtrl",["$scope","toastr","$http","$state","$filter",function(a,b,c,d,e){a.data={},a.profesor={},a.paises=[{id:1,pais:"COLOMBIA"}],a.tipos_doc=[{id:1,tipo:"CC"}],a.departamentos=[{id:1,departamento:"ANTIOQUIA"}],a.ciudades=[{id:1,ciudad:"MEDELLÍN"}],a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],a.estados_civiles=[{estado_civil:"Soltero"},{estado_civil:"Casado"},{estado_civil:"Divorciado"},{estado_civil:"Viudo"}],c.get("::profesores/show/"+d.params.profe_id).then(function(b){return b=b.data,a.profesor=b[0],null===a.profesor.ciudad_nac?(a.profesor.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisNacSelect(a.profesor.pais_nac,a.profesor.pais_nac)):c.get("::ciudades/datosciudad/"+a.profesor.ciudad_nac).then(function(b){return a.paises=b.paises,a.departamentosNac=b.departamentos,a.ciudadesNac=b.ciudades,a.profesor.pais_nac=b.pais,a.profesor.departamento_nac=b.departamento,a.profesor.ciudad_nac=b.ciudad}),null===a.profesor.ciudad_doc?(a.profesor.pais_doc={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisDocSelect(a.profesor.pais_doc,a.profesor.pais_doc)):c.get("::ciudades/datosciudad/"+a.profesor.ciudad_doc).then(function(b){return b=b.data,a.paises=b.paises,a.departamentos=b.departamentos,a.ciudades=b.ciudades,a.profesor.pais_doc=b.pais,a.profesor.departamento_doc=b.departamento,a.profesor.ciudad_doc=b.ciudad}),c.get("::tiposdocumento").then(function(b){var c,d,e,f,g;if(a.tipos_doc=b.data,null===a.profesor.tipo_doc)return a.profesor.tipo_doc=a.tipos_doc[0];for(f=a.tipos_doc,g=[],d=0,e=f.length;e>d;d++)c=f[d],a.profesor.tipo_doc===c.id?g.push(a.profesor.tipo_doc=c):g.push(void 0);return g})}),c.get("::paises").then(function(b){return a.paises=b.data},function(a){return b.error("No se pudo traer los paises")}),a.guardar=function(){return c.put("::profesores/update/"+a.profesor.profesor_id,a.profesor).then(function(a){return b.success("Profesor actualizado con éxito")},function(a){return b.error("No se guardaron los cambios","Problemas")})},a.paisNacSelect=function(b,d){return c.get("::ciudades/departamentos/"+b.id).then(function(c){return a.departamentosNac=c.data,"undefined"==typeof a.profesor.pais_doc?(a.profesor.pais_doc=b,a.paisDocSelect(b)):void 0})},a.departNacSelect=function(b){return c.get("::ciudades/por-departamento/"+b.departamento).then(function(c){return a.ciudadesNac=c.data,"undefined"==typeof a.profesor.departamento_doc?(a.profesor.departamento_doc=b,a.departDocSelect(b)):void 0})},a.paisDocSelect=function(b,d){return c.get("::ciudades/departamentos/"+b.id).then(function(b){return a.departamentos=b.data})},a.departDocSelect=function(b){return c.get("::ciudades/por-departamento/"+b.departamento).then(function(b){return a.ciudades=b.data})},a.dateOptions={formatYear:"yyyy"}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AreasCtrl",["$scope","toastr","$filter","$http","$uibModal",function(a,b,c,d,e){var f,g;return a.creando=!1,a.editando=!1,a.currentArea={},a.currenAreaEdit={},a.gridScope=a,a.cancelarCrear=function(){return a.creando=!1},a.cancelarEdit=function(){return a.editando=!1},a.crear=function(){return d.post("::areas",a.currentArea).then(function(c){return a.gridOptions.data.push(c.data),delete a.currentArea,b.success("Area creada con éxito")},function(a){return b.error("Error creando","Problema")})},a.guardar=function(){return d.put("::areas/update/"+a.currentAreaEdit.id,a.currentAreaEdit).then(function(c){return delete a.currentAreaEdit,b.success("Area actualizada con éxito"),a.cancelarEdit()},function(a){return b.error("Error guardando","Problema")})},a.editar=function(b){return a.currentAreaEdit=b,a.editando=!0},a.eliminar=function(b){var d;return d=e.open({templateUrl:"==areas/removeArea.tpl.html",controller:"RemoveAreaCtrl",resolve:{area:function(){return b}}}),d.result.then(function(b){return a.gridOptions.data=c("filter")(a.areas,{id:"!"+b.id})})},f='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',g='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",maxWidth:50,enableFiltering:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:f+g,enableCellEdit:!1},{field:"orden",type:"number",maxWidth:40,enableSorting:!1},{field:"nombre",enableHiding:!1},{field:"alias",displayName:"Alias"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&(a.currentAreaEdit=b,a.guardar()),a.$apply()})}},d.get("::areas").then(function(b){return a.areas=b.data,a.gridOptions.data=a.areas})}]).controller("RemoveAreaCtrl",["$scope","$uibModalInstance","area","$http","toastr",function(a,b,c,d,e){return a.area=c,a.ok=function(){return d["delete"]("::areas/destroy/"+c.id).then(function(a){return e.success("Grupo eliminado: "+c.nombre,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el area.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("LoginCtrl",["$scope","$rootScope","AUTH_EVENTS","AuthService","$location","$cookies","Perfil","App","$http",function(a,b,c,d,e,f,g,h,i){var j;j=300,a.logueando=!0,a.recuperando=!1,a.registrando=!1,a.logoPathDefault="images/Logo_MyVc_Header.gif",a.logoPath="images/Logo_Colegio_Header.gif",i.get(a.logoPath).then(function(){return console.log("imagen existe")},function(){return a.logoPath=a.logoPathDefault}),a.credentials={username:"",password:""},a.host=e.host(),a.login=function(a){return d.login_credentials(a).then(function(a){d.verificar().then(function(a){return localStorage.removeItem("token_verificado")},function(a){return console.log("Falló en Verificar")})})},a.enviarPass=function(a){return i.post("::login/ver-pass",{email:a,ruta:location.origin+location.pathname}).then(function(a){return alert("Ahora, verifica tu correo")},function(){return alert("Parece que el correo no está registrado.")})},a.to_recuperando=function(){return a.logueando=!1,a.recuperando=!0,a.registrando=!1},a.to_registrando=function(){return a.logueando=!1,a.recuperando=!1,a.registrando=!0},a.to_logueando=function(){return a.logueando=!0,a.recuperando=!1,a.registrando=!1}}]).controller("ResetPasswordCtrl",["$scope","$state","$stateParams","$cookies","Perfil","App","$http","toastr",function(a,b,c,d,e,f,g,h){a.reseteando=!1,a.username=c.username,a.logoPath="images/Logo_Colegio_Header.gif",c.numero<1e4&&(console.log("Reseteo inválido, deja de intentarlo."),b.go("login")),a.credentials={password1:"",password2:""},a.reset=function(d){return a.reseteando=!0,d.password1!==d.password2?(h.warning("Las contraseñas no coinciden."),void(a.reseteando=!1)):d.password1.length<4?(h.warning("Debe tener al menos 4 caracteres"),void(a.reseteando=!1)):g.put("::login/reset-password",{password1:d.password1,numero:c.numero,username:c.username}).then(function(c){return"Token inválido"===c.data?(h.warning("Token inválido"),a.reseteando=!1):b.go("login")},function(b){return console.log("No se pudo resetear"),a.reseteando=!1})}}])}.call(this),function(){angular.module("myvcFrontApp").directive("loginDialog",["AUTH_EVENTS","App",function(a,b){return{restrict:"A",templateUrl:"==login/login-form.html",link:function(b){var c;return c=function(){return b.visible=!0},b.visible=!1,b.$on(a.notAuthenticated,c),b.$on(a.sessionTimeout,c)}}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("LogoutCtrl",["$scope","$state","$cookieStore","Perfil",function(a,b,c,d){return console.log("A salir!!"),b.go("login")}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider",function(a){return a.state("panel.niveles",{url:"^/niveles",views:{maincontent:{templateUrl:"==grados/niveles.tpl.html",controller:"NivelesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Niveles educativos"}]}}},data:{displayName:"Niveles",icon_fa:"fa fa-graduation-cap",pageTitle:"Niveles - MyVc"}}),a.state("panel.niveles.nuevo",{url:"/nuevo",views:{edit_nivel:{templateUrl:"==grados/nivelesNew.tpl.html",controller:"NivelesNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Nivel nuevo - MyVc"}}),a.state("panel.niveles.editar",{url:"/editar/:nivel_id",views:{edit_nivel:{templateUrl:"==grados/nivelesEdit.tpl.html",controller:"NivelesEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar nivel - MyVc"}}),a.state("panel.grados",{url:"^/grados",views:{maincontent:{templateUrl:"==grados/grados.tpl.html",controller:"GradosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Grados"}]}}},resolve:{niveles:["$http",function(a){return a.get("::niveles_educativos").then(function(a){return a.data})}]},data:{displayName:"Grados",icon_fa:"fa fa-graduation-cap",pageTitle:"Grados - MyVc"}}),a.state("panel.grados.nuevo",{url:"/nuevo",views:{edit_grado:{templateUrl:"==grados/gradosNew.tpl.html",controller:"GradosNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Grado nuevo - MyVc"}}),a.state("panel.grados.editar",{url:"/editar/:grado_id",views:{edit_grado:{templateUrl:"==grados/gradosEdit.tpl.html",controller:"GradosEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar grado - MyVc"}}),a.state("panel.grupos",{url:"^/grupos",views:{maincontent:{templateUrl:"==grados/grupos.tpl.html",controller:"GruposCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Grupos"}]}}},resolve:{grados:["$http",function(a){return a.get("::grados").then(function(a){return a.data})}],profesores:["$http",function(a){return a.get("::contratos").then(function(a){return a.data})}]},data:{displayName:"Grupos",icon_fa:"fa fa-graduation-cap",pageTitle:"Grupos - MyVc"}}),a.state("panel.grupos.nuevo",{url:"/nuevo",views:{edit_grupo:{templateUrl:"==grados/gruposNew.tpl.html",controller:"GruposNewCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap",pageTitle:"Grupo nuevo - MyVc"}}),a.state("panel.grupos.editar",{url:"/editar/:grupo_id",views:{edit_grupo:{templateUrl:"==grados/gruposEdit.tpl.html",controller:"GruposEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap",pageTitle:"Editar grupo - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GradosCtrl",["$scope","$filter","$state","App","niveles","$uibModal","toastr","$http",function(a,b,c,d,e,f,g,h){var i,j,k;a.grados={nivel:{}},a.gridScope=a,a.niveles=e,a.editar=function(a){return c.go("panel.grados.editar",{grado_id:a.id})},a.eliminar=function(c){var d;return d=f.open({templateUrl:"==grados/removeGrado.tpl.html",controller:"RemoveGradoCtrl",size:"sm",resolve:{grado:function(){return c}}}),d.result.then(function(c){return a.grados=b("filter")(a.grados,{id:"!"+c.id}),a.gridOptions.data=a.grados})},k="==grados/editCellNivel.tpl.html",i='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',j='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:i+j,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"abreviatura",maxWidth:50,enableSorting:!1},{field:"orden",type:"number",maxWidth:50},{field:"nivel_educativo_id",displayName:"Nivel Educativo",editDropdownOptionsArray:e,cellFilter:"mapNivel:grid.appScope.niveles",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{name:"nn",displayName:"",maxWidth:20,enableSorting:!1,enableFiltering:!1}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&h.put("::grados/update/"+b.id,b).then(function(a){return g.success("Grado actualizado con éxito","Actualizado")},function(a){return g.error("Cambio no guardado","Error")}),a.$apply()})}},h.get("::grados").then(function(b){return a.grados=b.data,a.gridOptions.data=a.grados}),a.$on("gradocreado",function(b,c){return a.grados.push(c),a.gridOptions.data=a.grados})}]).filter("mapNivel",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b})[0],d.nombre):""}}]).controller("RemoveGradoCtrl",["$scope","$uibModalInstance","grado","$http","toastr",function(a,b,c,d,e){return a.grado=c,a.ok=function(){return d["delete"]("::grados/destroy/"+c.id).then(function(a){return e.success("Grado "+a.nombre+" eliminado con éxito","Eliminado")},function(a){return e.error("No se pudo eliminar a "+row.nombre)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GradosNewCtrl",["$scope","toastr","$http",function(a,b,c){return a.grado={orden:1},a.restarOrden=function(){return a.grado.orden>0?a.grado.orden=a.grado.orden-1:void 0},a.sumarOrden=function(){return a.grado.orden<40?a.grado.orden=a.grado.orden+1:void 0},a.crear=function(){return c.post("::grados/store",a.grado).then(function(c){return c=c.data,a.$emit("gradocreado",c),b.success("Grado "+c.nombre+" creado")},function(a){return b.error("Falló al intentar guardar")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GradosEditCtrl",["$scope","$state","$http","toastr",function(a,b,c,d){return c.get("::grados/show/"+b.params.grado_id).then(function(b){return a.grado=b.data}),a.guardar=function(){return c.put("::grados/update/"+a.grado.id,a.grado).then(function(a){return d.success("Se guardaron los cambios.")},function(a){return d.error("Falló al intentar guardar")})},a.restarOrden=function(){return a.grado.orden>0?a.grado.orden=a.grado.orden-1:void 0},a.sumarOrden=function(){return a.grado.orden<40?a.grado.orden=a.grado.orden+1:void 0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GruposCtrl",["$scope","$filter","$state","grados","profesores","$uibModal","$http","toastr","AuthService",function(a,b,c,d,e,f,g,h,i){var j,k,l,m;a.gridScope=a,a.grados=d,a.profesores=e,a.hasRoleOrPerm=i.hasRoleOrPerm,a.editar=function(a){return c.go("panel.grupos.editar",{grupo_id:a.id})},a.eliminar=function(c){var d;return d=f.open({templateUrl:"==grados/removeGrupo.tpl.html",controller:"RemoveGrupoCtrl",resolve:{grupo:function(){return c}}}),d.result.then(function(c){return a.grupos=b("filter")(a.grupos,{id:"!"+c.id}),a.gridOptions.data=a.grupos})},k='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',m='<a uib-tooltip="Listado de alumnos" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ui-sref="panel.listalumnos({grupo_id: row.entity.id})"><i class="fa fa-users "></i></a>',j="==grados/botonCaritasGrupo.tpl.html",a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"orden",type:"number",maxWidth:60},{name:"edicion",displayName:"Edición",maxWidth:80,enableSorting:!1,enableFiltering:!1,cellTemplate:k+l+m,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura",maxWidth:50,enableSorting:!1},{field:"titular_id",displayName:"Titular",editDropdownOptionsArray:e,cellFilter:"mapProfesores:grid.appScope.profesores",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"profesor_id",editDropdownValueLabel:"nombres"},{field:"grado_id",displayName:"Grado",editDropdownOptionsArray:d,cellFilter:"mapGrado:grid.appScope.grados",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{field:"caritas",name:"caritas",maxWidth:70,cellTemplate:j,enableFiltering:!1,enableCellEdit:!1}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){var f;return d!==e&&(f={abrev:b.abrev,grado_id:b.grado_id,nombre:b.nombre,orden:b.orden,titular_id:b.titular_id,caritas:b.caritas,id:b.id},g.put("::grupos/update",f).then(function(a){return h.success("Grupo actualizado con éxito","Actualizado")},function(a){return h.error("Cambio no guardado","Error")})),a.$apply()})}},a.cambiarCaritas=function(a){var b;return a.caritas=!a.caritas,b={abrev:a.abrev,grado_id:a.grado_id,nombre:a.nombre,orden:a.orden,titular_id:a.titular_id,caritas:a.caritas,id:a.id},g.put("::grupos/update",b).then(function(a){return h.success("Grupo actualizado con éxito","Actualizado")},function(a){return h.error("Cambio no guardado","Error")})},g.get("::grupos").then(function(b){var c,d,e,f;for(a.grupos=b.data,f=a.grupos,d=0,e=f.length;e>d;d++)c=f[d],c.caritas=c.caritas?!0:!1;return a.gridOptions.data=a.grupos}),a.$on("grupocreado",function(b,c){return a.grupos.push(c),a.gridOptions.data=a.grupos})}]).filter("mapGrado",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b})[0],d.nombre):"Elija..."}}]).controller("RemoveGrupoCtrl",["$scope","$uibModalInstance","grupo","$http","toastr",function(a,b,c,d,e){return a.grupo=c,a.ok=function(){return d["delete"]("::grupos/destroy/"+c.id).then(function(a){return e.success("Grupo "+c.nombre+" eliminado con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar al grupo.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GruposNewCtrl",["$scope","$http","toastr",function(a,b,c){return a.grupo={orden:1,caritas:!1,valormatricula:0,valorpension:0},b.get("::grados").then(function(b){return a.grados=b.data}),b.get("::contratos").then(function(b){return a.profesores=b.data}),a.restarOrden=function(){return a.grupo.orden>0?a.grupo.orden=a.grupo.orden-1:void 0},a.sumarOrden=function(){return a.grupo.orden<40?a.grupo.orden=a.grupo.orden+1:void 0},a.crear=function(){return b.post("::grupos/store",a.grupo).then(function(b){return a.$emit("grupocreado",b.data),c.success("Grupo "+b.data.nombre+" creado")},function(a){return c.error("No se pudo crear el grupo","Error")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("GruposEditCtrl",["$scope","$state","$http","toastr",function(a,b,c,d){return c.get("::grupos/show/"+b.params.grupo_id).then(function(b){return a.grupo=b.data}),c.get("::grados").then(function(b){return a.grados=b.data}),c.get("::contratos").then(function(b){return a.profesores=b.data}),a.guardar=function(){var b;return a.grupo.titular.profesor_id?a.grupo.titular_id=a.grupo.titular.profesor_id:a.grupo.titular_id=a.grupo.titular.id,b=a.grupo.titular,delete a.grupo.titular,a.grupo.grado_id=a.grupo.grado.id,c.put("::grupos/update",a.grupo).then(function(c){return d.success("Grupo "+c.data.nombre+" editado."),a.grupo.titular=b},function(c){return a.grupo.titular=b})},a.restarOrden=function(){return a.grupo.orden>0?a.grupo.orden=a.grupo.orden-1:void 0},a.sumarOrden=function(){return a.grupo.orden<40?a.grupo.orden=a.grupo.orden+1:void 0}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NivelesCtrl",["$scope","$filter","$state","toastr","$http",function(a,b,c,d,e){var f,g;a.gridScope=a,a.editar=function(a){return c.go("panel.niveles.editar",{nivel_id:a.id})},a.eliminar=function(c){return $htt["delete"]("niveles_educativos/"+c.id).then(function(c){return a.niveles=b("filter")(a.niveles,{id:"!"+c.data.id}),a.gridOptions.data=a.niveles},function(a){return d.warning("No se pudo eliminar.")})},f='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',g='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"orden",type:"number",maxWidth:50,enableSorting:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:f+g,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,f,g){return f!==g&&e.put("::niveles_educativos/"+b.id,b).then(function(a){return d.success("Nivel actualizado","Actualizado")},function(a){return d.error("Cambio no guardado","Error")}),a.$apply()})}},e.get("::niveles_educativos").then(function(b){return a.niveles=b.data,a.gridOptions.data=a.niveles})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NivelesNewCtrl",["$scope","$http","toastr",function(a,b,c){a.nivel={orden:0},a.restarOrden=function(){return a.nivel.orden>0?a.nivel.orden=a.nivel.orden-1:void 0},a.sumarOrden=function(){return a.nivel.orden<40?a.nivel.orden=a.nivel.orden+1:void 0},a.crear=function(){return b.post("::niveles_educativos",a.nivel).then(function(a){return c.success("Se hizo el post del nivel")},function(a){return c.error("Falló al intentar guardar")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("NivelesEditCtrl",["$scope","toastr","$state","$http",function(a,b,c,d){return a.nivel={},d.get("::niveles_educativos/"+c.params.nivel_id).then(function(b){return a.nivel=b.data}),a.guardar=function(){return d.put("niveles_educativos/"+c.params.nivel_id,a.nivel).then(function(a){return b.success("Se guardó nivel")},function(a){return b.error("Falló al intentar guardar")})},a.restarOrden=function(){return a.nivel.orden>0?a.nivel.orden=a.nivel.orden-1:void 0},a.sumarOrden=function(){return a.nivel.orden<40?a.nivel.orden=a.nivel.orden+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){return a.state("panel.areas",{url:"^/areas",views:{maincontent:{templateUrl:"==areas/areas.tpl.html",controller:"AreasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Areas"}]}}},data:{displayName:"Areas",icon_fa:"fa fa-graduation-cap",pageTitle:"Áreas - MyVc"}}),a.state("panel.materias",{url:"^/materias",views:{maincontent:{templateUrl:"==areas/materias.tpl.html",controller:"MateriasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Materias"}]}}},resolve:{areas:["$http",function(a){return a.get("::areas").then(function(a){return a.data})}]},data:{displayName:"Materias",icon_fa:"fa fa-graduation-cap",pageTitle:"Materias - MyVc"}}),a.state("panel.asignaturas",{url:"^/asignaturas",views:{maincontent:{templateUrl:"==areas/asignaturas.tpl.html",controller:"AsignaturasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Asignaturas"}]}}},resolve:{datosAsignaturas:["$http",function(a){return a.put("::asignaturas/datos-asignaturas").then(function(a){return a.data})}]},data:{displayName:"Asignaturas",icon_fa:"fa fa-graduation-cap",pageTitle:"Asignatura - MyVc"}}),a.state("panel.listasignaturas",{url:"^/listasignaturas/:profesor_id",params:{profesor_id:{value:null}},views:{maincontent:{templateUrl:"==areas/listAsignaturas.tpl.html",controller:"ListAsignaturasCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:["$stateParams",function(a){return localStorage.profesor_id=a.profesor_id,"Listado de asignaturas"}]}}},data:{displayName:"Listado de asignaturas",icon_fa:"fa fa-graduation-cap",pageTitle:"Mis asignaturas - MyVc"}}),a.state("panel.frases",{url:"^/frases",views:{maincontent:{templateUrl:"==areas/frases.tpl.html",controller:"FrasesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Frases"}]}}},data:{displayName:"Frases",icon_fa:"fa fa-graduation-cap",pageTitle:"Frases - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("MateriasCtrl",["$scope","toastr","$http","areas","$uibModal","$filter",function(a,b,c,d,e,f){var g,h;return a.creando=!1,a.editando=!1,a.currentmateria={},a.currenmateriaEdit={},a.areas=d,a.gridScope=a,a.cancelarCrear=function(){return a.creando=!1},a.cancelarEdit=function(){return a.editando=!1},a.crear=function(){return c.post("::materias",a.currentmateria).then(function(c){return a.gridOptions.data.push(c.data),delete a.currentmateria,b.success("Materia creada con éxito")},function(a){return b.error("Error creando","Problema")})},a.guardar=function(){return c.put("::materias/update/"+a.currentmateriaEdit.id,a.currentmateriaEdit).then(function(c){return a.currentmateriaEdit.area_id=c.data.area_id,delete a.currentmateriaEdit,b.success("Materia actualizada con éxito"),a.cancelarEdit()},function(a){return b.error("Error guardando","Problema");
})},a.editar=function(b){return b.area=f("filter")(d,{id:b.area_id})[0],a.currentmateriaEdit=b,a.editando=!0},a.eliminar=function(b){var c;return c=e.open({templateUrl:"==areas/removeMateria.tpl.html",controller:"RemovemateriaCtrl",resolve:{materia:function(){return b}}}),c.result.then(function(b){return a.gridOptions.data=f("filter")(a.gridOptions.data,{id:"!"+b.id})})},g='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',h='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,multiSelect:!1,columnDefs:[{field:"id",type:"number",maxWidth:50,enableFiltering:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:g+h,enableCellEdit:!1},{field:"materia",enableHiding:!1,filter:{condition:function(b,c,d){var e,g;return g=f("filter")(a.gridOptions.data,{materia:b}),e=f("filter")(g,{materia:c}),e.length>0}}},{field:"alias",displayName:"Alias"},{field:"area_id",displayName:"Area",editDropdownOptionsArray:d,cellFilter:"mapAreas:grid.appScope.areas",editableCellTemplate:"ui-grid/dropdownEditor",filter:{condition:function(b,c){var d,e;return e=f("filter")(a.areas,{nombre:b}),d=f("filter")(e,{id:c},!0),d.length>0}},editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{name:"nn",displayName:"",maxWidth:20,enableSorting:!1,enableFiltering:!1}],onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&(a.currentmateriaEdit=b,a.guardar()),a.$apply()})}},c.get("::materias").then(function(b){var c,d,e,g,h;for(a.gridOptions.data=b.data.materias,a.areas=b.data.mat_por_areas,a.areas=f("orderBy")(a.areas,"orden"),g=a.areas,h=[],d=0,e=g.length;e>d;d++)c=g[d],h.push(c.materias=f("orderBy")(c.materias,"orden"));return h}),a.onSortMaterias=function(a,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r;for(m=[],n=[],i={},console.log(e,a,h.area),k=o=0,q=d.length;q>o;k=++o)l=d[k],l.orden=k,j={},j[""+l.id]=k,m.push(j);if(i.partFrom={sortHash:m},d!==e){for(k=p=0,r=e.length;r>p;k=++p)l=e[k],l.orden=k,j={},j[""+l.id]=k,n.push(j);i.partTo={sortHash:n,area_id:h.area.id}}return c.put("::materias/update-orden",i).then(function(a){return!0},function(a){return b.warning("No se pudo ordenar","Problema"),!1})},a.onSortAreas=function(a,d,e,f,g){var h,i,j,k,l,m,n;for(l=[],console.log(a,d,e,f,g),k=m=0,n=d.length;n>m;k=++m)h=d[k],h.orden=k,j={},j[""+h.id]=k,l.push(j);return i={sortHash:l},c.put("::areas/update-orden",i).then(function(a){return!0},function(a){return b.warning("No se pudo ordenar","Problema"),!1})}}]).filter("mapAreas",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b})[0],d?d.nombre:"Elija..."):"Elija..."}}]).controller("RemovemateriaCtrl",["$scope","$uibModalInstance","materia","$http","toastr",function(a,b,c,d,e){return a.materia=c,a.ok=function(){return d["delete"]("::materias/destroy/"+c.id).then(function(a){return e.success("Materia "+c.nombre+" eliminada con éxito.","Eliminada")},function(a){return e.warning("Problema","No se pudo eliminar la Materia.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AsignaturasCtrl",["$scope","$http","datosAsignaturas","$uibModal","$filter","App","AuthService","toastr",function(a,b,c,d,e,f,g,h){var i,j;return g.verificar_acceso(),a.creando=!1,a.editando=!1,a.currentasignatura={grupo:void 0,profesor:void 0},a.currenasignaturaEdit={},a.copiando=!1,a.asignaturas=[],a.materias=c.materias,a.grupos=c.grupos,a.profesores=c.profesores,b.get("::asignaturas/papelera").then(function(b){return a.asignaturas_eliminadas=b.data},function(a){return h.error("Error trayendo las asignaturas de papelera","Problema")}),a.restaurarAsignatura=function(a){return a.restaurando?void 0:(a.restaurando=!0,b.put("::asignaturas/restaurar",{asignatura_id:a.asignatura_id}).then(function(a){return h.success("Listo. Debes actualizar la página para ver los cambios.")},function(b){return a.restaurando=!1,h.error("Error restaurando","Problema")}))},a.gridScope=a,a.seleccionaGrupo=function(b,c){var d;return b=void 0===b?{id:"!"}:b,a.gridOptions.data=e("filter")(a.asignaturas,{grupo_id:b.id},!0),void 0!==a.currentasignatura.profesor?(d=a.currentasignatura.profesor.id,a.gridOptions.data=e("filter")(a.gridOptions.data,{profesor_id:d},!0)):void 0},a.mostrarTodas=function(b,c){return a.gridOptions.data=a.asignaturas},a.seleccionaProfe=function(b,c){var d;if(b){if(b=void 0===b?{profesor_id:"!"}:b,a.gridOptions.data=e("filter")(a.asignaturas,{profesor_id:b.profesor_id},!0),a.currentasignatura.grupo)return d=a.currentasignatura.grupo.id,a.gridOptions.data=e("filter")(a.gridOptions.data,{grupo_id:d},!0)}else if(a.currentasignatura.grupo)return d=a.currentasignatura.grupo.id,a.gridOptions.data=e("filter")(a.gridOptions.data,{grupo_id:d},!0)},a.filtrarAsignaturas=function(){var b,c;return a.gridOptions.data=a.asignaturas,void 0!==a.currentasignatura.grupo&&(b=a.currentasignatura.grupo.id,a.gridOptions.data=e("filter")(a.gridOptions.data,{grupo_id:b},!0)),void 0!==a.currentasignatura.profesor?(c=a.currentasignatura.profesor.id,a.gridOptions.data=e("filter")(a.gridOptions.data,{profesor_id:c},!0)):void 0},a.cancelarCrear=function(){return a.creando=!1},a.cancelarEdit=function(){return a.editando=!1},a.copiarAsignaturas=function(){return a.copiando=!1,b.post("::asignaturas/copiar",{grupo_id_origen:a.currentasignatura.grupo.id,grupo_id_destino:a.currentasignatura.grupo_destino.id}).then(function(b){return a.copiando=!0,h.success("Asignaturas copiadas. Actualice")},function(a){return h.error("Error creando","Problema")})},a.crear=function(){return b.post("::asignaturas",a.currentasignatura).then(function(b){return a.asignaturas.push(b.data),a.filtrarAsignaturas(),a.cancelarCrear(),h.success("Asignatura creada con éxito")},function(a){return h.error("Error creando","Problema")})},a.guardar=function(){return b.put("::asignaturas/update/"+a.currentasignaturaEdit.id,a.currentasignaturaEdit).then(function(b){return a.currentasignaturaEdit.area_id=b.data.area_id,h.success("Asignatura actualizada con éxito"),a.cancelarEdit()},function(a){return h.error("Error guardando","Problema")})},a.editar=function(b){return b.materia=e("filter")(c.materias,{id:b.materia_id},!0)[0],b.grupo=e("filter")(c.grupos,{id:b.grupo_id},!0)[0],b.profesor=e("filter")(c.profesores,{profesor_id:b.profesor_id},!0)[0],a.currentasignaturaEdit=b,a.editando=!0},a.eliminar=function(b){var c;return c=d.open({templateUrl:"==areas/removeAsignatura.tpl.html",controller:"RemoveAsignaturaCtrl",resolve:{asignatura:function(){return b}}}),c.result.then(function(b){return a.asignaturas=e("filter")(a.asignaturas,{id:"!"+b.id}),a.gridOptions.data=a.asignaturas,a.filtrarAsignaturas()})},i='<a uib-tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',j='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",width:60,enableFiltering:!1,enableCellEdit:!1,enableColumnMenu:!1},{name:"edicion",displayName:"Edición",width:70,enableSorting:!1,enableFiltering:!1,cellTemplate:i+j,enableCellEdit:!1,enableColumnMenu:!1},{field:"materia_id",displayName:"Materia",editDropdownOptionsArray:c.materias,cellFilter:"mapMaterias:grid.appScope.materias",filter:{condition:function(a,b){var d,f;return f=e("filter")(c.materias,{materia:a}),d=e("filter")(f,{id:b},!0),d.length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"materia",enableCellEditOnFocus:!0},{field:"grupo_id",displayName:"Grupos",editDropdownOptionsArray:c.grupos,cellFilter:"mapGrupos:grid.appScope.grupos",filter:{condition:function(a,b){var d,f;return f=e("filter")(c.grupos,{nombre:a}),d=e("filter")(f,{id:b},!0),d.length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre",enableCellEditOnFocus:!0},{field:"profesor_id",displayName:"Profesor",editDropdownOptionsArray:c.profesores,cellFilter:"mapProfesores:grid.appScope.profesores",filter:{condition:function(a,b){var d;return d=e("filter")(c.profesores,function(c){var d,e,f;return d=c.nombres?c.nombres.toLowerCase().indexOf(a.toLowerCase())>-1:!1,e=c.apellidos?c.apellidos.toLowerCase().indexOf(a.toLowerCase())>-1:!1,f=c.profesor_id===b?!0:!1,(d||e)&&f}),d.length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"profesor_id",editDropdownValueLabel:"nombre_completo",enableCellEditOnFocus:!0},{field:"creditos",displayName:"Créditos",type:"number",maxWidth:50},{name:"nn",displayName:"",width:10,enableSorting:!1,enableFiltering:!1,enableColumnMenu:!1}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&(a.currentasignaturaEdit=b,a.guardar()),a.$apply()})}},b.get("::asignaturas").then(function(b){return a.asignaturas=b.data,a.gridOptions.data=a.asignaturas})}]).filter("mapMaterias",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b},!0)[0],d?d.materia:"En papelera..."):"Elija..."}}]).filter("mapGrupos",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b},!0)[0],d.nombre):"Elija..."}}]).filter("mapProfesores",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{profesor_id:b},!0),d.length>0?d[0].nombres+" "+d[0].apellidos:"Elija..."):"Elija..."}}]).controller("RemoveAsignaturaCtrl",["$scope","$uibModalInstance","asignatura","$http","toastr",function(a,b,c,d,e){return a.asignatura=c,a.ok=function(){return d["delete"]("::asignaturas/destroy/"+c.id).then(function(a){return e.success("asignatura "+c.nombre+" eliminada con éxito.","Eliminada")},function(a){return e.warning("Problema","No se pudo eliminar la asignatura.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ListAsignaturasCtrl",["$scope","$http","toastr","$state","$cookies","$rootScope","AuthService","App","resolved_user","$filter","$uibModal",function(a,b,c,d,e,f,g,h,i,j,k){return a.UNIDAD=a.USER.unidad_displayname,a.GENERO_UNI=a.USER.genero_unidad,a.SUBUNIDAD=a.USER.subunidad_displayname,a.GENERO_SUB=a.USER.genero_subunidad,a.UNIDADES=a.USER.unidades_displayname,a.SUBUNIDADES=a.USER.subunidades_displayname,a.hasRoleOrPerm=g.hasRoleOrPerm,a.dato={},a.views=h.views+"areas/",a.mes=(new Date).getMonth(),a.profesor={},d.params.profesor_id?(a.profesor_id=d.params.profesor_id,b.get("::asignaturas/listasignaturas/"+d.params.profesor_id).then(function(b){return a.asignaturas=b.data.asignaturas,a.profesor=b.data.info_profesor,a.gruposcomportamientos=b.data.grados_comp,a.grupos=b.data.grupos,a.pedidos=b.data.pedidos,a.materias=b.data.materias},function(a){return c.error("No se pudo traer las asignaturas")})):b.get("::asignaturas/listasignaturas").then(function(b){var c,d,e,f,g;for(a.asignaturas=b.data.asignaturas,a.gruposcomportamientos=b.data.grados_comp,a.grupos=b.data.grupos,a.pedidos=b.data.pedidos,a.materias=b.data.materias,f=a.pedidos,g=[],d=0,e=f.length;e>d;d++)c=f[d],(1===c.materia_to_add_accepted||1===c.asignatura_to_remove_accepted)&&(c.estado=":: APROBADO ::  "),0===c.materia_to_add_accepted||0===c.asignatura_to_remove_accepted?g.push(c.estado=":: RECHAZADO ::  "):g.push(void 0);return g},function(a){return c.error("No se pudo traer tus asignaturas")}),a.irAComportamiento=function(b){return d.params.profesor_id?localStorage.profesor_id=d.params.profesor_id:localStorage.profesor_id=a.USER.persona_id,d.go("panel.comportamiento",{grupo_id:b.id})},a.solicitarMateria=function(){return a.dato.grupo?a.dato.materia?!a.dato.creditos>0?void c.warning("Debes asignar la intensidad horaria."):b.put("::ChangesAskedAssignment/solicitar-materia",{grupo_id:a.dato.grupo.id,materia_id:a.dato.materia.id,creditos:a.dato.creditos}).then(function(b){return a.pedidos.push(b.data.pedido),c.success("Materia solicitada. Un administrador lo revisará.")},function(a){return c.error("No se pudo solicitar materia")}):void c.warning("Debes seleccionar una materia."):void c.warning("Debes seleccionar un grupo.")},a.quitarSolicitud=function(d){return b.put("::ChangesAsked/destruir-pedido-asignatura",{asked_id:d.asked_id,assignment_id:d.assignment_id}).then(function(b){return a.pedidos=j("filter")(a.pedidos,{asked_id:"!"+d.asked_id}),c.success("Solicitada eliminada")},function(a){return c.error("No se pudo solicitar materia")})},a.noEsMia=function(b){var d,e,f,g,h;for(h=a.pedidos,f=0,g=h.length;g>f;f++)if(e=h[f],e.asignatura_to_remove_id===b.asignatura_id&&!e.asignatura_to_remove_accepted)return void c.info("Ya has hecho esta solicitud");return d=k.open({templateUrl:"==areas/asignaturaNoEsMia.tpl.html",controller:"AsignaturaNoEsMiaCtrl",resolve:{asignatura:function(){return b}}}),d.result.then(function(b){return c.success("Has solicitado remoción de asignatura."),a.pedidos.push(b.pedido)})},a.irDefinitivas=function(a){return localStorage.asignatura_id_def=a.asignatura_id,d.go("panel.definitivas_periodos",{profesor_id:d.params.profesor_id})},a.open=function(a){return d.go("panel.unidades",{asignatura_id:a.asignatura_id})}}]).controller("AsignaturaNoEsMiaCtrl",["$scope","$uibModalInstance","asignatura","$http","toastr","App",function(a,b,c,d,e,f){return a.asignatura=c,a.ok=function(){var a;return a={asignatura_id:c.asignatura_id},d.put("::ChangesAskedAssignment/pedir-quitar-asignatura",a).then(function(a){return b.close(a.data)},function(a){return e.error("Problema","No se pudo hacer solicitud.")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("FrasesCtrl",["$scope","toastr","$filter","$http","$uibModal","App","AuthService",function(a,b,c,d,e,f,g){var h,i;return g.verificar_acceso(),a.currentFrase={},a.currentFraseEdit={},a.creando=!1,a.gridScope=a,a.tipos=[{tipo_frase:"Debilidad"},{tipo_frase:"Amenaza"},{tipo_frase:"Oportunidad"},{tipo_frase:"Fortaleza"}],a.currentFrase.tipo_frase={tipo_frase:"Fortaleza"},a.cancelarCrear=function(){return a.creando=!1},a.crear=function(){return d.post("::frases/store",a.currentFrase).then(function(c){return a.gridOptions.data.push(c.data),a.currentFrase.frase="",a.cancelarCrear(),b.success("Frase creada con éxito")},function(a){return b.error("Error creando","Problema")})},a.guardar=function(){return d.put("::frases/update/"+a.currentFraseEdit.id,a.currentFraseEdit).then(function(c){return a.currentFraseEdit.frase=c.data.frase,b.success("Frase actualizada con éxito")},function(a){return b.error("Error guardando","Problema")})},a.eliminar=function(b){var d;return d=e.open({templateUrl:f.views+"areas/removeFrase.tpl.html",controller:"RemoveFraseCtrl",resolve:{frase:function(){return b}}}),d.result.then(function(b){return a.gridOptions.data=c("filter")(a.gridOptions.data,{id:"!"+b.id})})},h='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',i='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",width:70,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:60,enableSorting:!1,enableFiltering:!1,cellTemplate:i,enableCellEdit:!1},{field:"tipo_frase",displayName:"Tipo",width:90,enableCellEdit:!1},{field:"frase",displayName:"Frase",minWidth:300}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return d!==e&&(a.currentFraseEdit=b,a.guardar()),a.$apply()})}},d.get("::frases").then(function(b){return a.gridOptions.data=b.data})}]).controller("RemoveFraseCtrl",["$scope","$uibModalInstance","frase","$http","toastr",function(a,b,c,d,e){return a.frase=c,a.ok=function(){return d["delete"]("::frases/destroy/"+c.id).then(function(a){return e.success('frase "'+c.frase+'" eliminada con éxito.',"Eliminada")},function(a){return e.warning("Problema","No se pudo eliminar la frase.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("PaisesCtrl",["$scope",function(a){a.gridOptions={enableSorting:!0,columnDefs:[{field:"pais"},{field:"abreviación"},{field:"id"}],onRegisterApi:function(b){return a.gridApi=b}}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("CiudadesCtrl",["$scope","toastr","$http","paises","$filter",function(a,b,c,d,e){a.paises=d.data,a.datos={},a.creando_ciudad=!1,a.creando_departamento=!1,a.creando_pais=!1,a.ciudad_new="",a.departamento_new="",a.pais_new="",a.modificando_depart=!1,a.crearCiudad=function(){return a.creando_ciudad=!0,a.$broadcast("paisSeleccionadoEvent2")},a.crearDepartamento=function(){return a.creandodepartamento=!0},a.crearPais=function(){return a.creandopais=!0},a.guardarPais=function(d){return d?(d=d.toUpperCase(),a.creandopais=!0,c.post("::paises/store",{pais_new:d}).then(function(c){return b.success("Creado correctamente: "+d),a.paises=c.data,a.creandopais=!1,a.pais_new="",a.mostrarAgregarPais=!1},function(a){return b.error("No se pudo crear","Error")})):b.warning("Debes escribir el nombre del pais.")},a.guardarCiudad=function(d,f){var g;return a.datos.pais?a.datos.departamento||""!==f?""===d?void b.warning("Debe escribir la nueva ciudad."):(g=a.datos.departamento?departamento.departamento:f,c.post("::ciudades/guardar-ciudad",{ciudad:d,departamento:g,pais_id:a.datos.pais.id}).then(function(d){return b.success("Creado correctamente: "+d.data.ciudad),a.datos.departamento&&a.ciudades.push(d.data),a.creandociudad=!1,a.ciudad_new="",a.departamento_new="",a.guardar=!0,c.get("::paises").then(function(b){return a.paises=b.data,a.paisSelect(e("filter")(a.paises,{id:1})[0])},function(a){return b.error("No se pudo traer las ciudades.")})},function(a){return b.error("No se pudo crear","Error")})):void b.warning("Debe seleccionar departamento o escribir uno nuevo."):void b.warning("Debes seleccionar un pais.")},a.escribeEnDepartamentoNew=function(){return a.datos.departamento=void 0},a.actualizarCiudad=function(a){return c.put("::ciudades/actualizar-ciudad",a).then(function(c){return b.success("Actualizado: "+a.ciudad),a.editandoCiudad=!1},function(a){return b.error("No se pudo actualizar","Error")})},a.actualizarDepartamento=function(d){return c.put("::ciudades/actualizar-departamento",d).then(function(c){var e,f,g,h,i;for(b.success("Actualizado: "+d.departamento),d.editandoDepart=!1,f=a.ciudad_new.pais,i=a.ciudades,g=0,h=i.length;h>g;g++)e=i[g],e.departamento=d.departamento;return a.modificando_depart=!0},function(a){return b.error("No se pudo actualizar","Error")})},a.actualizarPais=function(a){return c.put("::paises/actualizar",a).then(function(c){return b.success("Actualizado: "+a.pais),a.editandoPais=!1,a.editandoAbrev=!1},function(a){return b.error("No se pudo actualizar","Error")})},a.paisSelect=function(b,d){return c.put("::ciudades/departamentos-by-id",{pais_id:b.id}).then(function(c){return a.departamentos=c.data.departamentos,"undefined"==typeof a.datos.pais&&(a.datos.pais=b),a.$broadcast("paisSeleccionadoEvent"+d)})},a.paisSelect(e("filter")(a.paises,{id:1})[0],1),a.departamentoSelect=function(b,d){return b?(a.departamento_new="",c.get("::ciudades/por-departamento/"+b.departamento).then(function(c){return a.ciudades=c.data,"undefined"==typeof a.datos.departamento&&(a.datos.departamento=b),a.$broadcast("departamentoSeleccionadoEvent"+d)})):void 0},a.eliminarCiudad=function(d){return c["delete"]("::ciudades/destroy/"+d.id).then(function(c){return b.success("Ciudad enviada a la papelera.","Eliminado"),a.ciudades=e("filter")(a.ciudades,{id:"!"+d.id})},function(a){return b.warning("No se pudo enviar a la papelera.","Problema")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("MensajesCtrl",["$scope","$rootScope","$interval",function(a,b,c){}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider",function(a){return a.state("panel.filemanager",{url:"/filemanager",views:{maincontent:{templateUrl:"==fileManager/fileManager.tpl.html",controller:"FileManagerCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Administrador de archivos"}]}}},data:{displayName:"Administrador de archivos",icon_fa:"fa fa-cube",pageTitle:"Imágenes - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("FileManagerCtrl",["$scope","Upload","$timeout","$filter","App","$http","Perfil","$uibModal","resolved_user","toastr","AuthService","ProfesoresServ",function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o;a.USER=i,a.subir_intacta={},a.hasRoleOrPerm=k.hasRoleOrPerm,a.cantUp=10,a.tabFileManager="mis_img",m=function(){return a.dato={imgUsuario:{id:a.USER.imagen_id,nombre:a.USER.imagen_nombre},imgOficial:{id:a.USER.foto_id,nombre:a.USER.foto_nombre}}},m(),a.perfilPath=e.images+"perfil/",a.imgFiles=[],a.errorMsg="",a.fileReaderSupported=null!==window.FileReader&&(null===window.FileAPI||FileAPI.html5!==!1),a.dato.usuarioElegido=[],a.dato.tipo_a_cambiar="alumno",a.usuariosall=[],a.profesores=[],f.get("::myimages").then(function(b){return b=b.data,a.imagenes_privadas=b.imagenes_privadas,a.imagenes_publicas=b.imagenes_publicas,a.logo=b.logo,a.dato.imgParaUsuario=b.imagenes_privadas[0],a.grupos=b.grupos,a.profesores=b.profesores},function(a){return j.error("No se trajeron las imágenes.")}),a.hasRoleOrPerm(["profesor","admin"])&&(a.cantUp=2),localStorage.tabFileManager?a.tabFileManager=localStorage.tabFileManager:(localStorage.tabFileManager=a.tabFileManager,c(function(){return a.tabFileManager="mis_img"})),a.selectTab=function(b){return localStorage.tabFileManager=b,a.tabFileManager=localStorage.tabFileManager},a.uploadFiles=function(b){var c,d,e,f,g;if(a.imagenes_privadas.length>2&&a.hasRoleOrPerm(["alumno","acudiente"])&&j.warning("No tiene permiso para subir más imágenes"),a.imgFiles=b,a.errorMsg="",b&&b.length){for(g=[],d=e=0,f=b.length;f>=0?f>e:e>f;d=f>=0?++e:--e)c=b[d],g.push(n(c));return g}},n=function(b){return a.errorMsg=null,o(b),a.generateThumb(b)},a.generateThumb=function(b){return null!==b&&a.fileReaderSupported&&b.type.indexOf("image")>-1?c(function(){var a;return a=new FileReader,a.readAsDataURL(b),a.onload=function(a){return c(function(){return b.dataUrl=a.target.result})}}):void 0},o=function(c){var d;return d=a.subir_intacta.intacta?"-intacta":"",c.size>1e7?void(a.errorMsg="Archivo excede los 10MB permitidos."):b.upload({url:e.Server+"myimages/store"+d,file:c}).progress(function(a){var b;return b=parseInt(100*a.loaded/a.total),c.porcentaje=b}).success(function(b,c,d,e){return a.subir_intacta.intacta?a.imagenes_publicas.push(b):a.imagenes_privadas.push(b)}).error(function(a){return console.log("Falla uploading: ",a)}).xhr(function(a){})},a.pedirCambioUsuario=function(b){return b.id?f.put("::images-users/cambiar-imagen-perfil/"+a.USER.user_id,{imagen_id:b.id}).then(function(c){return c=c.data,a.hasRoleOrPerm("admin")?(g.setImagen(c.imagen_id,b.nombre),a.$emit("cambianImgs",{image:c}),j.success("Imagen principal cambiada")):j.info("Ahora espera que un administrador acepte tu imagen","Solicitado")},function(a){return j.error("No se pudo cambiar imagen","Problema")}):j.warning("Selecciona una imagen")},a.pedirCambioOficial=function(b){return b.id?f.put("::images-users/cambiar-imagen-oficial/"+a.USER.user_id,{foto_id:b.id}).then(function(c){return c=c.data,a.hasRoleOrPerm("admin")?(g.setOficial(c.foto_id,b.nombre),a.$emit("cambianImgs",{foto:c}),j.success("Foto oficial cambiada")):j.info("Ahora espera que un administrador acepte tu imagen","Solicitado")},function(a){return j.error("No se pudo cambiar foto","Problema")}):j.warning("Selecciona una imagen")},a.pedirCambioFirma=function(b){var c;return b.id?(c={imgFirmaProfe:b.id},f.put("::perfiles/cambiarfirmaunprofe/"+a.USER.persona_id,c).then(function(b){return j.success("Firma cambiada con éxito"),a.USER.firma_id=b.data.id,a.USER.firma_nombre=b.data.nombre},function(a){return j.error("Error al asignar foto al profesor","Problema")})):j.warning("Selecciona una imagen")},a.cambiarLogoColegio=function(b){return f.put("::myimages/cambiarlogocolegio",{logo_id:b.id}).then(function(c){return j.success("Logo del colegio cambiado"),a.logo.logo=b.nombre,a.logo.logo_id=b.id,console.log(a.logo,b)},function(a){return j.error("No se pudo cambiar el logo","Problema")})},a.grupoSelect=function(b,c){return f.get("::grupos/listado/"+b.id).then(function(b){return b=b.data,a.alumnos=b,a.dato.alumnoElegido=b[0],a.alumSelect(a.dato.alumnoElegido)},function(a){return j.error("No se pudo traer los usuarios")})},a.rotarImagen=function(a){return f.put("::images-users/rotarimagen/"+a.id).then(function(b){return a.nombre="",j.success("Imagen rotada"),a.nombre=b.data+"?"+(new Date).getTime()},function(a){return j.error("Imagen no rotada")})},a.publicarImagen=function(b){return f.put("::myimages/publicar-imagen/"+b.id).then(function(c){return j.info("Ahora la imagen es pública"),a.imagenes_privadas=d("filter")(a.imagenes_privadas,{id:"!"+b.id}),a.imagenes_publicas.push(b)},function(a){return j.error("Imagen no publicada")})},a.privatizarImagen=function(b){return f.put("::myimages/privatizar-imagen/"+b.id).then(function(c){return c=c.data,c.imagen?void j.warning("No puede ser logo del año "+c.imagen.is_logo_of_year):(j.info("Ahora la imagen es privada"),b.user_id===a.USER.user_id&&a.imagenes_privadas.push(b),a.imagenes_publicas=d("filter")(a.imagenes_publicas,{id:"!"+b.id}))},function(a){return j.error("Imagen no privatizada")})},a.borrarImagen=function(b,c){var e;return e=h.open({templateUrl:"==fileManager/removeImage.tpl.html",controller:"RemoveImageCtrl",size:"sm",resolve:{imagen:function(){return b},user_id:function(){return c},datos_imagen:function(){var d;return d={imagen_id:b.id,user_id:c},f.get("::myimages/datos-imagen",d).then(function(b){return a.datos_imagen=b.data},function(a){return j.error("Error al traer datos de imagen","Problema"),{}})}}}),e.result.then(function(b){return a.hasRoleOrPerm("admin")?(b.publica?a.imagenes_publicas=d("filter")(a.imagenes_publicas,{id:"!"+b.id}):a.imagenes_privadas=d("filter")(a.imagenes_privadas,{id:"!"+b.id}),j.success("La imagen ha sido removida.")):b.user_id===a.USER.user_id?(j.success("La imagen ha sido removida."),b.publica?a.imagenes_publicas=d("filter")(a.imagenes_publicas,{id:"!"+b.id}):a.imagenes_privadas=d("filter")(a.imagenes_privadas,{id:"!"+b.id})):j.info("Un administrador borrará la imagen ya que no fuiste tú quien la subió","Solicitado")})},a.cambiarImgUnUsuario=function(b,c){var e,g;return g=!1,g=c?confirm("Esto quitará la imágen de tu lista. ¿Seguro que deseas cambiar la imagen de este usuario?"):confirm("¿Ya no quieres que esta sea su imagen de perfil?"),g?(e={},c&&(e.imagen_id=c.id),f.put("::images-users/cambiar-imagen-un-usuario/"+b.user_id,e).then(function(e){return c?(b.imagen_id=c.id,b.imagen_nombre=c.nombre,a.imagenes_privadas=d("filter")(a.imagenes_privadas,function(a){return a.id!==c.id}),a.dato.selectedImg=void 0,j.success("Imagen quitada con éxito")):(b.imagen_id=null,b.imagen_nombre="default_male.png",j.success("Imagen asignada con éxito"))},function(a){return j.error("Error al asignar imagen a usuario","Problema")})):void 0},a.cambiarFotoUnUsuario=function(b,c){var e,g;return g=!1,g=c?confirm("Esto quitará la imágen de tu lista. ¿Seguro que deseas cambiar la imagen de este usuario?"):confirm("¿Ya no quieres que esta sea su foto oficial?"),g?(e={},c&&(e.imagen_id=c.id),f.put("::images-users/cambiar-foto-un-usuario/"+b.user_id,e).then(function(e){return c?(b.imagen_id=c.id,b.foto_nombre=c.nombre,a.imagenes_privadas=d("filter")(a.imagenes_privadas,function(a){return a.id!==c.id}),a.dato.selectedImg=void 0,j.success("Foto quitada con éxito")):(b.foto_id=null,b.foto_nombre="default_male.png",j.success("Foto asignada con éxito"))},function(a){return j.error("Error al asignar foto oficial","Problema")})):void 0},a.cambiarFirmaUnProfe=function(b,c){var e;return e={imagen_id:c.id},f.put("::images-users/cambiar-firma-un-profe/"+b.profesor_id,e).then(function(e){return b.firma_id=c.id,b.firma_nombre=c.nombre,a.imagenes_privadas=d("filter")(a.imagenes_privadas,function(a){return a.id!==c.id}),a.dato.selectedImg=void 0,j.success("Firma asignada con éxito")},function(a){return j.error("Error al asignar firma","Problema")})},a.alumSelect=function(b,c){var d;return d={usuario_id:b.user_id},f.put("::images-users/imagenes-de-usuario",d).then(function(b){return a.imagenes_del_usuario=b.data,a.mostrando_opt_img_de_alum=!0},function(a){return j.error("Error trayendo imagenes del usuario","Problema")})},a.profeSelect=function(b,c){var d;return d={usuario_id:b.user_id},f.put("::images-users/imagenes-de-usuario",d).then(function(b){return a.imagenes_del_usuario=b.data,a.mostrando_opt_img_de_prof=!0},function(a){return j.error("Error trayendo imagenes del usuario","Problema")})},a.moveImgToMe=function(a,b){var c;return c={img_id:a.id},f.put("::images-users/move-img-to-me",c).then(function(a){return j.success("Ahora la imagen te pertenece.")},function(a){return j.error("Error mover imagen","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("RemoveImageCtrl",["$scope","$uibModalInstance","imagen","user_id","datos_imagen","App","$http","AuthService","toastr",function(a,b,c,d,e,f,g,h,i){a.imagesPath=f.images+"perfil/",a.imagen=c,a.datos_imagen=e,a.hasRoleOrPerm=h.hasRoleOrPerm,a.ok=function(){return g["delete"]("::myimages/destroy/"+c.id).then(function(a){return console.log("Proceso de eliminado exitoso")},function(a){return i.error("No se pudo eliminar la imagen.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","USER_ROLES","PERMISSIONS",function(a,b,c){return a.state("panel.papelera",{url:"^/papelera",views:{maincontent:{templateUrl:"==papelera/papelera.tpl.html",controller:"PapeleraCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Papelera de reciclaje"}]}}},data:{displayName:"Papelera",icon_fa:"fa fa-trash",pageTitle:"Papelera - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("PapeleraCtrl",["$scope","App","$state","$http","$uibModal","$filter","toastr",function(a,b,c,d,e,f,g){var h,i,j,k,l,m;return a.restaurarAlum=function(b){return d.put("::alumnos/restore/"+b.alumno_id).then(function(){return a.gridAlumnos.data=f("filter")(a.gridAlumnos.data,{alumno_id:"!"+b.alumno_id}),g.success("Éxito","Alumno restaurado")},function(a){return g.error("No se restauró el alumno","Error")})},a.elimAlum=function(b){var c;return c=e.open({templateUrl:"==papelera/forceRemoveAlumno.tpl.html",controller:"ForceRemoveAlumnoCtrl",resolve:{alumno:function(){return b}}}),c.result.then(function(b){return a.gridAlumnos.data=f("filter")(a.gridAlumnos.data,{alumno_id:"!"+b.alumno_id})})},h='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarAlum(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',
i='<a uib-tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimAlum(row.entity)"><i class="fa fa-times "></i></a>',a.gridAlumnos={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"alumno_id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:110,enableSorting:!1,enableFiltering:!1,cellTemplate:h+i},{field:"nombres",enableHiding:!1},{field:"apellidos"},{field:"sexo",maxWidth:20},{field:"username",displayName:"Usuario"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date"},{field:"direccion",displayName:"Dirección"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},a.restaurarGrupo=function(b){return d.put("::grupos/restore/"+b.id).then(function(){return a.gridGrupos.data=f("filter")(a.gridGrupos.data,{id:"!"+b.id}),g.success("Éxito","Grupo restaurado")},function(a){return g.error("No se restauró el grupo","Error")})},a.elimGrupo=function(b){var c;return c=e.open({templateUrl:"::papelera/forceRemoveGrupo.tpl.html",controller:"ForceRemoveGrupoCtrl",resolve:{grupo:function(){return b}}}),c.result.then(function(b){return a.gridGrupos.data=f("filter")(a.gridGrupos.data,{id:"!"+b.id})})},j='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarGrupo(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',k='<a uib-tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimGrupo(row.entity)"><i class="fa fa-times "></i></a>',a.gridGrupos={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:110,enableSorting:!1,enableFiltering:!1,cellTemplate:j+k},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura"},{field:"grado_id",maxWidth:20},{field:"titular_id",displayName:"Titular"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},d.get("::alumnos/trashed").then(function(b){return a.gridAlumnos.data=b.data},function(a){return g.warning("No se pudo traer los alumnos eliminados.")}),d.get("::grupos/trashed").then(function(b){return a.gridGrupos.data=b.data},function(a){return g.warning("No se pudo traer los grupos eliminados.")}),a.restaurarUnidad=function(b){return d.put("::unidades/restore/"+b.id).then(function(){return a.gridUnidad.data=f("filter")(a.gridUnidad.data,{id:"!"+b.id}),g.success("Éxito","Unidad restaurada")},function(a){return g.error("No se restauró la unidad","Error")})},a.elimUnidad=function(b){var c;return c=e.open({templateUrl:"==papelera/forceRemoveUnidad.tpl.html",controller:"ForceRemoveUnidadCtrl",resolve:{unidad:function(){return b}}}),c.result.then(function(b){return a.gridUnidad.data=f("filter")(a.gridUnidad.data,{id:"!"+b.id})})},l='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarUnidad(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',m='<a uib-tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimUnidad(row.entity)"><i class="fa fa-times "></i></a>',a.gridUnidad={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:110,enableSorting:!1,enableFiltering:!1,cellTemplate:l+m},{field:"definicion",displayName:"Definición",enableHiding:!1},{field:"alias_materia",displayName:"Materia"},{field:"abrev_grupo",displayName:"Grupo"},{field:"numero_periodo",displayName:"Per",maxWidth:20},{field:"porcentaje",displayName:"Porc"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},d.get("::unidades/trashed").then(function(b){return a.gridUnidad.data=b.data},function(a){return g.warning("No se pudo traer las unidades eliminados.")}),d.get("::unidades/trashed").then(function(b){return a.gridUnidad.data=b.data},function(a){return g.warning("No se pudo traer las unidades eliminadas.")})}])}.call(this),function(){angular.module("myvcFrontApp").controller("ForceRemoveAlumnoCtrl",["$scope","$uibModalInstance","alumno","$http","toastr",function(a,b,c,d,e){return a.alumno=c,a.ok=function(){return d["delete"]("::alumnos/forcedelete/"+c.alumno_id).then(function(a){return e.success("Alumno eliminado con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar al alumno.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("ForceRemoveGrupoCtrl",["$scope","$uibModalInstance","grupo","$http","toastr",function(a,b,c,d,e){return a.grupo=c,a.ok=function(){return d["delete"]("::grupos/forcedelete/"+c.id).then(function(a){return e.success("Grupo eliminado con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar al grupo.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("ForceRemoveUnidadCtrl",["$scope","$uibModalInstance","unidad","$http","toastr",function(a,b,c,d,e){return a.unidad=c,a.ok=function(){return d["delete"]("::unidades/forcedelete/"+c.id).then(function(a){return e.success("Unidad eliminada con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar la unidad.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){return a.state("panel.bitacora",{url:"/bitacora",views:{maincontent:{templateUrl:""+b.views+"bitacora/bitacora.tpl.html",controller:"BitacoraCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Bitacora"}]}}},data:{displayName:"Bitacora",icon_fa:"fa fa-male",pageTitle:"Bitácora - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("BitacoraCtrl",["$scope","toastr","$state","$http","uiGridConstants","AuthService",function(a,b,c,d,e,f){var g;return a.data={},a.hasRoleOrPerm=f.hasRoleOrPerm,d.get("::contratos").then(function(b){return a.contratos=b.data},function(a){return b.error("No se trajeron los profesores contratados")}),d.get("::bitacoras").then(function(b){return a.gridOptions.data=b.data},function(a){return b.error("No se pudo traer la bitácora")}),a.seleccionaProfe=function(c,e){return d.get("::bitacoras/index/"+c.user_id).then(function(b){return a.gridOptions.data=b.data},function(a){return b.error("No se pudo traer la bitácora")})},g='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"id",type:"number",width:60},{name:"edicion",displayName:"Edición",width:40,enableSorting:!1,enableFiltering:!1,cellTemplate:g,enableCellEdit:!1},{field:"descripcion",displayName:"Descripción",filter:{condition:e.filter.CONTAINS}},{field:"affected_element_type",displayName:"Tipo",minWidth:80,filter:{condition:e.filter.CONTAINS}},{field:"affected_element_old_value_int",displayName:"Anterior"},{field:"affected_element_new_value_int",displayName:"Nuevo"},{field:"created_at",displayName:"Fecha",width:150,filter:{condition:e.filter.CONTAINS}}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","USER_ROLES","PERMISSIONS",function(a,b,c){a.state("panel.usuarios",{url:"^/usuarios",views:{maincontent:{templateUrl:"==usuarios/usuarios.tpl.html",controller:"UsuariosCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Usuarios"}]}}},data:{displayName:"Usuarios",icon_fa:"fa fa-user",needed_permissions:[c.can_edit_usuarios],pageTitle:"Usuarios - MyVc"}}).state("panel.user",{url:"^/user/:username",views:{maincontent:{templateUrl:"==usuarios/user.tpl.html",controller:"UserCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Perfil"}]}}},resolve:{perfilactual:["$http","$stateParams","$q","$state","toastr",function(a,b,c,d,e){var f,g;return f=c.defer(),g=b.username,g||""===g?a.get("::perfiles/username/"+g).then(function(a){return a.data[0].fecha_nac&&(a.data[0].fecha_nac=a.data[0].fecha_nac?new Date(a.data[0].fecha_nac.replace(/-/g,"/")):a.data[0].fecha_nac),f.resolve(a.data[0])},function(a){return f.reject(a)}):(e.warning("Lo sentimos, nombre de usuario no encontrado"),d.go("panel")),f.promise}]},data:{displayName:"Perfil",icon_fa:"fa fa-user"}}).state("panel.user.resumen",{url:"/r",views:{user_detail:{templateUrl:"==usuarios/userResumen.tpl.html",controller:"UserResumenCtrl"}},data:{displayName:"Resumen",icon_fa:"fa fa-user"}}).state("panel.user.configuracion",{url:"/c",views:{user_detail:{templateUrl:"==usuarios/userConfiguracion.tpl.html",controller:"UserConfiguracionCtrl"}},data:{displayName:"Configuración de perfil",icon_fa:"fa fa-user"}}).state("panel.usuarios.roles",{url:"/roles",views:{user_roles:{templateUrl:"==usuarios/roles.tpl.html",controller:"RolesCtrl"}},data:{displayName:"Roles",icon_fa:"fa fa-user-secret"}}).state("panel.usuarios.editar",{url:"/editar/:user_id",views:{edit_user:{templateUrl:"==usuarios/usuariosEdit.tpl.html",controller:"UsuariosEditCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-users",pageTitle:"Editar alumno - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserCtrl",["$scope","$http","$state","AuthService","Perfil","App","perfilactual","$filter",function(a,b,c,d,e,f,g,h){var i,j;if(j=c.params.username,a.perfilactual=g,a.companieros=[],a.profesores=[],a.materias=[],a.canConfig=!1,a.hasRoleOrPerm=d.hasRoleOrPerm,a.perfilPath=f.images+"perfil/",a.setImagenPrincipal(),a.USER.user_id===a.perfilactual.user_id&&(a.canConfig=!0),a.setImagenPrincipal=function(){var b,c,d,e,g;return d=f.images+"perfil/",c=a.perfilactual.imagen_nombre,b=a.perfilactual.foto_nombre,g=d+c,e=d+b,a.imagenPrincipal=g,a.imagenOficial=e},i=function(){return b.get("::perfiles/profesormispersonas").then(function(b){return b=b.data,a.perfilactual=b[0],a.setImagenPrincipal()},function(a){return toastr.error("No se pudo traer el usuario"),c.transitionTo("panel")})},a.paisNacSelect=function(c,d){return b.get("::ciudades/departamentos/"+c.id).then(function(b){return a.departamentosNac=b.data,"undefined"==typeof a.perfilactual.pais_doc?(a.perfilactual.pais_doc=c,a.paisDocSelecionado(c)):void 0})},a.departNacSelect=function(c){return b.get("::ciudades/por-departamento/"+c.departamento).then(function(b){return a.ciudadesNac=b.data,"undefined"==typeof a.perfilactual.departamento_doc?(a.perfilactual.departamento_doc=c,a.departDocSeleccionado(c)):void 0})},a.paisDocSelecionado=function(c,d){return b.get("::ciudades/departamentos/"+c.id).then(function(b){return a.departamentos=b.data})},a.departDocSeleccionado=function(c){return b.get("::ciudades/por-departamento/"+c.departamento).then(function(b){return a.ciudades=b.data})},b.get("::paises").then(function(b){return a.paises=b.data}),b.get("::tiposdocumento").then(function(b){var c;return a.tipos_doc=b.data,a.perfilactual.tipo_doc&&(c=h("filter")(a.tipos_doc,{id:a.perfilactual.tipo_doc}),c.length>0)?a.perfilactual.tipo_doc=c[0]:void 0}),null===a.perfilactual.ciudad_nac)a.perfilactual.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisNacSelect(a.perfilactual.pais_nac,a.perfilactual.pais_nac);else{if("N/A"===a.perfilactual.ciudad_nac)return;b.get("::ciudades/datosciudad/"+a.perfilactual.ciudad_nac).then(function(b){return a.paises=b.data.paises,a.departamentosNac=b.departamentos,a.ciudadesNac=b.ciudades,a.perfilactual.pais_nac=b.pais,a.perfilactual.departamento_nac=b.departamento,a.perfilactual.ciudad_nac=b.ciudad}),b.get("::ciudades/datosciudad/"+a.perfilactual.ciudad_doc).then(function(b){return a.paises=b.data.paises,a.departamentos=b.departamentos,a.ciudades=b.ciudades,a.perfilactual.pais_doc=b.pais,a.perfilactual.departamento_doc=b.departamento,a.perfilactual.ciudad_doc=b.ciudad})}return a.nameToShow=function(){return"Usu"===a.perfilactual.tipo?a.perfilactual.username.toUpperCase():a.perfilactual.nombres+" "+a.perfilactual.apellidos}}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserConfiguracionCtrl",["$scope","$http","$state","toastr","AuthService","Perfil","App","perfilactual",function(a,b,c,d,e,f,g,h){return e.verificar_acceso(),a.data={},a.comprobando=!1,a.mostrarErrorUsername=!1,a.mostrarErrorPassword=!1,a.canSaveUsername=!1,a.hasRoleOrPerm=e.hasRoleOrPerm,a.perfilPath=g.images+"perfil/",a.perfilactual=h,a.newusername="",a.passantiguo="",a.newpass="",a.newpassverif="",a.status={passCambiado:!1},a.nombresdeusuario=[],b.get("::perfiles/usernames").then(function(b){return a.nombresdeusuario=b.data},function(a){return d.error("No se trajeron los nombres de usuario")}),a.dateOptions={formatYear:"yyyy",allowInvalid:!0},a.guardarEmailRestore=function(a){return b.put("::perfiles/guardar-mi-email-restore",{email_restore:a}).then(function(a){return d.success("Email guardado con éxito")},function(a){return d.error("No se trajeron los nombres de usuario")})},a.$watch("newusername",function(a,b){}),a.comprobarusername=function(c){return a.canSaveUsername=!1,a.comprobando=!0,c.username&&(c=c.username),c===a.perfilactual.username?(d.warning("Copia un nombre de usuario diferente al que ya tienes"),void(a.comprobando=!1)):""===c?(d.warning("Debes copiar un nombre de usuario."),void(a.comprobando=!1)):b.get("::perfiles/comprobarusername/"+c).then(function(b){return b=b.data,b[0].existe?(d.warning("Nombre de usuario ya en uso."),a.mostrarErrorUsername=!0):(a.mostrarErrorUsername=!1,a.canSaveUsername=!0),a.comprobando=!1},function(b){return d.error("No se trajeron los nombres de usuario"),a.comprobando=!1})},a.guardar=function(){var c;return a.canSaveUsername=!1,c={nombres:a.perfilactual.nombres,apellidos:a.perfilactual.apellidos,sexo:a.perfilactual.sexo,fecha_nac:a.perfilactual.fecha_nac,celular:a.perfilactual.celular,tipo:a.perfilactual.tipo,email_persona:a.perfilactual.email_persona},b.put("::perfiles/update/"+a.perfilactual.persona_id,c).then(function(a){return d.success("Datos guardados")},function(b){return d.error("Datos NO guardados","Problema"),a.canSaveUsername=!0})},a.solicitarCambios=function(){return a.canSaveUsername=!1,b.put("::ChangesAsked/solicitar-cambios",a.perfilactual).then(function(a){return d.info("Debes esperar que un administrador acepte cambios","Solicitud realizada",{timeOut:8e3})},function(b){return d.error("Datos NO guardados","Problema"),a.canSaveUsername=!0})},a.CambiarUsername=function(c){return b.put("::perfiles/guardar-username/"+a.perfilactual.user_id,{username:c}).then(function(b){return d.success("Nombre de usuario guardado"),f.User().username=c,a.$emit("cambianImgs",{username:c})},function(a){return d.error("Nombre de usuario NO guardado","Problema")})},a.CambiarPass=function(c,e,f){var g;return c!==e?void d.warning("Las contraseñas no coinciden"):c.length<4?void d.warning("La contraseña debe tener mínimo 4 caracteres. Sin espacios ni Ñ ni tildes."):(a.cambiandoPass=!0,g={password:e,oldpassword:f},b.put("::perfiles/cambiarpassword/"+a.perfilactual.user_id,g).then(function(b){return d.success("Contraseña cambiada."),a.status.passCambiado=!1,a.cambiandoPass=!1},function(b){return b=b.data,b.$error&&"Contraseña antigua es incorrecta"===b.error.message?d.warning(b.error.message):d.error("No se pudo cambiar la contraseña."),a.cambiandoPass=!1}))},a.CambiarCorreoRestore=function(){var c;return c={email_restore:a.email_restore},b.put("::perfiles/cambiaremailrestore/"+a.perfilactual.user_id,c).then(function(a){return d.success("Contraseña cambiada.")},function(a){return d.error("No se pudo cambiar la contraseña","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserResumenCtrl",["$scope","$http",function(a,b){}])}.call(this),function(){angular.module("myvcFrontApp").controller("UsuariosCtrl",["$scope","$http","$state","$rootScope","AuthService","Perfil","App","$uibModal","$filter","toastr",function(a,b,c,d,e,f,g,h,i,j){var k,l;return e.verificar_acceso(),a.editar=function(a){return c.go("panel.usuarios.editar",{usuario_id:a.user_id})},a.eliminar=function(b){var c;return c=h.open({templateUrl:"==usuarios/removeUsuario.tpl.html",controller:"RemoveUsuarioCtrl",resolve:{usuario:function(){return b}}}),c.result.then(function(b){return a.gridOptions.data=i("filter")(a.gridOptions.data,{id:"!"+b.id})})},a.resetPass=function(a){var b;return b=h.open({templateUrl:"==usuarios/resetPass.tpl.html",controller:"ResetPassCtrl",resolve:{usuario:function(){return a}}}),b.result.then(function(a){})},a.verRoles=function(a){var c;return c=h.open({templateUrl:"==usuarios/verRoles.tpl.html",controller:"VerRolesCtrl",resolve:{usuario:function(){return a},roles:function(){return b.get("::roles")}}}),c.result.then(function(a){})},k='<a uib-tooltip="No cambies roles, consulta antes" class="btn btn-default btn-xs shiny" ng-click="grid.appScope.verRoles(row.entity)">Roles</a>',l='<a uib-tooltip="Resetear contraseña" tooltip-placement="right" class="btn btn-default btn-xs shiny" ng-click="grid.appScope.resetPass(row.entity)">Cambiar password</a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enableGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"user_id",width:70,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:200,enableSorting:!1,enableFiltering:!1,cellTemplate:k+l,enableCellEdit:!1},{field:"username",displayName:"Usuario",filter:{condition:function(a,b,c){var d;return d=c.entity,d.username?d.username.toLowerCase().indexOf(a.toLowerCase())>-1:!1}},enableHiding:!1},{field:"nombres",cellTemplate:'<div>{{row.entity.nombres + " " + row.entity.apellidos}}</div>',filter:{condition:function(a,b,c){var d;return d=c.entity,d.nombres?d.nombres.toLowerCase().indexOf(a.toLowerCase())>-1||d.apellidos.toLowerCase().indexOf(a.toLowerCase())>-1:!1}}},{field:"sexo",width:70},{field:"roles",displayName:"Roles",enableCellEdit:!1,cellFilter:"mapRoles",filter:{condition:function(a,b){var c;return c=i("filter")(b,{name:a}),c.length>0}}}],multiSelect:!1,onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,f){return e!==f&&("username"===d.field?b.put("::perfiles/guardar-username/"+c.user_id,{username:c.username}).then(function(a){return j.success("Nombre de Usuario actualizado con éxito","Actualizado")},function(a){return j.error("Cambio no guardado","Error")}):b.put("::perfiles/update/"+c.persona_id,c).then(function(a){return j.success("Usuario actualizado con éxito","Actualizado")},function(a){return j.error("Cambio no guardado","Error")})),a.$apply()})}},b.get("::perfiles/usuariosall?year_id="+a.USER.year_id).then(function(b){return a.gridOptions.data=b.data}),a.crearTodosLosUsuarios=function(){return b.put("::perfiles/creartodoslosusuarios").then(function(a){return j.success("Usuarios creados con éxito")},function(a){return j.error("No se pudo crear los usuarios","Problema")})}}]).filter("mapRoles",["$filter",function(a){return function(a,b){var c;return a?(c=[],angular.forEach(a,function(a,b){return c.push(a.name)}),c=c.join()):""}}]).controller("RemoveUsuarioCtrl",["$scope","$uibModalInstance","usuario","$http","toastr",function(a,b,c,d,e){return a.usuario=c,a.ok=function(){return d["delete"]("::perfiles/destroy/"+c.user_id).then(function(a){return e.success("Usuario eliminado con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar al usuario.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("ResetPassCtrl",["$scope","$uibModalInstance","usuario","$http","toastr",function(a,b,c,d,e){return a.usuario=c,a.newpassword="",a.showPassword=!1,a.ok=function(){return d.put("::perfiles/reset-password/"+c.user_id,{password:a.newpassword}).then(function(a){return e.success("Contraseña cambiada.")},function(a){return e.warning("No se pudo cambiar contraseña.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("VerRolesCtrl",["$scope","$uibModalInstance","usuario","roles","$http","toastr",function(a,b,c,d,e,f){return a.usuario=c,a.roles=d.data,a.datos={selecteds:[]},a.datos.selecteds=c.roles,a.seleccionando=function(a,b){return e.put("::roles/addroletouser/"+a.id,{user_id:c.user_id}).then(function(a){return f.success("Rol agregado con éxito.")},function(a){return f.warning("No se pudo agregar el rol al usuario.","Problema")})},a.quitando=function(a,b){return e.put("::roles/removeroletouser/"+a.id,{user_id:c.user_id}).then(function(a){return f.success("Rol quitado con éxito.")},function(a){return f.warning("No se pudo quitar el rol al usuario.","Problema")})},a.ok=function(){return c.roles=a.datos.selecteds,b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("UsuariosEditCtrl",["$scope","$rootScope","$state","$http","toastr",function(a,b,c,d,e){a.data={},a.usuario={},a.tipos=[{tipo:"Alumno"},{tipo:"Profesor"},{tipo:"Acudiente"},{tipo:"Solo usuario"}],a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],d.get("::usuarios/show/"+c.params.usuario_id).then(function(b){return a.usuario=b.data}),a.guardar=function(){return d.put("::alumnos/update/"+a.alumno.id,a.alumno).then(function(a){return e.success("Alumno actualizado correctamente")},function(a){return e.error("No se pudo guardar el alumno")})},a.paisNacSelect=function(b,c){return d.get("::ciudades/departamentos/"+b.id).then(function(c){return a.departamentosNac=c,"undefined"==typeof a.alumno.pais_doc?(a.alumno.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return d.get("::ciudades/por-departamento/"+b.departamento).get().then(function(c){return a.ciudadesNac=c,"undefined"==typeof a.alumno.departamento_doc?(a.alumno.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b,c){return d.get("::ciudades/departamentos/"+b.id).then(function(b){return a.departamentos=b.data})},a.departSeleccionado=function(b){return d.get("::ciudades/por-departamento/"+b.departamento).then(function(b){return a.ciudades=b.data})},a.dateOptions={formatYear:"yyyy"},a.restarEstrato=function(){return a.alumno.estrato>0?a.alumno.estrato=a.alumno.estrato-1:void 0},a.sumarEstrato=function(){return a.alumno.estrato<10?a.alumno.estrato=parseInt(a.alumno.estrato)+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("RolesCtrl",["$scope","$http","$state","$rootScope","AuthService","toastr","App","$filter",function(a,b,c,d,e,f,g,h){return e.verificar_acceso(),a.hasRoleOrPerm=e.hasRoleOrPerm,a.dato={},a.roles=[],a.permissions=[],b.get("::roles").then(function(b){return a.roles=b.data},function(a){return f.error("No se pudo traer los roles ",a)}),b.get("::permissions").then(function(b){return a.permissions=b.data},function(a){return f.error("No se pudo traer los permissions ",a)}),a.expand=function(a){return a.mostrandoPermisos=!0},a.collapse=function(a){return a.mostrandoPermisos=!1},a.addPermissions=function(a){return b.put("::roles/addpermission/"+a.id,{permission_id:a.newperm.id}).then(function(b){return a.perms.push(b.data),f.success("Permiso agregado al rol "+a.display_name)},function(a){return f.error("No se pudo agregar el permiso","Problema")})},a.removePermission=function(a,c){return b.put("::roles/removepermission/"+a.id,{permission_id:c.id}).then(function(b){return a.perms=h("filter")(a.perms,{id:"!"+c.id}),f.success("Permiso eliminado del rol "+a.display_name)},function(a){return f.error("No se pudo quitar el permiso","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PermissionsCtrl",["$scope","$http",function(a,b){}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(a,b,c){return a.state("panel.unidades",{url:"^/unidades/:asignatura_id",views:{maincontent:{templateUrl:"==unidades/unidades.tpl.html",controller:"UnidadesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:["AuthService","$q",function(a,b){var c;return c=b.defer(),a.verificar().then(function(a){return c.resolve(a.unidades_displayname)},function(a){return c.resolve("Unidades")}),c.promise}]}}},resolve:{usuario:["AuthService",function(a){return a.verificar()}]},data:{displayName:"Unidades",icon_fa:"fa fa-graduation-cap",pageTitle:"Unidades - MyVc",needed_permissions:[c.can_work_like_teacher,c.can_edit_unidades_subunidades]}}).state("panel.copiar",{url:"^/copiar",views:{maincontent:{templateUrl:"==unidades/copiar.tpl.html",controller:"CopiarCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Copiar"}]}}},data:{displayName:"Copiar",icon_fa:"fa fa-copy",pageTitle:"Copiar - MyVc",needed_permissions:[c.can_work_like_teacher,c.can_edit_unidades_subunidades]}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("UnidadesCtrl",["$scope","$uibModal","$http","$state","$filter","AuthService","toastr","resolved_user","$timeout",function(a,b,c,d,e,f,g,h,i){return f.verificar_acceso(),a.asignatura={},a.asignatura_id=d.params.asignatura_id,a.datos={},a.UNIDAD=a.USER.unidad_displayname,a.GENERO_UNI=a.USER.genero_unidad,a.SUBUNIDAD=a.USER.subunidad_displayname,a.GENERO_SUB=a.USER.genero_subunidad,a.UNIDADES=a.USER.unidades_displayname,a.SUBUNIDADES=a.USER.subunidades_displayname,a.hasRoleOrPerm=f.hasRoleOrPerm,a.activar_crear_unidad=!0,a.unidades=[],c.get("::unidades/de-asignatura-periodo/"+a.asignatura_id+"/"+a.USER.periodo_id).then(function(b){var c,d,f,g,h,i,j,k;if(b.data.length>0){for(j=b.data,f=0,h=j.length;h>f;f++)for(d=j[f],d.anim_bloqueada=!1,d.subunidades=e("orderBy")(d.subunidades,"orden"),a.bloquear_animacion(d),k=d.subunidades,g=0,i=k.length;i>g;g++)c=k[g],c.anim_bloqueada=!1,a.bloquear_animacion(c);return a.unidades=b.data,a.unidades=e("orderBy")(a.unidades,"orden"),a.calcularPorcUnidades()}},function(b){return g.error("No se pudo traer las "+a.UNIDADES,"Problemas")}),c.get("::asignaturas/show/"+a.asignatura_id).then(function(b){return b=b.data,a.asignatura=b,a.inicializado=!0,a.profesor_id=b.profesor_id,b?void 0:a.no_asignatura=!0},function(b){return g.error("No se pudo traer los datos de la asignatura"),a.no_asignatura=!0}),a.mostrarUnidadesEliminadas=function(){return a.mostrando_unidades_eliminadas?a.mostrando_unidades_eliminadas=!1:c.put("::unidades/eliminadas/"+a.asignatura_id).then(function(b){return b=b.data,a.unidades_eliminadas=b.unidades_eliminadas,a.subunidades_eliminadas=b.subunidades_eliminadas,a.mostrando_unidades_eliminadas=!0},function(b){return a.mostrando_unidades_eliminadas=!0,g.error("No se pudo traer las unidades eliminadas")})},a.restaurarUnidad=function(b){return b.restaurando?void 0:(b.restaurando=!0,c.put("::unidades/restore/"+b.id).then(function(c){return a.unidades.push(b),a.calcularPorcUnidades(),i(function(){return a.onSortUnidades(void 0,a.unidades)},100),g.success("Listo.")},function(a){return b.restaurando=!1,g.error("Error restaurando","Problema")}))},a.mostrarSubunidadesEliminadas=function(){return a.mostrando_subunidades_eliminadas?a.mostrando_subunidades_eliminadas=!1:c.put("::subunidades/eliminadas/"+a.asignatura_id).then(function(b){return b=b.data,a.subunidades_eliminadas=b.subunidades,a.mostrando_subunidades_eliminadas=!0},function(b){return a.mostrando_subunidades_eliminadas=!0,g.error("No se pudo traer las subunidades eliminadas")})},a.restaurarSubunidad=function(a){return a.restaurando?void 0:(a.restaurando=!0,c.put("::subunidades/restore/"+a.id).then(function(a){return g.success("Listo. Recargue para ver los cambios")},function(b){return a.restaurando=!1,g.error("Error restaurando","Problema")}))},a.copiarUnidades=function(){return a.asignatura.periodo_id=a.USER.periodo_id,a.asignatura.year_id=a.USER.year_id,localStorage.asignatura_a_copiar=JSON.stringify(a.asignatura),d.go("panel.copiar")},a.calcularPorcUnidades=function(){var b;return b=0,angular.forEach(a.unidades,function(a,c){var d;return b+=a.porcentaje,d=0,angular.forEach(a.subunidades,function(a,b){return d+=a.porcentaje}),a.subunidades.porc_subunidades=d,a.subunidades.unidad_id=a.id}),a.unidades.porc_unidades=b},a.crearUnidad=function(){return a.activar_crear_unidad=!1,a.newunidad.asignatura_id=a.asignatura.asignatura_id,c.post("::unidades",a.newunidad).then(function(b){var c;return b=b.data,b.subunidades=[],b.obligatoria=0,b.anim_bloqueada=!1,a.unidades.push(b),c="creado","F"===a.GENERO_UNI&&(c="creada"),g.success(a.UNIDAD+" "+c+". Ahora agrégale "+a.SUBUNIDADES),a.newunidad.definicion="",a.calcularPorcUnidades(),a.activar_crear_unidad=!0,a.bloquear_animacion()},function(b){return g.error("No se pudo crear la unidad","Problemas"),a.activar_crear_unidad=!0})},a.actualizarUnidad=function(b){var d;return d={definicion:b.definicion,porcentaje:b.porcentaje},c.put("::unidades/update/"+b.id,d).then(function(c){var d;return d="actualizado","F"===a.GENERO_UNI&&(d="actualizada"),g.success(a.UNIDAD+" "+d+" con éxito."),b.editando=!1,a.calcularPorcUnidades()},function(b){return g.error("No se pudo actualizar "+a.UNIDAD,"Problemas")})},a.removeUnidad=function(c){var d;return d=b.open({templateUrl:"==unidades/removeUnidad.tpl.html",controller:"RemoveUnidadCtrl",resolve:{unidad:function(){return c}}}),d.result.then(function(b){return a.unidades=e("filter")(a.unidades,{id:"!"+b.id}),a.calcularPorcUnidades(),i(function(){return a.onSortUnidades(void 0,a.unidades)},100)})},a.onSortUnidades=function(b,d,e,f,h){var i,j,k,l,m,n,o;for(l=[],k=n=0,o=d.length;o>n;k=++n)m=d[k],m.orden=k,j={},j[""+m.id]=k,l.push(j);return i={sortHash:l},c.put("::unidades/update-orden",i).then(function(a){return!0},function(a){return g.warning("No se pudo ordenar","Problema"),!1}),a.calcularPorcUnidades()},a.onStartSortUnidades=function(a,b,c,d){},a.bloquear_animacion=function(a){return i(function(){return a.anim_bloqueada=!0},2e3)},a.activar_crear_subunidad=!0,a.onSortSubunidades=function(b,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,s,t,u;if(d===e){for(l=[],k=p=0,s=d.length;s>p;k=++p)o=d[k],o.orden=k,j={},j[""+o.id]=k,l.push(j);i={sortHash:l},c.put("::subunidades/update-orden",i).then(function(a){return!0},function(a){return g.warning("No se pudo ordenar","Problema"),!1})}else{for(m=[],n=[],i={},k=q=0,t=d.length;t>q;k=++q)o=d[k],o.orden=k,j={},j[""+o.id]=k,m.push(j);for(m.length>0&&(i.unidad1_id=d.unidad_id,i.sortHash1=m),k=r=0,u=e.length;u>r;k=++r)o=e[k],o.orden=k,j={},j[""+o.id]=k,n.push(j);m.length>0&&(i.unidad2_id=e.unidad_id,i.sortHash2=n),c.put("::subunidades/update-orden-varias",i).then(function(a){return!0},function(a){return g.warning("No se pudo ordenar","Problema"),!1})}return a.calcularPorcUnidades()},a.addSubunidad=function(b){return a.activar_crear_subunidad=!1,b.newsubunidad?b.newsubunidad.definicion?(b.newsubunidad.porcentaje||(b.newsubunidad.porcentaje=0),b.newsubunidad.nota_default||(b.newsubunidad.nota_default=0),b.newsubunidad.unidad_id=b.id,b.newsubunidad.definicion=b.newsubunidad.definicion.trim(),c.post("::subunidades",b.newsubunidad).then(function(c){var d;return c.data.anim_bloqueada=!1,b.subunidades.push(c.data),d="creado","F"===a.GENERO_SUB&&(d="creada"),g.success(a.SUBUNIDAD+" "+d+" con éxito."),b.newsubunidad.definicion="",a.calcularPorcUnidades(),a.activar_crear_subunidad=!0,
a.bloquear_animacion(c.data)},function(b){return g.error("No se pudo crear  "+("M"===a.GENERO_UNI?"el":"la")+scope.SUBUNIDAD,"Problemas"),a.activar_crear_subunidad=!0})):(g.warning("Debes escribir la difinición."),void(a.activar_crear_subunidad=!0)):(g.warning("Aún debes escribir."),void(a.activar_crear_subunidad=!0))},a.ir_a_notas=function(a){return d.go("panel.notas",a)},a.actualizarSubunidad=function(b){var d;return d={definicion:b.definicion,porcentaje:b.porcentaje,nota_default:b.nota_default,orden:b.orden},c.put("::subunidades/update/"+b.id,d).then(function(c){var d;return d="actualizado","F"===a.GENERO_SUB&&(d="actualizada"),g.success(a.SUBUNIDAD+" "+d+" con éxito."),b.editando=!1,a.calcularPorcUnidades()},function(b){return g.error("No se pudo actualizar "+a.SUBUNIDAD,"Problemas")})},a.removeSubunidad=function(c,d){var f;return f=b.open({templateUrl:"==unidades/removeSubunidad.tpl.html",controller:"RemoveSubunidadCtrl",resolve:{subunidad:function(){return d}}}),f.result.then(function(b){return c.subunidades=e("filter")(c.subunidades,{id:"!"+d.id}),a.calcularPorcUnidades(),i(function(){return a.onSortSubunidades(void 0,void 0,c.subunidades)},100)})}}]).controller("RemoveUnidadCtrl",["$scope","$uibModalInstance","unidad","$http","toastr",function(a,b,c,d,e){return a.unidad=c,a.ok=function(){return d["delete"]("::unidades/destroy/"+c.id).then(function(a){return e.success("Unidad eliminada con éxito.","Eliminada")},function(a){return e.warning("No se pudo eliminar la unidad.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("RemoveSubunidadCtrl",["$scope","$uibModalInstance","subunidad","$http","toastr",function(a,b,c,d,e){return a.subunidad=c,a.ok=function(){return d["delete"]("::subunidades/destroy/"+c.id).then(function(a){return e.success("Subunidad eliminada con éxito.","Eliminada")},function(a){return e.warning("No se pudo eliminar la subunidad.","Problema")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CopiarCtrl",["$scope","$uibModal","$http","$filter","$rootScope","AuthService","toastr","App","YearsServ",function(a,b,c,d,e,f,g,h,i){var j;return f.verificar_acceso(),a.hasRoleOrPerm=f.hasRoleOrPerm,a.configuracion={copiar_subunidades:!0,copiar_notas:!0},a.periodos=[],a.resultado="",j=a.USER.persona_id,a.urlTplSubunidades="==unidades/subunidadespop.tpl.html",a.profesores=[],a.hasRoleOrPerm("admin")===!0&&(a.conprofes=!0),c.get("::profesores/conyears").then(function(b){var c,d,e,f,g,h,i,k,l,m,n,o,p;if(a.profesores=b.data,localStorage.asignatura_a_copiar){if(a.asignatura_a_copiar=JSON.parse(localStorage.asignatura_a_copiar),a.asignatura_a_copiar.profesor_id){for(l=a.profesores,o=[],e=0,h=l.length;h>e;e++){if(c=l[e],c.id===a.asignatura_a_copiar.profesor_id)for(a.configuracion.profesor_from=c,a.years_copy=c.years,m=a.years,f=0,i=m.length;i>f;f++)d=m[f],d.id===a.asignatura_a_copiar.year_id&&(a.configuracion.year_from=d,a.yearSelect(d));c.id===j?(a.years_copy_to=c.years,a.configuracion.year_to=c.years[c.years.length-1],o.push(a.yearToSelect(c.years[c.years.length-1]))):o.push(void 0)}return o}for(n=a.profesores,p=[],g=0,k=n.length;k>g;g++)c=n[g],c.id===j?(a.years_copy_to=c.years,a.configuracion.year_to=c.years[c.years.length-1],p.push(a.yearToSelect(c.years[c.years.length-1]))):p.push(void 0);return p}},function(a){return g.error("No se pudo traer los profes con años",a)}),a.profesorSelect=function(b,c){return a.years_copy=b.years,a.configuracion.year_from=a.years_copy[a.years_copy.length-1],a.configuracion.periodo_from?(a.configuracion.periodo_from=a.configuracion.year_from.periodos[0],a.periodoSelect(a.configuracion.periodo_from)):a.periodos=a.configuracion.year_from.periodos},a.yearSelect=function(b,c){var d,e,f,g,h;if(a.periodos=b.periodos,a.asignatura_a_copiar&&a.asignatura_a_copiar.periodo_id){for(g=a.periodos,h=[],e=0,f=g.length;f>e;e++)d=g[e],d.id===a.asignatura_a_copiar.periodo_id?(a.configuracion.periodo_from=d,h.push(a.periodoSelect(d))):h.push(void 0);return h}},a.periodoSelect=function(b,e){var f;return f=a.asignatura_a_copiar?a.asignatura_a_copiar.profesor_id:a.configuracion.profesor_from.id,c.get("::asignaturas/list-asignaturas-year/"+f+"/"+a.configuracion.periodo_from.id).then(function(b){var c,e,f,g,h,i;if(a.asignaturas=b.data,a.asignatura_a_copiar&&a.asignatura_a_copiar.asignatura_id)for(i=a.asignaturas,g=0,h=i.length;h>g;g++)f=i[g],f.asignatura_id===a.asignatura_a_copiar.asignatura_id&&(a.configuracion.asignatura_from=f,a.asignaturaSelect(f));return a.configuracion.asignatura_from?(e=a.configuracion.asignatura_from.asignatura_id,c=d("filter")(a.asignaturas,{asignatura_id:e})[0],a.configuracion.asignatura_from=c,a.asignaturaSelect(c)):void 0},function(a){return g.error("No se pudo traer las asignaturas origen")})},a.asignaturaSelect=function(b,c){var d,e,f,g;if(b&&b.unidades){for(g=b.unidades.items,e=0,f=g.length;f>e;e++)d=g[e],d.seleccionada=!0;return a.unidades=b.unidades}return a.unidades=[]},a.profesorToSelect=function(b,c){return a.years_copy_to=b.years,a.configuracion.periodo_to?(a.configuracion.periodo_to=a.configuracion.year_to.periodos[0],a.periodoToSelect(a.configuracion.periodo_to)):void 0},a.yearToSelect=function(b,c){return a.periodos_to=b.periodos},a.periodoToSelect=function(b,e){return a.conprofes===!0&&(j=a.configuracion.profesor_to.id),c.get("::asignaturas/list-asignaturas-year/"+j+"/"+a.configuracion.periodo_to.id).then(function(b){var c,e;return b=b.data,a.asignaturas_to=b,a.configuracion.asignatura_to?(e=a.configuracion.asignatura_to.asignatura_id,c=d("filter")(a.asignaturas_to,{asignatura_id:e})[0],a.configuracion.asignatura_to=c,a.asignaturaToSelect(c)):void 0},function(a){return g.error("No se pudo traer las asignaturas destino, ",a)})},a.asignaturaToSelect=function(b,c){return b&&b.unidades?a.unidades_to=b.unidades:a.unidades_to=[],a.activar_btn_copiar=!0},a.copiar=function(){var b,e,f;if(a.activar_btn_copiar)return a.activar_btn_copiar=!1,e=d("filter")(a.unidades.items,{seleccionada:!0}),f=[],angular.forEach(e,function(a,b){return f.push(a.id)}),b={copiar_subunidades:a.configuracion.copiar_subunidades,copiar_notas:a.configuracion.copiar_notas,asignatura_to_id:a.configuracion.asignatura_to.asignatura_id,periodo_from_id:a.configuracion.periodo_from.id,periodo_to_id:a.configuracion.periodo_to.id,unidades_ids:f,grupo_from_id:a.configuracion.asignatura_from.grupo_id,grupo_to_id:a.configuracion.asignatura_to.grupo_id},c.put("::periodos/copiar",b).then(function(b){var c,d,f,h,i,j;for(b=b.data,g.success("Copiado con éxito"),a.activar_btn_copiar=!0,a.resultado="Unidades copiadas: "+b.unidades_copiadas+" - Subunidades copiadas: "+b.subunidades_copiadas+" - Notas copidas: "+b.notas_copiadas,d=0,h=e.length;h>d;d++)c=e[d],a.unidades_to.items.push(c);if(a.configuracion.asignatura_from.asignatura_id===a.configuracion.asignatura_to.asignatura_id&&a.configuracion.periodo_from.id===a.configuracion.periodo_to.id){for(j=[],f=0,i=e.length;i>f;f++)c=e[f],j.push(a.unidades.items.push(c));return j}},function(b){return g.error("No se pudieron copiar los datos"),a.activar_btn_copiar=!0})}}])}.call(this),function(){angular.module("myvcFrontApp").directive("unidadDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"unidades/unidadDir.tpl.html",transclude:!0,scope:{unidad:"=",indice:"="},link:function(a,b,c){},controller:["$scope","$http","toastr","$uibModal","$filter",function(a,b,c,d,e){return a.activar_crear_subunidad=!0,a.onSortSubunidades=function(d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u;if(e===f){for(l=[],k=p=0,s=e.length;s>p;k=++p)o=e[k],o.orden=k,j={},j[""+o.id]=k,l.push(j);i={sortHash:l},b.put("::subunidades/update-orden",i).then(function(a){return!0},function(a){return c.warning("No se pudo ordenar","Problema"),!1})}else{for(m=[],n=[],i={},k=q=0,t=e.length;t>q;k=++q)o=e[k],o.orden=k,j={},j[""+o.id]=k,m.push(j);for(m.length>0&&(i.unidad1_id=e.unidad_id,i.sortHash1=m),k=r=0,u=f.length;u>r;k=++r)o=f[k],o.orden=k,j={},j[""+o.id]=k,n.push(j);m.length>0&&(i.unidad2_id=f.unidad_id,i.sortHash2=n),b.put("::subunidades/update-orden-varias",i).then(function(a){return!0},function(a){return c.warning("No se pudo ordenar","Problema"),!1})}return a.$parent.calcularPorcUnidades()},a.addSubunidad=function(d){return a.activar_crear_subunidad=!1,d.newsubunidad.unidad_id=d.id,b.post("::subunidades",d.newsubunidad).then(function(b){var e;return d.subunidades.push(b.data),e="creado","F"===a.$parent.GENERO_SUB&&(e="creada"),c.success(a.$parent.SUBUNIDAD+" "+e+" con éxito."),d.newsubunidad.definicion="",a.$parent.calcularPorcUnidades(),a.activar_crear_subunidad=!0},function(b){return c.error("No se pudo crear  "+("M"===a.$parent.GENERO_UNI?"el":"la")+scope.$parent.SUBUNIDAD,"Problemas"),a.activar_crear_subunidad=!0})},a.actualizarSubunidad=function(d){var e;return e={definicion:d.definicion,porcentaje:d.porcentaje,nota_default:d.nota_default,orden:d.orden},b.put("::subunidades/update/"+d.id,e).then(function(b){var e;return e="actualizado","F"===a.$parent.GENERO_SUB&&(e="actualizada"),c.success(a.$parent.SUBUNIDAD+" "+e+" con éxito."),d.editando=!1,a.$parent.calcularPorcUnidades()},function(b){return c.error("No se pudo actualizar "+a.$parent.SUBUNIDAD,"Problemas")})},a.removeSubunidad=function(b,c){var f;return f=d.open({templateUrl:"==unidades/removeSubunidad.tpl.html",controller:"RemoveSubunidadCtrl",resolve:{subunidad:function(){return c}}}),f.result.then(function(d){return b.subunidades=e("filter")(b.subunidades,{id:"!"+c.id}),a.$parent.calcularPorcUnidades()})}}]}}])}.call(this),function(){angular.module("myvcFrontApp").directive("contenteditable",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e;return e=function(){return d.$setViewValue(b.html())},d.$render=function(){return b.html(d.$viewValue||0)},b.bind("blur keyup change",function(){return a.$apply(e)})}}})}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(a,b,c,d){return a.state("panel.informes",{url:"^/informes",views:{maincontent:{templateUrl:"==informes/informes.tpl.html",controller:"InformesCtrl"},headerContent:{templateUrl:"==panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Informes interactivos"}]}}},resolve:{resolved_user:["AuthService",function(a){return a.verificar()}],alumnos:["$http",function(a){return a.get("::alumnos/sin-matriculas")}]},data:{displayName:"Informes",icon_fa:"fa fa-print",pageTitle:"Informes - MyVc",needed_permissions:[d.can_work_like_teacher,d.can_work_like_admin]}}).state("panel.informes.boletines_periodo",{url:"/boletines_periodo/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes/boletinesPeriodo.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(a,b,c,d){var e,f,g;return e=c.defer(),g=d.getObject("requested_alumnos"),f=d.getObject("requested_alumno"),g?a.put("::boletines/detailed-notas/"+b.grupo_id,{requested_alumnos:g,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):f?a.put("::boletines/detailed-notas/"+f[0].grupo_id,{requested_alumnos:f,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):a.put("::boletines/detailed-notas-group/"+b.grupo_id,{periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}),e.promise}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.boletines_periodo2",{url:"/boletines_periodo2/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/boletinesPeriodo2.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(a,b,c,d){var e,f,g;return e=c.defer(),g=d.getObject("requested_alumnos"),f=d.getObject("requested_alumno"),g?a.put("::boletines2/detailed-notas/"+b.grupo_id,{requested_alumnos:g,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):f?a.put("::boletines2/detailed-notas/"+f[0].grupo_id,{requested_alumnos:f,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):a.put("::boletines2/detailed-notas-group/"+b.grupo_id,{periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}),e.promise}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.boletines_periodo3",{url:"/boletines_periodo3/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/boletinesPeriodo3.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(a,b,c,d){var e,f,g;return e=c.defer(),g=d.getObject("requested_alumnos"),f=d.getObject("requested_alumno"),g?a.put("::boletines3/detailed-notas/"+b.grupo_id,{requested_alumnos:g,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):f?a.put("::boletines3/detailed-notas/"+f[0].grupo_id,{requested_alumnos:f,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):a.put("::boletines3/detailed-notas-group/"+b.grupo_id,{periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}),e.promise}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.boletines_periodo4",{url:"/boletines_periodo4/:grupo_id/:periodo_a_calcular",params:{grupo_id:{value:null},periodo_a_calcular:{value:null}},views:{report_content:{templateUrl:"==informes2/boletinesPeriodo4.tpl.html",controller:"BoletinesPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(a,b,c,d){var e,f,g;return e=c.defer(),g=d.getObject("requested_alumnos"),f=d.getObject("requested_alumno"),g?a.put("::boletines3/detailed-notas/"+b.grupo_id,{requested_alumnos:g,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):f?a.put("::boletines3/detailed-notas/"+f[0].grupo_id,{requested_alumnos:f,periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):a.put("::boletines3/detailed-notas-group/"+b.grupo_id,{periodo_a_calcular:b.periodo_a_calcular}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}),e.promise}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Boletines periodo",pageTitle:"Boletines periodo - MyVc"}}).state("panel.informes.puestos_grupo_periodo",{url:"/puestos_grupo_periodo/:grupo_id",views:{report_content:{templateUrl:"==informes/puestosGrupoPeriodo.tpl.html",controller:"PuestosGrupoPeriodoCtrl",resolve:{alumnosDat:["$http","$stateParams",function(a,b){return a.put("::boletines/detailed-notas/"+b.grupo_id)}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{pageTitle:"Puestos periodo - MyVc"}}).state("panel.informes.puestos_grupo_year",{url:"/puestos_grupo_year/:grupo_id/:periodo_a_calcular",views:{report_content:{templateUrl:""+b.views+"informes/puestosGrupoYear.tpl.html",controller:"PuestosGrupoYearCtrl",resolve:{datos_puestos:["$http","$stateParams",function(a,b){var c;return c={grupo_id:b.grupo_id,periodo_a_calcular:b.periodo_a_calcular},a.put("::puestos/detailed-notas-year",c)}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Puestos del año",icon_fa:"fa fa-print",pageTitle:"Puestos del año - MyVc"}}).state("panel.informes.planillas_grupo",{url:"/planillas_grupo/:grupo_id/:periodos_a_calcular",views:{report_content:{templateUrl:"==informes/planillas.tpl.html",controller:"PlanillasCtrl",resolve:{asignaturas:["$http","$stateParams",function(a,b){return a.get("::planillas/show-grupo/"+b.grupo_id)}]}}},data:{displayName:"Planillas grupo",icon_fa:"fa fa-print",pageTitle:"Planillas grupo - MyVc"}}).state("panel.informes.notas_perdidas_profesor",{url:"/notas_perdidas_profesor/:profesor_id/:periodo_a_calcular",views:{report_content:{templateUrl:"==informes/notasPerdidasProfesor.tpl.html",controller:"NotasPerdidasProfesorCtrl",resolve:{grupos:["$http","$stateParams",function(a,b){return a.put("::notas-perdidas/profesor-grupos",{profesor_id:b.profesor_id,periodo_a_calcular:b.periodo_a_calcular})}]}}},data:{displayName:"Notas perdidas por profesor",icon_fa:"fa fa-print",pageTitle:"Notas perdidas por profesor - MyVc"}}).state("panel.informes.notas_perdidas_todos",{url:"/notas_perdidas_profesor/:periodo_a_calcular",views:{report_content:{templateUrl:"==informes/notasPerdidasTodos.tpl.html",controller:"NotasPerdidasTodosCtrl",resolve:{profesores:["$http","$stateParams",function(a,b){return a.put("::notas-perdidas/todos",{periodo_a_calcular:b.periodo_a_calcular})}]}}},data:{displayName:"Todas las notas perdidas",icon_fa:"fa fa-print",pageTitle:"Notas perdidas todas - MyVc"}}).state("panel.informes.ver_ausencias",{url:"/ver_ausencias",views:{report_content:{templateUrl:"==informes/verAusencias.tpl.html",controller:"VerAusenciasCtrl",resolve:{grupos_ausencias:["$http","$stateParams",function(a,b){return a.get("::planillas/ver-ausencias")}]}}},data:{displayName:"Ausencias",icon_fa:"fa fa-print",pageTitle:"Ausencias - MyVc"}}).state("panel.informes.ver_simat",{url:"/ver_simat",views:{report_content:{templateUrl:"==informes/verSimat.tpl.html",controller:"VerSimatCtrl",resolve:{grupos_simat:["$http","$stateParams",function(a,b){return a.get("::planillas/ver-simat")}]}}},data:{displayName:"SIMAT",icon_fa:"fa fa-print",pageTitle:"SIMAT - MyVc"}}).state("panel.informes.ver_observador_vertical",{url:"/ver_observador_vertical/:grupo_id",params:{grupo_id:{value:null}},views:{report_content:{templateUrl:"==informes/verObservadorVertical.tpl.html",controller:"VerObservadorVerticalCtrl",resolve:{grupos_observador:["$http","$stateParams",function(a,b){return a.get("::observador/vertical/"+b.grupo_id)}]}}},data:{displayName:"Observador",icon_fa:"fa fa-print",pageTitle:"Observador - MyVc"}}).state("panel.informes.ver_observador_vertical_todos",{url:"/ver_observador_vertical_todos",views:{report_content:{templateUrl:"==informes/verObservadorVertical.tpl.html",controller:"VerObservadorVerticalCtrl",resolve:{grupos_observador:["$http","$stateParams",function(a,b){return a.get("::observador/vertical-todos")}]}}},data:{displayName:"Observador",icon_fa:"fa fa-print",pageTitle:"Observador - MyVc"}}).state("panel.informes.planillas_profesor",{url:"/planillas_profesor/:profesor_id/:periodos_a_calcular",views:{report_content:{templateUrl:"==informes/planillas.tpl.html",controller:"PlanillasCtrl",resolve:{asignaturas:["$http","$stateParams",function(a,b){return a.get("::planillas/show-profesor/"+b.profesor_id)}]}}},data:{displayName:"Planillas profesor",icon_fa:"fa fa-print",pageTitle:"Planillas profesor - MyVc"}}).state("panel.informes.control_tardanza_entrada",{url:"/control_tardanza_entrada/:grupo_id",views:{report_content:{templateUrl:"==informes/controlTardanzaEntrada.tpl.html",controller:"ControlTardanzaEntradaCtrl",resolve:{grupos:["$http","$stateParams",function(a,b){return a.put("::planillas-ausencias/tardanza-entrada")}]}}},data:{displayName:"Control de tardanza entrada",icon_fa:"fa fa-print",pageTitle:"Control de tardanza entrada - MyVc"}}).state("panel.informes.planillas_ausencias1",{url:"/planillas_ausencias1/:profesor_id",views:{report_content:{templateUrl:"==informes/planillasAusencias1.tpl.html",controller:"PlanillasAusencias1Ctrl",resolve:{asignaturas:["$http","$stateParams",function(a,b){return a.get("::planillas-ausencias/show-profesor/"+b.profesor_id)}]}}},data:{displayName:"Planillas profesor",icon_fa:"fa fa-print",pageTitle:"Planillas profesor - MyVc"}}).state("panel.informes.boletines_finales",{url:"/boletines_finales/:grupo_id",params:{grupo_id:{value:null}},views:{report_content:{templateUrl:"==informes/boletinesFinales.tpl.html",controller:"BoletinesFinalesCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(a,b,c,d){var e,f,g;return e=c.defer(),g=d.getObject("requested_alumnos"),f=d.getObject("requested_alumno"),g?a.put("::bolfinales/detailed-notas-year/"+b.grupo_id,{requested_alumnos:g}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):f?a.put("::bolfinales/detailed-notas-year/"+f[0].grupo_id,{requested_alumnos:f}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):a.put("::bolfinales/detailed-notas-year-group/"+b.grupo_id).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}),e.promise}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Boletines finales",pageTitle:"Boletines finales - MyVc"}}).state("panel.informes.certificados_estudio",{url:"/certificados_estudio/:grupo_id",params:{grupo_id:{value:null}},views:{report_content:{templateUrl:"==informes/certificadosEstudio.tpl.html",controller:"CertificadosEstudioCtrl",resolve:{alumnosDat:["$http","$stateParams","$q","$cookies",function(a,b,c,d){var e,f,g;return e=c.defer(),g=d.getObject("requested_alumnos"),f=d.getObject("requested_alumno"),g?a.put("::bolfinales/detailed-notas-year/"+b.grupo_id,{requested_alumnos:g}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):f?a.put("::bolfinales/detailed-notas-year/"+f[0].grupo_id,{requested_alumnos:f}).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}):a.put("::bolfinales/detailed-notas-year/"+b.grupo_id).then(function(a){return e.resolve(a.data)},function(a){return e.reject(a.data)}),e.promise}],escalas:["EscalasValorativasServ",function(a){return a.escalas()}]}}},data:{displayName:"Certificados de estudio",pageTitle:"Certificados de estudio - MyVc"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("InformesCtrl",["$scope","$http","$state","$stateParams","$filter","App","AuthService","ProfesoresServ","alumnos","$timeout","$cookies","toastr","$interval","DownloadServ",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,r,s;return g.verificar_acceso(),a.rowsAlum=[],i=i.data,a.$state=c,a.config={periodos_a_calcular:1,mostrar_foto:!0,show_firma_rector:!0,periodo_a_calcular:a.USER.numero_periodo},a.filtered_alumnos=i,a.perfilPath=f.images+"perfil/",a.views=f.views,a.datos={grupo:""},b.put("::informes/datos").then(function(b){var d;return b=b.data,a.year_actual=b.year,a.grupos=b.grupos,a.profesores=b.profesores,a.imgs_public=b.imagenes,a.periodos_grupos=b.periodos_grupos,b.periodos_desactualizados&&(a.periodos_desactualizados=b.periodos_desactualizados),c.params.grupo_id&&(d=parseInt(c.params.grupo_id),a.datos.grupo=e("filter")(a.grupos,{id:d},!0)[0],a.filtered_alumnos=e("filter")(i,{grupo_id:d},!0)),c.params.profesor_id?(d=parseInt(c.params.profesor_id),a.datos.profesor=e("filter")(a.profesores,{profesor_id:d},!0)[0]):void 0},function(a){return l.error("No se pudo traer los profesores")}),localStorage.tipo_boletin&&(a.tipo_boletin=localStorage.tipo_boletin),a.eligirTipo=function(b){return localStorage.tipo_boletin=b,a.tipo_boletin=b},a.range=function(a){return new Array(a)},k.getObject("config")?a.config=k.getObject("config"):a.config.orientacion="vertical",k.getObject("requested_alumnos")&&(s=k.getObject("requested_alumnos"),s.length>0?(q=[],angular.forEach(s,function(a,b){var c;return c=e("filter")(i,{alumno_id:a.alumno_id},!0)[0],q.push(c)}),a.datos.selected_alumnos=q):a.datos.selected_alumno=s[0]),k.getObject("requested_alumno")&&(s=k.getObject("requested_alumno"),p=e("filter")(i,{alumno_id:s[0].alumno_id},!0)[0],a.datos.selected_alumno=p),a.$watch("config",function(b,c){return k.putObject("config",b),a.$broadcast("change_config")},!0),a.selectTab=function(b){return a.config.informe_tab_actual=b,k.putObject("config",a.config)},a.putConfigCookie=function(){return k.putObject("config",a.config)},a.calcularGrupoPeriodo=function(a,c){return a.desabilitado=!0,b.put("::definitivas_periodos/calcular-grupo-periodo",{grupo_id:a.grupo_id,periodo_id:c.id,num_periodo:c.numero}).then(function(b){return l.success(a.nombre+" calculado con éxito")},function(b){return a.desabilitado=!1,l.error("No se pudo calcular las definitivas del grupo "+a.nombre+", Per "+c.numero)})},a.calcularPeriodo=function(c){return a.porcentaje=0,c.bloqueado=!0,a.grupo_temp_calculado=!0,a.grupo_temp_indce=0,a.intervalo=m(function(){var d;return a.grupo_temp_calculado?(a.grupo_temp_calculado=!1,d=c.grupos[a.grupo_temp_indce],a.porcentaje=parseInt(100*(a.grupo_temp_indce+1)/c.grupos.length),b.put("::definitivas_periodos/calcular-grupo-periodo",{grupo_id:d.grupo_id,periodo_id:c.id,num_periodo:c.numero}).then(function(b){return l.success(d.nombre+" calculado con éxito"),a.grupo_temp_calculado=!0,a.grupo_temp_indce=a.grupo_temp_indce+1,a.grupo_temp_indce===c.grupos.length?m.cancel(a.intervalo):void 0},function(b){return a.grupo_temp_calculado=!0,l.warning("No se pudo calcular "+d.nombre+", Per "+c.numero+". Intentaremos de nuevo.")})):void 0},20)},a.verBoletinesGrupo=function(b){return("1"===b||1===b)&&(b=""),k.remove("requested_alumnos"),k.remove("requested_alumno"),a.datos.grupo.id?(a.config.orientacion="vertical",c.go("panel.informes.boletines_periodo"+b,{grupo_id:a.datos.grupo.id,periodo_a_calcular:a.USER.numero_periodo},{reload:!0})):void l.warning("Debes seleccionar el grupo")},a.verBoletinesAlumnos=function(b){return("1"===b||1===b)&&(b=""),a.datos.selected_alumnos.length>0?(a.config.orientacion="vertical",k.putObject("requested_alumnos",a.datos.selected_alumnos),c.go("panel.informes.boletines_periodo"+b,{grupo_id:a.datos.grupo.id,periodo_a_calcular:a.USER.numero_periodo},{reload:!0})):l.warning("Debes seleccionar al menos un alumno o cargar boletines del grupo completo")},a.verBoletinAlumno=function(b){return("1"===b||1===b)&&(b=""),a.datos.selected_alumno?(k.putObject("requested_alumno",[a.datos.selected_alumno]),c.go("panel.informes"),a.config.orientacion="vertical",m(function(){return c.go("panel.informes.boletines_periodo"+b,{periodo_a_calcular:a.USER.numero_periodo})},1,1)):l.warning("Elige un alumno o carga el grupo completo")},a.verPuestosPeriodo=function(){return a.datos.grupo.id?(a.config.orientacion="vertical",c.go("panel.informes.puestos_grupo_periodo",{grupo_id:a.datos.grupo.id,periodos_a_calcular:a.config.periodos_a_calcular})):void l.warning("Debes seleccionar el grupo")},a.verPuestosYear=function(){return a.datos.grupo.id?(a.config.orientacion="vertical",c.go("panel.informes.puestos_grupo_year",{grupo_id:a.datos.grupo.id,periodo_a_calcular:a.config.periodo_a_calcular})):void l.warning("Debes seleccionar el grupo")},a.verPlanillasGrupo=function(){return a.datos.grupo.id?(a.config.orientacion="oficio_horizontal",c.go("panel.informes.planillas_grupo",{grupo_id:a.datos.grupo.id,periodos_a_calcular:a.config.periodos_a_calcular},{reload:!0})):l.warning("Elige un grupo")},a.verPlanillasProfe=function(){return a.datos.profesor?(a.config.orientacion="oficio_horizontal",c.go("panel.informes.planillas_profesor",{profesor_id:a.datos.profesor.profesor_id,periodos_a_calcular:a.config.periodos_a_calcular},{reload:!0})):l.warning("Elige un profesor")},a.verAusencias=function(){return c.go("panel.informes.ver_ausencias",{periodos_a_calcular:a.config.periodos_a_calcular},{reload:!0})},a.verSimat=function(){return n.download("::simat/alumnos","Alumnos con acudientes "+a.USER.year+".xls"),c.go("panel.informes.ver_simat",{reload:!0})},a.verObservadorVertical=function(){return a.datos.grupo.id?c.go("panel.informes.ver_observador_vertical",{grupo_id:a.datos.grupo.id},{reload:!0}):void l.warning("Debes seleccionar el grupo")},a.verObservadorVerticalTodos=function(){return c.go("panel.informes.ver_observador_vertical_todos",{reload:!0})},a.verPlanillasControlTardanzas=function(){return a.config.orientacion="oficio_horizontal",c.go("panel.informes.control_tardanza_entrada",{reload:!0})},a.verNotasPerdidasProfesor=function(){return a.datos.profesor?(a.config.orientacion="carta_horizontal",c.go("panel.informes.notas_perdidas_profesor",{profesor_id:a.datos.profesor.profesor_id,periodo_a_calcular:a.config.periodo_a_calcular},{reload:!0})):l.warning("Elige un profesor")},a.verNotasPerdidasTodos=function(){return a.config.orientacion="carta_horizontal",c.go("panel.informes.notas_perdidas_todos",{periodo_a_calcular:a.config.periodo_a_calcular},{reload:!0})},a.selectGrupo=function(b){return b?a.filtered_alumnos=e("filter")(i,{grupo_id:b.id},!0):(a.filtered_alumnos=i,k.putObject("requested_alumno",""),k.putObject("requested_alumnos","")),a.datos.selected_alumnos="",a.datos.selected_alumno=""},a.selectAlumnos=function(a){},a.selectAlumno=function(a){},a.$on("cambia_descripcion",function(b,c){return a.descripcion_informe=c}),a.pdfMaker=function(){var a;return a={content:[["Este es un ejemplo de reporte en pdf"],{table:{headerRows:1,widths:["*","auto",100,"*"],body:[["No","Primero","Segundo","Tercero"],["0","No me gusta!!","No queda bonito","FACILMENTE!"],["1",{text:"En negrita",bold:!0},"Así que ","me mordió la vaca"]]}}]},pdfMake.createPdf(a).open()},a.verBoletinesFinalesGrupo=function(){return k.remove("requested_alumnos"),k.remove("requested_alumno"),a.datos.grupo.id?c.go("panel.informes.boletines_finales",{grupo_id:a.datos.grupo.id,periodos_a_calcular:a.config.periodos_a_calcular},{reload:!0}):void l.warning("Debes seleccionar el grupo")},a.verBoletinesFinalesAlumnos=function(){return a.datos.selected_alumnos.length>0?(k.putObject("requested_alumnos",a.datos.selected_alumnos),c.go("panel.informes.boletines_finales",{grupo_id:a.datos.grupo.id,periodos_a_calcular:a.config.periodos_a_calcular},{reload:!0})):l.warning("Debes seleccionar al menos un alumno o cargar boletines del grupo completo")},a.verBoletinFinalAlumno=function(){return a.datos.selected_alumno?(k.remove("requested_alumnos"),k.putObject("requested_alumno",[a.datos.selected_alumno]),c.go("panel.informes"),m(function(){return c.go("panel.informes.boletines_finales")},1,1)):l.warning("Elige un alumno o carga el grupo completo")},a.verCertificadosEstudioGrupo=function(){return k.remove("requested_alumnos"),k.remove("requested_alumno"),a.datos.grupo.id?c.go("panel.informes.certificados_estudio",{grupo_id:a.datos.grupo.id},{reload:!0}):void l.warning("Debes seleccionar el grupo")},a.verCertificadosEstudioAlumnos=function(){return a.datos.selected_alumnos.length>0?(k.putObject("requested_alumnos",a.datos.selected_alumnos),c.go("panel.informes.certificados_estudio",{grupo_id:a.datos.grupo.id,periodos_a_calcular:a.config.periodos_a_calcular},{reload:!0})):l.warning("Debes seleccionar al menos un alumno o cargar boletines del grupo completo")},a.verCertificadosEstudioAlumno=function(){return a.datos.selected_alumno?(k.remove("requested_alumnos"),k.putObject("requested_alumno",[a.datos.selected_alumno]),c.go("panel.informes"),m(function(){return c.go("panel.informes.certificados_estudio")},1,1)):l.warning("Elige un alumno o carga el grupo completo")},a.meses=[{nombre:"Enero"},{nombre:"Febrero"},{nombre:"Marzo"},{nombre:"Abril"},{nombre:"Mayo"},{nombre:"Junio"},{nombre:"Julio"},{nombre:"Agosto"},{nombre:"Septiembre"},{nombre:"Octubre"},{nombre:"Noviembre"},{nombre:"Diciembre"
}],a.numYearActual=a.USER.year,o=[31,28,31,30,31,30,31,31,30,31,30,31],r=function(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?o[b]:29},a.getAllDaysInMonth=function(b){var c,d,e,f,g,h;for(f=r(a.numYearActual,b),g=[],d=h=1;f>=1?f>=h:h>=f;d=f>=1?++h:--h)c=new Date(a.numYearActual,parseInt(b),d),e=c.getDay(),0!==e&&6!==e&&g.push(d);return g}}]).filter("fechaHoraStringShort",["$filter",function(a){return function(b,c){return b?(b=new Date(b),b=isNaN(b)?new Date(b):new Date(c),b=a("date")(b,"MMMdd H:mm")):""}}])}.call(this),function(){angular.module("myvcFrontApp").controller("BoletinesPeriodoCtrl",["$scope","alumnosDat","escalas","$uibModal","$cookieStore",function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(a.grupo=b[0],a.year=b[1],a.alumnos=b[2],a.escalas=c,a.year.mostrar_puesto_boletin)for(m=a.alumnos,i=0,k=m.length;k>i;i++)f=m[i],f.texto_puesto=" - Puesto: "+f.puesto+"/"+a.grupo.cantidad_alumnos;if(a.config=e.get("config"),a.requested_alumnos=e.get("requested_alumnos"),a.requested_alumno=e.get("requested_alumno"),a.alumnos[0].asignaturas)a.alumnos[0].asignaturas.length<14?a.ancho_chart=50*a.alumnos[0].asignaturas.length:a.ancho_chart=40*a.alumnos[0].asignaturas.length;else{for(h=0,n=a.alumnos[0].areas,j=0,l=n.length;l>j;j++)g=n[j],h+=g.cant;14>h?a.ancho_chart=50*h:a.ancho_chart=40*h}return a.ancho_chart>800&&(a.ancho_chart=800),a.$on("change_config",function(){return a.config=e.get("config")}),a.requested_alumnos?a.$emit("cambia_descripcion","Mostrando "+a.alumnos.length+" boletines de "+a.grupo.cantidad_alumnos+" del grupo "+a.grupo.nombre_grupo):a.requested_alumno?a.$emit("cambia_descripcion","Mostrando un boletin de "+a.grupo.cantidad_alumnos+" del grupo "+a.grupo.nombre_grupo):a.$emit("cambia_descripcion",a.alumnos.length+" boletines del grupo "+a.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").directive("boletinAlumnoDir",["App","Perfil","$filter",function(a,b,c){return{restrict:"EA",templateUrl:"==informes/boletinAlumnoDir.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(c,d,e){var f,g,h,i,j;for(c.USER=b.User(),c.USER.nota_minima_aceptada=parseInt(c.USER.nota_minima_aceptada),c.perfilPath=a.images+"perfil/",c.views=a.views,c.options={chart:{type:"discreteBarChart",height:180,width:c.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,valueFormat:function(a){return d3.format(",.0f")(a)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},g=[],j=c.alumno.asignaturas,h=0,i=j.length;i>h;h++)f=j[h],g.push({label:f.alias_materia,value:f.nota_asignatura});return c.data=[{key:"Definitivas de asignaturas",values:g}]}}}]).directive("boletinAlumnoDir2",["App","Perfil","$filter",function(a,b,c){return{restrict:"EA",templateUrl:"==informes2/boletinAlumnoDir2.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(c,d,e){var f,g,h,i,j;for(c.USER=b.User(),c.USER.nota_minima_aceptada=parseInt(c.USER.nota_minima_aceptada),c.perfilPath=a.images+"perfil/",c.views=a.views,c.options={chart:{type:"discreteBarChart",height:180,width:c.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,valueFormat:function(a){return d3.format(",.0f")(a)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},g=[],j=c.alumno.asignaturas,h=0,i=j.length;i>h;h++)f=j[h],g.push({label:f.alias_materia,value:f.nota_asignatura});return c.data=[{key:"Definitivas de asignaturas",values:g}]}}}]).directive("boletinAlumnoDir3",["App","Perfil","$filter",function(a,b,c){return{restrict:"EA",templateUrl:"==informes2/boletinAlumnoDir3.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(c,d,e){var f,g,h,i,j,k,l,m,n;for(c.USER=b.User(),c.USER.nota_minima_aceptada=parseInt(c.USER.nota_minima_aceptada),c.perfilPath=a.images+"perfil/",c.views=a.views,c.options={chart:{type:"discreteBarChart",height:180,width:c.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,valueFormat:function(a){return d3.format(",.0f")(a)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},h=[],m=c.alumno.areas,i=0,k=m.length;k>i;i++)for(f=m[i],n=f.asignaturas,j=0,l=n.length;l>j;j++)g=n[j],h.push({label:g.alias_materia,value:g["nota_final_per"+c.USER.numero_periodo]});return c.data=[{key:"Definitivas de asignaturas",values:h}]}}}]).directive("boletinAlumnoDir4",["App","Perfil","$filter",function(a,b,c){return{restrict:"EA",templateUrl:"==informes2/boletinAlumnoDir4.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(c,d,e){var f,g,h,i,j,k,l,m,n;for(c.USER=b.User(),c.USER.nota_minima_aceptada=parseInt(c.USER.nota_minima_aceptada),c.perfilPath=a.images+"perfil/",c.views=a.views,c.options={chart:{type:"discreteBarChart",height:180,width:c.$parent.ancho_chart,margin:{top:20,right:20,bottom:60,left:55},useInteractiveGuideline:!0,x:function(a){return a.label},y:function(a){return a.value},showValues:!0,valueFormat:function(a){return d3.format(",.0f")(a)},transitionDuration:500},title:{enable:!1,text:"Definitivas por asignaturas"}},h=[],m=c.alumno.areas,i=0,k=m.length;k>i;i++)for(f=m[i],n=f.asignaturas,j=0,l=n.length;l>j;j++)g=n[j],g.nota_final_per1>=c.USER.nota_minima_aceptada?g.desempenio_per1="Alcanzado":g.desempenio_per1="En proceso",g.nota_final_per2>=c.USER.nota_minima_aceptada?g.desempenio_per2="Alcanzado":c.USER.numero_periodo>=2&&(g.desempenio_per2="En proceso"),g.nota_final_per3>=c.USER.nota_minima_aceptada?g.desempenio_per3="Alcanzado":c.USER.numero_periodo>=3&&(g.desempenio_per3="En proceso"),g.nota_final_per4>=c.USER.nota_minima_aceptada?g.desempenio_per4="Alcanzado":c.USER.numero_periodo>=4&&(g.desempenio_per4="En proceso"),h.push({label:g.alias_materia,value:g["nota_final_per"+c.USER.numero_periodo]});return c.data=[{key:"Definitivas de asignaturas",values:h}]}}}]).filter("cantPerdidasPer",[function(){return function(a,b,c){return this.suma=0,angular.forEach(a,function(a,c){var d;return b=parseFloat(b),d=parseFloat(a.id),d===b?this.suma=this.suma+a.cantNotasPerdidas:void 0}),0===this.suma?"":this.suma}}]).directive("dynamic",["$compile",function(a){return{restrict:"A",replace:!0,link:function(b,c,d){return b.$watch(d.dynamic,function(d){return c.html(d),a(c.contents())(b)})}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PuestosGrupoPeriodoCtrl",["$scope","$state","alumnosDat","escalas","$cookieStore",function(a,b,c,d,e){return c=c.data,a.fechahora=new Date,a.grupo=c[0],a.year=c[1],a.alumnos=c[2],a.escalas=d,a.config=e.get("config"),a.$on("change_config",function(){return a.config=e.get("config")})}])}.call(this),function(){angular.module("myvcFrontApp").filter("puestoAlumno",[function(){return function(a,b){var c;return c=0,angular.forEach(b,function(b){return a.promedio<b.promedio?c+=1:void 0}),c}}]).filter("notasAsignatura",[function(){return function(a,b){var c;return c="",angular.forEach(a,function(a){return c=c+'<div class="ellipsis350"><b>Per'+b+": "+a.definicion_unidad+"</b></div>",angular.forEach(a.subunidades,function(a,b){return a.nota?c=c+(b+1)+". "+a.definicion_subunidad+"<b> => "+a.nota.nota+"</b><br>":void 0})}),c}}]).filter("notasPerdidasAsignaturas",["$filter",function(a){return function(b){return this.cantidad_perdidas=0,angular.forEach(b,function(b){return this.cantidad_perdidas=this.cantidad_perdidas+a("notasPerdidasAsignatura")(b.unidades,!0)}),this.cantidad_perdidas}}]).filter("notasPerdidasAsignatura",["Perfil",function(a){return function(b,c,d){var e;return this.unidades_response=[],this.cantidad_perdidas=0,angular.forEach(b,function(b){var c;return this.subunis=[],angular.forEach(b.subunidades,function(b){if(b.nota)if(b.nota.nota||0===b.nota.nota){if(b.nota.nota<a.User().nota_minima_aceptada)return this.subunis.push(b)}else if(b.nota<a.User().nota_minima_aceptada)return this.subunis.push(b)},this),this.cantidad_perdidas=this.cantidad_perdidas+this.subunis.length,this.subunis.length>0?(c={unidad_id:b.unidad_id,definicion_unidad:b.definicion_unidad,valor_unidad:b.valor_unidad,orden_unidad:b.orden_unidad,nota_unidad:b.nota_unidad,subunidades:this.subunis},this.unidades_response.push(c)):void 0},this),c?this.cantidad_perdidas:(e="",angular.forEach(unidades_response,function(a){return e=e+'<div class="ellipsis350"><b>Per'+d+": "+a.definicion_unidad+"</b></div>",angular.forEach(a.subunidades,function(a,b){return e=e+'<span class="ellipsis250">'+(b+1)+". "+a.definicion_subunidad+" </span><b> => "+a.nota.nota+"</b><br>"})}),e)}}]).filter("notasPerdidasAsignaturaPeriodo",["$filter",function(a){return function(b,c){var d,e,f,g,h;for(e=0,g=0,h=b.length;h>g;g++)d=b[g],f=a("notasPerdidasAsignatura")(d.unidades,!0),e+=f;return e}}]).filter("promAsig",["$filter",function(a){return function(a,b){var c,d,e,f,g,h,i,j,k;for(f=0,e=0,g=0,i=a.length;i>g;g++)for(c=a[g],k=c.asignaturas,h=0,j=k.length;j>h;h++)d=k[h],d.asignatura_id===b&&(e++,f+=d.nota_asignatura);return f/e}}]).filter("promGrupoPer",["$filter",function(a){return function(a){var b,c,d,e;for(c=0,d=0,e=a.length;e>d;d++)b=a[d],c+=b.promedio;return c/a.length}}]).filter("notasPerdidasGrupoPer",["$filter",function(a){return function(b){var c,d,e,f;for(d=0,e=0,f=b.length;f>e;e++)c=b[e],d+=a("notasPerdidasAsignaturaPeriodo")(c.asignaturas,!0);return d}}])}.call(this),function(){angular.module("myvcFrontApp").filter("promGrupoYear",[function(){return function(a){var b,c,d,e;for(c=0,d=0,e=a.length;e>d;d++)b=a[d],c+=b.promedio_year;return c/a.length}}]).filter("promAsigYear",["$filter",function(a){return function(a,b){var c,d,e,f,g,h,i,j,k;for(f=0,d=0,g=0,i=a.length;i>g;g++)for(c=a[g],k=c.notas_asig,h=0,j=k.length;j>h;h++)e=k[h],e.asignatura_id===b&&(d++,f+=parseFloat(e.nota_asignatura_year));return f/d}}]).filter("notasAsignaturaYear",["$filter",function(a){return function(b){var c,d,e,f,g;for(c=0,d="",f=0,g=b.length;g>f;f++)e=b[f],d+=a("notasAsignatura")(e.unidades,e.numero);return d}}]).filter("notasPerdidasAsignaturaYear",["$filter",function(a){return function(b,c){var d,e,f,g,h;for(d=0,e="",g=0,h=b.length;h>g;g++)f=b[g],c?d+=a("notasPerdidasAsignatura")(f.unidades,c,f.numero):e+=a("notasPerdidasAsignatura")(f.unidades,!1,f.numero);return c?d:e}}]).filter("notasPerdidasAsignaturasYear",["$filter",function(a){return function(b){return this.cantidad_perdidas=0,angular.forEach(b,function(b){return this.cantidad_perdidas=this.cantidad_perdidas+a("notasPerdidasAsignaturaYear")(b.periodos,!0)}),this.cantidad_perdidas}}]).filter("notasPerdidasGrupoYear",["$filter",function(a){return function(a){var b,c,d,e;for(c=0,d=0,e=a.length;e>d;d++)b=a[d],c+=b.perdidos_year;return c}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PuestosGrupoYearCtrl",["$scope","datos_puestos","escalas","$cookieStore",function(a,b,c,d){return b=b.data,a.fechahora=new Date,a.grupo=b.grupo,a.year=b.year,a.alumnos=b.alumnos,a.escalas=c,a.config=d.get("config"),a.$on("change_config",function(){return a.config=d.get("config")}),a.alumnos_materias=[],a.add_alum_materia=function(b,c){return a.alumnos_materias.push({asignatura:b,alumno:c})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PlanillasCtrl",["$scope","App","Perfil","asignaturas","$state",function(a,b,c,d,e){var f,g,h,i,j;for(d=d.data,a.USER=c.User(),a.USER.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.year=d[0],a.asignaturas=d[1],a.perfilPath=b.images+"perfil/",a.unidadesdefault=["  ","  ","  ","  ","  "],a.subunidadesdefault=["  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  ","  "],j=a.asignaturas,h=0,i=j.length;i>h;h++)g=j[h],g.alumnos_temp=g.alumnos,g.alumnos_temp.length<32?g.alumnos1=g.alumnos_temp:g.alumnos_temp.length<37?(g.alumnos1=g.alumnos_temp.splice(0,27),g.alumnos2=g.alumnos_temp.splice(0,20)):g.alumnos_temp.length<62&&(g.alumnos1=g.alumnos_temp.splice(0,31),g.alumnos2=g.alumnos_temp.splice(0,32));return e.params.profesor_id?(f=a.asignaturas[0],a.$emit("cambia_descripcion",a.asignaturas.length+" planillas  del profesor "+f.nombres_profesor+" "+f.apellidos_profesor)):e.params.grupo_id?(f=a.asignaturas[0],a.$emit("cambia_descripcion",a.asignaturas.length+" planillas  del grupo "+f.nombre_grupo)):void 0}]).controller("ControlTardanzaEntradaCtrl",["$scope","App","Perfil","$state","grupos",function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o;for(a.USER=c.User(),i=e.data[0],a.year=i,a.grupos=i.grupos,a.perfilPath=b.images+"perfil/",a.numberColumExt=21,a.numberColumInt=4,a.getNumber=function(a){return new Array(a)},n=a.grupos,j=0,l=n.length;l>j;j++)for(h=n[j],g=0,o=h.alumnos,k=0,m=o.length;m>k;k++)f=o[k],g++,3===g?(f.gris=!0,g=0):f.gris=!1;return a.$emit("cambia_descripcion","Planillas para el control de tardanzas en la entrada."),a.dato={},a.mesSeleccionado=function(){return"-1"===a.mesMostrar?a.numberColumExt=21:(a.dato.mes=""+a.mesMostrar,a.dias=a.getAllDaysInMonth(a.dato.mes),a.numberColumExt=a.dias.length)}}])}.call(this),function(){angular.module("myvcFrontApp").controller("BoletinesFinalesCtrl",["$scope","alumnosDat","escalas","$cookieStore",function(a,b,c,d){return a.grupo=b[0],a.year=b[1],a.alumnos=b[2],a.escalas=c,a.config=d.get("config"),a.requested_alumnos=d.get("requested_alumnos"),a.requested_alumno=d.get("requested_alumno"),a.$on("change_config",function(){return a.config=d.get("config")}),a.requested_alumnos?a.$emit("cambia_descripcion","Mostrando "+a.alumnos.length+" boletines de "+a.grupo.cantidad_alumnos+" del grupo "+a.grupo.nombre_grupo):a.requested_alumno?a.$emit("cambia_descripcion","Mostrando un boletin de "+a.grupo.cantidad_alumnos+" del grupo "+a.grupo.nombre_grupo):a.$emit("cambia_descripcion",a.alumnos.length+" boletines del grupo "+a.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").directive("boletinFinalAlumnoDir",["App","Perfil",function(a,b){return{restrict:"EA",templateUrl:"==informes/boletinFinalAlumnoDir.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(c,d,e){return c.USER=b.User(),c.USER.nota_minima_aceptada=parseInt(c.USER.nota_minima_aceptada),c.perfilPath=a.images+"perfil/",c.views=a.views}}}]).filter("promedioPeriodo",[function(){return function(a,b){var c,d,e,f,g,h,i,j,k;for(f=0,g=0,i=a.length;i>g;g++)for(c=a[g],k=c.definitivas,h=0,j=k.length;j>h;h++)d=k[h],d.periodo_id&&parseFloat(d.periodo_id)===parseFloat(b)&&(f+=parseFloat(d.DefMateria));return e=f/a.length}}])}.call(this),function(){angular.module("myvcFrontApp").directive("editNotasMatYearDir",["App","Perfil",function(a,b){return{restrict:"EA",templateUrl:"==informes/editNotasMatYearDir.tpl.html",scope:{asignatura:"=",alumno:"=",alumnosasigs:"="},controller:["$scope","App","$http","EscalasValorativasServ","AuthService","toastr",function(a,c,d,e,f,g){var h;return a.USER=b.User(),a.USER.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.perfilPath=c.images+"perfil/",a.periodos_materia=[],a.solo_notas_perdidas=!0,a.hasRoleOrPerm=f.hasRoleOrPerm,e.escalas().then(function(b){return a.escalas=b}),h={alumno_id:a.alumno.alumno_id,asignatura_id:a.asignatura.asignatura_id,periodos_a_calcular:"de_usuario"},d.put("::editnota/alum-asignatura",h).then(function(b){return a.periodos_materia=b.data},function(a){}),a.cambiaNota=function(a,b){return d.put("::notas/update/"+a.id,{nota:a.nota}).then(function(b){return g.success("Cambiada: "+a.nota)},function(b){return g.error("No pudimos guardar la nota "+a.nota)})}}]}}])}.call(this),function(){angular.module("myvcFrontApp").directive("certificadoEstudioDir",["App","Perfil",function(a,b){return{restrict:"EA",templateUrl:"==informes/certificadoEstudioDir.tpl.html",scope:{grupo:"=",year:"=",alumno:"=",config:"=",escalas:"="},link:function(c,d,e){var f,g;return c.USER=b.User(),c.USER.nota_minima_aceptada=parseInt(c.USER.nota_minima_aceptada),c.perfilPath=a.images+"perfil/",c.views=a.views,g=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],f=new Date,c.fecha_dia=f.getDate(),c.fecha_mes=g[f.getMonth()],c.fecha_year=f.getFullYear()}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CertificadosEstudioCtrl",["$scope","$state","alumnosDat","escalas","$cookieStore",function(a,b,c,d,e){return a.grupo=c[0],a.year=c[1],a.alumnos=c[2],a.escalas=d,a.config=e.get("config"),a.requested_alumnos=e.get("requested_alumnos"),a.requested_alumno=e.get("requested_alumno"),a.$on("change_config",function(){return a.config=e.get("config")}),a.requested_alumnos?a.$emit("cambia_descripcion","Mostrando "+a.alumnos.length+" boletines de "+a.grupo.cantidad_alumnos+" del grupo "+a.grupo.nombre_grupo):a.requested_alumno?a.$emit("cambia_descripcion","Mostrando un boletin de "+a.grupo.cantidad_alumnos+" del grupo "+a.grupo.nombre_grupo):a.$emit("cambia_descripcion",a.alumnos.length+" boletines del grupo "+a.grupo.nombre_grupo)}])}.call(this),function(){angular.module("myvcFrontApp").controller("NotasPerdidasProfesorCtrl",["$scope","App","Perfil","grupos","$state","$stateParams",function(a,b,c,d,e,f){return a.grupos=d.data,a.periodo_a_calcular=f.periodo_a_calcular,a.USER=c.User(),a.USER.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.perfilPath=b.images+"perfil/",a.$emit("cambia_descripcion","Notas pendientes ")}]).controller("NotasPerdidasTodosCtrl",["$scope","App","Perfil","profesores","$state","$stateParams",function(a,b,c,d,e,f){return a.profesores=d.data,a.periodo_a_calcular=f.periodo_a_calcular,a.USER=c.User(),a.USER.nota_minima_aceptada=parseInt(a.USER.nota_minima_aceptada),a.perfilPath=b.images+"perfil/",a.$emit("cambia_descripcion","Notas pendientes ")}]).controller("VerAusenciasCtrl",["$scope","App","Perfil","grupos_ausencias","$state",function(a,b,c,d,e){return a.grupos_ausencias=d.data,a.USER=c.User(),a.perfilPath=b.images+"perfil/",a.$emit("cambia_descripcion","Ausencias y tardanzas a la institución ")}]).controller("VerSimatCtrl",["$scope","App","Perfil","grupos_simat","$state",function(a,b,c,d,e){return a.grupos_simat=d.data,a.USER=c.User(),a.perfilPath=b.images+"perfil/",a.$emit("cambia_descripcion","Ausencias y tardanzas a la institución ")}]).controller("VerObservadorVerticalCtrl",["$scope","App","Perfil","grupos_observador","$state",function(a,b,c,d,e){return a.grupos_observador=d.data,a.editor_options={allowedContent:!0,entities:!1},a.onEditorReady=function(){return console.log("Editor listo")},a.USER=c.User(),a.perfilPath=b.images+"perfil/",a.$emit("cambia_descripcion","Observador del alumno ")}]).directive("compile",["$compile","$timeout",function(a,b){return{restrict:"A",link:function(c,d,e){return b(function(){return a(d.contents())(c)})}}}])}.call(this),function(){angular.module("myvcFrontApp").filter("decimales",[function(){return function(a,b){return a=parseFloat(a),a=a%1===0?a.toFixed(0):a.toFixed(b),a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]).filter("decimales_if",[function(){return function(a,b){var c;return a=parseFloat(a),a=a%1===0?a.toFixed(0):a.toFixed(b),c=a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),c=parseFloat(c)}}]).filter("setDecimal",[function(){return function(a,b){var c;return isNaN(a)?a:(c="1"+Array(+(b>0&&b+1)).join("0"),Math.round(a*c)/c)}}]).filter("formatNumberDocumento",["$filter",function(a){return function(b){return!isNaN(b)&&angular.isNumber(+b)?a("number")(b,0):b}}])}.call(this),function(){angular.module("myvcFrontApp").filter("materiasPerdidasYear",[function(){return function(a,b,c){return b?(this.alumnos_response=[],angular.forEach(a,function(a,d){return this.cant_asig_perdidas=0,angular.forEach(a.notas_asig,function(a,b){return Math.round(a.nota_asignatura_year)<c?this.cant_asig_perdidas++:void 0}),this.cant_asig_perdidas>=b?this.alumnos_response.push(a):void 0}),alumnos_response):a}}]).filter("materiasPerdidas",[function(){return function(a,b,c){return b?(this.alumnos_response=[],angular.forEach(a,function(a,d){return this.cant_asig_perdidas=0,angular.forEach(a.asignaturas,function(a,b){return Math.round(a.nota_asignatura)<c?this.cant_asig_perdidas++:void 0}),this.cant_asig_perdidas>=b?this.alumnos_response.push(a):void 0}),alumnos_response):a}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(a,b,c){a.state("panel.actividades.votaciones",{url:"/votaciones",views:{actividades_content:{templateUrl:""+b.views+"votaciones/votacionesInicio.tpl.html",controller:"VotacionesInicioCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Votaciones"}]}}},data:{displayName:"Votaciones",icon_fa:"fa fa-legal",pageTitle:"Votaciones - MyVc"}}),a.state("panel.actividades.votaciones.config",{url:"/config",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/votaciones.tpl.html",controller:"VotacionesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Configuración - MyVc"}]}}},data:{displayName:"Configuración",icon_fa:"fa fa-legal",pageTitle:"Configuración - MyVc"}}).state("panel.actividades.votaciones.participantes",{url:"/participantes",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/participantes.tpl.html",controller:"ParticipantesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Participantes"}]}}},data:{needed_permissions:[c.can_edit_participantes],displayName:"Participantes",icon_fa:"fa fa-legal",pageTitle:"Participantes - MyVc"}}).state("panel.actividades.votaciones.candidatos",{url:"/candidatos",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/candidatos.tpl.html",controller:"CandidatosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Candidatos"}]}}},data:{needed_permissions:[c.can_edit_candidatos],pageTitle:"Candidatos - MyVc"}}).state("panel.actividades.votaciones.votar",{url:"/votar",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/votar.tpl.html",controller:"VotarCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Votar"}]}}},data:{pageTitle:"Votar - MyVc"}}).state("panel.actividades.votaciones.votarprueba",{url:"/prueba",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/votarprueba.tpl.html",controller:"VotarPruebaCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Prueba votación"}]}}},data:{pageTitle:"Prueba votación - MyVc"}}).state("panel.actividades.votaciones.resultados",{url:"/resultados",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/resultados.tpl.html",controller:"ResultadosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Resultados"}]}}},data:{pageTitle:"Resultados - MyVc"}}).state("panel.actividades.votaciones.tarjetones",{url:"/tarjetones",views:{votaciones_view:{templateUrl:""+b.views+"votaciones/tarjetones.tpl.html",controller:"TarjetonesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Tarjetones"}]}}},data:{pageTitle:"Tarjetones - MyVc"}})}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotacionesCtrl",["$scope","$filter","$http","resolved_user","App","toastr",function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n;a.data={},a.editing=!1,a.gridScope=a,a.votacionEdit={},a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:"",aspiraciones:[{aspiracion:"",abrev:""}]},a.date={dateOptions:{startingDay:1}},a.addAspiracion=function(){return a.votacion.aspiraciones.push({aspiracion:"",abrev:""})},a.removeAspiracion=function(b){return a.votacion.aspiraciones.splice(b,1)},a.addAspiracionEdit=function(b){return c.post("::aspiraciones/store",{votacion_id:b}).then(function(b){return f.success("Aspiración creada."),a.votacionEdit.aspiraciones.push({id:b.data.id,aspiracion:"",abrev:""})},function(a){return f.error("No se pudo crear aspiración.")})},a.updateAspiracionEdit=function(a){return c.put("::aspiraciones/update",a).then(function(a){return f.success("Aspiración modificada.")},function(a){return f.error("No se pudo modificar aspiración.")})},a.removeAspiracionEdit=function(d){return c["delete"]("::aspiraciones/destroy/"+d.id).then(function(c){return f.success("Aspiración eliminada."),a.votacionEdit.aspiraciones=b("filter")(a.votacionEdit.aspiraciones,{id:"!"+d.id})},function(a){return f.error("No se pudo eliminar aspiración.")})},a.editar=function(b){return a.editing=!0,a.votacionEdit=b},a.eliminar=function(d){return c["delete"]("::votaciones/destroy/"+d.id).then(function(c){return a.gridOptions.data=b("filter")(a.gridOptions.data,{id:"!"+d.id})},function(a){return f.error("No se pudo eliminar.")})},a.cambiarInAction=function(b){return c.put("::votaciones/set-in-action",{id:b.id,in_action:b.in_action}).then(function(c){var d,e,g,h;if(b.in_action)for(h=a.gridOptions.data,e=0,g=h.length;g>e;e++)d=h[e],b.id!==d.id&&(d.in_action=!1);else b.in_action=!1;return f.success("Cambiado")},function(a){return f.error("No se pudo poner en acción.")})},a.cambiarVotanProfes=function(a){return c.put("::votaciones/set-votan-profes",{id:a.id,votan_profes:a.votan_profes}).then(function(a){return f.success("Cambiado")},function(a){return f.error("No se pudo cambiar votan profes.")})},a.cambiarVotanAcudientes=function(a){return c.put("::votaciones/set-votan-acudientes",{id:a.id,votan_acudientes:a.votan_acudientes}).then(function(a){return f.success("Cambiado")},function(a){return f.error("No se pudo cambiar votan acudientes.")})},a.cambiarLocked=function(a){return c.put("::votaciones/set-locked",{id:a.id,locked:a.locked}).then(function(a){return f.success("Cambiado")},function(a){return f.error("No se pudo cambiar bloqueo.")})},a.cambiarPermisoVerResults=function(a){return c.put("::votaciones/set-permiso-ver-results",{id:a.id,can_see_results:a.can_see_results}).then(function(a){return f.success("Cambiado")},function(a){return f.error("No se pudo cambiar el permiso.")})},a.cambiarEventoActual=function(b){return c.put("::votaciones/set-actual",{id:b.id,actual:b.actual}).then(function(c){var d,e,g,h;if(b.actual)for(h=a.gridOptions.data,e=0,g=h.length;g>e;e++)d=h[e],b.id!==d.id&&(d.actual=!1);else b.actual=!1;return f.success("Cambiado")},function(a){return f.error("No se pudo volver actual.")})},k='<a uib-tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',h="==votaciones/botonEventoActual.tpl.html",j="==votaciones/botonEventoLocked.tpl.html",n="==votaciones/botonVotanProfes.tpl.html",i="==votaciones/botonVotanAcudientes.tpl.html",g="==votaciones/botonEventoInAction.tpl.html",m="==votaciones/botonPermisoVerResults.tpl.html",a.gridOptions={enableSorting:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"id",displayName:"Id",width:40,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",width:50,enableSorting:!1,enableFiltering:!1,cellTemplate:k+l,enableCellEdit:!1},{field:"nombre",enableHiding:!1,minWidth:110},{field:"locked",displayName:"Bloqueado",cellTemplate:j,minWidth:80},{field:"votan_profes",displayName:"Profes votan",minWidth:80,cellTemplate:n},{field:"votan_acudientes",displayName:"Acudientes votan",minWidth:80,cellTemplate:i},{field:"actual",displayName:"Actual",cellTemplate:h,minWidth:80},{field:"in_action",displayName:"En acción",cellTemplate:g,minWidth:80},{field:"can_see_results",displayName:"Permiso",cellTemplate:m,minWidth:80},{field:"fecha_inicio",displayName:"Inicia",cellFilter:"date:mediumDate",type:"date",minWidth:80},{field:"fecha_fin",displayName:"Termina",cellFilter:"date:mediumDate",type:"date",minWidth:80}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,d,e,g){return e!==g&&c.put("::votaciones/update/"+b.id,b).then(function(a){return f.success("Evento actualizado con éxito","Actualizado")},function(a){return f.error("Cambio no guardado","Error")}),a.$apply()})}},c.get("::votaciones").then(function(b){return a.gridOptions.data=b.data},function(a){return f.error("Error trayendo los eventos.")}),a.crear=function(){return c.post("::votaciones/store",a.votacion).then(function(b){return b=b.data,b.actual&&angular.forEach(a.gridOptions.data,function(a,b){return a.actual=0}),a.gridOptions.data.push(b)},function(a){return f.error("Falló al intentar guardar")})},a.guardar=function(){return c.post("::votaciones/update/"+a.votacionEdit.id,a.votacionEdit).then(function(a){return f.success("Se hizo el put de la votación")},function(a){return f.error("Falló al intentar guardar")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotacionesInicioCtrl",["$scope","$rootScope","$interval","resolved_user","App","AuthService","$state",function(a,b,c,d,e,f,g){f.verificar_acceso(),a.hasRoleOrPerm=f.hasRoleOrPerm,a.USER=d,g.is("panel.actividades.votaciones")&&(a.hasRoleOrPerm(["alumno","acudiente"])&&g.go("panel.actividades.votaciones.votar"),a.hasRoleOrPerm(["admin","profesor"])&&g.go("panel.actividades.votaciones.config"))}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("CandidatosCtrl",["$scope","$filter","$http","toastr","App",function(a,b,c,d,e){a.perfilPath=e.images+"perfil/",a.aspiraciones=[],a.allinscritos=[],c.get("::candidatos/conaspiraciones").then(function(b){return a.aspiraciones=b.data},function(a){return d.error("No se pudo traer las aspiraciones","Problema")}),c.get("::participantes/allinscritos").then(function(b){return a.allinscritos=b.data},function(a){return d.error("No se pudo traer los inscritos","Problema")}),a.crearCandidato=function(a){var b;return b={},b.user_id=a.newParticip.user_id,b.plancha=a.newParticip.plancha,b.numero=a.newParticip.numero,b.aspiracion_id=a.id,c.post("::candidatos/store",b).then(function(b){return b=b.data,a.candidatos=b,a.newParticip=null,d.success("Candidato creado con éxito")},function(a){return"Candidato ya inscrito"===a.data.error.message?d.warning("Candidato ya inscrito en esta aspiración"):d.warning("No se pudo crear el candidato","Problema")})},a.eliminarCandidato=function(a,e){return c["delete"]("::candidatos/destroy/"+a).then(function(c){return e.candidatos=b("filter")(e.candidatos,{candidato_id:"!"+a}),d.success("Candidato removido de la candidatura")},function(a){return d.error("No se pudo quitar de la candidatura","Problema")})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("ParticipantesCtrl",["$scope","$filter","$http","toastr",function(a,b,c,d){var e,f,g;a.editing=!1,a.gridScope=a,a.participante={},g=!1,a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.eliminar=function(e){return c["delete"]("::participantes/destroy/"+e.id).then(function(c){return d.success("Se ha eliminado."),a.gridOptions.data=b("filter")(a.gridOptions.data,{id:"!"+c.data.id})},function(a){return d.error("No se pudo eliminar.")})},a.cambiarLocked=function(a){return c.put("::participantes/set-locked",{id:a.id,locked:a.locked}).then(function(a){return d.success("Cambiado")},function(a){return d.error("No se pudo cambiar bloqueo.");
})},f='<a uib-tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',e="==votaciones/botonEventoLocked.tpl.html",a.gridOptions={enableSorting:!0,showGridFooter:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:f,enableCellEdit:!1},{field:"nombres",displayName:"nombres",enableCellEdit:!1,minWidth:80},{field:"apellidos",displayName:"apellidos",enableCellEdit:!1},{field:"nombre_grupo",displayName:"Grado",enableCellEdit:!1},{field:"username",displayName:"Usuario",enableCellEdit:!1},{field:"votados",displayName:"Votados",enableCellEdit:!1},{field:"completo",displayName:"Completo",enableCellEdit:!1},{field:"locked",displayName:"Bloqueado",cellTemplate:e,minWidth:80}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},c.put("::participantes/datos").then(function(b){return b=b.data,a.gridOptions.data=b.participante,a.grupos=b.grupos,a.votacion=b.votacion,a.datos.grupo_profes_acudientes=b.partic_gr},function(a){return d.warning("Asegúrate de tener al menos un evento como actual.")}),a.guardarInscripciones=function(){return a.guardando_inscrip=!0,c.put("::participantes/guardar-inscripciones",{grupos:a.grupos}).then(function(b){return d.success("Inscripciones guardadas."),a.guardando_inscrip=!1},function(b){return d.error("Error al intentar guardar Inscripciones."),a.guardando_inscrip=!1})}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotarCtrl",["$scope","$http","toastr",function(a,b,c){a.votaciones=[],a.indexVotando=0,b.get("::votaciones/en-accion-inscrito").then(function(b){var d,e,f,g,h;if(b=b.data,b.msg)return c.warning(b.msg,"Atención");for(a.votaciones=b,g=a.votaciones,h=[],e=0,f=g.length;f>e;e++)d=g[e],d.completos?h.push(a.indexVotando++):h.push(void 0);return h}),a.$on("termineDeVotar",function(){return a.indexVotando++,a.$broadcast("terminaVotacion",a.indexVotando)})}]).controller("chooseCandidatoCtrl",["$scope","$http","$uibModalInstance","App","candidato","aspiracion","votacion_id","toastr",function(a,b,c,d,e,f,g,h){return a.candidato=e,a.aspiracion=f,a.imagesPath=d.images+"perfil/",a.ok=function(){var a;return a={},a.votacion_id=g,e.voto_blanco?(a.blanco_aspiracion_id=f.id,a.voto_blanco=!0):a.candidato_id=e.candidato_id,b.post("::votos/store",a).then(function(a){return a=a.data,a.msg?h.info(a.msg):h.success("Voto guardado con éxito"),c.close(a)},function(a){return a=a.data,a.data&&a.data.msg?h.error(a.data.msg):h.error("No se pudo guardar el voto."),c.dismiss("Error al guardar")})},a.cancel=function(){return c.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("myvcFrontApp").controller("VotarPruebaCtrl",["$scope","$filter","$http","App","$state","$uibModal","$window",function(a,b,c,d,e,f,g){a.hover=!1,a.aspiraciones=[],a.maxi=e.params.maxi,a.windowHeight=angular.element(g).height()-100,a.wzStep=0,a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},c.get("::votaciones/actual").then(function(b){return a.votacion=b.data,a.votacion.locked?a.toastr.warning("La votación actual está bloqueada"):void 0}),c.get("::candidatos/conaspiraciones").then(function(b){return a.aspiraciones=b.data},function(b){return a.toastr.error("No se pudo traer las aspiraciones","Problema")}),c.get("::participantes/allinscritos").then(function(b){return a.allinscritos=b.data},function(b){return a.toastr.error("No se pudo traer los inscritos","Problema")}),a.currentImg="default_male.jpg",a.imagesPath=d.images+"perfil/",a.mostrarImagen=function(b){return b.iluminado=!0,a.currentImg=b.imagen_nombre},a.ocultarImagen=function(a){return a.iluminado=!1},a.nextAspiracion=function(){return a.wzStep<a.aspiraciones.length?a.wzStep+=1:void 0},a.prevAspiracion=function(){return a.wzStep>0?a.wzStep-=1:void 0},a.goAspiracion=function(b){return a.wzStep=parseInt(a.wzStep),b=parseInt(b),b<a.wzStep?a.wzStep=b:void 0},a.open=function(b,c){var d;return a.votacion.locked?void a.toastr.warning("La votación actual está bloqueada"):(d=f.open({templateUrl:"==votaciones/chooseCandidato.tpl.html",controller:"chooseCandidatoCtrl",resolve:{candidato:function(){return b},aspiracion:function(){return c},votacion_id:function(){return a.votacion.id}}}),d.result.then(function(b){return c.votado.push(b),a.nextAspiracion()},function(){}))}}]).controller("chooseCandidatoPruebaCtrl",["$scope","$http","$uibModalInstance","App","candidato","aspiracion","toastr",function(a,b,c,d,e,f,g){return a.candidato=e,a.aspiracion=f,a.imagesPath=d.images+"perfil/",a.ok=function(){var a,b;return a={},a.candidato_id=e.candidato_id,b={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:"",completo:!1},g.success("Voto guardado con éxito"),c.close(b)},a.cancel=function(){return c.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("votarPanelDir",["App","Perfil","$http",function(a,b,c){return{restrict:"EA",templateUrl:"==votaciones/votarPanel.tpl.html",scope:{votacion:"="},controller:["$scope","App","toastr","$window","$uibModal",function(a,c,d,e,f){a.USER=b.User(),a.hover=!1,a.maxi=!1,a.windowHeight=angular.element(e).height()-100,a.wzStep=0,a.currentImg="default_male.jpg",a.imagesPath=c.images+"perfil/",a.$parent.$index===a.$parent.indexVotando&&(a.maxi=!0),a.$on("terminaVotacion",function(b,c){return a.$parent.$index===c?a.maxi=!0:void 0}),a.votacion.completos&&(a.wzStep=a.votacion.aspiraciones.length),a.mostrarImagen=function(b){return b.iluminado=!0,a.currentImg=b.imagen_nombre},a.ocultarImagen=function(a){return a.iluminado=!1},a.nextAspiracion=function(){return a.wzStep<a.votacion.aspiraciones.length?a.wzStep+=1:void 0},a.prevAspiracion=function(){return a.wzStep>0?a.wzStep-=1:void 0},a.goAspiracion=function(b){return a.wzStep=parseInt(a.wzStep),b=parseInt(b),b<a.wzStep?a.wzStep=b:void 0},a.open=function(b,c){var e;if(a.votacion.locked)d.warning("La votación está bloqueada.");else{if(!a.votacion.locked_votacion)return e=f.open({templateUrl:"==votaciones/chooseCandidato.tpl.html",controller:"chooseCandidatoCtrl",resolve:{candidato:function(){return b},aspiracion:function(){return c},votacion_id:function(){return a.votacion.id}}}),e.result.then(function(b){var e,f,g,h,i;for(c.votado=!0,f=0,i=a.votacion.aspiraciones,g=0,h=i.length;h>g;g++)e=i[g],e.votado&&f++;return a.votacion.aspiraciones.length===f&&(a.$emit("termineDeVotar"),a.maxi=!1,d.info("Ahora continúa con la siguiente votación.")),a.nextAspiracion()},function(){});d.warning("Usted está bloqueado en esta votación.")}}}]}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ResultadosCtrl",["$scope","$http","App","toastr",function(a,b,c,d){a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.imagesPath=c.images+"perfil/",b.put("::votos/show").then(function(b){return a.votaciones=b.data.votaciones,a.year=b.data.year},function(a){return d.error("Error trayendo las votaciones.")})}]).controller("TarjetonesCtrl",["$scope","$http","App","toastr",function(a,b,c,d){a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.imagesPath=c.images+"perfil/",b.put("::votos/show").then(function(b){return a.votaciones=b.data.votaciones,a.year=b.data.year},function(a){return d.error("Error trayendo las votaciones.")})}])}.call(this),function(){angular.module("myvcFrontApp").directive("loader",[function(){return{restrict:"E",templateUrl:"==directives/loader.tpl.html",scope:{cargando:"="},link:function(a,b,c){}}}])}.call(this),angular.module("uiBreadcrumbs",["ui.router","myvcFrontApp"]).directive("uiBreadcrumbs",["$interpolate","$state","App",function(a,b,c){return{restrict:"E",templateUrl:c.views+"directives/uiBreadcrumbs.tpl.html",scope:{displaynameProperty:"@"},link:function(c){function d(){for(var a=[],d=b.$current;d&&""!==d.name;){var g=e(d),h=f(d);g!==!1&&a.push({displayName:g,route:d.name,icon_fa:h}),d=d.parent}a.reverse(),c.breadcrumbs=a}function e(b){var d,e,f,g;if(!c.displaynameProperty)return b.name;for(f=c.displaynameProperty.split("."),e=b,d=0;d<f.length;d++){if(!angular.isDefined(e[f[d]]))return b.name;if(e[f[d]]===!1)return!1;e=e[f[d]]}return g=a(e)(b.locals.globals)}function f(b){var c,d;return c=b,angular.isDefined(c.data.icon_fa)?c.data.icon_fa===!1?!1:(c=c.data.icon_fa,d=a(c)(b.locals.globals)):""}c.breadcrumbs=[],""!==b.$current.name&&d(),c.$on("$stateChangeSuccess",function(){d()})}}}]),function(){angular.module("myvcFrontApp").directive("sidebarMenu",["$rootScope","AuthService","$http","$uibModal","Perfil","ProfesoresServ","$window","$state",function(a,b,c,d,e,f,g,h){return{restrict:"E",replace:!0,templateUrl:"==directives/sidebarMenu.tpl.html",scope:{cargando:"="},link:function(a,b,c){return a.$watch(function(){return g.innerWidth},function(a){return a>880?b.removeClass("hide"):b.addClass("hide")})},controller:["$scope","$attrs","$state","App",function(g,h,i,j){return g.perfilPath=j.images+"perfil/",this.groups=[],g.hasRoleOrPerm=b.hasRoleOrPerm,g.$state=a.$state,g.persona_id=e.User().persona_id,g.hasRoleOrPerm(["Admin","Profesor"])&&c.get("::grupos").then(function(a){return g.grupos=a.data},function(a){return toastr.error("No se pudo traer los grupos del menú")}),f.contratos().then(function(a){return g.profesores=a},function(a){return toastr.error("No se pudo traer los profesores del menú")}),g.listarAsignaturas=function(){var a;return a=d.open({templateUrl:"==areas/listasignaturasPop.tpl.html",controller:"ListasignaturasPopCtrl"}),a.result.then(function(a){})},g.irDefinitivas=function(a){return i.go("panel.definitivas_periodos",{profesor_id:a})},g.ir_a_informes=function(){return i.go("panel.informes")},this.clikeando=function(){},this.closeOthers=function(a){return angular.forEach(this.groups,function(a){return a.menuIsOpen===!0?a.menuIsOpen=!1:void 0})},this.addGroup=function(a){var b;return b=this,this.groups.push(a),a.$on("$destroy",function(c){return b.removeGroup(a)})},this.removeGroup=function(a){var b;return b=this.groups.indexOf(a),-1!==b?this.groups.splice(b,1):void 0},this}]}}]).directive("subMenu",[function(){return{require:"^sidebarMenu",restrict:"A",replace:!0,scope:!0,link:function(a,b,c,d){return a.menuIsOpen=c.menuIsOpen?a.$eval(c.menuIsOpen):!1,c.hija?(a.menuIsOpen===!0&&b.addClass("open"),a.toggleOpen=function(){return a.menuIsOpen===!1?(b.addClass("open"),a.menuIsOpen=!0):(b.removeClass("open"),a.menuIsOpen=!1)}):(d.addGroup(a),a.$watch("menuIsOpen",function(a){return a===!0?b.addClass("open"):b.removeClass("open")}),a.toggleOpen=function(){return a.menuIsOpen===!1?(d.closeOthers(a),a.menuIsOpen=!0):a.menuIsOpen=!1})}}}]).directive("myDropDown",["$document",function(a){return{restrict:"A",replace:!0,scope:!0,link:function(a,b,c){a.menuIsOpen=c.menuIsOpen?a.$eval(c.menuIsOpen):!1,a.menuIsOpen===!0&&b.addClass("open"),a.toggleOpen=function(){a.menuIsOpen===!0?(b.addClass("open"),a.menuIsOpen=!0):(b.removeClass("open"),a.menuIsOpen=!1)}}}}]).directive("stopEvent",[function(){return{restrict:"A",link:function(a,b,c){return b.bind(c.stopEvent,function(a){return a.stopPropagation()})}}}]).directive("toggle",function(){var a,b,c,d,e;return e="selected",b={},a=function(a,c){return b[a]=b[a]||[],-1===b[a].indexOf(c)?b[a].push(c):void 0},c=function(a,c){var d;return d=(b[a]||[]).indexOf(c),-1!==d?b[a].splice(d,1):void 0},d=function(a,c){return angular.forEach(b[a]||[],function(a){return a.removeClass(e)}),c.addClass(e)},{restrict:"A",link:function(b,e,f){var g;return g=f.toggle||"default",a(g,e),e.on("click",function(){return b.$apply(function(){return d(g,e)})}),b.$on("$destroy",function(){return e.off(),c(g,e)})}}}).controller("ListasignaturasPopCtrl",["$scope","$uibModalInstance","$http","toastr","$state",function(a,b,c,d,e){return a.selectAsignatura=function(a,c){return e.go("panel.notas",{asignatura_id:a,profesor_id:c}),b.close(a)},c.get("::asignaturas/listasignaturas-alone").then(function(b){return a.asignaturas=b.data},function(a){return d.error("No se pudo traer tus asignaturas")}),a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").directive("updateTitle",["$rootScope","$timeout",function(a,b){return{link:function(c,d){var e;return e=function(a,c,e){var f;return f="MyVc",c.data&&c.data.pageTitle&&(f=c.data.pageTitle),e&&e.username&&(f=e.username+" - MyVc"),b(function(){return d.text(f)},0,!1)},a.$on("$stateChangeSuccess",e)}}}])}.call(this),function(){angular.module("myvcFrontApp").directive("notaRapida",["$rootScope","toastr","EscalasValorativasServ",function(a,b,c){return{restrict:"AE",transclude:!0,templateUrl:"==directives/notaRapida.tpl.html",link:function(d,e,f){return d.valorNotaRapida=100,a.notaRapida.enable?d.activado=!0:d.activado=!1,d.activar=function(){return d.activado?void 0:(d.activado=!0,a.notaRapida.enable=d.activado,b.info("Nota rápida activada","ACTIVADA"))},d.desactivar=function(){return d.activado=!1,a.notaRapida.enable=d.activado,b.info("Nota rápida desactivada","DESACTIVADA")},d.$on("keydown:27",function(a,b){return d.desactivar()}),c.escalas().then(function(a){return d.escalas=a},function(a){return console.log("No se trajeron las escalas valorativas",a)}),d.setValor=function(b){return a.notaRapida.valorNota=b,d.activar()}}}}]).directive("cambiamodel",["$rootScope",function(a){return{restrict:"A",link:function(b,c,d){return b.$watch(d.ngModel,function(b){return a.notaRapida.valorNota=b})}}}]).directive("keypressEvents",["$document","$rootScope",function(a,b){return{restrict:"A",link:function(){return a.bind("keypress keydown",function(a){return 27===a.which?b.$broadcast("keydown:27",a):void 0})}}}]).filter("range",function(){return function(a,b,c){var d,e;for(c=parseInt(c),b=parseInt(b),d=e=b;c>=b?c>=e:e>=c;d=c>=b?++e:--e)a.push(d);return a}}).run(["$templateCache",function(a){return a.put("/tmpls/draggable-default","<div ng-transclude></div>")}]).directive("draggable",[function(){return{restrict:"AE",transclude:!0,replace:!0,scope:{},templateUrl:function(a,b){return angular.isDefined(b.template)?b.template:"/tmpls/draggable-default"},link:function(a,b,c){var d,e,f;return a.obj={id:null,content:"",group:null},a.placeholder=!1,a.obj.content=b.html(),angular.isDefined(c.id)&&(a.obj.id=c.id),angular.isDefined(c.placeholder)&&(a.placeholder=a.$eval(c.placeholder)),f=angular.isDefined(c.options)?a.$eval(c.options):{},angular.isDefined(c.group)&&(a.obj.group=c.group,f.stack="."+c.group),d={start:function(b,c){a.placeholder&&c.helper.wrap('<div class="dragging"></div>'),a.$apply(function(){a.$emit("draggable.started",{obj:a.obj})})},drag:function(b){a.$apply(function(){a.$emit("draggable.dragging")})},stop:function(b,c){a.placeholder&&c.helper.unwrap(),a.$apply(function(){a.$emit("draggable.stopped")})}},e=angular.extend({},f,d),b.draggable(e)}}}])}.call(this),function(){angular.module("myvcFrontApp").directive("withpaddingDir",["$rootScope","$state",function(a,b){return{link:function(c,d){var e,f;return e=function(a,c,e){return b.includes("panel.actividades")||b.includes("panel.mis_actividades")?angular.element(d).addClass("no-padding"):angular.element(d).removeClass("no-padding")},f=function(a,c){return b.includes("panel.actividades")||b.includes("panel.mis_actividades")?angular.element(d).addClass("no-padding"):angular.element(d).removeClass("no-padding")},a.$on("$stateChangeSuccess",e),a.$on("$viewContentLoaded",f)}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("Perfil",["App","$q","$cookies","$http",function(a,b,c,d){var e;return e={},{setUser:function(a){return e=a},User:function(){return e},save:function(){return e.save()},id:function(){return e.user_id},idioma:function(){return e.idioma_system},setImagen:function(a,b){return e.imagen_id=a,e.imagen_nombre=b},setOficial:function(a,b){return e.foto_id=a,e.foto_nombre=b},nameToShow:function(){return"Usuario"===e.tipo?e.username.toUpperCase():e.nombres+" "+e.apellidos},deleteUser:function(){return e={}}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("AuthService",["$state","$http","$cookies","Perfil","$rootScope","AUTH_EVENTS","$q","$filter","toastr",function(a,b,c,d,e,f,g,h,i){var j;return j={},j.verificar=function(){var a;return a=g.defer(),d.User().user_id?a.resolve(d.User()):c.get("xtoken")?void 0!==c.get("xtoken")&&"undefined"!==c.get("xtoken")&&"[object Object]"!==c.get("xtoken")?j.login_from_token().then(function(b){return d.setUser(b),a.resolve(b)},function(b){return console.log("No se logueó from token"),a.reject(b)}):(j.borrarToken(),a.reject("Token mal estructurado.")):(console.log("No hay token"),a.resolve("No hay token."),e.$broadcast(f.notAuthenticated)),a.promise},j.verificar_acceso=function(){var b,c;return d.User().user_id||a.go("login"),c=a.current,c.data.needed_permissions?(b=c.data.needed_permissions,j.isAuthorized(b)?void 0:(e.lastState=c.name,j.isAuthenticated()?e.$broadcast(f.notAuthorized):a.transitionTo("login"))):!0},j.login_credentials=function(d){var h;return h=g.defer(),j.borrarToken(),b.post("::login/credentials",d).then(function(a){var d;return d=a.data,d.el_token?(c.put("xtoken",d.el_token),b.defaults.headers.common.Authorization="Bearer "+c.get("xtoken"),localStorage.logueando="token_verificado",h.resolve(d.el_token)):(e.$broadcast(f.loginFailed),h.reject("Error en login"))},function(b){return e.$broadcast(f.loginFailed),b?b.status?400===b.status?i.error("Datos inválidos","",{timeOut:8e3}):-1===b.status?i.error("No parece haber comunicación con el servidor","",{timeOut:8e3}):500===b.status&&i.error("No parece haber comunicación con la Base de datos","",{timeOut:8e3}):b.data?b.data.error&&("Token expirado"===b.data.error||"token_expired"===b.error?(i.warning("La sesión ha expirado"),"login"!==a.current.name&&a.go("login")):e.$broadcast(f.loginFailed)):i.error("No parece haber comunicación con el servidor"):i.error("No parece haber comunicación con el servidor"),h.reject("Error en login")}),h.promise},j.login_from_token=function(){var a,d;return a=g.defer(),b.defaults.headers.common.Authorization="Bearer "+c.get("xtoken"),d=b.post("::login").then(function(b){var c;return c=b.data,e.$broadcast(f.loginSuccess),a.resolve(c)},function(b){return a.reject("Error en login con token.")}),a.promise},j.logout=function(){var c;return c=b.put("::login/logout",{user_id:d.User().user_id}).then(function(a){return console.log("Sesión cerrada")},function(a){return console.log("No se registró el cierre de sesión.")}),e.lastState=null,e.lastStateParam=null,d.deleteUser(),j.borrarToken(),delete localStorage.logueando,a.transitionTo("login")},j.borrarToken=function(){return c.remove("xtoken"),delete b.defaults.headers.common.Authorization},j.isAuthenticated=function(){return!!d.User().user_id},j.isAuthorized=function(a){var b,c;return c=d.User(),c.is_superuser?!0:(angular.isArray(a)||(a=[a]),angular.isArray(c.perms)?(b=[],angular.forEach(a,function(a){return-1!==c.perms.indexOf(a)?b.push(a):void 0}),j.isAuthenticated()&&b.length>0):a.length>0?!1:!0)},j.hasRoleOrPerm=function(a,b){var c;if(!angular.isArray(a)){if(!a)return!1;a=[a]}return c=[],angular.forEach(a,function(a){var b;return b=[],b=h("filter")(d.User().roles,{name:a}),b&&b.length>0?c.push(a):void 0}),c.length>0},j}])}.call(this),function(){angular.module("myvcFrontApp").factory("NotasServ",["$http","$q",function(a,b){var c;return c={},c.detalladas=function(c,d,e){var f;return f=b.defer(),a.put("::notas/detailed",{asignatura_id:c,profesor_id:d,con_asignaturas:e}).then(function(a){return f.resolve(a.data)},function(a){return f.reject(a)}),f.promise},c}]).factory("EscalasValorativasServ",["$http","$q","$filter",function(a,b,c){var d,e;return d=[],e={},e.escalas=function(){var c;return c=b.defer(),d.length>0?c.resolve(d):a.get("::escalas").then(function(a){var b,e,f;for(d=a.data,e=0,f=d.length;f>e;e++)b=d[e],b.orden=parseInt(b.orden),b.perdido=parseInt(b.perdido),b.porc_final=parseInt(b.porc_final),b.porc_inicial=parseInt(b.porc_inicial),b.id=parseInt(b.id),b.year_id=parseInt(b.year_id);return c.resolve(d)},function(a){return c.reject(a)}),c.promise},e.escala_maxima=function(){var a;return a=c("orderBy")(d,"orden")[d.length-1]},e}]).factory("AusenciasServ",["$http","$q",function(a,b){var c;return c={},c.detalladas=function(c){var d;return d=b.defer(),a.get("::ausencias/detailed/"+c).then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)}),d.promise},c}]).factory("ComportamientoServ",["$http","$q",function(a,b){var c;return c={},c.detallados=function(c){var d;return d=b.defer(),a.get("::nota_comportamiento/detailed/"+c).then(function(a){return d.resolve(a.data)},function(a){return d.reject(a)}),d.promise},c}])}.call(this),function(){angular.module("myvcFrontApp").factory("ProfesoresServ",["$http","$q",function(a,b){var c;return c={},c.profesores=[],c.contratos=function(){var d;return d=b.defer(),c.profesores.length>0?d.resolve(c.profesores):a.get("::contratos").then(function(a){return c.profesores=a.data,d.resolve(c.profesores)},function(a){return console.log("No se trajeron los profesores contratados. ",a),d.reject(a.data)}),d.promise},c}])}.call(this),function(){angular.module("myvcFrontApp").factory("YearsServ",["$http","$q",function(a,b){var c,d;return d=[],c={getYears:function(){var c;return c=b.defer(),d.length>0?c.resolve(d):a.get("::years").then(function(a){return d=a.data,c.resolve(d)},function(a){return c.reject(a)}),c.promise}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("DownloadServ",["$http","$q",function(a,b){var c;return c={},c.download=function(c,d){var e;return e=b.defer(),a.get(c,{responseType:"blob"}).then(function(a){var b,c,f,g;return console.log("Entraaaaaa",a),g=a.headers("Content-Type"),c=a.headers("Content-Disposition"),c&&(f=c.match(/.*filename=\"?([^;\"]+)\"?.*/),f[1]&&(d=f[1])),d=d.replace(/[<>:"\/\\|?*]+/g,"_"),b=new Blob([a.data],{type:g}),saveAs(b,d),e.resolve(d)},function(a){return console.log(a),e.reject(a)}),e.promise},c.download2=function(c,d){var e;return e=b.defer(),a.get(c,{responseType:"arraybuffer"}).then(function(a){var b,c;return b=new Blob([a],{type:"Type:application/vnd.ms-excel; charset=UTF-8"}),c=URL.createObjectURL(b),window.open(c),e.resolve(d)},function(a){return console.log("Pailaaassss",a),e.reject(a)}),e.promise},c}])}.call(this),angular.module("ngLocale",[],["$provide",function(a){var b={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["a. m.","p. m."],DAY:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ERANAMES:["antes de Cristo","después de Cristo"],ERAS:["a. C.","d. C."],FIRSTDAYOFWEEK:0,MONTH:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],SHORTDAY:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],SHORTMONTH:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],STANDALONEMONTH:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d MMM y H:mm:ss",mediumDate:"d MMM y",mediumTime:"H:mm:ss","short":"d/M/yy H:mm",shortDate:"d/M/yy",shortTime:"H:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"es-es",localeID:"es_ES",pluralCat:function(a,c){return 1==a?b.ONE:b.OTHER}})}]);