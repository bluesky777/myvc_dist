"use strict";function createCookie(a,b,c){var d,e;c?(d=new Date,d.setTime(d.getTime()+864e5*c),e="; expires="+d.toGMTString()):e="",document.cookie=a+"="+b+e+"; path=/"}function readCookie(a){for(var b,c=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(b=d[e];" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(c))return b.substring(c.length,b.length)}return null}function eraseCookie(a){createCookie(a,"",-1)}function getInternetExplorerVersion(){var a,b,c=-1;return"Microsoft Internet Explorer"==navigator.appName&&(a=navigator.userAgent,b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=b.exec(a)&&(c=parseFloat(RegExp.$1))),c}function getThemeColorFromCss(a){var b=$("<span></span>").hide().appendTo("body");b.addClass(a);var c=b.css("color");return b.remove(),c}function InitiateSideMenu(){$(".sidebar-toggler").on("click",function(){return $("#sidebar").toggleClass("hide"),$(".sidebar-toggler").toggleClass("active"),!1});var a=$("#sidebar").hasClass("menu-compact");$("#sidebar-collapse").on("click",function(){if($("#sidebar").is(":visible")||$("#sidebar").toggleClass("hide"),$("#sidebar").toggleClass("menu-compact"),$(".sidebar-collapse").toggleClass("active"),a=$("#sidebar").hasClass("menu-compact"),$(".sidebar-menu").closest("div").hasClass("slimScrollDiv")&&($(".sidebar-menu").slimScroll({destroy:!0}),$(".sidebar-menu").attr("style","")),a)$(".open > .submenu").removeClass("open");else if($(".page-sidebar").hasClass("sidebar-fixed")){var b=readCookie("rtl-support")||"/index-rtl-fa.html"==location.pathname||"/index-rtl-ar.html"==location.pathname?"right":"left";$(".sidebar-menu").slimscroll({height:"auto",position:b,size:"3px",color:themeprimary})}}),$(".sidebar-menu").on("click",function(b){console.log("Me cliquearon ",b);var c=$(b.target).closest("a");if(c&&0!=c.length){if(c.hasClass("menu-dropdown")){var d=c.next().get(0);if(!$(d).is(":visible")){var e=$(d.parentNode).closest("ul");if(a&&e.hasClass("sidebar-menu"))return;e.find("> .open > .submenu").each(function(){this==d||$(this.parentNode).hasClass("active")||$(this).slideUp(200).parent().removeClass("open")})}return a&&$(d.parentNode.parentNode).hasClass("sidebar-menu")?!1:($(d).slideToggle(200).parent().toggleClass("open"),!1)}if(a&&c.get(0).parentNode.parentNode==this){var f=c.find(".menu-text").get(0);if(b.target!=f&&!$.contains(f,b.target))return!1}}})}function InitiateWidgets(){$('.widget-buttons *[data-toggle="maximize"]').on("click",function(a){a.preventDefault();var b=$(this).parents(".widget").eq(0),c=$(this).find("i").eq(0),d="fa-compress",e="fa-expand";b.hasClass("maximized")?(c&&c.addClass(e).removeClass(d),b.removeClass("maximized"),b.find(".widget-body").css("height","auto")):(c&&c.addClass(d).removeClass(e),b.addClass("maximized"),maximize(b))}),$('.widget-buttons *[data-toggle="collapse"]').on("click",function(a){a.preventDefault();var b=$(this).parents(".widget").eq(0),c=b.find(".widget-body"),d=$(this).find("i"),e="fa-plus",f="fa-minus",g=300,h=200;b.hasClass("collapsed")?(d&&d.addClass(f).removeClass(e),b.removeClass("collapsed"),c.slideUp(0,function(){c.slideDown(g)})):(d&&d.addClass(e).removeClass(f),c.slideUp(h,function(){b.addClass("collapsed")}))}),$('.widget-buttons *[data-toggle="dispose"]').on("click",function(a){a.preventDefault();var b=$(this),c=b.parents(".widget").eq(0),d=300;c.hide(d,function(){c.remove()})})}function maximize(a){if(a){var b=$(window).height(),c=a.find(".widget-header").height();a.find(".widget-body").height(b-c)}}function scrollTo(a,b){var c=a&&a.size()>0?a.offset().top:0;jQuery("html,body").animate({scrollTop:c+(b?b:0)},"slow")}function Notify(a,b,c,d,e,f){toastr.options.positionClass="toast-"+b,toastr.options.extendedTimeOut=0,toastr.options.timeOut=c,toastr.options.closeButton=f,toastr.options.iconClass=e+" toast-"+d,toastr.custom(a)}function InitiateSettings(){if(null!=readCookie("navbar-fixed-top")&&"true"==readCookie("navbar-fixed-top")&&($("#checkbox_fixednavbar").prop("checked",!0),$(".navbar").addClass("navbar-fixed-top")),null!=readCookie("sidebar-fixed")&&"true"==readCookie("sidebar-fixed")&&($("#checkbox_fixedsidebar").prop("checked",!0),$(".page-sidebar").addClass("sidebar-fixed"),!$(".page-sidebar").hasClass("menu-compact"))){var a=readCookie("rtl-support")||"/index-rtl-fa.html"==location.pathname||"/index-rtl-ar.html"==location.pathname?"right":"left";$(".sidebar-menu").slimscroll({height:"auto",position:a,size:"3px",color:themeprimary})}null!=readCookie("breadcrumbs-fixed")&&"true"==readCookie("breadcrumbs-fixed")&&($("#checkbox_fixedbreadcrumbs").prop("checked",!0),$(".page-breadcrumbs").addClass("breadcrumbs-fixed")),null!=readCookie("page-header-fixed")&&"true"==readCookie("page-header-fixed")&&($("#checkbox_fixedheader").prop("checked",!0),$(".page-header").addClass("page-header-fixed")),$("#checkbox_fixednavbar").change(function(){$(".navbar").toggleClass("navbar-fixed-top"),$("#checkbox_fixedsidebar").is(":checked")&&($("#checkbox_fixedsidebar").prop("checked",!1),$(".page-sidebar").toggleClass("sidebar-fixed")),$("#checkbox_fixedbreadcrumbs").is(":checked")&&!$(this).is(":checked")&&($("#checkbox_fixedbreadcrumbs").prop("checked",!1),$(".page-breadcrumbs").toggleClass("breadcrumbs-fixed")),$("#checkbox_fixedheader").is(":checked")&&!$(this).is(":checked")&&($("#checkbox_fixedheader").prop("checked",!1),$(".page-header").toggleClass("page-header-fixed")),setCookiesForFixedSettings()}),$("#checkbox_fixedsidebar").change(function(){$(".page-sidebar").toggleClass("sidebar-fixed"),$("#checkbox_fixednavbar").is(":checked")||($("#checkbox_fixednavbar").prop("checked",!0),$(".navbar").toggleClass("navbar-fixed-top")),$("#checkbox_fixedbreadcrumbs").is(":checked")&&!$(this).is(":checked")&&($("#checkbox_fixedbreadcrumbs").prop("checked",!1),$(".page-breadcrumbs").toggleClass("breadcrumbs-fixed")),$("#checkbox_fixedheader").is(":checked")&&!$(this).is(":checked")&&($("#checkbox_fixedheader").prop("checked",!1),$(".page-header").toggleClass("page-header-fixed")),setCookiesForFixedSettings()}),$("#checkbox_fixedbreadcrumbs").change(function(){$(".page-breadcrumbs").toggleClass("breadcrumbs-fixed"),$("#checkbox_fixedsidebar").is(":checked")||($("#checkbox_fixedsidebar").prop("checked",!0),$(".page-sidebar").toggleClass("sidebar-fixed")),$("#checkbox_fixednavbar").is(":checked")||($("#checkbox_fixednavbar").prop("checked",!0),$(".navbar").toggleClass("navbar-fixed-top")),$("#checkbox_fixedheader").is(":checked")&&!$(this).is(":checked")&&($("#checkbox_fixedheader").prop("checked",!1),$(".page-header").toggleClass("page-header-fixed")),setCookiesForFixedSettings()}),$("#checkbox_fixedheader").change(function(){$(".page-header").toggleClass("page-header-fixed"),$("#checkbox_fixedbreadcrumbs").is(":checked")||($("#checkbox_fixedbreadcrumbs").prop("checked",!0),$(".page-breadcrumbs").toggleClass("breadcrumbs-fixed")),$("#checkbox_fixedsidebar").is(":checked")||($("#checkbox_fixedsidebar").prop("checked",!0),$(".page-sidebar").toggleClass("sidebar-fixed")),$("#checkbox_fixednavbar").is(":checked")||($("#checkbox_fixednavbar").prop("checked",!0),$(".navbar").toggleClass("navbar-fixed-top")),setCookiesForFixedSettings()})}function setCookiesForFixedSettings(){createCookie("navbar-fixed-top",$("#checkbox_fixednavbar").is(":checked"),100),createCookie("sidebar-fixed",$("#checkbox_fixedsidebar").is(":checked"),100),createCookie("breadcrumbs-fixed",$("#checkbox_fixedbreadcrumbs").is(":checked"),100),createCookie("page-header-fixed",$("#checkbox_fixedheader").is(":checked"),100);var a=readCookie("rtl-support")||"/index-rtl-fa.html"==location.pathname||"/index-rtl-ar.html"==location.pathname?"right":"left";$("#checkbox_fixedsidebar").is(":checked")?$(".page-sidebar").hasClass("menu-compact")||$(".sidebar-menu").slimscroll({position:a,size:"3px",color:themeprimary,height:"auto"}):$(".sidebar-menu").closest("div").hasClass("slimScrollDiv")&&($(".sidebar-menu").slimScroll({destroy:!0}),$(".sidebar-menu").attr("style",""))}function getcolor(a){switch(a){case"themeprimary":return themeprimary;case"themesecondary":return themesecondary;case"themethirdcolor":return themethirdcolor;case"themefourthcolor":return themefourthcolor;case"themefifthcolor":return themefifthcolor;default:return a}}function switchClasses(a,b){var c=document.getElementsByClassName(a);for(i=c.length-1;i>=0;i--)hasClass(c[i],"dropdown-menu")||(addClass(c[i],a+"-temp"),removeClass(c[i],a));var d=document.getElementsByClassName(b);for(i=d.length-1;i>=0;i--)hasClass(d[i],"dropdown-menu")||(addClass(d[i],a),removeClass(d[i],b));for(tempClasses=document.getElementsByClassName(a+"-temp"),i=tempClasses.length-1;i>=0;i--)hasClass(tempClasses[i],"dropdown-menu")||(addClass(tempClasses[i],b),removeClass(tempClasses[i],a+"-temp"))}function addClass(a,b){var c=a.className;c&&(c+=" "),a.className=c+b}function removeClass(a,b){var c=" "+a.className+" ";a.className=c.replace(" "+b,"").replace(/^\s+/g,"").replace(/\s+$/g,"")}function hasClass(a,b){var c=" "+a.className+" ",d=" "+b+" ";return-1!=c.indexOf(d)}var a;readCookie("current-skin")&&(a=document.createElement("link"),a.href=readCookie("current-skin"),a.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(a)),"/index-rtl-fa.html"!=location.pathname&&"/index-rtl-ar.html"!=location.pathname&&(readCookie("rtl-support")?(null!=document.getElementById("beyond-link")&&document.getElementById("beyond-link").setAttribute("href","assets/css/beyond-rtl.min.css"),null!=document.getElementById("bootstrap-rtl-link")&&document.getElementById("bootstrap-rtl-link").setAttribute("href","assets/css/bootstrap-rtl.min.css"),getInternetExplorerVersion()<=9&&getInternetExplorerVersion()>0&&(a=document.createElement("link"),a.href="assets/css/4095-rtl.min.css",a.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(a))):(null!=document.getElementById("beyond-link")&&document.getElementById("beyond-link").setAttribute("href","assets/css/beyond.min.css"),null!=document.getElementById("bootstrap-rtl-link")&&document.getElementById("bootstrap-rtl-link").setAttribute("href",""),getInternetExplorerVersion()<=9&&getInternetExplorerVersion()>0&&(a=document.createElement("link"),a.href="assets/css/4095.min.css",a.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(a))));var themeprimary=getThemeColorFromCss("themeprimary"),themesecondary=getThemeColorFromCss("themesecondary"),themethirdcolor=getThemeColorFromCss("themethirdcolor"),themefourthcolor=getThemeColorFromCss("themefourthcolor"),themefifthcolor=getThemeColorFromCss("themefifthcolor");$("#skin-changer li a").click(function(){createCookie("current-skin",$(this).attr("rel"),10),window.location.reload()});var rtlchanger=document.getElementById("rtl-changer");"/index-rtl-fa.html"!=location.pathname&&"/index-rtl-ar.html"!=location.pathname&&(readCookie("rtl-support")?(switchClasses("pull-right","pull-left"),switchClasses("databox-right","databox-left"),switchClasses("item-right","item-left"),$(".navbar-brand small img").attr("src","assets/img/logo-rtl.png"),null!=rtlchanger&&(document.getElementById("rtl-changer").checked=!0)):null!=rtlchanger&&(rtlchanger.checked=!1),null!=rtlchanger&&(rtlchanger.onchange=function(){this.checked?createCookie("rtl-support","true",10):eraseCookie("rtl-support"),setTimeout(function(){window.location.reload()},600)})),$(window).load(function(){setTimeout(function(){$(".loading-container").addClass("loading-inactive")},0)}),$("#btn-setting").on("click",function(){$(".navbar-account").toggleClass("setting-open")}),$("#fullscreen-toggler").on("click",function(){var a=document.documentElement;$("body").hasClass("full-screen")?($("body").removeClass("full-screen"),$("#fullscreen-toggler").removeClass("active"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()):($("body").addClass("full-screen"),$("#fullscreen-toggler").addClass("active"),a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen())});var popovers=$("[data-toggle=popover]");$.each(popovers,function(){$(this).popover({html:!0,template:'<div class="popover '+$(this).data("class")+'"><div class="arrow"></div><h3 class="popover-title '+$(this).data("titleclass")+'">Popover right</h3><div class="popover-content"></div></div>'})});var hoverpopovers=$("[data-toggle=popover-hover]");$.each(hoverpopovers,function(){$(this).popover({html:!0,template:'<div class="popover '+$(this).data("class")+'"><div class="arrow"></div><h3 class="popover-title '+$(this).data("titleclass")+'">Popover right</h3><div class="popover-content"></div></div>',trigger:"hover"})}),InitiateSideMenu(),InitiateSettings(),InitiateWidgets(),function(){angular.module("myvcFrontApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngSanitize","ngTouch","pascalprecht.translate","ui.bootstrap","ui.router","ui.select","angular-loading-bar","restangular","uiBreadcrumbs","toastr","http-auth-interceptor","ui.grid","ui.grid.edit","ui.grid.resizeColumns","ui.grid.exporter","ui.grid.selection","angularFileUpload"]).constant("App",function(){var a,b,c;return a="http://lalvirtual.com/",c=a+"myvc_server/public/",b=a+"myvc_front/",{Server:c,views:"views/",images:c+"images/"}}()).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",alumno:"alumno",acudiente:"acudiente",profesor:"profesor",guest:"guest"}).constant("PERMISSIONS",{can_see_panel:"can_see_panel",can_edit_alumnos:"can_edit_alumnos",can_edit_usuarios:"can_edit_usuarios",can_edit_notas:"can_edit_notas",can_edit_years:"can_edit_years",can_edit_periodos:"can_edit_periodos",can_edit_paises:"can_edit_paises",can_edit_ciudades:"can_edit_ciudades",can_edit_disciplinas:"can_edit_disciplinas",can_edit_profesores:"can_edit_profesores",can_edit_eventos:"can_edit_eventos",can_edit_votaciones:"can_edit_votaciones",can_edit_aspiraciones:"can_edit_aspiraciones",can_edit_participantes:"can_edit_participantes",can_edit_candidatos:"can_edit_candidatos"})}.call(this),function(){angular.module("myvcFrontApp").config(["$cookiesProvider","$stateProvider","$urlRouterProvider","$httpProvider","App","PERMISSIONS","RestangularProvider","$intervalProvider","$rootScopeProvider","USER_ROLES","toastrConfig",function(a,b,c,d,e,f,g,h,i,j,k){return g.setBaseUrl(e.Server),d.defaults.headers.post["X-CSRFToken"]=a.csrftoken,d.defaults.headers.put["X-CSRFToken"]=a.csrftoken,d.defaults.useXDomain=!0,d.defaults.xsrfCookieName="csrftoken",d.defaults.xsrfHeaderName="X-CSRFToken",delete d.defaults.headers.common["X-Requested-With"],c.otherwise("/"),c.when("/user/:username",["$match","$state",function(a,b){return b.transitionTo("panel.user.resumen",a)}]),b.state("main",{url:"/",views:{principal:{templateUrl:e.views+"main/main.tpl.html",controller:"MainCtrl"}},data:{displayName:"principal",icon_fa:""}}).state("login",{url:"/login",views:{principal:{templateUrl:""+e.views+"login/login.tpl.html",controller:"LoginCtrl"}},data:{displayName:"Login",icon_fa:"fa fa-user"}}).state("logout",{url:"/logout",views:{principal:{templateUrl:""+e.views+"login/logout.tpl.html",controller:"LogoutCtrl"}},data:{displayName:"Logout",icon_fa:"fa fa-user"}}).state("panel",{url:"/panel",views:{principal:{templateUrl:""+e.views+"panel/panel.tpl.html",controller:"PanelCtrl"}},resolve:{resolved_user:["AuthService",function(a){return console.log("Entra al resolve"),a.verificar()}]},data:{displayName:"Inicio",icon_fa:"fa fa-home",needed_permissions:[f.can_see_panel]}}),i.bigLoader=!0,_.mixin({findByValues:function(a,b,c){var d;return d=_.filter(a,function(a){return _.contains(c,a[b])}),0===d.length?!1:d[0]}}),angular.extend(k,{allowHtml:!0,closeButton:!0,closeHtml:"<button>&times;</button>",containerId:"toast-container",extendedTimeOut:2e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},maxOpened:6,messageClass:"toast-message",newestOnTop:!0,onHidden:null,onShown:null,positionClass:"toast-top-right",tapToDismiss:!0,target:"body",timeOut:5e3,titleClass:"toast-title",toastClass:"toast"}),this}])}.call(this),function(){angular.module("myvcFrontApp").run(["$rootScope","cfpLoadingBar","$state","$stateParams","$translate","$cookies","Restangular","Perfil","AuthService","AUTH_EVENTS","toastr",function(a,b,c,d,e,f,g,h,i,j,k){var l;return a.$state=c,a.$stateParams=d,a.lastState=null,a.lastStateParam=null,a.menucompacto=!1,a.$on("event:auth-loginRequired",function(a){return console.log("Acceso no permitido, vamos a loguear",a),c.transitionTo("login")}),l=function(){return null===a.lastState||"login"===a.lastState||"/"===a.lastState||"main"===a.lastState?c.transitionTo("panel"):c.transitionTo(a.lastState,a.lastStateParam),console.log("Funcion ingresar. lastState: ",a.lastState)},a.$on("event:auth-loginConfirmed",function(){return console.log("Logueado con éxito!"),l()}),a.$on("$stateChangeStart",function(b,c,d){return console.log("Va a empezar a cambiar un estado: ",c,d),null===a.lastState||"logout"!==c.name&&"login"!==c.name&&"main"!==c.name?(a.lastState=c.name,a.lastStateParam=d):void 0}),a.$on("$stateChangeSuccess",function(){return a.pageTitle=c.current.name}),a.$on("$translatePartialLoaderStructureChanged",function(){return e.refresh(),console.log("Translate refrescado supuestamente.")}),a.votacionActual=void 0,a.$on(j.loginSuccess,function(){return a.votacionActual?void 0:g.one("eventos").get().then(function(a){return a.rutear?c.go(a.state):l()},function(){})}),a.$on(j.loginFailed,function(a){return k.error("Datos incorrecto.","No se pudo loguear"),console.log("Evento loginFailed: ",a)}),a.$on(j.notAuthenticated,function(a){return c.transitionTo("login"),k.warning("No está autorizado.","Acceso exclusivo"),console.log("Evento notAuthenticated: ",a)}),a.$on(j.notAuthorized,function(b){return c.go("login"),console.log("Evento notAuthorized: ",b,a.lastState)})}])}.call(this),function(){angular.module("myvcFrontApp").controller("ApplicationController",["$scope","USER_ROLES","AuthService","toastr","$state","$rootScope",function(a,b,c,d){return a.USER={},a.toastr=d,a.verificar_acceso=c.verificar_acceso,a.isAuthorized=c.isAuthorized,a.hasRoleOrPerm=c.hasRoleOrPerm,a.USER_ROLES=b,a.isLoginPage=!1}])}.call(this),function(){angular.module("myvcFrontApp").controller("MainCtrl",["$scope","$window","$interval",function(){}])}.call(this),function(){angular.module("myvcFrontApp").controller("PanelCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","AuthService","Perfil","App","resolved_user",function(a,b,c,d,e,f,g,h,i,j){a.USER=j,a.pageTitle=f.pageTitle,a.logoPath="images/MyVc-1.gif",a.paramuser={username:a.USER.username},a.verificar_acceso(),a.setImagenPrincipal=function(){var b,c,d,e,f;return d=i.images+"perfil/",c=a.USER.imagen_nombre,b=a.USER.foto_nombre,f=d+c,e=d+b,a.imagenPrincipal=f,a.imagenOficial=e},a.setImagenPrincipal(),a.nameToShow=h.nameToShow,a.toggleCompactMenu=function(){return f.menucompacto=!f.menucompacto},a.seeDropdownPeriodos=!1,a.togglePeriodos=function(){return a.seeDropdownPeriodos=!a.seeDropdownPeriodos,console.log(a.seeDropdownPeriodos)},a.logout=function(){return g.logout()},a.goFileManager=function(){return d.go("panel.filemanager")},a.$on("cambianImgs",function(){return a.USER=h.User(),a.setImagenPrincipal()})}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(a,b,c,d){a.state("panel.alumnos",{url:"^/alumnos",views:{maincontent:{templateUrl:""+b.views+"alumnos/alumnos.tpl.html",controller:"AlumnosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Alumnos"}]}}},data:{displayName:"Alumnos",icon_fa:"fa fa-male",Permissions:[d.can_see_alumnos]}}).state("panel.mensajes",{url:"^/mensajes",views:{maincontent:{templateUrl:""+b.views+"mensajes/mensajes.tpl.html",controller:"MensajesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Mensajes"}]}}},data:{displayName:"Mensajes",icon_fa:"fa fa-envelope"}}).state("panel.notas",{url:"^/notas",views:{maincontent:{templateUrl:""+b.views+"notas/notas.tpl.html",controller:"NotasCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Notas"}]}}},data:{displayName:"Notas",icon_fa:"fa fa-graduation-cap",Permissions:[d.can_see_notas]}}).state("panel.years",{url:"^/years",views:{maincontent:{templateUrl:""+b.views+"colegio/years.tpl.html",controller:"YearsCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Años"}]}}},data:{displayName:"Años",icon_fa:"fa fa-graduation-cap",Permissions:[d.can_see_years]}}).state("panel.periodos",{url:"^/periodos",views:{maincontent:{templateUrl:""+b.views+"colegio/periodos.tpl.html",controller:"PeriodosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Periodos"}]}}},data:{displayName:"Periodos",icon_fa:"fa fa-graduation-cap",Permissions:[d.can_see_periodos]}}).state("panel.paises",{url:"^/paises",views:{maincontent:{templateUrl:""+b.views+"paises/paises.tpl.html",controller:"PaisesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Paises"}]}}},data:{displayName:"Paises",icon_fa:"fa fa-flag-checkered",Permissions:[d.can_see_paises]}}).state("panel.profesores",{url:"^/profesores",views:{maincontent:{templateUrl:""+b.views+"profesores/profesores.tpl.html",controller:"ProfesoresCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Profesores"}]}}},data:{displayName:"Profesores",icon_fa:"fa fa-graduation-cap",Permissions:[d.can_see_all_paises]}}).state("panel.ciudades",{url:"/ciudades",views:{maincontent:{templateUrl:""+b.views+"ciudades/ciudades.tpl.html",controller:"CiudadesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Ciudades"}]}}},data:{displayName:"Ciudades",icon_fa:"fa fa-map-marker",Permissions:[d.can_see_ciudades]}}).state("panel.disciplinas",{url:"/disciplinas",views:{maincontent:{templateUrl:""+b.views+"disciplinas/disciplinas.tpl.html",controller:"DisciplinasCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Disciplinas"}]}}},data:{displayName:"Disciplinas",icon_fa:"fa fa-align-justify",Permissions:[d.can_see_disciplinas]}}).state("panel.eventos",{url:"/eventos",views:{maincontent:{templateUrl:""+b.views+"eventos/eventos.tpl.html",controller:"EventosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Eventos"}]}}},data:{displayName:"Eventos",icon_fa:"fa fa-laptop",Permissions:[d.can_see_eventos]}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("PanelHeaderCtrl",["$scope","titulo",function(a,b){a.titulo=b}])}.call(this),function(){angular.module("myvcFrontApp").controller("YearsCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope",function(){console.log("Agregando year")}])}.call(this),function(){angular.module("myvcFrontApp").controller("PeriodosCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope",function(){console.log("Agregando periodos")}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){a.state("panel.alumnos.nuevo",{url:"/nuevo",views:{edit_alumno:{templateUrl:""+b.views+"alumnos/alumnosNew.tpl.html",controller:"AlumnosNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo alumno"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-male"}}).state("panel.alumnos.editar",{url:"/editar/:alumno_id",views:{edit_alumno:{templateUrl:""+b.views+"alumnos/alumnosEdit.tpl.html",controller:"AlumnosEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-users"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("AlumnosCtrl",["$scope","App","$rootScope","$state","$interval","RAlumnos","Restangular","uiGridConstants","GruposServ","$modal","$filter",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p;a.bigLoader=!0,a.dato={},a.dato.mostrartoolgrupo=!0,a.gridScope=a,p=e(function(){return a.bigLoader=!1},1e3),a.dato.grupo={nombre:""},i.getGrupos().then(function(b){return a.grupos=b}),a.editar=function(a){return console.log("Presionado para editar fila: ",a),d.go("panel.alumnos.editar",{alumno_id:a.alumno_id})},a.eliminar=function(c){var d;return console.log("Presionado para eliminar fila: ",c),d=j.open({templateUrl:b.views+"alumnos/removeAlumno.tpl.html",controller:"RemoveAlumnoCtrl",size:"sm",resolve:{alumno:function(){return c}}}),d.result.then(function(b){return a.gridOptions.data=k("filter")(a.gridOptions.data,{alumno_id:"!"+b.alumno_id}),console.log("Resultado del modal: ",b)})},a.matricularUno=function(b){var c;return a.dato.grupo.id?(c={alumno_id:b.alumno_id,grupo_id:a.dato.grupo.id},console.log("Argumentos: ",c),g.all("matriculas/matricularuno/"+c.alumno_id+"/"+c.grupo_id).post().then(function(c){return console.log("Matriculado. ",c),b.matricula_id=c.id,b.grupo_id=c.grupo_id,b.nombregrupo=a.dato.grupo.nombre,b.abrevgrupo=a.dato.grupo.abrev,b.actual=1,a.toastr.success("Alumno matriculado con éxito","Matriculado"),b},function(b){return console.log("Falla al matricularlo. ",b),a.toastr.error("No se pudo matricular el alumno.","Error")})):void a.toastr.warning("Debes definir el grupo al que vas a matricular.","Falta grupo")},a.eliminarMatricula=function(b){return console.log(b),g.all("matriculas/destroy/"+b.matricula_id).remove().then(function(c){return console.log("Desmatriculado. ",c),b.currentyear=0,a.toastr.success("Alumno desmatriculado"),b},function(b){return console.log("No se pudo desmatricular.",b),a.toastr.error("No se pudo desmatricular","Problema")})},l='<a tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',m='<a tooltip="X Eliminar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',n=""+b.views+"directives/botonesMatricular.tpl.html",o='<div ng-class="{ \'sortable\': sortable }">\n<div class="ui-grid-vertical-bar">&nbsp;</div>\n<div class="ui-grid-cell-contents {{col.headerClass}}" col-index="renderIndex">\n	{{ col.displayName CUSTOM_FILTERS }}\n	<br>\n	<select ng-model="grid.appScope.value[col.field]" ng-change="$event.stopPropagation();grid.appScope.yourFilterFunction(col.field)">\n	</select>\n</div></div></div>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"no_matricula",type:"number",maxWidth:50,enableSorting:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:l+m,enableCellEdit:!1},{field:"nombres",enableHiding:!1},{field:"apellidos"},{field:"sexo",maxWidth:20},{field:"username",displayName:"Usuario"},{field:"abrevgrupo",displayName:"Grupo",enableCellEdit:!1,cellTemplate:n,filter:{condition:h.filter.CONTAINS,placeholder:"Abreviatura. Ej: 8A"}},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date"},{field:"direccion",displayName:"Dirección"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return console.log("Fila editada, ",b," Column:",c," newValue:"+d+" oldValue:"+e),d!==e&&g.one("alumnos/update",b.alumno_id).customPUT(b).then(function(){return a.toastr.success("Alumno actualizado con éxito","Actualizado")},function(b){return a.toastr.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",b)}),a.$apply()})}},f.getList().then(function(b){return a.gridOptions.data=b}),a.borrar=function(b){return b["delete"]().then(function(b){return console.log("Eliminado con éxito",b),a.toastr.success("El alumno fue eliminado","Exito")},function(b){return console.log("No se pudo eliminar",b),a.toastr.error("No se pudo eliminar el alumno","Error")})},a.$on("alumnoguardado",function(b,c){return a.gridOptions.data.push(c)})}]).controller("RemoveAlumnoCtrl",["$scope","$modalInstance","alumno","Restangular","toastr",function(a,b,c,d,e){return a.alumno=c,a.ok=function(){return d.all("alumnos/destroy/"+c.alumno_id).remove().then(function(){return e.success("Eliminado","Alumno eliminado con éxito.")},function(a){return e.warning("No se pudo eliminar al alumno.","Problema"),console.log("Error eliminando alumno: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AlumnosNewCtrl",["$scope","$rootScope","$interval","Restangular","RAlumnos","RPaises","RCiudades","RGrupos",function(a,b,c,d,e,f,g,h){a.data={},a.alumno={no_matricula:"",nombres:"",apellidos:"",sexo:"M",documento:"",fecha_nac:"2000-06-26",tipo_sangre:{},eps:"",telefono:"",celular:"",direccion:"",barrio:"",estrato:1,religion:"PENTECOSTAL UNIDA",email:"@gmail.com",facebook:"@gmail.com",foto:"perfil/default_male.jpg",pazysalvo:!0,deuda:0,pais_nac:{id:1,pais:"COLOMBIA",abrev:"CO"}},a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],f.getList().then(function(b){return a.paises=b,a.pais_nac=b[0],a.paisNacSelect(b[0],a.pais_nac)},function(){return console.log("No se pudo traer los paises")}),h.getList().then(function(b){return a.grupos=b},function(){return console.log("No se pudo traer los grupos")}),d.one("tiposdocumento").get().then(function(b){return a.tipos_doc=b}),a.crear=function(){return d.all("alumnos/store").post(a.alumno).then(function(b){return console.log("Se hizo el post del alumno",b),a.toastr.success("Alumno "+b.nombres+" creado"),a.$emit("alumnoguardado",b)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.paisNacSelect=function(b){return d.one("ciudades/departamentos",b.id).get().then(function(c){return a.departamentosNac=c,"undefined"==typeof a.alumno.pais_doc?(a.alumno.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return d.one("ciudades/pordepartamento",b.departamento).get().then(function(c){return a.ciudadesNac=c,"undefined"==typeof a.alumno.departamento_doc?(a.alumno.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b){return d.one("ciudades/departamentos",b.id).get().then(function(b){return a.departamentos=b})},a.departSeleccionado=function(b){return d.one("ciudades/pordepartamento",b.departamento).get().then(function(b){return a.ciudades=b})},a.dateOptions={formatYear:"yy"},a.restarEstrato=function(){return a.alumno.estrato>0?a.alumno.estrato=a.alumno.estrato-1:void 0},a.sumarEstrato=function(){return a.alumno.estrato<10?a.alumno.estrato=a.alumno.estrato+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AlumnosEditCtrl",["$scope","$rootScope","$state","Restangular","RAlumnos","RPaises","RCiudades",function(a,b,c,d,e,f){a.data={},a.alumno={},a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],d.one("alumnos/show",c.params.alumno_id).get().then(function(b){return a.alumno=b,console.log("Llega: ",a.alumno),b.user&&(a.alumno.username=b.user.username),b.user&&(a.alumno.email2=b.user.email),null===a.alumno.ciudad_nac?(a.alumno.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisNacSelect(a.alumno.pais_nac,a.alumno.pais_nac)):(d.one("ciudades/datosciudad",a.alumno.ciudad_nac).get().then(function(b){return a.paises=b.paises,a.departamentosNac=b.departamentos,a.ciudadesNac=b.ciudades,a.alumno.pais_nac=b.pais,a.alumno.departamento_nac=b.departamento,a.alumno.ciudad_nac=b.ciudad
}),d.one("ciudades/datosciudad",a.alumno.ciudad_doc).get().then(function(b){return a.paises=b.paises,a.departamentos=b.departamentos,a.ciudades=b.ciudades,a.alumno.pais_doc=b.pais,a.alumno.departamento_doc=b.departamento,a.alumno.ciudad_doc=b.ciudad}))}),f.getList().then(function(b){return a.paises=b},function(a){return console.log("No se pudo traer los paises",a)}),d.one("tiposdocumento").get().then(function(b){return a.tipos_doc=b}),a.guardar=function(){return console.log("A guardar: ",a.alumno),d.one("alumnos/update",a.alumno.id).customPUT(a.alumno).then(function(b){return console.log("Se guardó alumno",b),a.toastr.success("Alumno actualizado correctamente")},function(b){return console.log("Falló al intentar guardar: ",b),a.toastr.error("No se pudo guardar el alumno")})},a.paisNacSelect=function(b){return d.one("ciudades/departamentos",b.id).get().then(function(c){return a.departamentosNac=c,"undefined"==typeof a.alumno.pais_doc?(a.alumno.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return d.one("ciudades/pordepartamento",b.departamento).get().then(function(c){return a.ciudadesNac=c,"undefined"==typeof a.alumno.departamento_doc?(a.alumno.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b){return d.one("ciudades/departamentos",b.id).get().then(function(b){return a.departamentos=b})},a.departSeleccionado=function(b){return d.one("ciudades/pordepartamento",b.departamento).get().then(function(b){return a.ciudades=b})},a.dateOptions={formatYear:"yyyy"},a.restarEstrato=function(){return a.alumno.estrato>0?a.alumno.estrato=a.alumno.estrato-1:void 0},a.sumarEstrato=function(){return a.alumno.estrato<10?a.alumno.estrato=parseInt(a.alumno.estrato)+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("NotasCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope",function(){console.log("Agregando Notas")}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){a.state("panel.profesores.nuevo",{url:"/nuevo",views:{edit_profesor:{templateUrl:""+b.views+"profesores/profesoresNew.tpl.html",controller:"ProfesoresNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo profesor"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap"}}).state("panel.profesores.editar",{url:"/editar/:profe_id",views:{edit_profesor:{templateUrl:""+b.views+"profesores/profesoresEdit.tpl.html",controller:"ProfesoresEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar alumno"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("ProfesoresCtrl",["$scope","$rootScope","RProfesores","Restangular","$interval","$state",function(a,b,c,d,e,f){var g,h;a.gridScope=a,a.editar=function(a){return console.log("Presionado para editar fila: ",a),f.go("panel.profesores.editar",{profe_id:a.id})},a.eliminar=function(a){return console.log("Presionado para eliminar fila: ",a),f.go("panel.profesores.eliminar",{profe_id:a.id})},g='<a tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',h='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"id",displayName:"Id",maxWidth:50,enableFiltering:!1,enableCellEdit:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:g+h,enableCellEdit:!1},{field:"nombres",enableHiding:!1},{field:"apellidos"},{field:"sexo",maxWidth:20},{field:"fecha_nac",displayName:"Nacimiento"},{field:"username",displayName:"Usuario",enableCellEdit:!1},{field:"facebook"},{field:"celular"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,e,f){return console.log("Fila editada, ",b," Column:",c," newValue:"+e+" oldValue:"+f),e!==f&&d.one("profesores/update",b.id).customPUT(b).then(function(){return a.toastr.success("Profesor actualizado con éxito","Actualizado")},function(b){return a.toastr.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",b)}),a.$apply()})}},c.getList().then(function(b){return a.gridOptions.data=b}),a.$on("profesorcreado",function(b,c){return console.log("profesorcreado, ",b,c),a.gridOptions.data.push(c),console.log(a.gridOptions.data)})}])}.call(this),function(){angular.module("myvcFrontApp").controller("ProfesoresNewCtrl",["$scope","$rootScope","$interval","RProfesores","Restangular","RPaises",function(a,b,c,d,e,f){a.profesor={nombres:"FRANCISCO",apellidos:"BAEZ",sexo:"M",documento:"99817333",fecha_nac:"2000-06-26",telefono:"8886242",celular:"3216478754",direccion:"CRR 45 NO 30-23",barrio:"MORICHAL",email:"miguelito@gmail.com",facebook:"miguelito@gmail.com"},a.estados_civiles=[{estado_civil:"Soltero"},{estado_civil:"Casado"},{estado_civil:"Divorciado"},{estado_civil:"Viudo"}],f.getList().then(function(b){return a.paises=b},function(){return console.log("No se pudo traer los paises")}),e.one("tiposdocumento").get().then(function(b){return a.tipos_doc=b}),a.crear=function(){return e.one("profesores/store").customPOST(a.profesor).then(function(b){return console.log("Se hizo el post del profesor",b),a.toastr.success("Profesor creado con éxito"),a.$emit("profesorcreado",b)},function(b){return console.log("No se guardó el profesor, ",b),a.toastr.error("Profesor NO creado","Problema")})},a.paisNacSelect=function(b){return e.one("ciudades/departamentos",b.id).get().then(function(c){return a.departamentosNac=c,"undefined"==typeof a.profesor.pais_doc?(a.profesor.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return e.one("ciudades/pordepartamento",b.departamento).get().then(function(c){return a.ciudadesNac=c,"undefined"==typeof a.profesor.departamento_doc?(a.profesor.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b){return e.one("ciudades/departamentos",b.id).get().then(function(b){return a.departamentos=b})},a.departSeleccionado=function(b){return e.one("ciudades/pordepartamento",b.departamento).get().then(function(b){return a.ciudades=b})},a.dateOptions={formatYear:"yy"}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ProfesoresEditCtrl",["$scope","$rootScope","$interval","Restangular","$state","RPaises","RCiudades",function(a,b,c,d,e,f){a.data={},a.profesor={},a.sangres=[{sangre:"O+"},{sangre:"O-"},{sangre:"A+"},{sangre:"A-"},{sangre:"B+"},{sangre:"B-"},{sangre:"AB+"},{sangre:"AB-"}],a.estados_civiles=[{estado_civil:"Soltero"},{estado_civil:"Casado"},{estado_civil:"Divorciado"},{estado_civil:"Viudo"}],d.one("profesores/show",e.params.profe_id).get().then(function(b){return a.profesor=b,console.log("Llega: ",a.profesor),b.user&&(a.profesor.username=b.user.username),b.user&&(a.profesor.email2=b.user.email),a.profesor.estado_civil={estado_civil:b.estado_civil},null===a.profesor.ciudad_nac?(a.profesor.pais_nac={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisNacSelect(a.profesor.pais_nac,a.profesor.pais_nac)):(d.one("ciudades/datosciudad",a.profesor.ciudad_nac).get().then(function(b){return a.paises=b.paises,a.departamentosNac=b.departamentos,a.ciudadesNac=b.ciudades,a.profesor.pais_nac=b.pais,a.profesor.departamento_nac=b.departamento,a.profesor.ciudad_nac=b.ciudad}),d.one("ciudades/datosciudad",a.profesor.ciudad_doc).get().then(function(b){return a.paises=b.paises,a.departamentos=b.departamentos,a.ciudades=b.ciudades,a.profesor.pais_doc=b.pais,a.profesor.departamento_doc=b.departamento,a.profesor.ciudad_doc=b.ciudad}))}),f.getList().then(function(b){return a.paises=b},function(a){return console.log("No se pudo traer los paises",a)}),d.one("tiposdocumento").get().then(function(b){return a.tipos_doc=b}),a.guardar=function(){return console.log("A guardar: ",a.profesor),d.one("profesores/update",a.profesor.id).customPUT(a.profesor).then(function(b){return console.log("Se guardó profesor",b),a.toastr.success("Profesor actualizado con éxito")},function(b){return console.log("Falló al intentar guardar: ",b),a.toastr.error("No se guardaron los cambios","Problemas")})},a.paisNacSelect=function(b){return d.one("ciudades/departamentos",b.id).get().then(function(c){return a.departamentosNac=c,"undefined"==typeof a.profesor.pais_doc?(a.profesor.pais_doc=b,a.paisSelecionado(b)):void 0})},a.departNacSelect=function(b){return d.one("ciudades/pordepartamento",b.departamento).get().then(function(c){return a.ciudadesNac=c,"undefined"==typeof a.profesor.departamento_doc?(a.profesor.departamento_doc=b,a.departSeleccionado(b)):void 0})},a.paisSelecionado=function(b){return d.one("ciudades/departamentos",b.id).get().then(function(b){return a.departamentos=b})},a.departSeleccionado=function(b){return d.one("ciudades/pordepartamento",b.departamento).get().then(function(b){return a.ciudades=b})},a.dateOptions={formatYear:"yyyy"}}])}.call(this),function(){angular.module("myvcFrontApp").controller("MateriasCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope",function(){console.log("Materias a la orden")}])}.call(this),function(){angular.module("myvcFrontApp").controller("AreasCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope",function(){console.log("Agregando áreas")}])}.call(this),function(){angular.module("myvcFrontApp").controller("LoginCtrl",["$scope","$rootScope","AUTH_EVENTS","AuthService","$location","Restangular","$cookies","Perfil","App",function(a,b,c,d,e){var f;f=300,a.logueando=!0,a.recuperando=!1,a.registrando=!1,a.logoPath="images/MyVc-1.gif",a.credentials={username:"",password:""},a.host=e.host(),a.login=function(a){var b;return b=d.login_credentials(a),b.then(function(){},function(a){return console.log("Promise rechazada",a)})},a.to_recuperando=function(){return a.logueando=!1,a.recuperando=!0,a.registrando=!1},a.to_registrando=function(){return a.logueando=!1,a.recuperando=!1,a.registrando=!0},a.to_logueando=function(){return a.logueando=!0,a.recuperando=!1,a.registrando=!1}}])}.call(this),function(){angular.module("myvcFrontApp").directive("loginDialog",["AUTH_EVENTS","App",function(a){return{restrict:"A",templateUrl:"#{App.views}/login/login-form.html",link:function(b){var c;return c=function(){return b.visible=!0},b.visible=!1,b.$on(a.notAuthenticated,c),b.$on(a.sessionTimeout,c)}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("LogoutCtrl",["$scope","AUTH_EVENTS","authService","$state","Restangular","$cookies","Perfil",function(a,b,c,d){return console.log("A salir!!"),d.go("login")}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){return a.state("panel.niveles",{url:"/niveles",views:{maincontent:{templateUrl:""+b.views+"grados/niveles.tpl.html",controller:"NivelesCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Niveles educativos"}]}}},data:{displayName:"Niveles",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.niveles.nuevo",{url:"/nuevo",views:{edit_nivel:{templateUrl:""+b.views+"grados/nivelesNew.tpl.html",controller:"NivelesNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.niveles.editar",{url:"/editar/:nivel_id",views:{edit_nivel:{templateUrl:""+b.views+"grados/nivelesEdit.tpl.html",controller:"NivelesEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.grados",{url:"/grados",views:{maincontent:{templateUrl:""+b.views+"grados/grados.tpl.html",controller:"GradosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Grados"}]}}},resolve:{niveles:["RNiveles",function(a){return a.getList().then(function(a){return a})}]},data:{displayName:"Grados",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.grados.nuevo",{url:"/nuevo",views:{edit_grado:{templateUrl:""+b.views+"grados/gradosNew.tpl.html",controller:"GradosNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.grados.editar",{url:"/editar/:grado_id",views:{edit_grado:{templateUrl:""+b.views+"grados/gradosEdit.tpl.html",controller:"GradosEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.grupos",{url:"/grupos",views:{maincontent:{templateUrl:""+b.views+"grados/grupos.tpl.html",controller:"GruposCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Grupos"}]}}},resolve:{grados:["RGrados",function(a){return a.getList().then(function(a){return a})}],profesores:["RProfesores",function(a){return a.getList().then(function(a){return a})}]},data:{displayName:"Grupos",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.grupos.nuevo",{url:"/nuevo",views:{edit_grupo:{templateUrl:""+b.views+"grados/gruposNew.tpl.html",controller:"GruposNewCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Nuevo"}]}}},data:{displayName:"Nuevo",icon_fa:"fa fa-graduation-cap"}}),a.state("panel.grupos.editar",{url:"/editar/:grupo_id",views:{edit_grupo:{templateUrl:""+b.views+"grados/gruposEdit.tpl.html",controller:"GruposEditCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Editar"}]}}},data:{displayName:"Editar",icon_fa:"fa fa-graduation-cap"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("GradosCtrl",["$scope","$filter","$rootScope","$state","$interval","RGrados","RNiveles","App","niveles","$modal",function(a,b,c,d,e,f,g,h,i,j){var k,l,m;a.grados={nivel:{}},a.gridScope=a,a.niveles=i,a.editar=function(a){return console.log("Presionado para editar fila: ",a),d.go("panel.grados.editar",{grado_id:a.id})},a.eliminar=function(c){var d;return console.log("Presionado para eliminar fila: ",c),d=j.open({templateUrl:h.views+"grados/removeGrado.tpl.html",controller:"RemoveGradoCtrl",size:"sm",resolve:{grado:function(){return c}}}),d.result.then(function(c){return a.grados=b("filter")(a.grados,{id:"!"+c.id}),a.gridOptions.data=a.grados,console.log("Resultado del modal: ",c)})},m=""+h.views+"grados/editCellNivel.tpl.html",k='<a tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:k+l,enableCellEdit:!1},{field:"nombre",enableHiding:!1,enableCellEditOnFocus:!0},{field:"abrev",displayName:"abreviatura",enableCellEditOnFocus:!0,maxWidth:50,enableSorting:!1},{field:"orden",type:"number",enableCellEditOnFocus:!0,maxWidth:50},{field:"nivel_educativo_id",displayName:"Nivel Educativo",editDropdownOptionsArray:i,cellFilter:"mapNivel:grid.appScope.niveles",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{name:"nn",displayName:"",maxWidth:20,enableSorting:!1,enableFiltering:!1}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return console.log("Fila editada, ",b," Column:",c," newValue:"+d+" oldValue:"+e),d!==e&&b.put().then(function(){return a.toastr.success("Grado actualizado con éxito","Actualizado")},function(b){return a.toastr.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",b)}),a.$apply()})}},f.getList().then(function(b){return a.grados=b,a.gridOptions.data=a.grados}),a.$on("gradocreado",function(b){return a.grados.push(b),a.gridOptions.data=a.grados})}]).filter("mapNivel",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b})[0],d.nombre):""}}]).controller("RemoveGradoCtrl",["$scope","$modalInstance","grado","Restangular","toastr",function(a,b,c,d,e){return a.grado=c,a.ok=function(){return c.remove().then(function(a){return e.success("Grado "+a.nombre+" eliminado con éxito","Eliminado")},function(a){return console.log("No se pudo eliminar",a),e.error("No se pudo eliminar a "+row.nombre)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("GradosNewCtrl",["$scope","$rootScope","$interval","Restangular","RNiveles","RGrados",function(a,b,c,d,e,f){return a.grado={orden:1},e.getList().then(function(b){return a.niveles=b}),a.restarOrden=function(){return a.grado.orden>0?a.grado.orden=a.grado.orden-1:void 0},a.sumarOrden=function(){return a.grado.orden<40?a.grado.orden=a.grado.orden+1:void 0},a.crear=function(){return f.post(a.grado).then(function(b){return console.log("Se hizo el post del grado",b),a.$emit("gradocreado",b),a.toastr.success("Grado "+b.nombre+" creado")},function(a){return console.log("Falló al intentar guardar: ",a)})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("GradosEditCtrl",["$scope","$state","$rootScope","$interval","Restangular","RGrados","RNiveles",function(a,b,c,d,e,f,g){return e.one("grados",b.params.grado_id).get().then(function(b){return a.grado=b,console.log("Traje ",b)}),g.getList().then(function(b){return a.niveles=b}),a.guardar=function(){return a.grado.put().then(function(a){return console.log("Se guardó grado",a)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.restarOrden=function(){return a.grado.orden>0?a.grado.orden=a.grado.orden-1:void 0},a.sumarOrden=function(){return a.grado.orden<40?a.grado.orden=a.grado.orden+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("GruposCtrl",["$scope","$filter","$rootScope","$state","$interval","RGrupos","grados","profesores","$modal","App",function(a,b,c,d,e,f,g,h,i,j){var k,l;a.gridScope=a,a.grados=g,a.profesores=h,a.editar=function(a){return console.log("Presionado para editar fila: ",a),d.go("panel.grupos.editar",{grupo_id:a.id})},a.eliminar=function(c){var d;return console.log("Presionado para eliminar fila: ",c),d=i.open({templateUrl:j.views+"grados/removeGrupo.tpl.html",controller:"RemoveGrupoCtrl",size:"sm",resolve:{grupo:function(){return c}}}),d.result.then(function(c){return a.grupos=b("filter")(a.grupos,{id:"!"+c.id}),a.gridOptions.data=a.grupos,console.log("Resultado del modal: ",c)})},k='<a tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',l='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"orden",type:"number",maxWidth:50},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:k+l,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura",maxWidth:50,enableSorting:!1},{field:"titular_id",displayName:"Titular",editDropdownOptionsArray:h,cellFilter:"mapProfesores:grid.appScope.profesores",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombres"},{field:"grado_id",displayName:"Grado",editDropdownOptionsArray:g,cellFilter:"mapGrado:grid.appScope.grados",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre"},{name:"nn",displayName:"",maxWidth:20,enableSorting:!1,enableFiltering:!1}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return console.log("Fila editada, ",b," Column:",c," newValue:"+d+" oldValue:"+e),d!==e&&b.put().then(function(){return a.toastr.success("Grupo actualizado con éxito","Actualizado")},function(b){return a.toastr.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",b)}),a.$apply()})}},f.getList().then(function(b){return a.grupos=b,a.gridOptions.data=a.grupos}),a.$on("grupocreado",function(b){return a.grupos.push(b),a.gridOptions.data=a.grupos})}]).filter("mapGrado",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b})[0],d.nombre):"Elija..."}}]).filter("mapProfesores",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b})[0],d.nombres+" "+d.apellidos):"Seleccione titular..."}}]).controller("RemoveGrupoCtrl",["$scope","$modalInstance","grupo","Restangular","toastr",function(a,b,c,d,e){return a.grupo=c,a.ok=function(){return d.all("grupos/destroy/"+c.id).remove().then(function(){return e.success("Grupo "+c.nombre+" eliminado con éxito.","Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar al grupo."),console.log("Error eliminando grupo: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("GruposNewCtrl",["$scope","$rootScope","$interval","Restangular","RGrupos","RGrados","RProfesores",function(a,b,c,d,e,f,g){return a.grupo={orden:1,caritas:!1,valormatricula:0,valorpension:0},f.getList().then(function(b){return a.grados=b}),g.getList().then(function(b){return a.profesores=b}),a.restarOrden=function(){return a.grupo.orden>0?a.grupo.orden=a.grupo.orden-1:void 0},a.sumarOrden=function(){return a.grupo.orden<40?a.grupo.orden=a.grupo.orden+1:void 0},a.crear=function(){return console.log("Datos a guardar: ",a.grupo,a.grupo.caritas),d.one("grupos/store").customPOST(a.grupo).then(function(b){return console.log("Se hizo el post del grupo",b),a.$emit("grupocreado",b),a.toastr.success("Grupo "+b.nombre+" creado")},function(b){return console.log("Falló al intentar guardar: ",b),a.toastr.error("No se pudo crear el grupo","Error")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("GruposEditCtrl",["$scope","$state","$rootScope","$interval","Restangular","RGrados","RGrupos","RProfesores",function(a,b,c,d,e,f,g,h){return e.one("grupos",b.params.grupo_id).get().then(function(b){return a.grupo=b}),f.getList().then(function(b){return a.grados=b}),h.getList().then(function(b){return a.profesores=b}),a.guardar=function(){return a.grupo.put().then(function(a){return console.log("Se guardó grupo",a)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.restarOrden=function(){return a.grupo.orden>0?a.grupo.orden=a.grupo.orden-1:void 0},a.sumarOrden=function(){return a.grupo.orden<40?a.grupo.orden=a.grupo.orden+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("NivelesCtrl",["$scope","$filter","$rootScope","$state","$interval","RNiveles",function(a,b,c,d,e,f){var g,h;a.gridScope=a,a.editar=function(a){return console.log("Presionado para editar fila: ",a),d.go("panel.niveles.editar",{nivel_id:a.id})},a.eliminar=function(c){return console.log("Presionado para eliminar fila: ",c),c.remove().then(function(c){return a.niveles=b("filter")(a.niveles,{id:"!"+c.id}),a.gridOptions.data=a.niveles},function(a){return console.log("No se pudo eliminar",a)})},g='<a tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',h='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,enableCellEditOnFocus:!0,columnDefs:[{field:"orden",type:"number",maxWidth:50,enableSorting:!1},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:g+h,enableCellEdit:!1},{field:"nombre",enableHiding:!1,enableCellEditOnFocus:!0},{field:"abrev",displayName:"Abreviatura",enableCellEditOnFocus:!0}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b,b.edit.on.afterCellEdit(a,function(b,c,d,e){return console.log("Fila editada, ",b," Column:",c," newValue:"+d+" oldValue:"+e),d!==e&&b.put().then(function(){return a.toastr.success("Nivel actualizado con éxito","Actualizado")},function(b){return a.toastr.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",b)}),a.$apply()})}},f.getList().then(function(b){return a.niveles=b,a.gridOptions.data=a.niveles})}])}.call(this),function(){angular.module("myvcFrontApp").controller("NivelesNewCtrl",["$scope","$rootScope","$interval","Restangular","RNiveles","RPaises","RCiudades",function(a,b,c,d,e){a.nivel={orden:0},a.restarOrden=function(){return a.nivel.orden>0?a.nivel.orden=a.nivel.orden-1:void 0},a.sumarOrden=function(){return a.nivel.orden<40?a.nivel.orden=a.nivel.orden+1:void 0},a.crear=function(){return e.post(a.nivel).then(function(a){return console.log("Se hizo el post del nivel",a)},function(a){return console.log("Falló al intentar guardar: ",a)})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("NivelesEditCtrl",["$scope","$rootScope","$state","Restangular","RNiveles",function(a,b,c,d){return a.nivel={},d.one("niveles_educativos",c.params.nivel_id).get().then(function(b){return a.nivel=b}),a.guardar=function(){return a.nivel.put().then(function(a){return console.log("Se guardó nivel",a)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.restarOrden=function(){return a.nivel.orden>0?a.nivel.orden=a.nivel.orden-1:void 0},a.sumarOrden=function(){return a.nivel.orden<40?a.nivel.orden=a.nivel.orden+1:void 0}}])}.call(this),function(){angular.module("myvcFrontApp").controller("PaisesCtrl",["$scope","$rootScope","$interval",function(a,b,c){var d;a.bigLoader=!0,d=c(function(){return a.bigLoader=!1},1e3),a.gridOptions={enableSorting:!0,columnDefs:[{field:"pais"},{field:"abreviación"},{field:"id"}],onRegisterApi:function(b){return a.gridApi=b}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CiudadesCtrl",["$scope","$rootScope","$interval",function(a,b,c){var d;a.bigLoader=!0,d=c(function(){return a.bigLoader=!1},1e3),a.gridOptions={enableSorting:!0,columnDefs:[{field:"ciudad"},{field:"pais_id"},{field:"id"}],onRegisterApi:function(b){return a.gridApi=b}}}])}.call(this),function(){angular.module("myvcFrontApp").controller("MensajesCtrl",["$scope","$rootScope","$interval",function(){}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){return a.state("panel.filemanager",{url:"/filemanager",views:{maincontent:{templateUrl:""+b.views+"fileManager/fileManager.tpl.html",controller:"FileManagerCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Administrador de archivos"}]}}},data:{displayName:"Administrador de archivos",icon_fa:"fa fa-cube"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("FileManagerCtrl",["$scope","$upload","$timeout","$filter","App","RImages","Restangular","Perfil","$modal","resolved_user",function(a,b,c,d,e,f,g,h,i,j){var k,l,m;a.USER=j,k=function(){return a.dato={imgUsuario:{id:a.USER.imagen_id,nombre:a.USER.imagen_nombre},imgOficial:{id:a.USER.foto_id,nombre:a.USER.foto_nombre}}},k(),a.perfilPath=e.images+"perfil/",a.imgFiles=[],a.errorMsg="",a.fileReaderSupported=null!==window.FileReader&&(null===window.FileAPI||FileAPI.html5!==!1),a.dato.usuarioElegido=[],f.getList().then(function(b){return a.imagenes=b,a.dato.imgParaUsuario=b[0]},function(a){return console.log("No se trajeron las imágenes.",a)}),a.upload=function(b){var c,d,e,f,g;if(a.imgFiles=b,a.errorMsg="",console.log("Entra al upload",b),b&&b.length){for(g=[],d=e=0,f=b.length;f>=0?f>e:e>f;d=f>=0?++e:--e)c=b[d],console.log("file: ",c),g.push(l(c));return g}},l=function(b){return a.errorMsg=null,a.generateThumb(b),m(b)},a.generateThumb=function(b){return null!==b&&a.fileReaderSupported&&b.type.indexOf("image")>-1?c(function(){var a;return a=new FileReader,a.readAsDataURL(b),a.onload=function(a){return c(function(){return b.dataUrl=a.target.result})}}):void 0},m=function(c){return c.size>1e7?void(a.errorMsg="Archivo excede los 10MB permitidos."):b.upload({url:e.Server+"/myimages/store",file:c}).progress(function(a){var b;return b=parseInt(100*a.loaded/a.total),c.porcentaje=b,console.log("progress: "+b+"% "+a.config.file.name,a.config)}).success(function(b,c,d,e){return a.imagenes.push(b),console.log("Success file ",e.file,"   -uploaded: ",b,c)}).error(function(a){return console.log("Falla uploading: ",a)}).xhr(function(){})},a.pedirCambioUsuario=function(b){return g.one("myimages/cambiarimagenperfil",a.USER.user_id).put({imagen_id:b.id}).then(function(c){return h.setImagen(c.imagen_id,b.nombre),a.$emit("cambianImgs",{image:c}),a.toastr.success("Imagen principal cambiada")},function(b){return console.log("NO Se pedirCambioUsuario: ",b),a.toastr.error("No se pudo cambiar imagen","Problema")})},a.pedirCambioOficial=function(b){return g.one("myimages/cambiarimagenoficial",a.USER.user_id).put({foto_id:b.id}).then(function(c){return h.setOficial(c.foto_id,b.nombre),a.$emit("cambianImgs",{foto:c}),a.toastr.success("Foto oficial cambiada")},function(b){return console.log("NO Se pedirCambioOficial: ",b),a.toastr.error("No se pudo cambiar foto","Problema")})},a.imagenSelect=function(a,b){return console.log("imagenSelect: ",a,b)},a.borrarImagen=function(b){var c;return c=i.open({templateUrl:e.views+"fileManager/removeImage.tpl.html",controller:"RemoveImageCtrl",size:"sm",resolve:{imagen:function(){return b}}}),c.result.then(function(b){return a.imagenes=d("filter")(a.imagenes,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},g.all("perfiles/usuariosall").getList().then(function(b){return a.usuariosall=b,a.dato.usuarioElegido=b[0]},function(){return console.log("No se pudo traer los usuarios")}),a.cambiarImgUnUsuario=function(b,c){var e;return console.log("Vamos a guardar el cambio de imagen",b,c),e={imgParaUsuario:c.id},g.one("perfiles/cambiarimgunusuario",b.user_id).customPUT(e).then(function(e){var f;return f=d("filter")(a.usuariosall,{user_id:b.user_id}),f[0].imagen_id=c.id,f[0].imagen_nombre=c.nombre,a.toastr.success("Imagen asignada con éxito"),console.log(e)},function(b){return console.log("Error al asignar imagen a usuario",b),a.toastr.error("Error al asignar imagen a usuario","Problema")})},a.usuarioSelect=function(b){return a.dato.selectUsuarioModel=b},a.cambiarFotoAlumno=function(){return console.log("Vamos a guardar el cambio de foto")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("RemoveImageCtrl",["$scope","$modalInstance","imagen","App","Restangular",function(a,b,c,d,e){a.imagesPath=d.images+"perfil/",a.imagen=c,a.ok=function(){return e.all("myimages/destroy/"+c.id).remove().then(function(){return console.log("Imagen removida con éxito.")
},function(a){return console.log("No se pudo eliminar la imagen.",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(a,b){return a.state("panel.papelera",{url:"^/papelera",views:{maincontent:{templateUrl:""+b.views+"papelera/papelera.tpl.html",controller:"PapeleraCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Papelera de reciclaje"}]}}},data:{displayName:"Papelera",icon_fa:"fa fa-trash"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("PapeleraCtrl",["$scope","App","$rootScope","$state","$interval","Restangular","$modal","$filter",function(a,b,c,d,e,f,g,h){var i,j,k,l;return a.restaurarAlum=function(b){return f.one("alumnos/restore",b.alumno_id).customPUT().then(function(){return a.gridAlumnos.data=h("filter")(a.gridAlumnos.data,{alumno_id:"!"+b.alumno_id}),a.toastr.success("Éxito","Alumno restaurado")},function(c){return console.log("No se pudo restaurar alumno.",b,c),a.toastr.error("No se restauró el alumno","Error")})},a.elimAlum=function(c){var d;return console.log("Presionado para eliminar fila: ",c),d=g.open({templateUrl:b.views+"papelera/forceRemoveAlumno.tpl.html",controller:"ForceRemoveAlumnoCtrl",size:"sm",resolve:{alumno:function(){return c}}}),d.result.then(function(b){return a.gridAlumnos.data=h("filter")(a.gridAlumnos.data,{alumno_id:"!"+b.alumno_id}),console.log("Resultado del modal: ",b)})},i='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarAlum(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',j='<a tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimAlum(row.entity)"><i class="fa fa-times "></i></a>',a.gridAlumnos={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"alumno_id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:i+j},{field:"nombres",enableHiding:!1},{field:"apellidos"},{field:"sexo",maxWidth:20},{field:"username",displayName:"Usuario"},{field:"fecha_nac",displayName:"Nacimiento",cellFilter:"date:mediumDate",type:"date"},{field:"direccion",displayName:"Dirección"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},a.restaurarGrupo=function(b){return f.one("grupos/restore",b.id).customPUT().then(function(){return a.gridGrupos.data=h("filter")(a.gridGrupos.data,{id:"!"+b.id}),a.toastr.success("Éxito","Grupo restaurado")},function(c){return console.log("No se pudo restaurar grupo.",b,c),a.toastr.error("No se restauró el grupo","Error")})},a.elimGrupo=function(c){var d;return console.log("Presionado para eliminar fila: ",c),d=g.open({templateUrl:b.views+"papelera/forceRemoveGrupo.tpl.html",controller:"ForceRemoveGrupoCtrl",size:"sm",resolve:{grupo:function(){return c}}}),d.result.then(function(b){return a.gridGrupos.data=h("filter")(a.gridGrupos.data,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},k='<a class="btn btn-default btn-xs shiny info" ng-click="grid.appScope.restaurarGrupo(row.entity)"><i class="fa fa-refresh "></i>Restaurar</a>',l='<a tooltip="¡Eliminar completamente!" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.elimGrupo(row.entity)"><i class="fa fa-times "></i></a>',a.gridGrupos={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",maxWidth:40},{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:k+l},{field:"nombre",enableHiding:!1},{field:"abrev",displayName:"Abreviatura"},{field:"grado_id",maxWidth:20},{field:"titular_id",displayName:"Titular"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},f.all("alumnos/trashed").getList().then(function(b){return a.gridAlumnos.data=b},function(a){return console.log("No se pudo traer los alumnos eliminados.",a)}),f.all("grupos/trashed").getList().then(function(b){return a.gridGrupos.data=b},function(a){return console.log("No se pudo traer los grupos eliminados.",a)})}]).controller("ForceRemoveAlumnoCtrl",["$scope","$modalInstance","alumno","Restangular","toastr",function(a,b,c,d,e){return a.alumno=c,a.ok=function(){return d.all("alumnos/forcedelete/"+c.alumno_id).remove().then(function(){return e.success("Alumno eliminado con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar al alumno.","Problema"),console.log("Error eliminando alumno: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("ForceRemoveGrupoCtrl",["$scope","$modalInstance","grupo","Restangular","toastr",function(a,b,c,d,e){return a.grupo=c,a.ok=function(){return d.all("grupos/forcedelete/"+c.id).remove().then(function(){return e.success("Grupo eliminado con éxito.","Eliminado")},function(a){return e.warning("No se pudo eliminar al grupo.","Problema"),console.log("Error eliminando grupo: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App",function(a,b){return a.state("panel.bitacora",{url:"/bitacora",views:{maincontent:{templateUrl:""+b.views+"bitacora/bitacora.tpl.html",controller:"BitacoraCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Bitacora"}]}}},data:{displayName:"Bitacora",icon_fa:"fa fa-male"}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("BitacoraCtrl",["$scope","$rootScope","$state","Restangular","RAlumnos","RPaises","RCiudades",function(a){return a.data={}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS",function(a,b,c,d){a.state("panel.usuarios",{url:"^/usuarios",views:{maincontent:{templateUrl:""+b.views+"usuarios/usuarios.tpl.html",controller:"UsuariosCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Usuarios"}]}}},data:{displayName:"Usuarios",icon_fa:"fa fa-user",Permissions:[d.can_see_alumnos]}}),a.state("panel.user",{url:"^/user/:username",views:{maincontent:{templateUrl:""+b.views+"usuarios/user.tpl.html",controller:"UserCtrl"},headerContent:{templateUrl:""+b.views+"panel/panelHeader.tpl.html",controller:"PanelHeaderCtrl",resolve:{titulo:[function(){return"Perfil"}]}}},data:{displayName:"Perfil",icon_fa:"fa fa-user",Permissions:[d.can_see_alumnos]}}),a.state("panel.user.resumen",{url:"/r",views:{user_detail:{templateUrl:""+b.views+"usuarios/userResumen.tpl.html",controller:"UserResumenCtrl"}},data:{displayName:"Resumen",icon_fa:"fa fa-user",Permissions:[d.can_see_alumnos]}}),a.state("panel.user.configuracion",{url:"/c",views:{user_detail:{templateUrl:""+b.views+"usuarios/userConfiguracion.tpl.html",controller:"UserConfiguracionCtrl"}},data:{displayName:"Configuración",icon_fa:"fa fa-user",Permissions:[d.can_see_alumnos]}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserCtrl",["$scope","$http","Restangular","$state","$rootScope","AuthService","Perfil","App",function(a,b,c,d,e,f,g,h){var i,j;return j=d.params.username,a.perfilactual={},a.companieros=[],a.profesores=[],a.materias=[],j&&c.one("perfiles/username").getList(j).then(function(b){return a.perfilactual=b[0],a.setImagenPrincipal()},function(a){return console.log("No se pudo traer el usuario, ",a),d.transitionTo("panel")}),a.setImagenPrincipal=function(){var b,c,d,e,f;return d=h.images+"perfil/",c=a.perfilactual.imagen_nombre,b=a.perfilactual.foto_nombre,f=d+c,e=d+b,a.imagenPrincipal=f,a.imagenOficial=e},i=function(){return c.one("perfiles/profesormispersonas").getList().then(function(b){return a.perfilactual=b[0],a.setImagenPrincipal()},function(a){return console.log("No se pudo traer el usuario, ",a),d.transitionTo("panel")})},a.nameToShow=function(){return"Usu"===a.perfilactual.tipo?a.perfilactual.username.toUpperCase():a.perfilactual.nombres+" "+a.perfilactual.apellidos}}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserConfiguracionCtrl",["$scope","$http","Restangular","$state","$rootScope","AuthService","Perfil","App",function(a,b,c){return a.data={},a.comprobando=!1,a.mostrarErrorUsername=!1,a.mostrarErrorPassword=!1,a.newusername="",a.passantiguo="",a.nombresdeusuario=[],c.all("perfiles/usernames").getList().then(function(b){return a.nombresdeusuario=b},function(a){return console.log("No se trajeron los nombres de usuario",a)}),a.comprobarusername=function(){return a.comprobando=!0,a.newusername.username&&(a.newusername=a.newusername.username),""===a.newusername?(a.toastr.warning("Debes copiar un nombre de usuario."),void(a.comprobando=!1)):c.all("perfiles/comprobarusername/"+a.newusername).getList().then(function(b){return a.mostrarErrorUsername=b[0].existe?!0:!1,a.comprobando=!1},function(b){return console.log("No se trajeron los nombres de usuario",b),a.comprobando=!1})},a.guardar=function(){var b;return console.log("A guardar"),b={nombres:a.perfilactual.nombres,apellidos:a.perfilactual.apellidos,sexo:a.perfilactual.sexo,fecha_nac:a.perfilactual.fecha_nac,celular:a.perfilactual.celular,email:a.perfilactual.email,tipo:a.perfilactual.tipo},c.one("perfiles/update",a.perfilactual.persona_id).customPUT(b).then(function(b){return console.log("Datos guardados, ",b),a.toastr.success("Datos guardados")},function(b){return console.log("No se pudo guardar cambios, ",b),a.toastr.error("Datos NO guardados","Problema")})},a.CambiarUsername=function(){return c.one("perfiles/guardarusername",a.perfilactual.user_id).customPUT({username:a.newusername}).then(function(b){return console.log("Nombre de usuario guardado, ",b),a.toastr.success("Nombre de usuario guardado")},function(b){return console.log("No se pudo guardar nombre de usuario, ",b),a.toastr.error("Nombre de usuario NO guardado","Problema")})},a.CambiarPass=function(){var b;return a.newpass!==a.newpassverif?void a.toastr.warning("Las contraseñas no coinciden"):a.newpass.length<4?void a.toastr.warning("La contraseña debe tener mínimo 4 caracteres. Sin espacios ni Ñ ni tildes."):(b={password:a.newpassverif,oldpassword:a.passantiguo},console.log(b),c.one("perfiles/cambiarpassword",a.perfilactual.user_id).customPUT(b).then(function(b){return console.log("Contraseña cambiada, ",b),a.toastr.success("Contraseña cambiada.")},function(b){return console.log("No se pudo cambiar la contraseña, ",b),a.toastr.error("No se pudo cambiar la contraseña","Problema")}))}}])}.call(this),function(){angular.module("myvcFrontApp").controller("UserResumenCtrl",["$scope","$http","Restangular","$state","$rootScope","AuthService","Perfil","App",function(){}])}.call(this),function(){angular.module("myvcFrontApp").controller("UsuariosCtrl",["$scope","$http","Restangular","$state","$rootScope","AuthService","Perfil","App",function(a,b,c){return a.crearTodosLosUsuarios=function(){return c.one("perfiles/creartodoslosusuarios").customPUT().then(function(b){return console.log("Usuarios creados, ",b),a.toastr.success("Usuarios creados con éxito")},function(b){return console.log("No se pudo crear los usuarios, ",b),a.toastr.error("No se pudo crear los usuarios","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").config(["$stateProvider","App","PERMISSIONS",function(a,b,c){a.state("votaciones",{url:"/votaciones",views:{principal:{templateUrl:""+b.views+"votaciones/inicio.tpl.html",controller:"InicioCtrl"}},resolve:{resolved_user:["AuthService",function(a){return a.verificar()}]},data:{needed_permissions:[c.can_see_panel]}}).state("votaciones.config",{url:"/config",views:{maincontent:{templateUrl:""+b.views+"votaciones/votaciones.tpl.html",controller:"VotacionesCtrl"}}}).state("votaciones.aspiraciones",{url:"/aspiraciones",views:{maincontent:{templateUrl:""+b.views+"votaciones/aspiraciones.tpl.html",controller:"AspiracionesCtrl"}}}).state("votaciones.candidatos",{url:"/candidatos",views:{maincontent:{templateUrl:""+b.views+"votaciones/candidatos.tpl.html",controller:"CandidatosCtrl"}}}).state("votaciones.participantes",{url:"/participantes",views:{maincontent:{templateUrl:""+b.views+"votaciones/participantes.tpl.html",controller:"ParticipantesCtrl"}}}).state("votaciones.votar",{url:"/votar/:maxi",views:{maincontent:{templateUrl:""+b.views+"votaciones/votar.tpl.html",controller:"VotarCtrl"}}}).state("votaciones.resultados",{url:"/resultados",views:{maincontent:{templateUrl:""+b.views+"votaciones/resultados.tpl.html",controller:"ResultadosCtrl"}}})}])}.call(this),function(){angular.module("myvcFrontApp").controller("VotacionesCtrl",["$scope","$filter","$rootScope","RVotaciones","Restangular","resolved_user",function(a,b,c,d,e){var f,g;a.data={},a.editing=!1,a.gridScope=a,a.votacionEdit={},a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.editar=function(b){return console.log("Presionado para editar fila: ",b),a.editing=!0,a.votacionEdit=b},a.eliminar=function(c){return e.all("votaciones/destroy/"+c.id).remove().then(function(d){return console.log("Se ha eliminado: ",d),a.gridOptions.data=b("filter")(a.gridOptions.data,{id:"!"+c.id})},function(a){return console.log("No se pudo eliminar.",a)})},f='<a tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',g='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:f+g,enableCellEdit:!1},{field:"nombre",enableHiding:!1},{field:"locked",displayName:"Bloqueado",maxWidth:50},{field:"actual",displayName:"Actual",maxWidth:50},{field:"in_action",displayName:"En acción",maxWidth:50},{field:"fecha_inicio",displayName:"Fecha inicio",cellFilter:"date:mediumDate",type:"date"},{field:"fecha_fin",displayName:"Fecha fin",cellFilter:"date:mediumDate",type:"date"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},d.getList().then(function(b){return a.gridOptions.data=b},function(a){return console.log("Error trayendo los eventos. ",a)}),a.crear=function(){return e.all("votaciones/store").post(a.votacion).then(function(b){return console.log("Se hizo el post de la votación",b),b.actual&&angular.forEach(a.gridOptions.data,function(a){return a.actual=0}),a.gridOptions.data.push(b)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.guardar=function(){return a.votacionEdit.put().then(function(a){return console.log("Se hizo el put de la votación",a)},function(a){return console.log("Falló al intentar guardar: ",a)})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("InicioCtrl",["$scope","$rootScope","$interval","resolved_user","App","AuthService",function(a,b,c,d,e,f){a.verificar_acceso(),a.logoPath="images/MyVc-1.gif",a.hasRoleOrPerm=f.hasRoleOrPerm,a.USER=d,a.setImagenPrincipal=function(){var b,c,d,f,g;return d=e.images+"perfil/",c=a.USER.imagen_nombre,b=a.USER.foto_nombre,g=d+c,f=d+b,a.imagenPrincipal=g,a.imagenOficial=f},a.setImagenPrincipal(),a.nameToShow=function(){return"Usu"===a.USER.tipo?a.USER.username.toUpperCase():a.USER.nombres+" "+a.USER.apellidos}}])}.call(this),function(){angular.module("myvcFrontApp").controller("AspiracionesCtrl",["$scope","$filter","$rootScope","RAspiraciones","Restangular",function(a,b,c,d,e){var f,g;a.editing=!1,a.gridScope=a,a.aspiracionEdit={},a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.editar=function(b){return console.log("Presionado para editar fila: ",b),a.editing=!0,a.aspiracionEdit=b},a.eliminar=function(c){return c.remove().then(function(c){return console.log("Se ha eliminado: ",c),a.gridOptions.data=b("filter")(a.gridOptions.data,{id:"!"+c.id})},function(a){return console.log("No se pudo eliminar.",a)})},f='<a tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',g='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:f+g,enableCellEdit:!1},{field:"aspiracion",displayName:"Aspiración"},{field:"abrev",displayName:"Abreviatura"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},d.getList().then(function(b){return a.gridOptions.data=b},function(a){return console.log("Error trayendo las aspiraciones. ",a)}),e.one("votaciones/actual").get().then(function(b){return a.votacion=b}),a.crear=function(){return a.aspiracion.votacion_id=a.votacion.id,d.post(a.aspiracion).then(function(b){return console.log("Se hizo el post de la votación",b),a.gridOptions.data.push(b)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.guardar=function(){return a.aspiracionEdit.put().then(function(a){return console.log("Se hizo el put de la aspiración. ",a)},function(a){return console.log("Falló al intentar guardar: ",a)})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("CandidatosCtrl",["$scope","$filter","Restangular",function(a,b,c){a.aspiraciones=[],a.allinscritos=[],c.all("candidatos/conaspiraciones").getList().then(function(b){return a.aspiraciones=b},function(b){return console.log("No se pudo con aspiraciones. ",b),a.toastr.error("No se pudo traer las aspiraciones","Problema")}),c.all("participantes/allinscritos").getList().then(function(b){return a.allinscritos=b},function(b){return console.log("No se pudo con los inscritos. ",b),a.toastr.error("No se pudo traer los inscritos","Problema")}),a.crearCandidato=function(b){var d;return d=[],d.participante_id=b.newParticip.participante_id,d.plancha=b.newParticip.plancha,d.numero=b.newParticip.numero,d.aspiracion_id=b.id,c.all("candidatos/store").post("candidato",d).then(function(c){return console.log("Candidato creado.",c),c.persona_id=b.newParticip.persona_id,c.nombres=b.newParticip.nombres,c.apellidos=b.newParticip.apellidos,c.user_id=b.newParticip.user_id,c.username=b.newParticip.username,c.tipo=b.newParticip.tipo,b.candidatos.push(c),b.newParticip=null,a.toastr.success("Candidato creado con éxito")},function(b){return"Candidato ya inscrito."===b.error.message?a.toastr.warning("Candidato ya inscrito en esta aspiración"):(console.log("Error al crear candidato. ",b),a.toastr.warning("No se pudo crear el candidato","Problema"))})},a.eliminarCandidato=function(d,e){return c.all("candidatos/destroy/"+d).remove().then(function(c){return console.log("Candidatura quitada.",c),e.candidatos=b("filter")(e.candidatos,{candidato_id:"!"+d}),a.toastr.success("Candidato removido de la candidatura")},function(b){return console.log("No se pudo quitar de la candidatura",b),a.toastr.error("No se pudo quitar de la candidatura","Problema")})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ParticipantesCtrl",["$scope","$filter","$rootScope","RParticipantes","RGrupos","Restangular","RUsers",function(a,b,c,d,e,f){var g,h;a.editing=!1,a.gridScope=a,a.participante={},a.participanteEdit={},a.grupoInscribir={grupo:{}},a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.editar=function(b){return console.log("Presionado para editar fila: ",b),a.editing=!0,a.participanteEdit=b},a.eliminar=function(c){return f.one("participantes/destroy/"+c.id).remove().then(function(c){return console.log("Se ha eliminado: ",c),a.gridOptions.data=b("filter")(a.gridOptions.data,{id:"!"+c.id}),a.actualizarUsuarios()},function(a){return console.log("No se pudo eliminar.",a)})},g='<a tooltip="Editar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',h='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-times "></i></a>',a.gridOptions={enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{name:"edicion",displayName:"Edición",maxWidth:50,enableSorting:!1,enableFiltering:!1,cellTemplate:g+h,enableCellEdit:!1},{field:"username",displayName:"Usuario"},{field:"locked",displayName:"Bloqueado"},{field:"intentos",displayName:"Intentos"}],multiSelect:!1,onRegisterApi:function(b){return a.gridApi=b}},d.getList().then(function(b){return a.gridOptions.data=b},function(a){return console.log("Error trayendo las aspiraciones. ",a)}),e.getList().then(function(b){return a.grupos=b},function(a){return console.log("Error trayendo los grupos. ",a)}),a.actualizarUsuarios=function(){return f.one("votaciones/unsignedsusers").get().then(function(b){return a.usuarios=b},function(a){return console.log("Error trayendo los usuarios. ",a)})},a.actualizarUsuarios(),f.one("votaciones/actual").get().then(function(b){return a.votacion=b}),a.crear=function(){return console.log("Datos a guardar: ",a.participante),d.post(a.participante).then(function(c){return console.log("Se hizo el post del participante: ",c),a.gridOptions.data.push(c),a.usuarios=b("filter")(a.usuarios,{id:"!"+c.user_id}),a.participante.user=null},function(a){return console.log("Falló al intentar guardar: ",a)})},a.guardar=function(){var b,c;return b=a.participanteEdit,c={id:b.id,user_id:b.user_id,votacion_id:b.votacion_id,locked:b.locked,intentos:b.intentos},f.one("participantes/update",c.id).put(c).then(function(a){return console.log("Se hizo el put del participante. ",a)},function(a){return console.log("Falló al intentar guardar: ",a)})},a.inscribirGrupo=function(){return f.all("participantes/inscribirgrupo/"+a.grupoInscribir.grupo.id).post().then(function(a){return console.log("Se inscribió el grupo. ",a)},function(a){return console.log("Error al intentar inscribir grupo.",a)})}}])}.call(this),function(){angular.module("myvcFrontApp").controller("VotarCtrl",["$scope","$filter","Restangular","App","$state","$modal","$window",function(a,b,c,d,e,f,g){a.hover=!1,a.aspiraciones=[],a.maxi=e.params.maxi,a.windowHeight=angular.element(g).height()-100,a.wzStep=0,a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},c.one("votaciones/actual").get().then(function(b){return a.votacion=b}),c.all("candidatos/conaspiraciones").getList().then(function(b){return a.aspiraciones=b},function(b){return console.log("No se pudo traer aspiraciones. ",b),a.toastr.error("No se pudo traer las aspiraciones","Problema")}),c.all("participantes/allinscritos").getList().then(function(b){return a.allinscritos=b},function(b){return console.log("No se pudo con aspiraciones. ",b),a.toastr.error("No se pudo traer los inscritos","Problema")}),a.currentImg="default_male.jpg",a.imagesPath=d.images+"perfil/",a.mostrarImagen=function(b){return b.iluminado=!0,a.currentImg=b.imagen_nombre},a.ocultarImagen=function(a){return a.iluminado=!1},a.nextAspiracion=function(){return a.wzStep<a.aspiraciones.length?a.wzStep+=1:void 0},a.prevAspiracion=function(){return a.wzStep>0?a.wzStep-=1:void 0},a.goAspiracion=function(b){return a.wzStep=parseInt(a.wzStep),b=parseInt(b),b<a.wzStep?a.wzStep=b:void 0},a.open=function(b,c){var e;return e=f.open({templateUrl:d.views+"votaciones/chooseCandidato.tpl.html",controller:"chooseCandidatoCtrl",resolve:{candidato:function(){return b},aspiracion:function(){return c.aspiracion}}}),e.result.then(function(b){return c.votado.push(b),console.log("Resultado del modal: ",b),a.toastr.success("Voto guardado con éxito"),a.nextAspiracion()},function(){return console.log("Modal dismissed at: "+new Date)})}}]).controller("chooseCandidatoCtrl",["$scope","Restangular","$modalInstance","App","candidato","aspiracion",function(a,b,c,d,e,f){return a.candidato=e,a.aspiracion=f,a.imagesPath=d.images+"perfil/",a.ok=function(){var a;return a={},a.candidato_id=e.candidato_id,console.log("Los datos ",a,e),b.all("votos/store").post("",a).then(function(a){return console.log("Voto guardado.",a),c.close(a)},function(a){return console.log("No se pudo guardar el voto.",a),c.dismiss("Error al guardar")})},a.cancel=function(){return c.dismiss("cancel")}}])}.call(this),function(){angular.module("myvcFrontApp").controller("ResultadosCtrl",["$scope","$filter","Restangular","App","$state","$modal","$window",function(a,b,c,d){a.votacion={locked:!1,is_action:!1,fecha_inicio:"",fecha_fin:""},a.imagesPath=d.images+"perfil/",c.one("votaciones/actual").get().then(function(b){return a.votacion=b}),c.one("votos/show").get().then(function(b){return a.aspiraciones=b,console.log(a.aspiraciones)},function(a){return console.log("Error trayendo las votaciones. ",a)})}])}.call(this),function(){angular.module("myvcFrontApp").directive("loader",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"directives/loader.tpl.html",scope:{cargando:"="},link:function(){}}}])}.call(this),angular.module("uiBreadcrumbs",["ui.router","myvcFrontApp"]).directive("uiBreadcrumbs",["$interpolate","$state","App",function(a,b,c){return{restrict:"E",templateUrl:c.views+"directives/uiBreadcrumbs.tpl.html",scope:{displaynameProperty:"@"},link:function(c){function d(){for(var a=[],d=b.$current;d&&""!==d.name;){var g=e(d),h=f(d);g!==!1&&a.push({displayName:g,route:d.name,icon_fa:h}),d=d.parent}a.reverse(),c.breadcrumbs=a}function e(b){var d,e,f,g;if(!c.displaynameProperty)return b.name;for(f=c.displaynameProperty.split("."),e=b,d=0;d<f.length;d++){if(!angular.isDefined(e[f[d]]))return b.name;if(e[f[d]]===!1)return!1;e=e[f[d]]}return g=a(e)(b.locals.globals)}function f(b){var c,d;return c=b,angular.isDefined(c.data.icon_fa)?c.data.icon_fa===!1?!1:(c=c.data.icon_fa,d=a(c)(b.locals.globals)):""}c.breadcrumbs=[],""!==b.$current.name&&d(),c.$on("$stateChangeSuccess",function(){d()})}}}]),function(){angular.module("myvcFrontApp").directive("databoxesContainer",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"directives/databoxesContainer.tpl.html",scope:{cargando:"="},link:function(){}}}])}.call(this),function(){angular.module("myvcFrontApp").directive("sidebarMenu",["App","$rootScope","AuthService",function(a,b,c){return{restrict:"E",replace:!0,templateUrl:""+a.views+"directives/sidebarMenu.tpl.html",scope:{cargando:"="},link:function(){},controller:["$scope","$attrs",function(a){return this.groups=[],a.hasRoleOrPerm=c.hasRoleOrPerm,a.$state=b.$state,this.clikeando=function(){return console.log("Menu compacto",b.menucompacto)},this.closeOthers=function(){return angular.forEach(this.groups,function(a){return a.menuIsOpen===!0?a.menuIsOpen=!1:void 0})},this.addGroup=function(a){var b;return b=this,this.groups.push(a),a.$on("$destroy",function(){return b.removeGroup(a)})},this.removeGroup=function(a){var b;return b=this.groups.indexOf(a),-1!==b?this.groups.splice(b,1):void 0}}]}}]).directive("subMenu",[function(){return{require:"^sidebarMenu",restrict:"A",replace:!0,scope:!0,link:function(a,b,c,d){return a.menuIsOpen=c.menuIsOpen?a.$eval(c.menuIsOpen):!1,c.hija?(a.menuIsOpen===!0&&b.addClass("open"),a.toggleOpen=function(){return a.menuIsOpen===!1?(b.addClass("open"),a.menuIsOpen=!0):(b.removeClass("open"),a.menuIsOpen=!1),console.log("Valor de scope.menuIsOpen: ",a.menuIsOpen)}):(d.addGroup(a),a.$watch("menuIsOpen",function(a){return a===!0?b.addClass("open"):b.removeClass("open")}),a.toggleOpen=function(){return a.menuIsOpen===!1?(d.closeOthers(a),a.menuIsOpen=!0):a.menuIsOpen=!1})}}}]).directive("myDropDown",["$document",function(a){return{restrict:"A",replace:!0,scope:!0,link:function(b,c,d){b.menuIsOpen=d.menuIsOpen?b.$eval(d.menuIsOpen):!1,b.menuIsOpen===!0&&c.addClass("open"),b.toggleOpen=function(){b.menuIsOpen===!1?(c.addClass("open"),b.menuIsOpen=!0,a.bind("click",function(a){var d;return(d=c.find(a.target).length>0)?void 0:(b.menuIsOpen=!1,c.removeClass("open"),b.$apply())})):(c.removeClass("open"),b.menuIsOpen=!1)}}}}]).directive("stopEvent",[function(){return{restrict:"A",link:function(a,b,c){return b.bind(c.stopEvent,function(a){return a.stopPropagation()})}}}]).directive("toggle",function(){var a,b,c,d,e;return e="selected",b={},a=function(a,c){return b[a]=b[a]||[],-1===b[a].indexOf(c)?b[a].push(c):void 0},c=function(a,c){var d;return d=(b[a]||[]).indexOf(c),-1!==d?b[a].splice(d,1):void 0},d=function(a,c){return angular.forEach(b[a]||[],function(a){return a.removeClass(e)}),c.addClass(e)},{restrict:"A",link:function(b,e,f){var g;return g=f.toggle||"default",a(g,e),e.on("click",function(){return b.$apply(function(){return d(g,e)})}),b.$on("$destroy",function(){return e.off(),c(g,e)})}}})}.call(this),function(){angular.module("myvcFrontApp").factory("Perfil",["RUsers","Restangular","App","$q","$cookies","$rootScope","AUTH_EVENTS","$http",function(){var a;return a={},{setUser:function(b){return a=b},User:function(){return a},save:function(){return a.save()},id:function(){return a.id},idioma:function(){return a.idioma_system},setImagen:function(b,c){return a.imagen_id=b,a.imagen_nombre=c},setOficial:function(b,c){return a.foto_id=b,a.foto_nombre=c},nameToShow:function(){return"Usu"===a.tipo?a.username.toUpperCase():a.nombres+" "+a.apellidos}}}])}.call(this),function(){angular.module("myvcFrontApp").factory("AuthService",["Restangular","$state","$http","$cookies","Perfil","$rootScope","AUTH_EVENTS","$q","$filter",function(a,b,c,d,e,f,g,h,i){var j;return j={},j.verificar=function(){var a;return a=h.defer(),e.User().user_id?a.resolve(e.User()):d.xtoken?void 0!==d.xtoken&&"undefined"!==d.xtoken&&"[object Object]"!==d.xtoken?j.login_from_token().then(function(b){return e.setUser(b),a.resolve(b)},function(b){return a.reject(b)}):(console.log("Token mal estructurado: ",d.xtoken),j.borrarToken(),a.reject("Token mal estructurado.")):(console.log("No hay token"),a.resolve("No hay token."),b.go("login")),a.promise},j.verificar_acceso=function(){var a,c;return e.User().user_id||b.go("login"),c=b.current,console.log("Verficar accesso: ",b.current,c.data),c.data.needed_permissions&&(a=c.data.needed_permissions,console.log("needed_permissions: ",a,c),!j.isAuthorized(a))?(event.preventDefault(),console.log("No tiene permisos, y... "),f.lastState=c.name,j.isAuthenticated()?(f.$broadcast(g.notAuthorized),console.log("...está Autenticado.")):(console.log("...NO está Autenticado."),b.transitionTo("login"))):void 0},j.login_credentials=function(b){var i;return i=h.defer(),j.borrarToken(),a.one("login").post("",b).then(function(a){return a.token?(d.xtoken=a.token,c.defaults.headers.common.Authorization="Bearer "+d.xtoken,e.setUser(a),console.log("Usuario traido: ",a),f.$broadcast(g.loginSuccess),i.resolve(a)):(console.log("No se trajo un token en el login.",a),f.$broadcast(g.loginFailed),i.reject("Error en login"))},function(a){return console.log("No se pudo loguear. ",a),f.$broadcast(g.loginFailed),i.reject("Error en login")}),i.promise},j.login_from_token=function(){var b,e;return b=h.defer(),c.defaults.headers.common.Authorization="Bearer "+d.xtoken,e=a.one("login").post().then(function(a){return f.$broadcast(g.loginSuccess),b.resolve(a)},function(a){return console.log("No se pudo loguear con token. ",a),b.reject("Error en login con token.")}),b.promise},j.logout=function(){return a.one("logout").get(),delete c.defaults.headers.common.Authorization,delete d.xtoken,b.transitionTo("login")},j.isAuthenticated=function(){return!!e.User().user_id},j.isAuthorized=function(a){var b;return console.log("Perfil.User().is_superuser",e.User().is_superuser),1===e.User().is_superuser?!0:(angular.isArray(a)||(a=[a]),angular.isArray(e.User().perms)?(b=[],_.each(a,function(a){return-1!==e.User().perms.indexOf(a)?b.push(a):void 0
}),console.log("Perfil.User().perms: ",e.User().perms,a,b,b.length>0),j.isAuthenticated()&&b.length>0):a.length>0?!0:!1)},j.borrarToken=function(){return delete d.xtoken,delete c.defaults.headers.common.Authorization},j.hasRoleOrPerm=function(a){var b;if(!angular.isArray(a)){if(!a)return!1;a=[a]}return b=[],_.each(a,function(a){var c;return c=i("filter")(e.User().roles,{name:a}),c.length>0?b.push(a):void 0}),b.length>0},j}])}.call(this),function(){angular.module("myvcFrontApp").factory("RUsers",["Restangular",function(a){return a.service("user")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RAlumnos",["Restangular",function(a){return a.service("alumnos")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RAsignaturas",["Restangular",function(a){return a.service("asignaturas")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RCiudades",["Restangular",function(a){return a.service("ciudades")}]).factory("RPaises",["Restangular",function(a){return a.service("paises")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RDefinicionesComportamiento",["Restangular",function(a){return a.service("definicionescomportamiento")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RFrases",["Restangular",function(a){return a.service("frases")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RNiveles",["Restangular",function(a){return a.service("niveles_educativos")}]).factory("RGrados",["Restangular",function(a){return a.service("grados")}]).factory("RGrupos",["Restangular",function(a){return a.service("grupos")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RMaterias",["Restangular",function(a){return a.service("materias")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RImages",["Restangular",function(a){return a.service("myimages")}]).factory("RAskedImages",["Restangular",function(a){return a.service("asked_images")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RNotas",["Restangular",function(a){return a.service("notas")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RNotasComportamiento",["Restangular",function(a){return a.service("notascomportamiento")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RPeriodos",["Restangular",function(a){return a.service("periodos")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RProfesores",["Restangular",function(a){return a.service("profesores")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RSubUnidades",["Restangular",function(a){return a.service("subunidades")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RUnidades",["Restangular",function(a){return a.service("unidades")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RYears",["Restangular",function(a){return a.service("years")}])}.call(this),function(){angular.module("myvcFrontApp").factory("RVotaciones",["Restangular",function(a){return a.service("votaciones")}]).factory("RParticipantes",["Restangular",function(a){return a.service("participantes")}]).factory("RAspiraciones",["Restangular",function(a){return a.service("aspiraciones")}]).factory("RCandidatos",["Restangular",function(a){return a.service("candidatos")}])}.call(this),function(){angular.module("myvcFrontApp").factory("GruposServ",["RGrupos",function(a){var b;return b={getGrupos:function(){return a.getList()}}}])}.call(this);